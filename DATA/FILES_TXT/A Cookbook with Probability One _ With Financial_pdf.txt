A Cookbook with Probability One _ With Financial.pdf

UNITEXT  161 
A Cookbook  
with Probability 
One
Damiano Rossello
With Financial Applications
UNITEXT 
La Matematica per il 3+2 
Volume 161 
Editor-in-Chief 
Alﬁo Quarteroni, Politecnico di Milano, Milan, Italy 
École Polytechnique Fédérale de Lausanne (EPFL), Lausanne, Switzerland 
Series Editors 
Luigi Ambrosio, Scuola Normale Superiore, Pisa, Italy 
Paolo Biscari, Politecnico di Milano, Milan, Italy 
Ciro Ciliberto, Università di Roma “Tor Vergata”, Rome, Italy 
Camillo De Lellis, Institute for Advanced Study, Princeton, NJ, USA 
Victor Panaretos, Institute of Mathematics,École Polytechnique Fédérale de 
Lausanne (EPFL), Lausanne, Switzerland 
Lorenzo Rosasco, DIBRIS, Università degli Studi di Genova, Genova, Italy 
Center for Brains Mind and Machines, Massachusetts Institute of Technology, 
Cambridge, Massachusetts, US 
Istituto Italiano di Tecnologia, Genova, Italy
The UNITEXT - La Matematica per il 3+2 series is designed for undergraduate 
and graduate academic courses, and also includes books addressed to PhD students 
in mathematics, presented at a sufﬁciently general and advanced level so that the 
student or scholar interested in a more speciﬁc theme would get the necessary 
background to explore it. 
Originally released in Italian, the series now publishes textbooks in English 
addressed to students in mathematics worldwide. 
Some of the most successful books in the series have evolved through several 
editions, adapting to the evolution of teaching curricula. 
Submissions must include at least 3 sample chapters, a table of contents, and 
a preface outlining the aims and scope of the book, how the book ﬁts in with the 
current literature, and which courses the book is suitable for. 
For 
any 
further 
information, 
please 
contact 
the 
Editor 
at 
Springer: 
francesca.bonadei@springer.com 
THE SERIES IS INDEXED IN SCOPUS 
*** 
UNITEXT is glad to announce a new series of free webinars and interviews 
handled by the Board members, who rotate in order to interview top experts in their 
ﬁeld. 
Access this link to subscribe to the events: 
https://cassyni.com/s/springer-unitext
Damiano Rossello 
A Cookbook with Probability 
One 
With Financial Applications
Damiano Rossello 
Department of Economics and Business 
Università di Catania 
Catania, Italy 
ISSN 2038-5714
ISSN 2532-3318 
(electronic) 
UNITEXT 
ISSN 2038-5722
ISSN 2038-5757 
(electronic) 
La Matematica per il 3+2 
ISBN 978-3-031-54687-7
ISBN 978-3-031-54688-4 
(eBook) 
https://doi.org/10.1007/978-3-031-54688-4 
© The Editor(s) (if applicable) and The Author(s), under exclusive license to Springer Nature Switzerland 
AG 2024 
This work is subject to copyright. All rights are solely and exclusively licensed by the Publisher, whether 
the whole or part of the material is concerned, speciﬁcally the rights of translation, reprinting, reuse 
of illustrations, recitation, broadcasting, reproduction on microﬁlms or in any other physical way, and 
transmission or information storage and retrieval, electronic adaptation, computer software, or by similar 
or dissimilar methodology now known or hereafter developed. 
The use of general descriptive names, registered names, trademarks, service marks, etc. in this publication 
does not imply, even in the absence of a speciﬁc statement, that such names are exempt from the relevant 
protective laws and regulations and therefore free for general use. 
The publisher, the authors and the editors are safe to assume that the advice and information in this book 
are believed to be true and accurate at the date of publication. Neither the publisher nor the authors or 
the editors give a warranty, expressed or implied, with respect to the material contained herein or for any 
errors or omissions that may have been made. The publisher remains neutral with regard to jurisdictional 
claims in published maps and institutional afﬁliations. 
This Springer imprint is published by the registered company Springer Nature Switzerland AG 
The registered company address is: Gewerbestrasse 11, 6330 Cham, Switzerland 
If disposing of this product, please recycle the paper.
To Francesca and Sara
Preface 
This book has been written for graduate students in economics with no prior 
exposition to probability theory out of undergraduate courses in Applied Statistics. 
It is intended to provide a self-contained account of probabilistic modelling mainly 
applied to ﬁnance. The fundamental concept of random variable’s distribution is 
introduced beforehand with respect to the usual treatment of this subject in standard 
probability textbooks. All the analytic tools developed subsequently are illustrated 
through examples concerning the probability distribution of future stock prices 
and returns modeled as proper random variables. Given the intended audience in 
mind, the book tries to strike a balance between precise mathematical deﬁnitions 
and their applied knowledge. For example, events induced by random variables 
are implicitly deﬁned as elements of a ﬁxed sigma-algebra, and the expectation 
of a random variable is ﬁrst deﬁned separately for discrete and continuous dis-
tribution, then a uniﬁed treatment is offered to underline the Lebesgue approach 
to abstract integration. The corresponding ‘symbolic manipulation’ of integrals 
is easily established and illustrated through examples. Overall, the necessary 
measure-theoretic approach to the subject is underpinned without ‘too tears’: 
students learn the working aspect of the advanced theory, but some technical 
details are deferred to appropriate appendices within each section or postponed 
to the end of the book, containing review material from elementary real analysis 
and algebra courses. Indeed, to guarantee a double level of readability the book 
is divided into two parts. The probabilistic aspect of building a ﬁnancial model 
such as the univariate random variables describing future asset prices or returns 
are illustrated from the scratch together with the corresponding distributions. The 
most important characteristics of these distributions are studied: moments, moment 
generating and characteristic functions, location-scale families, quantiles. Then their 
generalization to the multivariate case is presented: joint distribution functions and 
the corresponding vectorial ﬁrst and second moments. Moreover, the fundamentals 
of stochastic dependence/independence are deﬁned besides the treatment of Frechét 
bounds. The ‘probability redux’ stochastic processes are analyzed in term of 
their ﬁnite dimensional distributions, and typical examples are illustrated both in 
discrete and continuous time as candidate models for asset prices returns, and
vii
viii
Preface
loss variables. Convergence concepts as applied to the problem of evaluate point 
estimators or their asymptotic distribution are introduced. Special emphasis is 
put on non-parametric estimation of means, variances, correlation coefﬁcients and 
risk measures, using the tool of empirical distribution function. Short chapters 
on copula functions and prediction constitute an important addendum, as well 
as a targeted section on risk measures and option pricing. The key deﬁnitions 
and theorems are stated without burdening too much the reader with unnecessary 
technical details, so it represents what I call a ‘cookbook’. Since I don’t sacriﬁce 
some mathematical rigor, the book can be accessed by those students with more 
mathematical preparation/sophistication, indeed Lebegue measure and integration 
together with the Fubini theorem and iterated integrals are used throughout. The 
appendices to each chapter and exercises (with complete solutions) also contain 
some proofs of results which are only stated in the main text and aim at making 
the book quite self-contained. The double level of reading should be attractive also 
for students of Mathematics. Another distinguished feature is the use of computer 
software (Excel, Matlab, R) to build numerical examples and simulations of some 
probabilistic objects. I provide the complete coding of each numerical example 
within the textbook. The treatment is not encyclopedic, rather it concentrates only 
on the relevant probabilistic tools although the reader will beneﬁt from a more quick 
learning of topics that help a transition towards more advanced textbooks. The book 
itself has been developed in the last 17 years and has been evolved from lectures I 
taught for a graduate course on Probability for Finance (formerly called Calcolo 
delle Probabilita’ per la Finanza) at the Department of Economics and Business, 
University of Catania. A word of caution: in each chapter a reference to Appendix 
concerns that contained at the end of the chapter. Other appendices are placed after 
the solutions to exercises, and are labelled with uppercase letters. 
Catania, Italy
Damiano Rossello
Contents 
1 
Probability, Events and Random Variables..............................
1 
1.1 
The Need of Random Variables .....................................
1 
1.2 
Events and Their Manipulation ......................................
3 
1.3 
Probability Function .................................................
3 
1.4 
Frequency Justiﬁcation and Discrete Probability Spaces...........
7 
1.5 
Further Properties of a Probability Measure ........................ 
11 
1.6 
Further σ−algebra ................................................... 
14 
1.7 
Introduction to Trees ................................................. 
16 
1.8 
Exercises .............................................................. 
19 
Appendix ..................................................................... 
20 
2 
Distribution of Random Variables ........................................ 
27 
2.1 
Distribution Function ................................................ 
27 
2.2 
Discrete Random Variables .......................................... 
29 
2.3 
Continuous Random Variables....................................... 
32 
2.4 
Indicator Random Variables ......................................... 
35 
2.5 
Operations on Random Variables.................................... 
37 
2.6 
Comparing Random Variables ....................................... 
41 
2.7 
Symmetric Probability Laws......................................... 
43 
2.8 
Quantile Function .................................................... 
45 
2.9 
Mixed Random Variables and Distributions ........................ 
48 
2.10 
Exercises .............................................................. 
53 
Appendix ..................................................................... 
55 
3 
Multidimensional Random Variables .................................... 
75 
3.1 
Random Vectors ...................................................... 
75 
3.2 
Discrete Random Vectors ............................................ 
77 
3.3 
Continuous Random Vectors ........................................ 
80 
3.4 
Stochastic Dependence/Independence .............................. 
84 
ix 
x
Contents 
3.5 
More on Discrete and Continuous Random Vectors................ 
89 
3.6 
Block Dependence ................................................... 
91 
3.7 
Exercises .............................................................. 
92 
Appendix ..................................................................... 
94 
4 
Moments and the Alike .................................................... 103 
4.1 
A Motivating Starting Point ......................................... 103 
4.2 
Expectation ........................................................... 104 
4.3 
Variance and Moments ............................................... 110 
4.4 
Moment Generating and Characteristic Functions.................. 111 
4.5 
Summary Statistics ................................................... 113 
4.6 
Inequalities ........................................................... 116 
4.7 
Covariance and Moments of Random Vectors ...................... 119 
4.8 
Multivariate vs Univariate Expectation ............................. 124 
4.9 
More on Transformation of Rvs ..................................... 126 
4.10 
Exercises .............................................................. 129 
Appendix ..................................................................... 132 
5 
Special Distributions ....................................................... 143 
5.1 
Summary of Univariate Distributions ............................... 143 
5.2 
Discrete Uniform ..................................................... 143 
5.3 
Bernoulli .............................................................. 145 
5.4 
Binomial .............................................................. 146 
5.5 
Poisson................................................................ 150 
5.6 
Continuous Uniform ................................................. 153 
5.7 
Gaussian .............................................................. 158 
5.8 
Exponential ........................................................... 164 
5.9 
Gamma................................................................ 167 
5.10 
Student-t .............................................................. 169 
5.11 
Exercises .............................................................. 169 
Appendix ..................................................................... 171 
6 
Conditioning ................................................................ 173 
6.1 
Conditional Distributions ............................................ 173 
6.2 
Conditional Expectation Given an Event............................ 176 
6.3 
Conditional Expectation Given a Rv ................................ 179 
6.4 
Conditional Expectation Given a Sub-σ−algebra .................. 181 
6.5 
Exercises .............................................................. 185 
Appendix ..................................................................... 186 
7 
Regression, Prediction and More Dependence .......................... 189 
7.1 
Prediction ............................................................. 189 
7.2 
Linear Prediction and Dependence .................................. 192 
7.3 
Nonlinear Dependence ............................................... 194 
7.4 
Stochastic Dependence. . . Again..................................... 196 
7.5 
Exercises .............................................................. 201 
Appendix ..................................................................... 202 
Contents
xi 
8 
Convergence Concepts ..................................................... 207 
8.1 
Type of Convergence ................................................. 207 
8.2 
The Law of Large Numbers and the Central Limit Theorem ...... 212 
8.3 
Application 1: Point and CDF Estimation .......................... 215 
8.4 
Application 2: Monte Carlo Simulation ............................. 220 
8.5 
Application to Log-Normal Stock Price Model..................... 222 
8.6 
Exercises .............................................................. 224 
Appendix ..................................................................... 225 
9 
Introduction to Stochastic Processes ..................................... 237 
9.1 
Deﬁnition and Preliminary Classiﬁcation ........................... 237 
9.2 
Filtration and Distribution of a Process ............................. 239 
9.3 
Distributional Characteristics ........................................ 241 
9.4 
Special Kinds of Processes .......................................... 243 
9.5 
Brownian Motion Process ........................................... 252 
9.6 
Exercises .............................................................. 256 
Appendix ..................................................................... 256 
10 
Introduction to Market Risk Measures and Option Pricing ........... 261 
10.1 
Value-at-Risk ......................................................... 261 
10.2 
Coherent Risk Measures ............................................. 265 
10.3 
Working Examples ................................................... 270 
10.4 
Option Pricing ........................................................ 272 
10.5 
Exercises .............................................................. 278 
Appendix ..................................................................... 279 
Solutions to Exercises ............................................................ 285 
A 
Binary Expansions.......................................................... 339 
B 
Sequences of Real Numbers ............................................... 341 
C 
Limit Superior and Limit Inferior........................................ 345 
D 
Inﬁnite Sums ................................................................ 349 
E 
Open Subsets of Real Numbers ........................................... 353 
F 
Topology on n-Dimensional Euclidean Spaces .......................... 357 
G 
Vector Spaces and Normed Spaces ....................................... 361 
H 
Sequence and Series of Functions......................................... 365 
I 
Review of Multivariate Differentiation and Integration ............... 367 
J 
A Glimpse to Vector Analysis in double struck upper R cubedR3 ...................................... 373 
K 
Stieltjes Integral ............................................................ 377 
L 
Leibniz’s Formula .......................................................... 379 
xii
Contents 
M 
Lebesgue Measure .......................................................... 381 
N 
Lebesgue Integral........................................................... 385 
O 
Double Lebesgue Integral ................................................. 389 
References......................................................................... 395 
Index............................................................................... 397 
Chapter 1 
Probability, Events and Random 
Variables 
1.1 
The Need of Random Variables 
Suppose today you want to make a guess about the S&P500’s quote at the end 
of tomorrow. What is the chance to observe a value 35,501?1 Indeed, today we 
don’t know if 35,501 will be the true value tomorrow, thus we are faced something 
real called uncertainty. The word ‘uncertainty’ is a synonymous for random 
experiment , an empirical phenomenon or a given procedure whose outcome cannot 
be predicted with certainty. This can be interpreted as lack of information. A random 
experiment can be observed, but it hasn’t deterministic regularity at all. It doesn’t 
need to be performed, for example we can only think of tossing a coin. 
Denoting upper S Subscript upper TST the S&P500’s quote at time upper T greater than 0T > 0, then it behaves like a variable 
upper X left parenthesis dot right parenthesisX( · ) depending on some scenarios (viz. outcomes) omegaω collected in some universal 
set. A mathematical model for measuring numerically X based on the underlying 
random experiment should require at least the following (see Fig. 1.1):
•
A sample space upper Omega commaΩ, i.e. the set of all conceptually possible outcomes omegaω;
•
A function upper X colon upper Omega right arrow double struck upper R commaX : Ω →R, called a random variable (rv) . 
Actually, X is not a variable, but in a sense it ‘varies randomly’: ending the random 
experiment, we only observe one realization of the rv, out of all possible numerical 
values it may take on.2 Possible values of a rv by themselves are not interesting, 
we need to quantify how likely upper X left parenthesis omega right parenthesisX(ω) is, for example, less than or equal to 35,501. 
Collecting those outcomes omega element of upper Omegaω ∈Ω such that (s.t.) the condition upper X left parenthesis omega right parenthesis less than or slanted equals 35 comma 501X(ω) ⩽35, 501
holds, leads to consider subsets of the sample space called events. Extensively: 
upper A equals StartSet omega vertical bar upper X left parenthesis omega right parenthesis less than or slanted equals a EndSet comma omega element of upper Omega comma a element of double struck upper R commaA = {ω | X(ω) ⩽a},
ω ∈Ω,
a ∈R,
1 It is a synonymous for price, since the S&P500 is nothing but a ﬁnancial asset. 
2 X is sometimes called a variate and written x periodx.
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4_1
1
2
1
Probability, Events and Random Variables
Fig. 1.1 The S&P500’s price 
has a known value upper S 0S0 in 
t equals 0 commat = 0, but its value upper S Subscript upper TST in 
t equals upper Tt = T is unknown 
where a equals 35 comma 501a = 35, 501. One can drop the symbol omegaω and writes more compactly left brace upper X less than or slanted equals a right brace{X ⩽a}
which is always a subset of upper OmegaΩ. Other events can be considered, then a forecast about 
the future S&P500’s quote involves: 
upper A equals left brace upper X greater than or slanted equals a right brace or equals left brace upper X equals a right brace or equals left brace a less than or slanted equals upper X less than or slanted equals b right brace comma etc period comma a comma b element of double struck upper R periodA = {X ⩾a} or = {X = a} or = {a ⩽X ⩽b}, etc.,
a, b ∈R.
To evaluate how likely is to observe all such events we can assign them a 
probability, i.e. a numerical value between 0 and 1. For example, we can ask what 
is the probability that the future S&P500’s quote is less than or equal to a equals 33 comma 615a = 33, 615
or is greater than b equals 35 comma 501b = 35, 501 and this writes:3 
p equals sans serif upper P left parenthesis upper X less than or slanted equals a right parenthesis comma or p equals sans serif upper P left parenthesis upper X greater than b right parenthesis where p element of left bracket 0 comma 1 right bracket periodp = P(X ⩽a), or p = P(X > b)
where
p ∈[0, 1].
In summary what we plan to study is based on the following:
•
Dealing with phenomena we perceive as random.
•
Modelling these phenomena as scenarios of some experiment.
•
Outcomes are elements of a sample space upper Omega not equals empty set periodΩ /= ∅.
•
Subsets of upper OmegaΩ are called events.
•
Events will be assigned a probability, a number between 0 and 1 that expresses 
how likely the event is to occur. 
In particular, we will use a mathematical approach to the theory of probability ﬁrmly 
established by the Russian mathematician A.N. Kolmogorov in the 1930s. The core 
of this approach is a list of axioms about the behavior of probability expressed in 
terms of sets and functions. As we will see, using set theory and formal logic we 
are able to deduce anything about probability. Since we are interested in developing 
probabilistic modelling with ﬁnance in view, reference to ﬁnancial econometrics is 
often called for:
•
Financial econometrics is the econometrics of ﬁnancial markets.
•
Econometric theory is a framework needed for the empirical analysis in eco-
nomics based on mathematical tools and principles, especially those of probabil-
ity and theoretical statistics (quantitative laws of economics).
3 We avoid the cumbersome notation sans serif upper P left parenthesis left brace upper X less than or slanted equals a right brace right parenthesis commaP({X ⩽a}), but notice that it would be correct since sans serif upper P left parenthesis dot right parenthesisP( · )
is a function whose argument is an event left brace midline horizontal ellipsis right brace equals upper A period{· · · } = A.
1.3
Probability Function
3
•
Financial econometrics is the bulk of models describing -in particular- ﬁnancial 
time series such as prices, returns, interest rates, market indices, ﬁnancial ratios, 
derivatives prices, etc. 
Indeed, in the rest of the book we will apply the probabilistic framework especially 
to rvs modelling asset prices, besides we also treat rvs modelling asset returns.4 
Anyway, the probabilistic machinery we will present in the rest of this book is quite 
standard and suitable for random experiment different from those involving ﬁnancial 
models. Often, we refer to time index t equals 0 comma 1 comma 2 comma ellipsis comma upper Tt = 0, 1, 2, . . . , T or t element of left bracket 0 comma normal infinity right parenthesist ∈[0, ∞) to emphasize 
time dependence of relevant ﬁnancial quantities. Only the initial price upper S 0S0 is a known 
quantity, while each subsequent upper S Subscript tSt for t greater than 0t > 0 is a rv. 
1.2 
Events and Their Manipulation 
To begin with, we introduce the formal framework of set theory to describe events. 
Deﬁnition 1.1 An event is a subset upper A subset of upper OmegaA ⊂Ω of the sample space. We say that the 
event A occurs if and only if (iff) omega element of upper Aω ∈A. 
We can think of omegaω as the effective result showed by the experiment. 
Example 1.1 Rolling a dice once gives the sample space upper Omega equals StartSet 1 comma 2 comma 3 comma 4 comma 5 comma 6 EndSet periodΩ = {1, 2, 3, 4, 5, 6}. The 
subset upper A equals StartSet 2 comma 4 comma 6 EndSetA = {2, 4, 6} can be thought of as the event upper A equals StartSet even number shown EndSet periodA = {even number shown}. If 
the dice shows 3, then A does not occur.5 We can use a ‘verbal rule’ to describe upper A periodA.
Since upper Omega subset of upper OmegaΩ ⊂Ω and empty set subset of upper Omega∅⊂Ω, the sample space itself and the empty set are events. 
Given events upper A comma upper B subset of upper OmegaA, B ⊂Ω we can build other sensible events such as: upper A union upper B equals StartSet omega vertical bar omega element of upper A or omega element of upper B EndSet commaA ∪B =
{ω | ω ∈A or ω ∈B}, upper A intersection upper B equals StartSet omega vertical bar omega element of upper A and omega element of upper B EndSet commaA ∩B = {ω | ω ∈A and ω ∈B}, upper A minus upper B equals StartSet omega element of upper A vertical bar omega not an element of upper B EndSetA \ B = {ω ∈A | ω /∈B}
and upper A Superscript c Baseline equals StartSet omega vertical bar omega not an element of upper A EndSetAc = {ω | ω /∈A}, see Fig. 1.2 and Table 1.1. Typically, in probability theory 
relevant events deserve a special description. In econometrics events are induced by 
rvs, i.e. they received a numerical description. We can write left brace upper X element of upper B right brace{X ∈B} for a suitable 
subset upper B subset of double struck upper RB ⊂R of real numbers, to mean the collection of those scenarios omega element of upper Omegaω ∈Ω
s.t. upper X left parenthesis omega right parenthesisX(ω) takes value on upper B periodB. Therefore different choices of such B entail different 
events, see Table 1.2. 
1.3 
Probability Function 
It is not mandatory to regard all subsets of upper OmegaΩ as events. Whatever the cardinality of 
upper OmegaΩ, the assignment of probabilities to events like left brace upper X element of upper B right brace{X ∈B} may cause inconsistencies.
4 Returns have nice statistical properties than prices. We refer to closing daily prices. 
5 Observe that the sample space above need not to be described by a rv! 
4
1
Probability, Events and Random Variables
Fig. 1.2 Events can be 
depicted using Venn 
diagrams. Usually a rectangle 
represents the sample space 
upper OmegaΩ, while circles inside are 
used for smaller events. In 
particular: left circle equals upper A comma= A,
right circle equals upper B= B. The result of 
unions, intersections, set 
difference and complements 
are ﬁlled properly 
Table 1.1 Description of events as special subsets of upper OmegaΩ
Description: ‘verbal rule’
Sets and subsets 
Certain event
upper OmegaΩ (every omegaω is a member) 
Impossible event
empty set∅(no omegaω is a member) 
At least one events occurs
upper A union upper BA ∪B (omegaωs lie in A or in B) 
Both events occur
upper A intersection upper BA ∩B (omegaωs lie in A and in B) 
Mutually disjoint or incompatible events
upper A intersection upper B equals empty setA ∩B = ∅
The event A occurs but not B
upper A minus upper B equals upper A intersection upper B Superscript cA \ B = A ∩Bc (omegaωs never fall in  B) 
The event A implies the event B
upper A subset of upper BA ⊂B (omegaωs in  A are also in B) 
The event A does not occur
upper A Superscript cAc (omegaωs never fall in  A) 
Table 1.2 Numerical 
description of events induced 
by rvs 
Subset of real numbers upper B equalsB =
Events (a comma b element of double struck upper Ra, b ∈R and a less than ba < b) 
double struck upper RR
StartSet omega vertical bar negative normal infinity less than upper X left parenthesis omega right parenthesis less than normal infinity EndSet equals upper Omega{ω | −∞< X(ω) < ∞} = Ω
empty set∅
StartSet omega vertical bar upper X left parenthesis omega right parenthesis element of empty set EndSet equals empty set{ω | X(ω) ∈∅} = ∅
left parenthesis a comma b right bracket(a, b]
StartSet omega vertical bar a less than upper X left parenthesis omega right parenthesis less than or slanted equals b EndSet{ω | a < X(ω) ⩽b}
left bracket a comma b right parenthesis[a, b)
left brace a less than or slanted equals upper X less than b right brace{a ⩽X < b}
left bracket a comma b right bracket[a, b]
left brace a less than or slanted equals upper X less than or slanted equals b right brace{a ⩽X ⩽b}
left parenthesis a comma b right parenthesis(a, b)
left brace a less than upper X less than b right brace{a < X < b}
left parenthesis negative normal infinity comma b right bracket(−∞, b]
left brace upper X less than or slanted equals b right brace{X ⩽b}
left parenthesis negative normal infinity comma b right parenthesis(−∞, b)
left brace upper X less than b right brace{X < b}
left bracket a comma normal infinity right parenthesis[a, ∞)
left brace upper X greater than or slanted equals a right brace{X ⩾a}
left parenthesis a comma normal infinity right parenthesis(a, ∞)
left brace upper X greater than a right brace{X > a}
Example 1.2 Consider the experiment involving the daily stock price with three 
possible tick movements plus or minus 0.5±0.5, starting from an initial price upper S 0 equals 3.5S0 = 3.5, see also 
Example 1.9. Any scenario in the sample space can be coded with u corresponding 
to an upward tick movement plus 0.5+0.5, and d corresponding to an downward tick 
movement negative 0.5−0.5. Thus, each scenario omegaω is of the form uuu,ddd and all other possible 
combination of labels u,d. If we fail to record the last tick movement, then the event 
upper A equals left brace upper S 1 less than 3.5 right brace equals left brace ud bold period bold period comma du bold period bold period comma dd bold period bold period comma dd bold period bold period right brace equals left brace at least two downwards negative 0.5 right braceA = {S1 < 3.5} = {ud.., du.., dd.., dd..} = {at least two downwards −0.5}
1.3
Probability Function
5
cannot be fully depicted. We can say A is not ‘measurable’, i.e. we cannot give a yes 
or not answer to the question ‘Is omega element of upper A question markω ∈A?’ since we have not full information about 
omegaω given the encoding based on u,d. 
A sensible collection of events to which assign probabilities must be built upon 
the concept of occurrence and set operations as unions, complementation and 
intersections. 
Deﬁnition 1.2 (Partial Information) Given a nonempty sample space upper Omega commaΩ, a col-
lection script upper F subset of 2 Superscript upper OmegaF ⊂2Ω of events is called a bold italic sigmaσ-algebra or bold italic sigmaσ-ﬁeld if: 
emp
ty set element of script upper F period∅∈F.
upp
er A element of script upper FA ∈F implies upper A Superscript c Baseline element of script upper FAc ∈F (hence upper Omega element of script upper FΩ ∈F ). 
S3 
If upper A 1 comma upper A 2 comma ellipsisA1, A2, . . . belong to script upper FF also upper A 1 union upper A 2 union midline horizontal ellipsis equals union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i Baseline element of script upper F periodA1 ∪A2 ∪· · · = ∪∞
i=1Ai ∈F.
Usually upper A equals left brace upper X element of upper B right braceA = {X ∈B} or upper A Subscript i Baseline equals left brace upper X element of upper B Subscript i Baseline right brace commaAi = {X ∈Bi}, for a rv X and suitable subsets of real 
numbers upper B comma upper B Subscript i BaselineB, Bi with i equals 1 comma 2 comma ellipsisi = 1, 2, . . .
Remark 1.1 (Technical Issues)
•
We write 2 Superscript upper Omega2Ω for the power set of upper OmegaΩ, the collection of all subsets of the sample 
space.
•
A countable set contains an enumeration of elements. If there is a 1-to-1 
correspondence between a set A and the integers double struck upper N equals StartSet 1 comma 2 comma ellipsis EndSetN = {1, 2, . . .}, then A is 
countable and we write upper A equals StartSet omega 1 comma omega 2 comma ellipsis EndSetA = {ω1, ω2, . . .}. If  A is ﬁnite then there is 1-to-1 
correspondence between A and StartSet 1 comma 2 comma ellipsis comma n EndSet subset of double struck upper N{1, 2, . . . , n} ⊂N. When A is neither ﬁnite nor 
countable, then it is uncountable, or uncountably inﬁnite, and there is a 1-to-1 
correspondence with the unit interval left parenthesis 0 comma 1 right parenthesis(0, 1) or with double struck upper RR.
•
A countable list of events upper A 1 comma upper A 2 comma ellipsisA1, A2, . . . is a sequence written left parenthesis upper A Subscript i Baseline right parenthesis Subscript i element of double struck upper N(Ai)i∈N or left parenthesis upper A Subscript i Baseline right parenthesis Subscript i(Ai)i.
•
For a ﬁnite sample space, i.e. StartAbsoluteValue upper Omega EndAbsoluteValue equals n|Ω| = n elements,6 we always choose script upper F equals 2 Superscript upper Omega Baseline semicolonF = 2Ω; the 
power set is also ﬁnite with cardinality StartAbsoluteValue 2 Superscript upper Omega Baseline EndAbsoluteValue colon equals 2 Superscript StartAbsoluteValue upper Omega EndAbsoluteValue Baseline equals 2 Superscript n|2Ω| := 2|Ω| = 2n elements. 
Here some examples of more general event manipulation. 
Example 1.3 
.∪∞
i=1Ai is the event left brace at least one of the upper A Subscript i Baseline occurs right brace{at least one of the Ai occurs}: indeed omega element of union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript iω ∈
∪∞
i=1Ai is the same to say omega element of upper A Subscript iω ∈Ai for at least one i element of double struck upper N periodi ∈N. The special case is ‘ﬁnite 
union’, i.e. upper A 1 union upper A 2 union midline horizontal ellipsis union upper A Subscript nA1 ∪A2 ∪· · · ∪An and the verbal description is the same as above. 
Observe that we can write upper A 1 union upper A 2 union midline horizontal ellipsis union upper A Subscript n Baseline union empty set union midline horizontal ellipsisA1 ∪A2 ∪· · · ∪An ∪∅∪· · ·
Example 1.4 What about intersections? intersection Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i∩∞
i=1Ai is the event left brace all the upper A Subscript i Baseline right single quotation mark s occur right brace{all the Ai’s occur}, 
in fact omega element of intersection Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript iω ∈∩∞
i=1Ai is equivalent to say omega element of upper A Subscript nω ∈An for all i element of double struck upper N periodi ∈N. The special case is 
ﬁnite intersection, i.e. upper A 1 intersection upper A 2 intersection midline horizontal ellipsis intersection upper A Subscript nA1 ∩A2 ∩· · · ∩An
Example 1.5 The compound event upper A equals left brace upper S Subscript t comma 1 Baseline less than or slanted equals s 1 right brace intersection midline horizontal ellipsis intersection left brace upper S Subscript t comma n Baseline less than or slanted equals s Subscript n Baseline right braceA = {St,1 ⩽s1} ∩· · · ∩{St,n ⩽sn}, where 
upper S Subscript t comma iSt,i are random stock prices for i equals 1 comma ellipsis comma ni = 1, . . . , n, will play a central role in studying
6 We write StartAbsoluteValue upper Omega EndAbsoluteValue|Ω| to denote the cardinality of a set. Actually, two sets have the same cardinality iff 
there is a bijection (viz. a 1-to-1 correspondence) between them. This does not preclude that one 
can be a proper subset of the other. 
6
1
Probability, Events and Random Variables
stochastic dependence among several rvs. Clearly, for each scenario omega element of upper Omegaω ∈Ω the event 
A describes the conjoint measurement of n asset prices at a future date t. 
Hence, events from a sigma hyphen algebraσ-algebra can be manipulated using set operations, especially 
unions and intersections. Here some properties.
•
Commutativity: upper A union upper B equals upper B union upper A commaA ∪B = B ∪A, and similarly for intersections.
•
Associativity: upper A union left parenthesis upper B union upper C right parenthesis equals left parenthesis upper A union upper B right parenthesis union upper C commaA ∪(B ∪C) = (A ∪B) ∪C, and similarly for intersections.
•
Distributivity: upper A intersection left parenthesis upper B union upper C right parenthesis equals left parenthesis upper A intersection upper B right parenthesis union left parenthesis upper A intersection upper C right parenthesis commaA ∩(B ∪C) = (A ∩B) ∪(A ∩C), and upper A union left parenthesis upper B intersection upper C right parenthesis equals left parenthesis upper A union upper B right parenthesis intersection left parenthesis upper A union upper C right parenthesisA ∪(B ∩C) = (A ∪B) ∩
(A ∪C)
•
DeMorgan’s Laws: left parenthesis upper A union upper B right parenthesis Superscript c Baseline equals upper A Superscript c Baseline intersection upper B Superscript c Baseline comma(A ∪B)c = Ac ∩Bc, and left parenthesis upper A intersection upper B right parenthesis Superscript c Baseline equals upper A Superscript c Baseline union upper B Superscript c Baseline period(A ∩B)c = Ac ∪Bc.
•
. (Ac)c = A.
The probability’s assignment to events is then based on the following: 
Deﬁnition 1.3 (Probability Function) Given a sigma hyphen algebraσ-algebra of events, we call prob-
ability measure the set function sans serif upper P colon script upper F right arrow left bracket 0 comma 1 right bracketP : F →[0, 1] satisfying: 
san
s serif upper P left parenthesis empty set right parenthesis equals 0
P(∅) = 0 and sans serif upper P left parenthesis upper Omega right parenthesis equals 1P(Ω) = 1
san
s serif upper P left parenthesis union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i Baseline right parenthesis equals sans serif upper P left parenthesis upper A 1 right parenthesis plus sans serif upper P left parenthesis upper A 2 right parenthesis plus midline horizontal ellipsis equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis comma
P
(
∪∞
i=1Ai
)
= P(A1) + P(A2) + · · · = ∑∞
i=1 P(Ai), for any pairwise 
disjoint sequence left parenthesis upper A Subscript i Baseline right parenthesis Subscript i element of double struck upper N Baseline subset of script upper F(Ai)i∈N ⊂F of events, upper A Subscript i Baseline intersection upper A Subscript j Baseline equals empty setAi ∩Aj = ∅each i not equals ji /= j (countable 
additivity or sigmaσ-additivity). 
The couple left parenthesis upper Omega comma script upper F right parenthesis(Ω, F) is the event space (or measurable space) and the triple left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P)
is the probability space modelling a random experiment. 
PA1 and PA2 are axioms for a probability measure. Thanks to Deﬁnitions 1.2 
and 1.3 we can calculate probabilities for all the events in Table 1.1, also for  
intersections and differences of events (see Exercise 1.7). In summary, quantifying 
the likelihood of an event upper A element of script upper FA ∈F requires evaluation of sans serif upper P left parenthesis dot right parenthesisP( · ) at A to get a number 
sans serif upper P left parenthesis upper A right parenthesis element of left bracket 0 comma 1 right bracketP(A) ∈[0, 1] measuring how easy is that A occurs. The impossible event never 
occurs while the certain event always occurs, thus is sensible to assign them a 
probability zero and a probability 1, respectively. Thinking geometrically and using 
Venn diagrams to display upper OmegaΩ as a rectangle having area 1, sans serif upper P left parenthesis upper A right parenthesisP(A) measures the ‘area’ 
of the ‘circle’ representing upper A periodA. Disjoint circles upper A Subscript iAi inside upper OmegaΩ must have a union whose 
probability is given by adding each area computed separately. However, we must be 
careful in dealing with certain events behaving like empty set∅and upper OmegaΩ. More precisely, if we 
‘add’ the impossible event to any event upper A element of script upper FA ∈F, then the probability is not altered: 
sans serif upper P left parenthesis upper A right parenthesis equals sans serif upper P left parenthesis upper A right parenthesis plus 0 equals sans serif upper P left parenthesis upper A union empty set right parenthesis periodP(A) = P(A) + 0 = P(A ∪∅).
This may happen for other events than empty set∅. We say that upper B element of script upper FB ∈F is almost impossible 
if sans serif upper P left parenthesis upper A union upper B right parenthesis equals sans serif upper P left parenthesis upper A right parenthesisP(A ∪B) = P(A) whenever A and B are incompatible. This implies sans serif upper P left parenthesis upper B right parenthesis equals 0P(B) = 0, 
which can be taken as the true deﬁnition of almost impossibility. We call upper A element of script upper FA ∈F
an almost sure event if sans serif upper P left parenthesis upper A right parenthesis equals 1P(A) = 1 and A is not necessarily equal to upper OmegaΩ. Almost  
impossible events are also called sans serif upper PP-null or negligible. Obviously, if A is almost
1.4
Frequency Justiﬁcation and Discrete Probability Spaces
7
sure its complement upper A Superscript cAc is sans serif upper PP-null, see Exercise 1.11. A property upper S left parenthesis omega right parenthesisS(ω) depending on 
scenarios omega element of upper Omegaω ∈Ω is said to hold almost surely, a.s. for short, if 
sans serif upper P left parenthesis StartSet omega vertical bar upper S left parenthesis omega right parenthesis is false EndSet right parenthesis equals 0 periodP({ω | S(ω) is false}) = 0.
Such a property holds almost everywhere in upper OmegaΩ except on a subset with zero 
probability. 
Example 1.6 Consider the experiment of predicting the 1-day price upper S 1S1 of the 
S&P500, which can takes on the values 
StartSet 35 comma 407.5 comma 35 comma 408 comma 35 comma 408.5 comma 35 comma 409.5 comma 35 comma 410 comma 35 comma 410.5 EndSet comma{35, 407.5, 35, 408, 35, 408.5, 35, 409.5, 35, 410, 35, 410.5},
starting from the initial value 35 comma 40935, 409. The statement ‘only an integer price is 
shown’ is a property upper S left parenthesis omega right parenthesisS(ω) depending on the outcomes omegaω of this experiment. The 
set upper A equals StartSet omega vertical bar upper S left parenthesis omega right parenthesis is true EndSetA = {ω | S(ω) is true} is equal to the event StartSet 35 comma 408 comma 35 comma 410 EndSet{35, 408, 35, 410} while upper A Superscript c Baseline equals StartSet omega vertical bar upper S left parenthesis omega right parenthesis is false EndSetAc = {ω |
S(ω) is false} represents the event StartSet 35 comma 407.5 comma 35 comma 408.5 comma 35 comma 409.5 comma 35 comma 410.5 EndSet{35, 407.5, 35, 408.5, 35, 409.5, 35, 410.5}. If  
the probability assignment is based on experience and a subjective view (e.g. of a 
particular ﬁnancial analyst), then it is allowed to assign sans serif upper P left parenthesis upper A Superscript c Baseline right parenthesis equals 0P(Ac) = 0 and the property 
upper S left parenthesis omega right parenthesisS(ω) holds almost surely. In words: it is almost impossible that the S&P500 quote 
at the end of the day is fractional. 
1.4 
Frequency Justiﬁcation and Discrete Probability Spaces 
A random experiment can be repeated, maybe indeﬁnitely. Let n element of double struck upper Nn ∈N be the number 
of repetitions or trials of the same experiment: looking at daily stock price upper S 1S1. 
Suppose we observe stock prices over n equals 100n = 100 consecutive days,7 see Table 1.3. 
The relative frequency that upper S 1 less than 3.5S1 < 3.5 is StartFraction 21 plus 17 Over 100 EndFraction equals 0.38 comma 21+17
100
= 0.38, and it could be thought of 
an approximation of the probability that the rv X modelling upper S 1S1 has value less than 3.5 comma< 3.5, i.e. 
sans serif upper P left parenthesis upper X less than 3.5 right parenthesisP(X < 3.5) which amounts to evaluate how easy is to occur left brace upper X less than 3.5 right brace period{X < 3.5}. Moral: 
in a repeated experiment, writes 0 less than or slanted equals f Subscript n Baseline left parenthesis upper A right parenthesis less than or slanted equals n0 ⩽fn(A) ⩽n for the number of occurrence of 
an event upper A commaA, for example upper A equals left brace upper X less than 3.5 right brace commaA = {X < 3.5}, in n trials and get the relative frequency 
StartFraction f Subscript n Baseline left parenthesis upper A right parenthesis Over n EndFraction period fn(A)
n
. Thus, we believe that 
StartFraction f Subscript n Baseline left parenthesis upper A right parenthesis Over n EndFraction converges to a real number p element of left bracket 0 comma 1 right bracket as n becomes large commafn(A)
n
converges to a real number p ∈[0, 1] as n becomes large,
i.e. limit Underscript n right arrow normal infinity Endscripts StartFraction f Subscript n Baseline left parenthesis upper A right parenthesis Over n EndFraction lim
n→∞
fn(A)
n
would give sans serif upper P left parenthesis upper A right parenthesisP(A) or StartFraction f Subscript n Baseline left parenthesis upper A right parenthesis Over n EndFraction almost equals sans serif upper P left parenthesis upper A right parenthesis fn(A)
n
≈P(A) for n less than normal infinityn < ∞large enough. We 
trivially have:
7 Clearly, we refer to the same stock quoted repeatedly. Do not confuse this with the experiment 
based on 3 consecutive tick movements over the same day. 
8
1
Probability, Events and Random Variables
Table 1.3 Observed daily prices can be though of as a drawn of x Subscript i Baseline equals upper S 1 left parenthesis omega right parenthesisxi = S1(ω) values of the rv upper S 1S1, for  
i equals 1 comma 2 comma 3 comma 4i = 1, 2, 3, 4, each corresponding to a different scenario omega element of upper Omegaω ∈Ω. Probabilities can be approximated 
by relative frequencies 
Observed daily prices upper S 1 equalsS1 =
1.5
2.5
3.5
4.5 
Frequency of occurrence
21
17
39
23 
Fig. 1.3 Plot of relative 
frequencies of heads and tails 
against number of trials
•
. fn(∅)
n
= 0 and StartFraction f Subscript n Baseline left parenthesis upper Omega right parenthesis Over n EndFraction equals 1 comma fn(Ω)
n
= 1, i.e. the relative frequencies of observing ‘nothing’ or 
‘everything’;
•
. fn(A or B)
n
= fn(A)
n
+ fn(B)
n
for disjoint events A and upper B commaB, i.e. f Subscript n Baseline left parenthesis upper A right parenthesisfn(A) is the number 
of time we observed A while f Subscript n Baseline left parenthesis upper B right parenthesisfn(B) is the number of time we observed upper B commaB, and 
they cannot be observed in the same trial. 
Therefore, we expect that these properties transfer to the corresponding proba-
bilities as the number of trials n becomes very large. In fact, this is the reason why 
Deﬁnition 1.3 holds. 
Example 1.7 (Empirical Law of Large Number) We illustrate the behavior of 
heads and tails in the long run. Toss a fair coin n equals 10 comma 20 comma ellipsis comma 300n = 10, 20, . . . , 300 times, and count 
the frequencies of observing heads. Compute StartFraction f Subscript n Baseline left parenthesis upper A right parenthesis Over n EndFraction comma fn(A)
n
, each n comman, and interpret the relative 
frequency as approximating the probability of the event upper A equals StartSet 1 EndSet equals StartSet upper H is shown EndSet periodA = {1} = {H is shown}.
Here we encode upper H equals 1H = 1 and use 0 for a tail, in a single coin ﬂipping. We expect 
StartFraction f 300 left parenthesis upper A right parenthesis Over 300 EndFraction almost equals one half comma f300(A)
300
≈1
2, i.e. the probability sans serif upper P left parenthesis upper A right parenthesisP(A) of getting a head in the random experiment 
of tossing a fair coin once, see Fig. 1.3 and Example 1.8. Now, there is a further 
justiﬁcation of the deﬁnition and the properties of sans serif upper P left parenthesis dot right parenthesisP( · ) introduced previously, called 
‘stabilization of relative frequencies’. 
Example 1.8 (Simulating Heads and Tails in the Long Run...) To avoid tossing 
a fair coin 10 times, 20 times, etc. up to 300 times we suggest the following 
controlled experiment using your PC and Microsoft Excel 2007Superscript copyright sign Baseline period©. First, select the 
tab Data and then the tool Data Analysis from the Tools Menu also called 
Ribbon. Make sure to have installed the Analysis ToolPak. Otherwise: 
click the Office Button (left-up corner) and ﬁnd the command to customize 
Excel. Then, in the Add-Ins dialog box check the box to the left of
1.4
Frequency Justiﬁcation and Discrete Probability Spaces
9
Analysis ToolPak, and click OK. In the  Data Analysis dialog box 
choose Sampling, then click OK to get the corresponding dialog box and do:
•
Number of Variables equals 1= 1 (how many Excel’s columns to ﬁll)
•
Number of Random Numbers equals 300= 300
•
Distribution equals= Bernoulli
•
Parameters p equals 0.5p = 0.5
•
Output Options A1:A300 (what column to ﬁll with random samples). 
See Sect. 5.3 for the Bernoulli distribution. 
Example 1.9 (Discrete Probabilities and Stock Price) Consider the sample space 
modelling 3 consecutive tick movements plus or minus 0.5±0.5 starting from an initial price upper S 0 equals 3 commaS0 = 3,
with corresponding rv upper X equals upper S 1X = S1 for the 1-day price. We try to assign probabilities as 
follows: attach a probability weight 
sans serif upper P left parenthesis StartSet omega EndSet right parenthesis for omega equals uuu comma uud comma udu comma duu comma udd comma dud comma ddu comma ddd periodP({ω})
for
ω = uuu, uud, udu, duu, udd, dud, ddu, ddd.
For example: sans serif upper P left parenthesis upper X equals 2.5 right parenthesis equals sans serif upper P left parenthesis StartSet udd comma dud comma ddu EndSet right parenthesis periodP(X = 2.5) = P({udd, dud, ddu}). But left brace upper X equals 2.5 right brace{X = 2.5} is the disjoint 
union of three events (each consisting of a singleton): 
StartSet udd comma udu comma ddu EndSet equals StartSet udd EndSet union StartSet dud EndSet union StartSet ddu EndSet comma{udd, udu, ddu} = {udd} ∪{dud} ∪{ddu},
thus 
sans serif upper P left parenthesis upper X equals 2.5 right parenthesis equals sans serif upper P left parenthesis StartSet udd EndSet right parenthesis plus sans serif upper P left parenthesis StartSet udu EndSet right parenthesis plus sans serif upper P left parenthesis StartSet ddu EndSet right parenthesis equals three eighths equals 0.375 periodP(X = 2.5) = P({udd}) + P({udu}) + P({ddu}) = 3
8 = 0.375.
Example 1.10 Assigning a probability weight as we did before is based on ‘equally 
likely outcomes’. On the other hand, looking at the values X takes on we see that its 
range is the discrete set StartSet 1.5 comma 2.5 comma 3.5 comma 4.5 EndSet{1.5, 2.5, 3.5, 4.5} and the assignment of probabilities is 
sans serif upper P left parenthesis upper X equals 4.5 right parenthesis equals sans serif upper P left parenthesis upper X equals 1.5 right parenthesis equals one eighth comma sans serif upper P left parenthesis upper X equals 3.5 right parenthesis equals sans serif upper P left parenthesis upper X equals 2.5 right parenthesis equals three eighths periodP(X = 4.5) = P(X = 1.5) = 1
8,
P(X = 3.5) = P(X = 2.5) = 3
8.
In fact, the price upper X left parenthesis omega right parenthesis equals 3.5X(ω) = 3.5 can be reached in 3 ways, with omega equals uud comma udu comma duu semicolonω = uud, udu, duu;
the same is true for the price upper X left parenthesis omega right parenthesis equals 2.5X(ω) = 2.5. 
The above examples correspond to modelling discrete uniform probability spaces, 
where StartAbsoluteValue upper Omega EndAbsoluteValue equals n|Ω| = n and script upper F equals 2 Superscript upper OmegaF = 2Ω, i.e. we can always choose the power set as sigma hyphen algebraσ-algebra, 
see Example 1.12 in Sect. 1.6, which contains singletons StartSet omega EndSet{ω} as essential building 
blocks for probability computations. Here for each upper A element of script upper FA ∈F we have 
StartLayout 1st Row sans serif upper P left parenthesis upper A right parenthesis equals sigma summation Underscript omega element of upper A Endscripts sans serif upper P left parenthesis StartSet omega EndSet right parenthesis comma EndLayoutP(A) =
⎲
ω∈A
P({ω}),
(1.1) 
where StartAbsoluteValue upper A EndAbsoluteValue less than or slanted equals StartAbsoluteValue upper Omega EndAbsoluteValue|A| ⩽|Ω| is essential for sans serif upper PP to be a probability measure.
10
1
Probability, Events and Random Variables
Example 1.11 We compute the probability that the 1-day stock price is equal to 3.5 
as that of the event upper A equals left brace upper X equals 3.5 right braceA = {X = 3.5} with cardinality StartAbsoluteValue upper A EndAbsoluteValue equals 3 comma|A| = 3, and 
sans serif upper P left parenthesis upper A right parenthesis equals sigma summation Underscript omega element of upper A Endscripts sans serif upper P left parenthesis StartSet omega EndSet right parenthesis equals one eighth plus one eighth plus one eighth equals StartFraction StartAbsoluteValue upper A EndAbsoluteValue Over StartAbsoluteValue upper Omega EndAbsoluteValue EndFraction periodP(A) =
⎲
ω∈A
P({ω}) = 1
8 + 1
8 + 1
8 = |A|
|Ω|.
Discrete uniform probabilities may fail to work with countably inﬁnite sample 
spaces. Moreover, they are inadequate for not equally likely outcomes. However, 
there is a unifying treatment for the discrete case: given a ﬁnite upper OmegaΩ and its power 
set 2 Superscript upper Omega2Ω we have left parenthesis upper Omega comma 2 Superscript upper Omega Baseline comma sans serif upper P right parenthesis(Ω, 2Ω, P) called a discrete probability space, and sans serif upper PP is in 1-
to-1 correspondence with a sequence left parenthesis p Subscript i Baseline right parenthesis Subscript i element of double struck upper N(pi)i∈N of real numbers s.t. sigma summation Underscript i Endscripts p Subscript i Baseline equals 1∑
i pi = 1. 
Note that it may happen p Subscript i Baseline not equals p Subscript jpi /= pj for i not equals ji /= j (the space has no longer uniform 
probability weights). More precisely, if sans serif upper P colon 2 Superscript upper Omega Baseline right arrow left bracket 0 comma 1 right bracketP : 2Ω →[0, 1] is a probability measure 
then p Subscript i Baseline equals sans serif upper P left parenthesis StartSet omega Subscript i Baseline EndSet right parenthesispi = P({ωi}), for i equals 1 comma ellipsis comma ni = 1, . . . , n, whenever StartAbsoluteValue upper Omega EndAbsoluteValue equals n|Ω| = n and indeed 
sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline equals sigma summation Underscript i equals 1 Overscript n Endscripts sans serif upper P left parenthesis StartSet omega Subscript i Baseline EndSet right parenthesis equals sans serif upper P left parenthesis union Subscript i equals 1 Superscript n Baseline StartSet omega Subscript i Baseline EndSet right parenthesis equals sans serif upper P left parenthesis upper Omega right parenthesis equals 1 period
n
⎲
i=1
pi =
n
⎲
i=1
P({ωi}) = P
(
∪n
i=1{ωi}
)
= P(Ω) = 1.
It is worth noting StartSet omega Subscript i Baseline EndSet{ωi} are mutually disjoint events for which the probability measure 
is additive. Therefore, 
sans serif upper P left parenthesis upper A right parenthesis equals sigma summation Underscript i s period t period omega Subscript i Baseline element of upper A Endscripts p Subscript iP(A) =
⎲
i s.t. ωi∈A
pi
(1.2) 
which is nothing else formula (1.1) but without equally weights. On the other hand, 
assuming sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline equals 1∑n
i=1 pi = 1 and deﬁning the set function sans serif upper PP on 2 Superscript upper Omega2Ω by formula (1.2) we  
can easily verify PA1 of Deﬁnition 1.3, Sect. 1.3, and to check countable additivity8 
we simply write 
StartLayout 1st Row 1st Column Blank 2nd Column sans serif upper P left parenthesis upper A 1 union midline horizontal ellipsis upper A Subscript n Baseline union empty set union empty set union midline horizontal ellipsis right parenthesis equals sans serif upper P left parenthesis union Subscript i equals 1 Superscript n Baseline upper A Subscript i Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals sigma summation Underscript j s period t period omega Subscript j Baseline element of union Subscript i equals 1 Superscript n Baseline upper A Subscript i Baseline Endscripts sigma summation Underscript j equals 1 Overscript n Endscripts p Subscript j Baseline equals sigma summation Underscript j s period t period omega Subscript j Baseline element of upper A Subscript i Baseline Endscripts p Subscript j Baseline 3rd Row 1st Column Blank 2nd Column equals sigma summation Underscript i equals 1 Overscript n Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis comma EndLayoutP(A1 ∪· · · An ∪∅∪∅∪· · · ) = P
(
∪n
i=1Ai
)
=
⎲
j s.t. ωj ∈∪n
i=1Ai
n
⎲
j=1
pj =
⎲
j s.t. ωj ∈Ai
pj
=
n
⎲
i=1
P(Ai),
8 For a ﬁnite sample space we have 2 Superscript upper Omega2Ω is also ﬁnite and then it cannot contain inﬁnite sequences of 
events upper A 1 comma upper A 2 ellipsisA1, A2 . . . Thus, property S3 of a sigma hyphen algebraσ-algebra (see Deﬁnition 1.2, Sect. 1.3) should be stated 
for ﬁnite sequences of mutually disjoint events upper A 1 comma ellipsis comma upper A 2A1, . . . , A2, all belonging to 2 Superscript upper Omega2Ω, s.t. union Subscript i equals 1 Superscript n Baseline upper A Subscript i element of 2 Superscript upper Omega∪n
i=1Ai ∈2Ω. 
In this case the collection script upper F equals 2 Superscript upper OmegaF = 2Ω is called an algebra, see Appendix in Chap. 2. 
1.5
Further Properties of a Probability Measure
11
and observe that sans serif upper P left parenthesis StartSet omega Subscript j Baseline EndSet right parenthesis equals p Subscript jP({ωj}) = pj. Further is true: we can extend this 1-to-1 
correspondence to countably inﬁnite sample spaces, keeping 2 Superscript upper Omega2Ω as their sigma hyphen algebraσ-algebra, 
under the usual condition sigma summation Underscript i equals 1 Overscript normal infinity Endscripts p Subscript i Baseline equals 1∑∞
i=1 pi = 1 and sans serif upper P left parenthesis StartSet omega Subscript i Baseline EndSet right parenthesis equals p Subscript iP({ωi}) = pi, which is now an inﬁnite 
sequence of positive real numbers, see Appendix C. Eventually, for an arbitrary 
sample space upper OmegaΩ forming left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P), a probability is said to be discrete provided that 
the ﬁnite or countable upper C subset of upper OmegaC ⊂Ω satisﬁes sans serif upper P left parenthesis upper C right parenthesis equals 1P(C) = 1. As byproduct, sans serif upper P left parenthesis upper C Superscript c Baseline right parenthesis equals 0P(Cc) = 0 and for 
every event upper A element of script upper FA ∈F we have 
sans serif upper P left parenthesis upper A right parenthesis equals sans serif upper P left parenthesis upper A intersection upper C right parenthesis equals sigma summation Underscript omega element of upper A intersection upper C Endscripts sans serif upper P left parenthesis StartSet omega EndSet right parenthesis commaP(A) = P(A ∩C) =
⎲
ω∈A∩C
P({ω}),
so that sans serif upper PP is concentrated on C. From this more general setting we can deduce that 
for ﬁnite of countable sample spaces discussed above any sans serif upper PP must be discrete. If we 
insist on using weights p Subscript ipi to set up the probability of any other event upper A element of 2 Superscript upper OmegaA ∈2Ω, when 
the sample space is uncountable, then it can be shown that p Subscript i Baseline equals 0pi = 0 and, moreover, 
there is no probability which assigns a value to every subset of upper OmegaΩ in such a way 
axioms PA1 and PA2 are fulﬁlled, see Appendix. On the other hand, it is possible to 
circumvent this and build a probability measure:
•
restricting the sigma hyphen algebraσ-algebra 2 Superscript upper Omega2Ω to a more convenient class script upper FF of well representative 
events satisfying properties SA1-SA3 of Deﬁnition 1.2;
•
deﬁning the measure sans serif upper PP without using countable summation. 
The last item is directly linked to the question of what type of rv has to be used for 
random experiments with ﬁnite/countable scenarios and random experiment with 
uncountable scenarios, see Chap. 2. 
Remark 1.2 Given a probability space where script upper FF contains all singletons StartSet omega EndSet{ω} for 
every omega element of upper Omega commaω ∈Ω, we say that the outcome omegaω is an atom if sans serif upper P left parenthesis StartSet omega EndSet right parenthesis greater than 0P({ω}) > 0. A probability 
measure is diffusive if it has no atoms, i.e. sans serif upper P left parenthesis StartSet omega EndSet right parenthesis equals 0P({ω}) = 0 for every scenario omegaω. A  
probability measure is said to be purely atomic if its atoms form a countable set 
H such that sans serif upper P left parenthesis upper H Superscript c Baseline right parenthesis equals 0 periodP(H c) = 0. Thus a (uniform) discrete probability measure is purely 
atomic. 
1.5 
Further Properties of a Probability Measure 
Any probability measure sans serif upper PP acting as a set function obeys to some arithmetic and 
ordering rules. 
Proposition 1.1 Given a probability space left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis comma(Ω, F, P), the measure sans serif upper PP satisﬁes: 
sans
 serif upper P left parenthesis upper A Superscript c Baseline right parenthesis equals 1 minus sans serif upper P left parenthesis upper A right parenthesis commaP(Ac) = 1 −P(A), for every upper A element of script upper FA ∈F
Pr2 
If upper A subset of upper B commaA ⊂B, then sans serif upper P left parenthesis upper A right parenthesis less than or slanted equals sans serif upper P left parenthesis upper B right parenthesis commaP(A) ⩽P(B), for every pair upper A comma upper B element of script upper FA, B ∈F (monotonicity) 
Pr3 
If upper A subset of upper B commaA ⊂B, then sans serif upper P left parenthesis upper B minus upper A right parenthesis equals sans serif upper P left parenthesis upper B right parenthesis minus sans serif upper P left parenthesis upper A right parenthesis commaP(B \ A) = P(B) −P(A), for every pair upper A comma upper B element of script upper FA, B ∈F
sans
 serif upper P left parenthesis upper A union upper B right parenthesis equals sans serif upper P left parenthesis upper A right parenthesis plus sans serif upper P left parenthesis upper B right parenthesis minus sans serif upper P left parenthesis upper A intersection upper B right parenthesis commaP(A ∪B) = P(A) + P(B) −P(A ∩B), for every pair upper A comma upper B element of script upper F periodA, B ∈F.
12
1
Probability, Events and Random Variables
Proving Proposition 1.1 is a constructive exercise in computing probabilities. 
Proof First we check Pr1. Events upper A element of script upper FA ∈F and upper A Superscript cAc are incompatible, thus 1 equals sans serif upper P left parenthesis upper Omega right parenthesis equals sans serif upper P left parenthesis upper A union upper A Superscript c Baseline right parenthesis equals sans serif upper P left parenthesis upper A right parenthesis plus sans serif upper P left parenthesis upper A Superscript c Baseline right parenthesis period1 = P(Ω) =
P(A ∪Ac) = P(A) + P(Ac). To prove Pr2, let upper B equals upper A union left parenthesis upper B minus upper A right parenthesisB = A ∪(B \ A) be decomposed 
by two disjoint events, then sans serif upper P left parenthesis upper B right parenthesis equals sans serif upper P left parenthesis upper A right parenthesis plus sans serif upper P left parenthesis upper B minus upper A right parenthesisP(B) = P(A) + P(B \ A) by countable additivity, thus 
subtracting the second term on the right-hand side we are done. Now, Pr3 easily 
follows from Pr2. Claim Pr4 is based on decomposing upper A union upper BA ∪B by the disjoint events 
upper AA and upper B minus left parenthesis upper A intersection upper B right parenthesis commaB \ (A ∩B), since the latter is such that left parenthesis upper A intersection upper B right parenthesis subset of upper B(A ∩B) ⊂B and Pr3 applies. 
█
Next we present an important property of sans serif upper PP that will help in computing limiting 
probabilities, see Chap. 2, Sect. 2.1, and Appendix in Chap. 2. 
Theorem 1.1 (Continuity of Probability) Given a probability space left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P)
and an increasing sequence of events upper A 1 subset of upper A 2 subset of midline horizontal ellipsisA1 ⊂A2 ⊂· · · from script upper F commaF, deﬁne upper A colon equals limit Underscript i right arrow normal infinity Endscripts upper A Subscript i Baseline colon equals union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i Baseline periodA :=
limi→∞Ai := ∪∞
i=1Ai. Then it holds 
limit Underscript i right arrow normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis equals sans serif upper P left parenthesis upper A right parenthesis period lim
i→∞P(Ai) = P(A).
The same result holds true for decreasing sequences of events upper A 1 superset of upper A 2 superset of midline horizontal ellipsisA1 ⊃A2 ⊃· · · from 
script upper F commaF, and with upper A equals limit Underscript i right arrow normal infinity Endscripts upper A Subscript i Baseline colon equals intersection Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i Baseline periodA = limi→∞Ai := ∩∞
i=1Ai.
Property Pr2 does imply sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis less than or slanted equals sans serif upper P left parenthesis upper A Subscript i plus 1 Baseline right parenthesisP(Ai) ⩽P(Ai+1) is an increasing sequence of nonnegative 
reals, which is bounded above by sans serif upper P left parenthesis upper A right parenthesisP(A) for upper A Subscript i Baseline subset of upper AAi ⊂A and then converges to the 
limit sans serif upper P left parenthesis upper A right parenthesis periodP(A). This justiﬁes the interchange of limit and the probability measure, i.e. 
limit Underscript i right arrow normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis equals sans serif upper P left parenthesis limit Underscript i right arrow normal infinity Endscripts upper A Subscript i Baseline right parenthesis equals sans serif upper P left parenthesis upper A right parenthesislimi→∞P(Ai) = P(limi→∞Ai) = P(A) as for real-valued continuous function. 
The same reasoning applies to the case of a decreasing sequences of upper A Subscript iAis. In some 
textbooks increasing events upper A 1 comma upper A 2 comma ellipsisA1, A2, . . . and their union A are referred as upper A Subscript i Baseline up arrow upper AAi ↑A, 
using a notation similar to that of convergent sequences of real numbers. Similarly, 
decreasing events upper A 1 comma upper A 2 comma ellipsisA1, A2, . . . and their intersection A are referred as upper A Subscript i Baseline down arrow upper AAi ↓A. 
Continuity of the probability measure can be generalized to some extent. In a 
sigma hyphen algebraσ-algebra script upper FF the sigmaσ reminds us that not only ﬁnite but also countable unions of events 
are possible (sigma equalsσ = ‘sums’). Finite unions cannot capture tail events in experiment 
like tossing a coin inﬁnitely many times or predicting the future stock price with 
inﬁnitely many uptick and downtick movements. Let left parenthesis upper A Subscript i Baseline right parenthesis Subscript i element of double struck upper N(Ai)i∈N be a sequence in script upper FF
and deﬁne: 
StartLayout 1st Row 1st Column limit sup upper A Subscript i 2nd Column colon equals 3rd Column intersection Subscript n greater than or slanted equals 1 Baseline union Subscript i greater than or slanted equals n Baseline upper A Subscript i 2nd Row 1st Column limit inf upper A Subscript i 2nd Column colon equals 3rd Column union Subscript n greater than or slanted equals 1 Baseline intersection Subscript i greater than or slanted equals n Baseline upper A Subscript i Baseline period EndLayoutlim sup Ai := ∩n⩾1 ∪i⩾n Ai
lim inf Ai := ∪n⩾1 ∩i⩾n Ai.
They are easily veriﬁed belonging to script upper F periodF. The ﬁrst is often denoted by left brace upper A Subscript i Baseline i period o period right brace{Ai i.o.}
referred to as ‘upper A Subscript iAi inﬁnitely often’, since for a given i element of double struck upper Ni ∈N the event union Subscript i greater than or slanted equals n Baseline upper A Subscript i∪i⩾nAi is 
interpreted as ‘at least one of the upper A Subscript iAi occurs’ and 
intersection Subscript n equals 1 Superscript normal infinity Baseline union Subscript i equals n Superscript normal infinity Baseline upper A Subscript i Baseline equals StartSet omega vertical bar for all n omega element of union Subscript i equals n Superscript normal infinity Baseline upper A Subscript i Baseline EndSet ∩∞
n=1 ∪∞
i=nAi =
{
ω|∀n ω ∈∪∞
i=nAi
}
1.5
Further Properties of a Probability Measure
13
is the event that inﬁnitely many of the upper A Subscript iAi occur. The second limiting event above 
is often written left brace upper A Subscript i Baseline ev right brace{Ai ev} and referred to as ‘upper A Subscript iAi eventually’ or almost always, indeed 
intersection Subscript i greater than or slanted equals n Baseline upper A Subscript i∩i⩾nAi stands for ‘all the upper A Subscript iAi’s occur’ and 
union Subscript n equals 1 Superscript normal infinity Baseline intersection Subscript i equals n Superscript normal infinity Baseline upper A Subscript i Baseline equals StartSet omega vertical bar there exists n omega element of intersection Subscript i equals n Superscript normal infinity Baseline upper A Subscript i Baseline EndSet comma∪∞
n=1 ∩∞
i=nAi =
{
ω | ∃n ω ∈∩∞
i=nAi
}
,
is the event that all but a ﬁnite number of upper A Subscript iAi occur.9 For these tail events we have 
limit inf upper A Subscript i Baseline subset of limit sup upper A Subscript i Baseline comma left parenthesis limit sup upper A Subscript i Baseline right parenthesis Superscript c Baseline equals limit inf upper A Subscript i Superscript c Baseline comma limit sup upper A Subscript i Superscript c Baseline equals left parenthesis limit inf upper A Subscript i Baseline right parenthesis Superscript c Baseline periodlim inf Ai ⊂lim sup Ai,
(lim sup Ai)c = lim inf Ac
i ,
lim sup Ac
i = (lim inf Ai)c.
For example sans serif upper P left parenthesis upper A Subscript i Baseline i period o period right parenthesis equals 1 minus sans serif upper P left parenthesis upper A Subscript i Superscript c Baseline ev right parenthesis periodP(Ai i.o.) = 1−P(Ac
i ev). The relation on the right-hand side is based 
on DeMorgan’s laws. If limit inf upper A Subscript i Baseline equals limit sup upper A Subscript i Baseline equals upper Alim inf Ai = lim sup Ai = A we write limit Underscript i right arrow normal infinity Endscripts upper A Subscript i Baseline equals upper Alimi→∞Ai = A and 
say that the sequence left parenthesis upper A Subscript i Baseline right parenthesis Subscript i element of double struck upper N Baseline comma(Ai)i∈N, not supposed to be monotone, converges to the event 
upper A periodA. This in fact generalizes Theorem 1.1 (see Appendix). We also have: 
sans serif upper P left parenthesis limit inf upper A Subscript i Baseline right parenthesis less than or slanted equals limit inf sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis less than or slanted equals limit sup sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis less than or slanted equals sans serif upper P left parenthesis limit sup upper A Subscript i Baseline right parenthesis periodP(lim inf Ai) ⩽lim inf P(Ai) ⩽lim sup P(Ai) ⩽P(lim sup Ai).
If a sequence upper A Subscript i Baseline right arrow upper AAi →A in the sense given above, then 
limit Underscript i right arrow normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis equals sans serif upper P left parenthesis upper A right parenthesis comma lim
i→∞P(Ai) = P(A),
since10 limit inf sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis equals limit sup sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesislim inf P(Ai) = lim sup P(Ai). With this machinery at hand we present the 
following: 
Lemma 1.1 (Borel-Cantelli) Let upper A 1 comma upper A 2 comma ellipsis element of script upper FA1, A2, . . . ∈F any sequence of events on the 
probability space left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis period(Ω, F, P).
(i) If sigma summation Underscript i equals 1 Overscript normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis less than normal infinity comma∑∞
i=1 P(Ai) < ∞, then sans serif upper P left parenthesis upper A Subscript i Baseline i period o period right parenthesis equals 0 periodP(Ai i.o.) = 0.
(ii) If sigma summation Underscript i equals 1 Overscript normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis equals normal infinity∑∞
i=1 P(Ai) = ∞and upper A Subscript iAi are independent events, then sans serif upper P left parenthesis upper A Subscript i Baseline i period o period right parenthesis equals 1P(Ai i.o.) = 1. 
Proof Let upper A equals limit sup upper A Subscript i Baseline periodA = lim sup Ai. (i) We have upper A subset of union Subscript i equals n Superscript normal infinity Baseline upper A Subscript iA ⊂∪∞
i=nAi and then sans serif upper P left parenthesis upper A right parenthesis less than or slanted equals sigma summation Underscript i equals n Overscript normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesisP(A) ⩽∑∞
i=n P(Ai)
for all i element of double struck upper N commai ∈N, by monotonicity and subadditivity. Since the sum is taken over the tail 
of a convergent series, sigma summation Underscript i equals 1 Overscript normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis less than normal infinity comma∑∞
i=1 P(Ai) < ∞, then we know that limit Underscript i right arrow normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis equals 0limi→∞P(Ai) = 0
and then the sum also tends to zero as i right arrow normal infinity periodi →∞. (ii) Since left parenthesis limit sup upper A Subscript i Baseline right parenthesis Superscript c Baseline equals limit inf upper A Subscript i Superscript c(lim sup Ai)c = lim inf Ac
i
we can write upper A Superscript c Baseline equals union Subscript n equals 1 Superscript normal infinity Baseline intersection Subscript i equals n Superscript normal infinity Baseline upper A Subscript i Superscript cAc = ∪∞
n=1 ∩∞
i=n Ac
i and thus: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper A Superscript c Baseline right parenthesis 2nd Column less than or slanted equals 3rd Column sigma summation Underscript n equals 1 Overscript normal infinity Endscripts sans serif upper P left parenthesis intersection Subscript i equals n Superscript normal infinity Baseline upper A Subscript i Superscript c Baseline right parenthesis equals sigma summation Underscript n equals 1 Overscript normal infinity Endscripts limit Underscript m right arrow normal infinity Endscripts sans serif upper P left parenthesis intersection Subscript i equals n Superscript m Baseline upper A Subscript i Superscript c Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript n equals 1 Overscript normal infinity Endscripts limit Underscript m right arrow normal infinity Endscripts product Underscript i equals n Overscript m Endscripts left brace 1 minus sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis right brace less than or slanted equals sigma summation Underscript n equals 1 Endscripts limit Underscript m right arrow normal infinity Endscripts product Underscript i equals n Overscript m Endscripts e Superscript minus sans serif upper P left parenthesis upper A Super Subscript i Superscript right parenthesis Baseline 3rd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript n equals 1 Overscript normal infinity Endscripts e Superscript minus limit Underscript m right arrow normal infinity Endscripts sigma summation Underscript i equals n Overscript m Endscripts sans serif upper P left parenthesis upper A Super Subscript i Superscript right parenthesis Baseline equals sigma summation Underscript n equals 1 Overscript normal infinity Endscripts e Superscript negative normal infinity Baseline equals sigma summation Underscript n equals 1 Overscript normal infinity Endscripts 0 equals 0 comma EndLayoutP(Ac) ⩽
∞
⎲
n=1
P
(
∩∞
i=n Ac
i
)
=
∞
⎲
n=1
lim
m→∞P
(
∩m
i=n Ac
i
)
=
∞
⎲
n=1
lim
m→∞
m
∏
i=n
{1 −P(Ai)} ⩽
⎲
n=1
lim
m→∞
m
∏
i=n
e−P(Ai)
9 Only a ﬁnite number of upper A Subscript iAi does not occur. 
10 For a formal proof see e.g. [2, Th 4.1].  
14
1
Probability, Events and Random Variables
= 
∞
⎲
n=1 
e−limm→∞
∑m 
i=n P(Ai) = 
∞
⎲
n=1 
e−∞ = 
∞
⎲
n=1 
0 = 0, 
provided sigma summation Underscript i equals 1 Overscript normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis equals normal infinity period∑∞
i=1 P(Ai) = ∞.
█
In the proof above we use continuity of sans serif upper PP, independence among complements and 
the following fact: for every 0 less than x less than 10 < x < 1 it is true g left parenthesis x right parenthesis equals 1 minus x less than or slanted equals e Superscript negative x Baseline equals h left parenthesis x right parenthesis periodg(x) = 1 −x ⩽e−x = h(x). Just 
take the derivative of both functions g comma h periodg, h. The Borel-Cantelli Lemma asserts that if 
left parenthesis upper A Subscript i Baseline right parenthesis Subscript i element of double struck upper N(Ai)i∈N are independent then sans serif upper P left parenthesis upper A Subscript i Baseline i period o period right parenthesisP(Ai i.o.) is either 0 or 1. See Appendix C for related 
concepts of limit inf comma limit suplim inf, lim sup concerning real-valued sequences. 
1.6 
Further σ-algebra 
Recall that for a random experiment with sample space upper OmegaΩ the corresponding 
sigma hyphen algebraσ-algebra script upper FF may be interpreted as ‘partial information’. 
Example 1.12 (Richer Information) The power set 2 Superscript upper Omega2Ω is indeed a sigma hyphen algebraσ-algebra: the  
impossible event and the certain event are contained in it (they are subsets of upper OmegaΩ). 
For every upper A element of 2 Superscript upper OmegaA ∈2Ω we have upper A Superscript c Baseline element of 2 Superscript upper Omega Baseline commaAc ∈2Ω, because every event A belongs to 2 Superscript upper Omega2Ω as well 
as its complement upper A Superscript c Baseline periodAc. Given events upper A 1 comma upper A 2 comma ellipsisA1, A2, . . . from 2 Superscript upper Omega Baseline comma2Ω, their union union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i∪∞
i=1Ai is a 
subset of upper OmegaΩ and then it belongs to the power set. Here we have information on any 
event of interest: upper A element of 2 Superscript upper OmegaA ∈2Ω tells us the event A can occur, but also its contrary upper A Superscript cAc can 
occur; if each upper A 1 comma upper A 2 comma ellipsis element of 2 Superscript upper OmegaA1, A2, . . . ∈2Ω may occur, then the event left brace at least one of upper A Subscript i Baseline occur right brace{at least one of Ai occur}
is conceivable. 
Example 1.13 (Trivial sigma hyphen Algebraσ-Algebra) The set StartSet empty set comma upper Omega EndSet{∅, Ω} is a sigma hyphen algebraσ-algebra: the impossible 
event and the certain event are in here; their union is the whole sample space, then 
again belongs to it. The information provided by StartSet empty set comma upper Omega EndSet{∅, Ω} is minimal (nothing or 
everything can happen). 
Example 1.14 (sigma hyphen Algebraσ-Algebra Generated By an Event) 
Given an event upper A subset of upper Omega commaA ⊂Ω, the 
collection StartSet empty set comma upper A comma upper A Superscript c Baseline comma upper Omega EndSet{∅, A, Ac, Ω} is a sigma hyphen algebraσ-algebra (the veriﬁcation is quite simple). It provides 
information restricted to upper A periodA. It can be denoted by StartEnclose box sigma left parenthesis upper A right parenthesis EndEnclose σ(A) , the bold italic sigmaσ-algebra generated 
by the event bold upper A commaA, actually the smallest sigma hyphen algebraσ-algebra containing this event. 
Example 1.15 The collection of all events left brace upper X element of upper B right brace comma{X ∈B}, for a rv X and every 
suitable subsets B of real numbers, is a sigma hyphen algebraσ-algebra. It may be obtained by unions, 
intersections and complements of events left brace upper X less than or slanted equals a right brace comma{X
⩽a}, for every a element of double struck upper Ra
∈R. The  
information it provides is based on the numerical description of the underlying 
random experiment, given by the rv upper X periodX. Usually it is denoted by StartEnclose box sigma left parenthesis upper X right parenthesis EndEnclose σ(X) , the bold italic sigmaσ-
algebra generated by the rv bold upper XX, actually the smallest sigma hyphen algebraσ-algebra containing events 
of the form left brace upper X element of upper B right brace{X ∈B}. 
We can assign different sigma hyphen algebraσ-algebras to a ﬁxed experiment, depending on our needs.
1.6
Further σ-algebra
15
Example 1.16 For two possible tick movements, consider the following collections 
of events: 
script upper F 1 equals StartSet empty set comma upper Omega comma StartSet uu EndSet comma StartSet ud comma du comma dd EndSet EndSet script upper F 2 equals StartSet empty set comma upper Omega comma StartSet uu comma dd EndSet comma StartSet ud comma du EndSet EndSet periodF1 = {∅, Ω, {uu}, {ud,du,dd}}
F2 = {∅, Ω, {uu,dd}, {ud,du}} .
Properties S1–S3 of Deﬁnition 1.2 are easily veriﬁed, thus both are sigma hyphen algebraσ-algebra. Their 
intersection script upper F 1 intersection script upper F 2 equals StartSet empty set comma upper Omega EndSetF1 ∩F2 = {∅, Ω} is the trivial sigma hyphen algebraσ-algebra. Their union 
script upper F 1 union script upper F 2 equals StartSet empty set comma upper Omega comma StartSet uu EndSet comma StartSet ud comma du comma dd EndSet comma StartSet uu comma dd EndSet comma StartSet ud comma du EndSet EndSetF1 ∪F2 = {∅, Ω, {uu}, {ud,du,dd}, {uu,dd}, {ud,du}}
is not a sigma hyphen algebraσ-algebra, for example StartSet uu EndSet union StartSet ud comma du EndSet{uu} ∪{ud,du} does not belongs to it. 
Example 1.17 Let upper X 1 comma upper X 2 comma ellipsisX1, X2, . . . be rvs over the same probability space. They are 
indexed by natural numbers (viz. they form a sequence of rvs). Then sigma left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesisσ(X1, . . . , Xn)
is the sigma hyphen algebraσ-algebra generated by the n-tuple left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesis(X1, . . . , Xn), see Sect. 3.1, and contains 
those events A for which we can verify whether or not they have occurred, i.e., 
omega element of upper Aω ∈A, by checking only numerical values of the n-tuple. More generally, if left parenthesis upper X Subscript i Baseline right parenthesis Subscript i element of upper I(Xi)i∈I
is any indexed family of rvs, for a nonempty set I, then sigma left parenthesis upper X Subscript i Baseline comma i element of upper I right parenthesisσ(Xi, i ∈I) is the sigma hyphen algebraσ-algebra
generated by the whole family, see Chap. 9. Eventually, suppose that upper S 1 comma upper S 2 comma ellipsisS1, S2, . . . is a 
sequence of rvs representing a stock price over subsequent days t equals 1 comma 2 comma ellipsist = 1, 2, . . .. The  
sigma hyphen algebraσ-algebra sigma Subscript t Baseline colon equals sigma left parenthesis upper S Subscript t plus 1 Baseline comma upper S Subscript t plus 2 Baseline comma ellipsis right parenthesisσt := σ(St+1, St+2, . . .) contributes to the tail bold italic sigmaσ-algebra intersection Subscript t equals 1 Superscript normal infinity Baseline sigma Subscript t∩∞
t=1σt, see  
Exercise 1.13: the intersection of sigma hyphen algebraσ-algebras is again a sigma hyphen algebraσ-algebra. It can be shown 
that intersection Subscript t equals 1 Superscript normal infinity Baseline sigma Subscript t∩∞
t=1σt contains events like 
left brace limit Underscript t right arrow normal infinity Endscripts upper S Subscript t Baseline exists right brace comma left brace limit Underscript t right arrow normal infinity Endscripts t Superscript negative 1 Baseline sigma summation Underscript i equals 1 Overscript t Endscripts upper S Subscript i Baseline exists right brace comma left brace sigma summation Underscript t equals 1 Overscript normal infinity Endscripts upper S Subscript t Baseline converge right brace comma
⎨
lim
t→∞St exists
⎬
,
⌠
lim
t→∞t−1
t⎲
i=1
Si exists
⎫
,
⌠∞
⎲
t=1
St converge
⎫
,
see [16, Def 4.10]. Knowing the values of the stock price at subsequent days tells 
us whether they will be from some day t plus 1t + 1 on, and this also informs us about the 
limiting behavior of upper S Subscript tSt for t large enough, about the convergence of partial sums of 
daily prices together with that of their arithmetic mean. 
We have seen how a sigma hyphen algebraσ-algebra can be generated. In Example 1.14 we actually start 
from script upper G equals StartSet upper A comma upper A Superscript c Baseline EndSetG = {A, Ac}, add empty set∅which extends script upper GG to StartSet empty set comma upper A comma upper A Superscript c Baseline EndSet{∅, A, Ac} where performing all 
unions we obtain sigma left parenthesis upper A right parenthesis identical to sigma left parenthesis script upper G right parenthesisσ(A) ≡σ(G). The class script upper GG form a partition of the sample space 
upper OmegaΩ,11 and is called a generator.12 We continue to call sigma left parenthesis script upper G right parenthesisσ(G) the sigma hyphen algebraσ-algebra generated 
by script upper GG: it is the smallest sigma hyphen algebraσ-algebra containing that class and is equal to the intersection 
of all sigma hyphen algebraσ-algebras containing it, see Exercises 1.13 and 1.14 . 
Remark 1.3 Any sigma hyphen algebraσ-algebra of events is a piπ-system, meaning that it is closed under 
ﬁnite intersection, i.e., for every upper A comma upper B element of script upper FA, B ∈F we have upper A intersection upper B element of script upper FA ∩B ∈F. Moreover, script upper FF is also
11 I.e., their intersection is empty, and their union is the sample space. 
12 For ﬁnite sample space, Property S3 of a sigma hyphen algebraσ-algebra is expressed through ﬁnite union of event, 
see Appendix in Chap. 2. 
16
1
Probability, Events and Random Variables
closed under proper differences, i.e., upper A comma upper B element of script upper FA, B ∈F s.t. upper A subset of upper BA ⊂B implies upper B minus upper A element of script upper FB \ A ∈F, and 
it is closed under countable increasing union, i.e., upper A 1 subset of upper A 2 subset of midline horizontal ellipsisA1 ⊂A2 ⊂· · · , all belonging 
to script upper FF, implies upper A equals union Subscript i Baseline upper A Subscript i Baseline element of script upper FA = ∪iAi ∈F, see Exercise 1.15. These last two properties makes 
script upper FF a d-system or Dynkin system . Conversely, it can be shown that any collection of 
events which is both a piπ-system and a d-system, is also a sigma hyphen algebraσ-algebra. 
The construction of a sigma hyphen algebraσ-algebra based on generators can be pushed further. We 
can consider classes of events script upper GG which are ﬁnite, StartSet upper A 1 comma ellipsis comma upper A Subscript n Baseline EndSet{A1, . . . , An}, or countable, 
StartSet upper A 1 comma upper A 2 comma ellipsis EndSet{A1, A2, . . .}, and form a partition of the sample space. Hence, after adding empty set∅we 
get sigma left parenthesis script upper G right parenthesis equals script upper Fσ(G) = F and we can concentrate on minimal (viz. elementary or amenable) 
classes of events in such a way performing set operation yields the whole sigma hyphen algebraσ-algebra. 
A special case is script upper G equals StartSet StartSet omega EndSet vertical bar omega element of upper Omega EndSetG = {{ω} | ω ∈Ω}, i.e., the collection of all elementary events 
(viz. singletons) which together with the impossible event empty set∅generate the sigma hyphen algebraσ-algebra, 
i.e., sigma left parenthesis script upper G right parenthesis equals script upper F equals 2 Superscript upper Omegaσ(G) = F = 2Ω: every event upper A subset of upper OmegaA ⊂Ω is a union of some elementary events, 
upper A equals union Subscript omega element of upper A Baseline StartSet omega EndSetA = ∪ω∈A{ω}, then upper A element of sigma left parenthesis script upper G right parenthesisA ∈σ(G). 
Remark 1.4 A technical result from measure theory implies that uniqueness of a 
probability measure on an event space left parenthesis upper Omega comma script upper F right parenthesis(Ω, F) can be tested on a generator script upper GG of script upper FF, 
provided that it is a piπ-system, see also Appendix in Chap. 2.13 
1.7 
Introduction to Trees 
Trees, especially binomial trees, play a relevant pedagogic role in probability theory. 
In the following we introduce them to illustrate the wrong way to build a model 
for the evolution of a stock price over a ﬁnite set of dates. The S&P500 is a 
market index whose value at a future time is unknown in advance. In ﬁnance other 
traded assets behave similarly: stock prices, interest rates, foreign exchange rates, 
derivatives prices. A simple additive model for the future price upper S Subscript tSt can be built if 
we are interested in predicting a stock price at the end of t equals 1t = 1 trading day. In 
actual markets, starting from the initial (spot) price we would observe upward or 
downward tick movements of plus or minus 0.5 comma±0.5, as many times as permitted by trading rules. 
Example 1.18 Let upper S 1 left parenthesis omega right parenthesisS1(ω) be the 1-day stock price: the sample space contains all 
possible tick movements. If we admit 3 upwards and/or downwards and label each 
outcomes omega element of upper Omegaω ∈Ω accordingly, then 
upper Omega equals StartSet uuu comma uud comma udu comma duu comma udd comma dud comma ddu comma ddd EndSet periodΩ = {uuu, uud, udu, duu, udd, dud, ddu, ddd}.
13 It can be also showed that a class of events script upper GG which is a piπ-system generates a sigma hyphen algebraσ-algebra sigma left parenthesis script upper G right parenthesisσ(G)
equal to the smallest d-system containing the class, denoted d left parenthesis script upper G right parenthesisd(G). 
1.7
Introduction to Trees
17
Fig. 1.4 Getting scenarios omegaω
for the experiment ‘three tick 
movements of a daily stock 
price’ through a binomial 
tree. There is an obvious 
analogy with the experiment 
of tossing a coin three times, 
revealed by the corresponding 
coding (e.g. uuu can be 
replaced by HHH) 
Fig. 1.5 The binomial tree is  
also good to ﬁgure out the 
underlying rv upper S Subscript tSt
If we further assume a spot price upper S 0 equals 3 commaS0 = 3, then the daily price is given by the rv with 
values 
StartLayout 1st Row upper S 1 left parenthesis uuu right parenthesis equals 4.5 comma upper S 1 left parenthesis uud right parenthesis equals upper S 1 left parenthesis udu right parenthesis equals upper S 1 left parenthesis duu right parenthesis equals 3.5 comma 2nd Row upper S 1 left parenthesis udd right parenthesis equals upper S 1 left parenthesis dud right parenthesis equals upper S 1 left parenthesis ddu right parenthesis equals 2.5 comma upper S 1 left parenthesis ddd right parenthesis equals 1.5 period EndLayoutS1(uuu) = 4.5, S1(uud) = S1(udu) = S1(duu) = 3.5,
S1(udd) = S1(dud) = S1(ddu) = 2.5, S1(ddd) = 1.5.
From Example 1.18, the correpsonding binomial tree is a diagram representing 
different paths that might be followed by the price within one day: each node 
represents either an upward or a downward price movement, see Figs. 1.4, 1.5 
and 1.6. The very limitation of a tree is that it cannot be used if the number 
of scenarios is too large. Indeed, for the additive model this can lead to some 
inconsistencies. 
Example 1.19 It is worth noting that 2 upwards and 1 downward entail the same 
value 3.5, and similarly 1 upward together with 2 downwards give the same value 
2.5. If we assume a spot price upper S 0 equals 2 commaS0 = 2, then the daily price is given by a zero value 
upper S 1 left parenthesis ddd right parenthesis equals 0 periodS1(ddd) = 0. A spot price upper S 0 equals 1S0 = 1 gives a negative daily price upper S 1 left parenthesis ddd right parenthesis equals negative 0.5 periodS1(ddd) = −0.5.
18
1
Probability, Events and Random Variables
Fig. 1.6 Because of the 
symmetry in successive up 
and down stock price’s 
movements the tree is 
recombining, a prelude of 
the so called Markov property 
we will study in the sequel 
These are not real traded value!. Later, we introduce a multiplicative model for the 
future price which works, whatever the spot price is (see Sect. 5.4). 
Labeling scenarios is not necessarily relevant. 
Example 1.20 (Three Coin Tossing) The random experiment of ﬂipping a fair 
coin three times produces an 8-elements sample space, 
upper Omega equals StartSet HHH comma HHT comma HTH comma THH comma HTT comma THT comma TTH comma TTT EndSet commaΩ = {HHH, HHT, HTH, THH, HTT, THT, TTH, TTT},
where H stands for ‘head’ and T stands for ‘tail’, which shares the same structure of 
the sample space based on 3 possible up/down tick movements. In fact, we can use 
0 and 1 instead of H and T, respectively. 
We observe that the sample space underlying tick movements driving future stock 
prices is related to a sigma hyphen algebraσ-algebra built upon generating classes, see Sect. 1.6. More  
precisely, we have repeated single trials based on u or d up to three times to get the 
whole random experiment producing events like 
upper A equals StartSet omega vertical bar normal u is showed first EndSet comma or upper B equals StartSet omega vertical bar normal d is showed first EndSet equals upper A Superscript c Baseline periodA = {ω | u is showed ﬁrst}, or B = {ω | d is showed ﬁrst} = Ac.
This is the same to handle 
upper Omega equals StartSet d comma u EndSet times StartSet d comma u EndSet times StartSet d comma u EndSet equals left brace omega vertical bar omega equals left parenthesis a 1 comma a 2 comma a 3 right parenthesis comma a Subscript i Baseline equals u or d for i equals 1 comma 2 comma 3 right brace periodΩ = {d, u} × {d, u} × {d, u} = {ω | ω = (a1, a2, a3), ai = u or d for i = 1, 2, 3}.
We can turn to the system script upper G equals StartSet upper A comma upper B EndSet𝒢= {A, B} representing a decomposition of upper OmegaΩ, then 
adding empty set∅we generate the class script upper F equals StartSet empty set comma upper A comma upper B comma upper Omega EndSetF = {∅, A, B, Ω} on which a probability measure 
can be deﬁned if we are interested only in the ﬁrst tick movements. This framework 
can be generalized by considering further tick movements yielding scenario omega equals left parenthesis a 1 comma a 2 comma ellipsis right parenthesisω =
(a1, a2, . . .), and events such as 
StartLayout 1st Row 1st Column upper C equals StartSet omega equals left parenthesis a Subscript i Baseline right parenthesis Subscript i element of double struck upper N Baseline colon a 1 equals a 2 equals d EndSet comma 2nd Column Blank 3rd Column upper D equals StartSet omega equals left parenthesis a Subscript i Baseline right parenthesis Subscript i element of double struck upper N Baseline colon a 1 equals a 2 equals u EndSet comma 2nd Row 1st Column upper E equals left brace omega equals left parenthesis a Subscript i Baseline right parenthesis Subscript i element of double struck upper N Baseline colon a 1 equals d comma a 2 equals u right brace comma 2nd Column Blank 3rd Column upper F equals left brace omega equals left parenthesis a Subscript i Baseline right parenthesis Subscript i element of double struck upper N Baseline colon a 1 equals u comma a 2 equals d right brace period EndLayoutC = {ω = (ai)i∈N : a1 = a2 = d}, D = {ω = (ai)i∈N : a1 = a2 = u},
E = {ω = (ai)i∈N : a1 = d, a2 = u}, F = {ω = (ai)i∈N : a1 = u, a2 = d}.
1.8
Exercises
19
For example, C is the event of two consecutive tick movements. The collection script upper G equals StartSet upper C comma upper D comma upper E comma upper F EndSet𝒢=
{C, D, E, F} decomposes upper OmegaΩ and serves as a generator. Note that upper C union upper E equals upper AC ∪E = A and 
upper D union upper F equals upper B periodD∪F = B. Furthermore, we can perform double unions upper C union upper D comma upper C union upper F comma upper E union upper F comma upper D union upper EC∪D, C∪F, E∪F, D∪E
and triple unions such as upper C union upper E union upper F equals upper D Superscript c Baseline periodC ∪E ∪F = Dc. This process end with the class 
script upper F equals StartSet empty set comma upper Omega comma upper A comma upper B comma upper C comma upper D comma upper E comma upper F comma upper C Superscript c Baseline comma upper D Superscript c Baseline comma upper E Superscript c Baseline comma upper F Superscript c Baseline comma upper C union upper D comma upper C union upper F comma upper E union upper F comma upper D union upper E EndSet commaF =
{
∅, Ω, A, B, C, D, E, F, Cc, Dc, Ec, F c, C ∪D, C ∪F, E ∪F, D ∪E
}
,
after we added the impossible event. Note how this is linked to the problem of 
deﬁning a probability measure over a sample space when we pass to countably 
inﬁnite tick movements, see Appendix. 
1.8 
Exercises 
1.1 Let S0 = 3 be the initial price of a traded asset. What the event {S1 ⩽a} is, if 
we take a = 3.5? 
1.2 Find the events {S1 ⩾a}, {S1 < a}, {S1 > a} and {S1 = a}, again using 
a = 3.5. 
1.3 Given two real numbers a <  b,  write {X ⩽b} using {X ⩽a} and {a <  X ⩽
b}. 
1.4 Given a real number a ∈ R, write {X ⩾a} as the disjoint union of two events. 
1.5 Suppose the rv S1 is a model for the daily stock price, over an uncountably 
inﬁnite sample space Ω. Consider the event A = {1 < S1 < 3}, then show that it 
equals ∪∞
i=1{1 < S1 ⩽3 − 1 
i }. 
1.6 For the rv S1 modelling the 1-day price, consider the event A = {1 ⩽S1 ⩽3}, 
then show that it equals ∩∞
i=1{1 − 1 
i < S1 ⩽3}. 
1.7 Given the intersection of events A = ∩∞
i=1Ai s.t. every Ai ∈ F, show that 
A ∈F too, i.e. we also have ∩∞
i=1Ai is a member of the σ-algebra. Then, show that 
A \ B ∈F whenever both A, B ∈F. 
1.8 Show that A ∩ (B ∪ C) = (A ∩ B) ∪ (A ∩ C), for events A, B, C ∈F. This in 
particular implies A ∩ (B ∪ C) ∈F. 
1.9 Prove DeMorgan’s Law
(
∪∞
i=1Ai
)c = ∩∞
i=1Ac 
i , for events Ai ∈F. 
1.10 For events A, B, C ∈F prove the following using a different method than the 
one given in a previous exercise:
•
A ∪ (A ∩B) = A
•
(A ∪ B) ∩ (A ∪ C) = A ∪ (B ∩ C). 
1.11 (P-Null Events) Let P(A ∩ B) = P(B), Show that this implies P(A) = 0.
20
1
Probability, Events and Random Variables
1.12 (Discrete Uniform Probabilities) Let Ω be a ﬁnite sample space with n 
outcomes, equally likely. Set F = 2Ω and as usual assign a probability weight 
P({ω}) = 1 
n to each elementary event {ω} ∈ F, for every ω ∈Ω. Thus, deﬁne 
P(A) = |A| 
n for any other event A ∈ F. Verify that properties Pr1-Pr4 hold for this 
set function. 
1.13 Let G = {Si}i∈I be a collection of σ-algebras with respect to a sample space
Ω. Show that the intersection H = ∩i∈ISi is also a σ-algebra. 
1.14 Let C be a collection of subsets of the sample space Ω. Prove that there exists 
the smallest σ-algebra with respect to Ω which contains C. 
1.15 Show that a σ-algebra F of events contains proper difference of its events and 
countable increasing union of its events. 
1.16 (Trace σ-Algebra) 
Let Ω be a sample space and let σE := {A ∩ E | A ∈F} 
be a collection containing all intersections between each event in F and a ﬁxed event 
E ⊂Ω. Show that σE is a σ-algebra. 
Appendix 
Extending Probability Spaces 
Assume a ﬁnite sample space upper Omega equals StartSet omega 0 comma omega 1 comma ellipsis comma omega Subscript n Baseline EndSet commaΩ = {ω0, ω1, . . . , ωn}, where omega Subscript iωi is the outcome con-
sisting of i upwards and n minus in −i downwards price movements, for i equals 0 comma 1 comma 2 comma ellipsis comma n periodi = 0, 1, 2, . . . , n.
For example, for n equals 4n = 4 we have: 
StartLayout 1st Row 1st Column omega 2 2nd Column corresponds to 3rd Column 2 downwards and 2 upwards period EndLayoutω2 corresponds to 2 downwards and 2 upwards.
Observe that omega 2ω2 can be given by StartBinomialOrMatrix 4 Choose 2 EndBinomialOrMatrix
(4
2
)
different combination of 2 downwards and 
2 upwards, so it is natural to assign a probability weight sans serif upper P left parenthesis StartSet omega 2 EndSet right parenthesis equals StartBinomialOrMatrix 4 Choose 2 EndBinomialOrMatrix StartFraction 1 Over 2 Superscript 4 Baseline EndFraction periodP({ω2}) =
(4
2
) 1
24 . More 
generally,14 
sans serif upper P left parenthesis StartSet omega Subscript i Baseline EndSet right parenthesis equals StartBinomialOrMatrix n Choose i EndBinomialOrMatrix StartFraction 1 Over 2 Superscript n Baseline EndFractionP({ωi}) =
(n
i
) 1
2n
where one half1
2 is the probability of a single upward or 
downward. We claim sans serif upper P left parenthesis upper Omega right parenthesis equals sigma summation Underscript i equals 0 Overscript n Endscripts sans serif upper P left parenthesis StartSet omega Subscript i Baseline EndSet right parenthesisP(Ω) = ∑n
i=0 P({ωi}) is 1. Indeed: 
StartLayout 1st Row 1st Column sigma summation Underscript i equals 0 Overscript n Endscripts sans serif upper P left parenthesis StartSet omega Subscript i Baseline EndSet right parenthesis 2nd Column equals 3rd Column sigma summation Underscript i equals 0 Overscript n Endscripts StartBinomialOrMatrix n Choose i EndBinomialOrMatrix StartFraction 1 Over 2 Superscript n Baseline EndFraction equals sigma summation Underscript i equals 0 Overscript n Endscripts StartBinomialOrMatrix n Choose i EndBinomialOrMatrix left parenthesis one half right parenthesis Superscript i Baseline left parenthesis one half right parenthesis Superscript n minus i Baseline 2nd Row 1st Column Blank 2nd Column equals 3rd Column left parenthesis one half plus one half right parenthesis Superscript n Baseline equals 1 comma EndLayout
n
⎲
i=0
P({ωi}) =
n
⎲
i=0
⎛n
i
⎞
1
2n =
n
⎲
i=0
⎛n
i
⎞⎛
1
2
⎞i ⎛
1
2
⎞n−i
=
⎛
1
2 + 1
2
⎞n
= 1,
14 StartBinomialOrMatrix n Choose i EndBinomialOrMatrix equals StartFraction n factorial Over i factorial left parenthesis n minus i right parenthesis factorial EndFraction equals StartFraction left parenthesis i plus left parenthesis n minus i right parenthesis right parenthesis factorial Over i factorial left parenthesis n minus i right parenthesis factorial EndFraction comma
(n
i
)
=
n!
i!(n−i)! =
(i+(n−i))!
i!(n−i)! , i.e the number of permutations of two objects (1 upward and 1 
downward) repeated i times and n minus in −i times, respectively. 
Appendix
21
where we used the binomial formula left parenthesis a plus b right parenthesis Superscript n Baseline equals sigma summation Underscript i equals 0 Overscript n Endscripts StartBinomialOrMatrix n Choose i EndBinomialOrMatrix a Superscript i Baseline b Superscript n minus i Baseline period(a + b)n = ∑n
i=0
(n
i
)
aibn−i. As we have seen 
in Sect. 1.4, for ﬁnite upper Omega commaΩ, formula sans serif upper P left parenthesis upper A right parenthesis equals StartFraction StartAbsoluteValue upper A EndAbsoluteValue Over StartAbsoluteValue upper Omega EndAbsoluteValue EndFractionP(A) = |A|
|Ω| deﬁnes a ﬁnitely additive probability 
function. Equivalently sans serif upper P left parenthesis upper A right parenthesis equals sigma summation Underscript omega element of upper A Endscripts sans serif upper P left parenthesis StartSet omega EndSet right parenthesis commaP(A) = ∑
ω∈A P({ω}), a ﬁnite sum of probability weights 
each given by sans serif upper P left parenthesis StartSet omega EndSet right parenthesis equals StartFraction 1 Over n EndFraction periodP({ω}) = 1
n. This is a discrete uniform probability space, where the 
sigma hyphen algebraσ-algebra is the power set 2 Superscript upper Omega Baseline comma2Ω, which is ﬁnite too. One is tempted to extend this 
formula to inﬁnite countable sample spaces upper Omega equals StartSet omega 1 comma omega 2 comma ellipsis EndSetΩ = {ω1, ω2, . . .}, through the usual 
set function 
sans serif upper P left parenthesis upper A right parenthesis equals sigma summation Underscript omega Subscript j Baseline element of upper A Endscripts sans serif upper P left parenthesis StartSet omega Subscript j Baseline EndSet right parenthesis periodP(A) =
⎲
ωj ∈A
P({ωj}).
First, we need the additional requirement of a convergent series of real numbers, all 
lying in left bracket 0 comma 1 right bracket comma[0, 1],
sigma summation Underscript omega Subscript j Baseline element of upper Omega Endscripts sans serif upper P left parenthesis StartSet omega Subscript j Baseline EndSet right parenthesis equals 1
⎲
ωj ∈Ω
P({ωj}) = 1
to meet axiom PA1, Deﬁnition 1.3, for the probability of the whole upper Omega periodΩ. If the last 
convergence property holds, then the set function deﬁned above is a probability 
measure. In particular, for pairwise disjoint events upper A 1 comma upper A 2 comma ellipsis element of script upper FA1, A2, . . . ∈F countable 
additivity PA2 now reads: 
sans serif upper P left parenthesis union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i Baseline right parenthesis equals sigma summation Underscript omega Subscript j Baseline element of union Subscript i Baseline upper A Subscript i Baseline Endscripts sans serif upper P left parenthesis StartSet omega Subscript j Baseline EndSet right parenthesis equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts sigma summation Underscript omega Subscript j Baseline element of upper A Subscript i Baseline Endscripts sans serif upper P left parenthesis StartSet omega Subscript j Baseline EndSet right parenthesis equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis periodP(∪∞
i=1Ai) =
⎲
ωj ∈∪iAi
P({ωj}) =
∞
⎲
i=1
⎲
ωj ∈Ai
P({ωj}) =
∞
⎲
i=1
P(Ai).
Example 1.21 Consider the random experiment of forecasting the number of price 
changes or jumps. We don’t care of upwards and downwards movements, only 
the number of jumps is of interest: upper Omega equals left brace omega vertical bar omega equals 0 comma 1 comma 2 comma ellipsis right brace periodΩ = {ω | ω = 0, 1, 2, . . .} . We associate the 
sigma hyphen algebraσ-algebra script upper F equals 2 Superscript upper OmegaF = 2Ω of all events. Next, we assign the probability weight 
sans serif upper P left parenthesis StartSet omega EndSet right parenthesis equals StartFraction lamda Superscript i Baseline e Superscript negative lamda Baseline Over i factorial EndFraction comma with i equals omega equals 0 comma 1 comma 2 comma ellipsis comma and lamda greater than 0 periodP({ω}) = λi e−λ
i!
,
with i = ω = 0, 1, 2, . . . ,
and λ > 0.
For example, upper A element of script upper FA ∈F given by upper A equals StartSet 0 comma 1 comma 4 EndSetA = {0, 1, 4} is the event that no jumps or 1 jump 
or 4 jumps have occurred, and it corresponds to the union StartSet 0 EndSet union StartSet 1 EndSet union StartSet 4 EndSet{0} ∪{1} ∪{4} of 3 
pairwise disjoint events with probabilities StartFraction lamda Superscript 0 Baseline e Superscript negative lamda Baseline Over 0 factorial EndFraction comma StartFraction lamda Superscript 1 Baseline e Superscript negative lamda Baseline Over 1 factorial EndFraction comma StartFraction lamda Superscript 4 Baseline e Superscript negative lamda Baseline Over 4 factorial EndFraction period λ0 e−λ
0!
, λ1 e−λ
1!
, λ4 e−λ
4!
. With lamda equals 2λ = 2 they 
are 0.135335, 0.270670 and 0.090223. For n equals 10n = 10 the probability is 0.000038: 
indeed StartFraction lamda Superscript i Baseline e Superscript negative lamda Baseline Over i factorial EndFraction λi e−λ
i!
is very small for a large number n of jumps. It can be interpreted as 
the probability of rare events.
22
1
Probability, Events and Random Variables
Example 1.22 Consider the pairwise disjoint events upper A 1 equals StartSet 1 EndSet comma upper A 2 equals StartSet 3 EndSet comma upper A 3 equals StartSet 5 EndSet comma ellipsisA1 = {1}, A2 = {3}, A3 =
{5}, . . . from script upper F periodF. We have15 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i Baseline right parenthesis 2nd Column equals 3rd Column sigma summation Underscript omega element of union Subscript i Baseline upper A Subscript i Baseline Endscripts sans serif upper P left parenthesis StartSet omega EndSet right parenthesis equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts ModifyingBelow sigma summation Underscript omega element of upper A Subscript i Baseline Endscripts sans serif upper P left parenthesis StartSet omega EndSet right parenthesis With bottom brace Underscript equals sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis Endscripts equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts StartFraction lamda Superscript i Baseline e Superscript negative lamda Baseline Over i factorial EndFraction 2nd Row 1st Column Blank 2nd Column equals 3rd Column e Superscript negative lamda Baseline sigma summation Underscript i equals 1 Overscript normal infinity Endscripts StartFraction lamda Superscript i Baseline Over i factorial EndFraction equals e Superscript negative lamda Baseline left parenthesis e Superscript lamda Baseline minus 1 right parenthesis comma EndLayoutP(∪∞
i=1Ai) =
⎲
ω∈∪iAi
P({ω}) =
∞
⎲
i=1
⎲
ω∈Ai
P({ω})
◟
◝◜
◞
=P(Ai)
=
∞
⎲
i=1
λi e−λ
i!
= e−λ
∞
⎲
i=1
λi
i! = e−λ (eλ −1),
where we used the Taylor series expansion of the exponential function e Superscript lamdaeλ around 
lamda 0 equals 0 commaλ0 = 0, i.e. e Superscript lamda Baseline equals e Superscript lamda 0 Baseline plus StartFraction e Superscript lamda 0 Baseline Over 1 factorial EndFraction left parenthesis lamda minus lamda 0 right parenthesis Superscript 1 Baseline plus StartFraction e Superscript lamda 0 Baseline Over 2 factorial EndFraction left parenthesis lamda minus lamda 0 right parenthesis squared plus midline horizontal ellipsis equals sigma summation Underscript i equals 0 Overscript normal infinity Endscripts StartFraction lamda Superscript i Baseline Over i factorial EndFraction periodeλ = eλ0 + eλ0
1! (λ−λ0)1 + eλ0
2! (λ−λ0)2 +· · · = ∑∞
i=0
λi
i! . For example, 
with lamda equals 2 commaλ = 2, using Excel we compute =EXP(-2)*(EXP(2)-1)=0.864665. 
For the whole upper OmegaΩ we have: 
sans serif upper P left parenthesis StartSet 0 EndSet right parenthesis plus sans serif upper P left parenthesis StartSet 1 EndSet right parenthesis plus sans serif upper P left parenthesis StartSet 2 EndSet right parenthesis plus midline horizontal ellipsis equals sigma summation Underscript i equals 0 Overscript normal infinity Endscripts StartFraction lamda Superscript i Baseline e Superscript negative lamda Baseline Over i factorial EndFraction equals e Superscript negative lamda Baseline e Superscript lamda Baseline equals 1 periodP({0}) + P({1}) + P({2}) + · · · =
∞
⎲
i=0
λi e−λ
i!
= e−λeλ = 1.
We can get a countable sample space in the limit. 
Example 1.23 Assume the sample space consists of n possible sequences of 
upwards and downwards, starting from a given stock price upper S 0 periodS0. Encoding each 
outcome omega element of upper Omegaω ∈Ω as a ﬁnite sequence of symbols u,d we have that StartAbsoluteValue upper Omega EndAbsoluteValue equals 2 Superscript n Baseline colon|Ω| = 2n : we 
allow omegaω being the sequence with all u or all d, otherwise we have different sequences 
containing repeated u and d with alternative order. In fact: each symbol u or d can or 
cannot belong (2 possible choices) to the sequence encoding a ﬁxed omegaω and we have 
a total of 2 times 2 times midline horizontal ellipsis times 2 equals 2 Superscript n2 × 2 × · · · × 2 = 2n elements. 
Example 1.24 Now we assign a probability weight sans serif upper P left parenthesis StartSet omega EndSet right parenthesis equals StartFraction 1 Over 2 Superscript n Baseline EndFractionP({ω}) =
1
2n to each simple 
event StartSet omega EndSet{ω} and get the usual discrete uniform probability space. But things go 
wrong when the number of possible upwards and downwards becomes larger: 
limit Underscript n right arrow normal infinity Endscripts StartFraction 1 Over 2 Superscript n Baseline EndFraction equals 0 periodlimn→∞1
2n
= 0. Hence, each simple event has a probability zero as well as 
every other event upper A commaA, which is obviously made of pairwise disjoint unions of some 
singletons StartSet omega EndSet period{ω}. Conclusion: all events A from the corresponding sigma hyphen algebraσ-algebra have 
sans serif upper P left parenthesis upper A right parenthesis equals 0 periodP(A) = 0. Also for the certain event sans serif upper P left parenthesis upper Omega right parenthesis equals 0 commaP(Ω) = 0, since we can choose a ﬁnite or 
countable sequence left parenthesis upper A Subscript i Baseline right parenthesis Subscript i element of double struck upper N Baseline subset of script upper F(Ai)i∈N ⊂F of pairwise disjoint events s.t. their union is equal 
to the whole sample space, upper Omega equals union Subscript i Baseline upper A Subscript i Baseline periodΩ = ∪iAi. Therefore, sans serif upper P left parenthesis upper Omega right parenthesis equals sans serif upper P left parenthesis union Subscript i Baseline upper A Subscript i Baseline right parenthesisP(Ω) = P(∪iAi) and using 
axiom PA2 we have sans serif upper P left parenthesis union Subscript i Baseline upper A Subscript i Baseline right parenthesis equals sigma summation Underscript i Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis equals 0 periodP(∪iAi) = ∑
i P(Ai) = 0.
15 The probability of the event StartSet an odd number of jumps EndSet period{an odd number of jumps}.
Appendix
23
Example 1.25 When inﬁnite repetitions16 of the random experiment giving two 
possibilities (as u or d) are allowed, attaching a probability weight to singletons 
StartSet omega EndSet{ω} leads to some inconsistencies. A possible remedy is the following. Replace the 
encoding u or d with 1 or 0, so each outcome omegaω is made of an inﬁnite sequence 
of ones and zeros. This corresponds to the binary expansion of any real number 
contained in the unit interval left bracket 0 comma 1 right parenthesis[0, 1): 
upper Omega equals left brace omega vertical bar omega equals a 1 a 2 midline horizontal ellipsis comma where a Subscript i Baseline equals 0 or a Subscript i Baseline equals 1 right brace periodΩ = {ω | ω = a1a2 · · · , where ai = 0 or ai = 1}.
Since it is well known that x element of left bracket 0 comma 1 right parenthesisx ∈[0, 1) may be written 0 period a 1 a 2 ellipsis0.a1a2 . . . we have a 1-to-1 
correspondence between the elements omega element of upper Omegaω ∈Ω and the numbers x element of left bracket 0 comma 1 right parenthesis periodx ∈[0, 1). After we 
identify upper OmegaΩ with the right-open unit interval, a reasonable probability measure obeys 
to the formula 
sans serif upper P left parenthesis upper A right parenthesis equals length of upper A comma where upper A equals left bracket a comma b right bracket or left bracket a comma b right parenthesis or left parenthesis a comma b right bracket or left parenthesis a comma b right parenthesis commaP(A) = length of A,
where A = [a, b] or [a, b) or (a, b] or (a, b),
and the sigma hyphen algebraσ-algebra is obtained by union, intersections and complements of intervals 
with ﬁnite endpoints. This is called continuous uniform probability space. 
As we have seen in Sect. 1.4, discrete probability measure are adequate to model 
random experiments with at most countably inﬁnite outcomes but cannot be 
extended to events larger than a countable sample space keeping as building blocks 
probability weights. To get further a ﬂavor of how a remedy is possible, observe 
that for countable upper OmegaΩ there is a 1-to-1 correspondence with double struck upper NN, thus we can turn 
the probability space to left parenthesis double struck upper N comma 2 Superscript double struck upper N Baseline comma sans serif upper P right parenthesis(N, 2N, P), and replace sans serif upper P left parenthesis StartSet omega Subscript i Baseline EndSet right parenthesisP({ωi}) with p Subscript i Baseline colon equals p left parenthesis i right parenthesispi := p(i) s.t. as 
usual sigma summation Underscript i equals 1 Overscript normal infinity Endscripts p left parenthesis i right parenthesis equals 1∑∞
i=1 p(i) = 1. When the sample space is uncountably inﬁnite, there is a 
1-to-1 correspondence with the open unit interval left parenthesis 0 comma 1 right parenthesis(0, 1) and then with the closed 
unit interval left bracket 0 comma 1 right bracket[0, 1] or the whole double struck upper RR.17 Therefore, we may turn to left parenthesis double struck upper R comma script upper F comma sans serif upper P right parenthesis(R, F, P) and try 
to deﬁne the probability measure as sans serif upper P left parenthesis left bracket a comma b right bracket right parenthesis equals integral Subscript a Superscript b Baseline p left parenthesis x right parenthesis normal d xP([a, b]) =
⎰b
a p(x)dx for some nonnegative 
(Riemann) integrable function p colon double struck upper R right arrow double struck upper Rp : R →R s.t. integral Subscript negative normal infinity Superscript normal infinity Baseline p left parenthesis x right parenthesis normal d x equals 1
⎰∞
−∞p(x)dx = 1, and reals a less than ba < b. 
Observe that script upper FF must be generated by a proper collection of subsets in double struck upper RR, see  
Appendix in Chap. 2, while the family of ﬁnite intervals is not a sigma hyphen algebra periodσ-algebra.
Example 1.26 We want to model the future stock price upper S Subscript tSt as a rv taking uncount-
ably inﬁnite values on a closed interval left bracket upper S Subscript min Baseline comma upper S Subscript max Baseline right bracket[Smin, Smax], where upper S Subscript minSmin is the minimum 
quoted price in t and upper S Subscript maxSmax is the maximum future price. We can no longer use a 
discrete probability to compute the likelihood of events involving such upper S Subscript tSt. In fact, 
now upper OmegaΩ can be identiﬁed with the above interval and it can be shown sans serif upper P left parenthesis upper S Subscript t Baseline equals a right parenthesis equals sans serif upper P left parenthesis a right parenthesis equals 0P(St = a) =
P(a) = 0 for every a element of left bracket upper S Subscript min Baseline comma upper S Subscript max Baseline right bracketa ∈[Smin, Smax]. Compare this with results from Sects. 2.1, 2.2 
and 2.3.
16 We have to explicitly mention the auxiliary hypotheses that repetitions are independent. But the  
meaning of this will be clear later, so we tacitly assume it, see Sect. 5.4 in Chap. 5. 
17 This is a well known fact from real analysis. 
24
1
Probability, Events and Random Variables
Additional Properties of a Probability Measure 
The Boole’s Inequality is another fundamental property of a probability measure. 
Lemma 1.2 (Subadditivity) Let 
left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P)
be 
a 
probability 
space. 
Then 
sans serif upper P left parenthesis union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i Baseline right parenthesis less than or slanted equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis commaP(∪∞
i=1Ai) ⩽∑∞
i=1 P(Ai), for any sequence of events left parenthesis upper A Subscript i Baseline right parenthesis Subscript i element of double struck upper N Baseline subset of script upper F(Ai)i∈N ⊂F not necessarily 
pairwise disjoint. 
Remark 1.5 (Arbitrary Events vs Pairwise Disjoint Ones) Let left parenthesis upper A Subscript i Baseline right parenthesis Subscript i element of double struck upper N(Ai)i∈N be any 
sequence of events in a sigma hyphen algebra periodσ-algebra. We don’t know if the upper A Subscript iAi’s are pairwise disjoint. 
From this we can build a new sequence of mutually disjoint events simply by letting 
upper B 1 equals upper A 1B1 = A1 and upper B Subscript n Baseline equals upper A Subscript n Baseline minus left parenthesis union Subscript i equals 1 Superscript n minus 1 Baseline upper A Subscript i Baseline right parenthesis commaBn = An \
(
∪n−1
i=1 Ai
)
, for every n element of double struck upper N periodn ∈N. Indeed, upper B 2 equals upper A 2 minus upper A 1 commaB2 = A2 \ A1,
upper B 3 equals upper A 3 minus left parenthesis upper A 2 union upper A 1 right parenthesisB3 = A3 \ (A2 ∪A1) and so on. Clearly, any partial union belongs to script upper FF and so any 
set difference. We have union Subscript i equals 1 Superscript normal infinity Baseline upper B Subscript i Baseline equals union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i Baseline period∪∞
i=1Bi = ∪∞
i=1Ai.
Proof Deﬁne the sequence left parenthesis upper B Subscript i Baseline right parenthesis Subscript i element of double struck upper N(Bi)i∈N as in the above remark. For every n element of double struck upper Nn ∈N we 
have upper B Subscript n Baseline subset of upper A Subscript nBn ⊂An and upper B Subscript n Baseline element of script upper FBn ∈F as upper A Subscript n Baseline minus left parenthesis union Subscript i equals 1 Superscript n minus 1 Baseline upper A Subscript i Baseline right parenthesis equals upper A Subscript n Baseline intersection left parenthesis union Subscript i equals 1 Superscript n minus 1 Baseline upper A Subscript i Baseline right parenthesis Superscript cAn \
⎛
∪n−1
i=1 Ai
⎞
= An ∩
⎛
∪n−1
i=1 Ai
⎞c
and script upper FF is a 
sigma hyphen algebra periodσ-algebra. This implies sans serif upper P left parenthesis upper B Subscript n Baseline right parenthesis less than or slanted equals sans serif upper P left parenthesis upper A Subscript n Baseline right parenthesisP(Bn) ⩽P(An) and since union Subscript i equals 1 Superscript normal infinity Baseline upper B Subscript i Baseline equals union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i∪∞
i=1Bi = ∪∞
i=1Ai we have 
sans serif upper P left parenthesis union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i Baseline right parenthesis equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts sans serif upper P left parenthesis upper B Subscript i Baseline right parenthesis less than or slanted equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis commaP(∪∞
i=1Ai) = ∑∞
i=1 P(Bi) ⩽∑∞
i=1 P(Ai), for the events upper B Subscript iBi are pairwise disjoint. 
█
We can generalize Property Pr4, Proposition 1.1 of a probability measure. Pick a 
sequence of events upper A 1 comma ellipsis comma upper A Subscript n Baseline element of script upper FA1, . . . , An ∈F, then it is easy to prove the following union-
intersection formula: 
sans serif upper P left parenthesis upper A 1 union midline horizontal ellipsis union upper A Subscript n Baseline right parenthesis equals sigma summation Underscript k equals 1 Overscript n Endscripts left parenthesis negative 1 right parenthesis Superscript k minus 1 Baseline sigma summation Underscript StartSet i 1 comma ellipsis comma i Subscript k Baseline EndSet subset of StartSet 1 comma ellipsis comma n EndSet Endscripts sans serif upper P left parenthesis upper A Subscript i 1 Baseline intersection midline horizontal ellipsis intersection upper A Subscript i Sub Subscript k Subscript Baseline right parenthesisP(A1 ∪· · · ∪An) =
n
⎲
k=1
(−1)k−1
⎲
{i1,...,ik}⊂{1,...,n}
P(Ai1 ∩· · · ∩Aik)
(1.3) 
where the inner sum ranges over all subsets of k less than or slanted equals nk ⩽n indices in StartSet 1 comma ellipsis comma n EndSet period{1, . . . , n}. Indeed, 
formula (1.3) is equal to the inclusion-exclusion formula: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis union Subscript i equals 1 Superscript n Baseline upper A Subscript i Baseline right parenthesis 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript n Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis minus sigma summation Underscript i less than j less than or slanted equals n Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline intersection upper A Subscript j Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column plus 3rd Column sigma summation Underscript i less than j less than k less than or slanted equals n Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline intersection upper A Subscript j Baseline intersection upper A Subscript k Baseline right parenthesis plus midline horizontal ellipsis plus left parenthesis negative 1 right parenthesis Superscript n plus 1 Baseline sans serif upper P left parenthesis intersection Subscript i equals 1 Superscript n Baseline upper A Subscript i Baseline right parenthesis period EndLayoutP(∪n
i=1Ai) =
n
⎲
i=1
P(Ai) −
⎲
i<j⩽n
P(Ai ∩Aj)
(1.4)
+
⎲
i<j<k⩽n
P(Ai ∩Aj ∩Ak) + · · · + (−1)n+1P(∩n
i=1Ai).
For n equals 2n = 2 formula (1.4) holds by Pr4 of Proposition 1.1. To further illustrate the 
issue we also have:  
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper A 1 union upper A 2 union upper A 3 right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis upper A 1 right parenthesis plus sans serif upper P left parenthesis upper A 2 right parenthesis plus sans serif upper P left parenthesis upper A 3 right parenthesis 2nd Row 1st Column Blank 2nd Column minus 3rd Column sans serif upper P left parenthesis upper A 1 intersection upper A 2 right parenthesis minus sans serif upper P left parenthesis upper A 1 intersection upper A 3 right parenthesis minus sans serif upper P left parenthesis upper A 2 intersection upper A 3 right parenthesis 3rd Row 1st Column Blank 2nd Column plus 3rd Column sans serif upper P left parenthesis upper A 1 intersection upper A 2 intersection upper A 3 right parenthesis period EndLayoutP(A1 ∪A2 ∪A3) = P(A1) + P(A2) + P(A3)
−P(A1 ∩A2) −P(A1 ∩A3) −P(A2 ∩A3)
+ P(A1 ∩A2 ∩A3).
Appendix
25
The ﬁrst sum on the right entails the area in upper A 1 intersection upper A 2 intersection upper A 3 periodA1 ∩A2 ∩A3. To avoid repetitions 
we should subtract the area in upper A 1 intersection upper A 2 comma upper A 1 intersection upper A 3A1 ∩A2, A1 ∩A3 and upper A 2 intersection upper A 3 periodA2 ∩A3. We add the area in 
upper A 1 intersection upper A 2 intersection upper A 3 commaA1 ∩A2 ∩A3, since we have subtracted area left parenthesis upper A 1 right parenthesis comma area left parenthesis upper A 2 right parenthesisarea(A1), area(A2) and area left parenthesis upper A 3 right parenthesisarea(A3) twice. 
Now write sans serif upper P left parenthesis union Subscript i equals 1 Superscript n plus 1 Baseline upper A Subscript i Baseline right parenthesis equals sans serif upper P left parenthesis union Subscript i equals 1 Superscript n Baseline upper A Subscript i Baseline union upper A Subscript n plus 1 Baseline right parenthesisP(∪n+1
i=1 Ai) = P
(
∪n
i=1Ai ∪An+1
)
as equals sans serif upper P left parenthesis union Subscript i equals 1 Superscript n Baseline upper A Subscript i Baseline right parenthesis plus sans serif upper P left parenthesis upper A Subscript n plus 1 Baseline right parenthesis minus sans serif upper P left parenthesis left parenthesis union Subscript i equals 1 Superscript n Baseline upper A Subscript i Baseline right parenthesis intersection upper A Subscript n plus 1 Baseline right parenthesis comma= P(∪n
i=1Ai) + P(An+1) −
P
(
(∪n
i=1Ai) ∩An+1
)
, by Pr4 applied to the events union Subscript i equals 1 Superscript n Baseline upper A Subscript i∪n
i=1Ai and upper A Subscript n plus 1 Baseline periodAn+1. Trick: we  
prove inclusion-exclusion formula for n plus 1 periodn + 1. By induction, the formula holds for n periodn.
Again by induction, we also have 
StartLayout 1st Row 1st Column Blank 2nd Column Blank 3rd Column sans serif upper P left parenthesis left parenthesis union Subscript i equals 1 Superscript n Baseline upper A Subscript i Baseline right parenthesis intersection upper A Subscript n plus 1 Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column StartLayout 1st Row distrib period of union and intersection 2nd Row equals EndLayout 3rd Column sans serif upper P left parenthesis union Subscript i equals 1 Superscript n Baseline left parenthesis upper A Subscript i Baseline intersection upper A Subscript n plus 1 Baseline right parenthesis right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript n Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline intersection upper A Subscript n plus 1 Baseline right parenthesis minus sigma summation Underscript i less than j less than or slanted equals n Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline intersection upper A Subscript j Baseline intersection upper A Subscript n plus 1 Baseline right parenthesis plus midline horizontal ellipsis 4th Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript i less than j equals n plus 1 Overscript n Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline intersection upper A Subscript j Baseline right parenthesis minus sigma summation Underscript i less than j less than k equals n plus 1 Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline intersection upper A Subscript j Baseline intersection upper A Subscript k Baseline right parenthesis plus midline horizontal ellipsis EndLayout
P
(
(∪n
i=1Ai) ∩An+1
)
distrib. of ∪and ∩
=
P
(
∪n
i=1(Ai ∩An+1)
)
=
n
⎲
i=1
P(Ai ∩An+1) −
⎲
i<j⩽n
P(Ai ∩Aj ∩An+1) + · · ·
=
n
⎲
i<j=n+1
P(Ai ∩Aj) −
⎲
i<j<k=n+1
P(Ai ∩Aj ∩Ak) + · · ·
Inserting Eq. (1.4), given by the ﬁrst induction hypotheses, and the equation above 
into the expression of sans serif upper P left parenthesis union Subscript i equals 1 Superscript n plus 1 Baseline upper A Subscript i Baseline right parenthesisP(∪n+1
i=1 Ai) we have done. 
Continuity of P 
Proof of Theorem 1.1 Let A1 ⊂ A2 ⊂ · · ·  . . .  be increasing events from F s.t. 
A := ∪∞
i=1Ai. We can ﬁnd a new sequence of pairwise disjoint events B1, B2, . . .  
such that ∪∞
j=1Bj = ∪∞
i=1Ai = A. Furthermore, by countable additivity 
sans serif upper P left parenthesis upper A right parenthesis equals sans serif upper P left parenthesis union Subscript j equals 1 Superscript normal infinity Baseline upper B Subscript j Baseline right parenthesis equals sigma summation Underscript j equals 1 Overscript normal infinity Endscripts sans serif upper P left parenthesis upper B Subscript j Baseline right parenthesis equals limit Underscript i right arrow normal infinity Endscripts sigma summation Underscript j equals 1 Overscript i Endscripts sans serif upper P left parenthesis upper B Subscript j Baseline right parenthesis periodP(A) = P(∪∞
j=1Bj) =
∞
⎲
j=1
P(Bj) = lim
i→∞
i
⎲
j=1
P(Bj).
The deﬁnition of (Bj)j∈N entails ∑i 
j=1 P(Bj) = P(∪i 
j=1Bj) = P(Ai), then 
limi→∞ P(Ai) = P(A) and the proof is complete. If we handle a decreasing 
sequence of events A1 ⊃ A2 ⊃ · · ·  from F s.t. A := ∩∞
i=1Ai, then it sufﬁces 
to note that Ac 
1 ⊂ Ac 
2 ⊂ · · ·  , with Ac = ∪∞
i=1Ac 
i and moreover by Pr1 it holds 
P(Ac 
i ) = 1 −P(Ai). Hence we have that limi→∞ P(Ac 
i ) = 1 − limi→∞ P(Ai) is 
equivalent to 
StartLayout 1st Row 1st Column limit Underscript i right arrow normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis 2nd Column equals 3rd Column 1 minus limit Underscript i right arrow normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript i Superscript c Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column StartLayout 1st Row cont period of sans serif upper P for incr period seq period 2nd Row equals EndLayout 3rd Column 1 minus sans serif upper P left parenthesis upper A Superscript c Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper A right parenthesis period EndLayout lim
i→∞P(Ai)
=
1 −lim
i→∞P(Ac
i )
cont. of P for incr. seq.
=
1 −P(Ac)
=
P(A).
█
Chapter 2 
Distribution of Random Variables 
2.1 
Distribution Function 
In predicting the possible values of a rv X, given a probability space left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P), 
neither upper OmegaΩ nor X are given explicitly, instead we need to know sans serif upper P left parenthesis upper X element of upper B right parenthesisP(X ∈B) for suitable 
subsets upper B subset of double struck upper R commaB ⊂R, called the probability law of X, or simply the law, also written 
sans serif upper P Subscript upper X Baseline left parenthesis upper B right parenthesisPX(B), and the choice upper B equals left parenthesis negative normal infinity comma x right bracketB = (−∞, x] sufﬁces1 to compute it. 
Deﬁnition 2.1 The cumulative distribution function (CDF) of a rv X is deﬁned as 
upper F Subscript upper X Baseline left parenthesis x right parenthesis colon equals sans serif upper P left parenthesis upper X less than or slanted equals x right parenthesis commaFX(x) := P(X ⩽x),
(2.1) 
for any negative normal infinity less than x less than normal infinity−∞< x < ∞. 
For every real number x element of double struck upper R commax ∈R, formula (2.1) entails a numerical function upper F Subscript upper X Baseline colon double struck upper R right arrow left bracket 0 comma 1 right bracketFX : R →
[0, 1]. Any CDF has some typical features whatever the corresponding rv X is. In 
fact, there is a 1-to-1 correspondence between sans serif upper PP and upper F Subscript upper XFX: 
Theorem 2.1 Let sans serif upper PP be a probability measure over left parenthesis upper Omega comma script upper F right parenthesis(Ω, F ) and let upper F Subscript upper X Baseline colon double struck upper R right arrow left bracket 0 comma 1 right bracketFX : R →[0, 1]
be a function given by formula (2.1). Then we have: 
(a) 
. FX is nondecreasing, x 1 less than x 2x1 < x2 implies upper F Subscript upper X Baseline left parenthesis x 1 right parenthesis less than or slanted equals upper F Subscript upper X Baseline left parenthesis x 2 right parenthesisFX(x1) ⩽FX(x2); 
(b) 
. FX is right-continuous, upper F Subscript upper X Baseline left parenthesis x right parenthesis equals upper F Subscript upper X Baseline left parenthesis x Superscript plus Baseline right parenthesis colon equals limit Underscript h down arrow 0 Endscripts upper F Subscript upper X Baseline left parenthesis x plus h right parenthesisFX(x) = FX(x+) := lim
h↓0 FX(x + h); 
(c) 
. lim
x→∞FX(x) := upper F Subscript upper X Baseline left parenthesis normal infinity right parenthesis equals 1FX(∞) = 1 and limit Underscript x right arrow negative normal infinity Endscripts upper F Subscript upper X Baseline left parenthesis x right parenthesis colon equals lim
x→−∞FX(x) := upper F Subscript upper X Baseline left parenthesis negative normal infinity right parenthesis equals 0FX(−∞) = 0; 
(d) 
.P(a < X ⩽b) = upper F Subscript upper X Baseline left parenthesis b right parenthesis minus upper F Subscript upper X Baseline left parenthesis a right parenthesisFX(b) −FX(a) for a less than ba < b, with ﬁnite b element of double struck upper Rb ∈R and a greater than or slanted equals negative normal infinitya ⩾−∞. 
1 Other suitable upper B subset of double struck upper RB ⊂R can be deduced from left parenthesis negative normal infinity comma x right bracket(−∞, x] using unions, intersections and comple-
ments. The same construction can be repeated with ﬁnite intervals, see Appendix. 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4_2
27
28
2
Distribution of Random Variables
Conversely, if a function upper F Subscript upper X Baseline colon double struck upper R right arrow left bracket 0 comma 1 right bracketFX : R →[0, 1] satisﬁes properties (a)–(c) then there 
exists a probability sans serif upper PP over some event space left parenthesis upper Omega comma script upper F right parenthesis(Ω, F) s.t. upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x) is the CDF of a rv 
X, according to Deﬁnition 2.1, with law sans serif upper P Subscript upper X Baseline left parenthesis upper B right parenthesis equals sans serif upper P left parenthesis upper X element of upper B right parenthesisPX(B) = P(X ∈B) for suitable upper B subset of double struck upper RB ⊂R. 
Remark 2.1 (One-Sided Limits) Recall the following characterization of a limit 
for a real-valued function given h greater than 0 colonh > 0 :
• 
right limit, upper F left parenthesis x Superscript plus Baseline right parenthesis equals limit Underscript h down arrow 0 Endscripts upper F left parenthesis x plus h right parenthesis semicolonF(x+) = lim
h↓0 F(x + h);
• 
left limit, upper F left parenthesis x Superscript minus Baseline right parenthesis equals limit Underscript h down arrow 0 Endscripts upper F left parenthesis x minus h right parenthesis periodF(x−) = lim
h↓0 F(x −h).
Notation h down arrow 0h ↓0 means that h approaches zero by decreasing values, also written 
h right arrow 0 Superscript plush →0+. In the current context upper F identical to upper F Subscript upper XF ≡FX. 
Remark 2.2 (Sequential Characterization) A real-valued function is continuous 
at a point x 0x0 in its domain, written limit Underscript x right arrow x 0 Endscripts upper F left parenthesis x right parenthesis equals upper F left parenthesis x 0 right parenthesislimx→x0 F(x) = F(x0) iff there exists a sequence 
of points x 1 comma x 2 comma ellipsisx1, x2, . . . in its domain such that x Subscript i Baseline not equals x 0xi /= x0 and which converges to x 0x0, 
written limit Underscript i right arrow normal infinity Endscripts x Subscript i Baseline equals x 0limi→∞xi = x0, so we have  upper F left parenthesis x Subscript i Baseline right parenthesis right arrow upper F left parenthesis x 0 right parenthesisF(xi) →F(x0) whenever i right arrow normal infinity periodi →∞. In words 
for values x Subscript ixi close to x 0x0 one has upper F left parenthesis x Subscript i Baseline right parenthesisF(xi) staying close to upper F left parenthesis x 0 right parenthesisF(x0). Therefore, we have: 
• 
.F(x+) is limit Underscript i right arrow normal infinity Endscripts upper F left parenthesis x Subscript i Baseline right parenthesis equals upper F left parenthesis x right parenthesis lim
i→∞F(xi) = F(x) for any decreasing sequence x 1 greater than or slanted equals x 2 greater than or slanted equals midline horizontal ellipsisx1 ⩾x2 ⩾· · · with 
limit x commax, written x Subscript i Baseline down arrow x semicolonxi ↓x;
• 
.F(x−) is limit Underscript i right arrow normal infinity Endscripts upper F left parenthesis x Subscript i Baseline right parenthesis equals upper F left parenthesis x right parenthesis lim
i→∞F(xi) = F(x) for any increasing sequence x 1 less than or slanted equals x 2 less than or slanted equals midline horizontal ellipsisx1 ⩽x2 ⩽· · · with 
limit x commax, written x Subscript i Baseline up arrow x periodxi ↑x.
By Remarks 2.1 and 2.2 one-sided limits of a CDF can be given equivalently in 
sequential form, which is useful in proving probabilities as listed in Table 2.1. Right-
continuity of the CDF stated in item (b) of Theorem 2.1 reads upper F Subscript upper X Baseline left parenthesis x right parenthesis equals upper F Subscript upper X Baseline left parenthesis x Superscript plus Baseline right parenthesisFX(x) = FX(x+). 
Observe that upper F Subscript upper X Baseline left parenthesis x Superscript minus Baseline right parenthesis less than or slanted equals upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x−) ⩽FX(x) since the CDF is nondecreasing, i.e. it is a monotone 
Table 2.1 Computing probabilities via upper F Subscript upper XFX
#
upper B subset of double struck upper RB ⊂R
Event
sans serif upper P left parenthesis upper X element of upper B right parenthesisP(X ∈B)
1
left parenthesis negative normal infinity comma a right bracket(−∞, a]
left brace upper X less than or slanted equals a right brace{X ⩽a}
sans serif upper P left parenthesis upper X less than or slanted equals a right parenthesis equals upper F Subscript upper X Baseline left parenthesis a right parenthesisP(X ⩽a) = FX(a)
2
left parenthesis negative normal infinity comma a right parenthesis(−∞, a)
left brace upper X less than a right brace{X < a}
sans serif upper P left parenthesis upper X less than a right parenthesis equals upper F Subscript upper X Baseline left parenthesis a Superscript minus Baseline right parenthesisP(X < a) = FX(a−)
3
left parenthesis a comma b right bracket(a, b]
left brace a less than upper X less than or slanted equals b right brace{a < X ⩽b}
sans serif upper P left parenthesis a less than upper X less than or slanted equals b right parenthesis equals upper F Subscript upper X Baseline left parenthesis b right parenthesis minus upper F Subscript upper X Baseline left parenthesis a right parenthesisP(a < X ⩽b) = FX(b) −FX(a)
4
left bracket a comma b right bracket[a, b]
left brace a less than or slanted equals upper X less than or slanted equals b right brace{a ⩽X ⩽b}
sans serif upper P left parenthesis a less than or slanted equals upper X less than or slanted equals b right parenthesis equals upper F Subscript upper X Baseline left parenthesis b right parenthesis minus upper F Subscript upper X Baseline left parenthesis a Superscript minus Baseline right parenthesisP(a ⩽X ⩽b) = FX(b) −FX(a−)
5
StartSet a EndSet{a}
left brace upper X equals a right brace{X = a}
sans serif upper P left parenthesis upper X equals a right parenthesis equals upper F Subscript upper X Baseline left parenthesis a right parenthesis minus upper F Subscript upper X Baseline left parenthesis a Superscript minus Baseline right parenthesisP(X = a) = FX(a) −FX(a−)
6
left parenthesis b comma normal infinity right parenthesis(b, ∞)
left brace upper X greater than b right brace{X > b}
sans serif upper P left parenthesis upper X greater than b right parenthesis equals 1 minus upper F Subscript upper X Baseline left parenthesis b right parenthesisP(X > b) = 1 −FX(b)
7
left bracket b comma normal infinity right parenthesis[b, ∞)
left brace upper X greater than or slanted equals b right brace{X ⩾b}
sans serif upper P left parenthesis upper X greater than or slanted equals b right parenthesis equals 1 minus upper F Subscript upper X Baseline left parenthesis b Superscript minus Baseline right parenthesisP(X ⩾b) = 1 −FX(b−)
8
left bracket a comma b right parenthesis[a, b)
left brace a less than or slanted equals upper X less than b right brace{a ⩽X < b}
sans serif upper P left parenthesis a less than or slanted equals upper X less than b right parenthesis equals upper F Subscript upper X Baseline left parenthesis b Superscript minus Baseline right parenthesis minus upper F Subscript upper X Baseline left parenthesis a Superscript minus Baseline right parenthesisP(a ⩽X < b) = FX(b−) −FX(a−)
9
left parenthesis a comma b right parenthesis(a, b)
left brace a less than upper X less than b right brace{a < X < b}
sans serif upper P left parenthesis a less than upper X less than b right parenthesis equals upper F Subscript upper X Baseline left parenthesis b Superscript minus Baseline right parenthesis minus upper F Subscript upper X Baseline left parenthesis a right parenthesisP(a < X < b) = FX(b−) −FX(a)
2.2
Discrete Random Variables
29
real-valued function and then both one-sided limits exist and are ﬁnite.2 In Appendix 
we give a formal derivation of probabilities in the third column of Table 2.1. 
2.2 
Discrete Random Variables 
As we have seen in Chap. 1, for some random experiment is more appropriate to 
compute discrete probabilities over ﬁnite or countable sample spaces. For general 
upper OmegaΩ the same applies as well when numerical evaluation of scenarios omega element of upper Omegaω ∈Ω results in 
a ﬁnite or countable list of numbers. It should be clear that the law sans serif upper P Subscript upper XPX together 
with upper F Subscript upper XFX are the only responsible for the behavior of a rv X, not its analytical 
construction.3 
Deﬁnition 2.2 A rv  X is called discrete if its image upper X left parenthesis upper Omega right parenthesis equals StartSet x element of double struck upper R vertical bar there exists omega element of upper Omega s period t period upper X left parenthesis omega right parenthesis equals x EndSetX(Ω) = {x ∈R | ∃ω ∈
Ω s.t. X(ω) = x} is a set C either ﬁnite, StartSet x 1 comma ellipsis comma x Subscript n Baseline EndSet{x1, . . . , xn}, or countable, StartSet x 1 comma x 2 comma ellipsis EndSet{x1, x2, . . .}. 
The CDF of a discrete rv is a piecewise constant function or step function with jump 
discontinuities at the values x 1 comma x 2 comma ellipsisx1, x2, . . ., and is constant in between: 
• 
.FX(x) = yi−1 for x element of left bracket x Subscript i minus 1 Baseline comma x Subscript i Baseline right parenthesis x ∈[xi−1, xi) and i equals 2 comma 3 comma ellipsisi = 2, 3, . . .; obviously y Subscript i minus 1 Baseline element of left parenthesis 0 comma 1 right bracketyi−1 ∈(0, 1]; 
• 
on left parenthesis negative normal infinity comma x 1 right parenthesis(−∞, x1) it is limit Underscript x right arrow negative normal infinity Endscripts upper F Subscript upper X Baseline left parenthesis x right parenthesis equals 0 commalimx→−∞FX(x) = 0, and upper F Subscript upper X Baseline left parenthesis x Subscript n Baseline right parenthesis equals 1FX(xn) = 1 or more generally 
limit Underscript i right arrow normal infinity Endscripts upper F left parenthesis x Subscript i Baseline right parenthesis equals 1limi→∞F(xi) = 1 as x Subscript i Baseline right arrow normal infinityxi →∞. 
The situation described in Deﬁnition 2.2 has been already analyzed in Sect. 1.4 and 
Appendix in Chap. 1. Now, identifying sans serif upper PP with sans serif upper P Subscript upper XPX we can safely handle as a ‘sample 
space’ the whole double struck upper RR and ﬁnd an at most countable subset C s.t. sans serif upper P Subscript upper X Baseline left parenthesis upper C right parenthesis equals sans serif upper P left parenthesis upper X element of upper C right parenthesis equals 1PX(C) = P(X ∈
C) = 1 and sans serif upper P Subscript upper X Baseline left parenthesis upper C Superscript c Baseline right parenthesis equals 0PX(Cc) = 0. This would implies upper X colon upper Omega right arrow upper CX : Ω →C, i.e. the rv attains at most 
countable many values. The above deﬁnition has some consequences. 
• 
Whatever the sample space upper OmegaΩ is, for a discrete rv the events left brace upper X equals x Subscript i Baseline right brace{X = xi} form a 
partition: they are pairwise disjoint and their (ﬁnite or countable) union is just upper OmegaΩ. 
• 
Each probability sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesisP(X = xi) is called a mass for i equals 1 comma 2 comma ellipsisi = 1, 2, . . .; actually sans serif upper P left parenthesis upper X equals x right parenthesisP(X = x)
is a probability mass function of the values x element of double struck upper Rx ∈R. 
• 
The masses are concentrated at x 1 comma x 2 comma ellipsisx1, x2, . . ., while their value is zero otherwise, 
i.e. sans serif upper P left parenthesis upper X equals x right parenthesis equals 0P(X = x) = 0 for x not equals x Subscript ix /= xi. 
• 
We must have sigma summation Underscript i Endscripts sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis equals 1∑
i P(X = xi) = 1. 
• 
The set C is also where upper F Subscript upper XFX is strictly increasing, sometimes called the support 
of X and written script upper XX in some textbooks. 
• 
The value of 
upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x) for any 
x element of double struck upper Rx
∈
R is computed summing the masses: 
sans serif upper P left parenthesis upper X less than or slanted equals x right parenthesis equals upper F Subscript upper X Baseline left parenthesis x right parenthesis equals sigma summation Underscript i s period t period x Subscript i Baseline less than or slanted equals x Endscripts sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesisP(X ⩽x) = FX(x) = ∑
i s.t. xi ⩽x P(X = xi).
2 In the proof of item (b) in Theorem 2.1 the right-continuity limit Underscript i right arrow normal infinity Endscripts upper F Subscript upper X Baseline left parenthesis x plus StartFraction 1 Over i EndFraction right parenthesis equals upper F Subscript upper X Baseline left parenthesis x right parenthesislimi→∞FX(x + 1
i ) = FX(x) is 
understood in the sequential form, with x Subscript i Baseline equals x plus StartFraction 1 Over i EndFractionxi = x + 1
i being a decreasing sequence converging to x 
as i element of double struck upper Ni ∈N becomes larger. On the other hand, it is equivalent to have upper F Subscript upper X Baseline left parenthesis x Superscript plus Baseline right parenthesis equals limit Underscript h down arrow 0 Endscripts upper F Subscript upper X Baseline left parenthesis x plus h right parenthesisFX(x+) = limh↓0 FX(x + h). 
3 In fact two rvs deﬁned over the same probability space, are regarded as equal iff their laws are 
equal, see Sect. 2.6. 
30
2
Distribution of Random Variables
• 
.P(X = xi) = FX(xi) −FX(x−
i ) > 0, where the left limit upper F Subscript upper X Baseline left parenthesis x Subscript i Superscript minus Baseline right parenthesisFX(x−
i ) is equal to the 
value that upper F Subscript upper XFX assumes at the leftmost point x Subscript i minus 1xi−1 for i equals 2 comma 3 comma ellipsisi = 2, 3, . . .
Remark 2.3 We will see in Sect. 2.3 how for some rvs we may deﬁne the support 
as the set of points x element of double struck upper Rx ∈R s.t. sans serif upper P left parenthesis x minus epsilon less than upper X less than x plus epsilon right parenthesis greater than 0P(x −ϵ < X < x + ϵ) > 0 for every epsilon greater than 0ϵ > 0. 
Example 2.1 Let a function upper F colon double struck upper R right arrow left bracket 0 comma 1 right bracketF : R →[0, 1] be deﬁned as: 
upper F left parenthesis x right parenthesis colon equals StartLayout Enlarged left brace 1st Row 1st Column 0 comma 2nd Column if x less than negative 1 2nd Row 1st Column one half comma 2nd Column if negative 1 less than or slanted equals x less than 1 3rd Row 1st Column 1 comma 2nd Column if x greater than or slanted equals 1 period EndLayoutF(x) :=
⎧
⎨
⎩
0, if x < −1
1
2, if −1 ⩽x < 1
1, if x ⩾1.
It can be showed that F is a CDF and then satisﬁes properties (a)–(d) of Theo-
rem 2.1. 
Indeed, Example 2.1 provides us with an useful exercise in proving upper F identical to upper F Subscript upper XF ≡FX for 
some discrete rv X. We verify: 
• 
F is nondecreasing, indeed it is piecewise constant with values upper F left parenthesis x right parenthesis equals 0F(x) = 0 if 
x element of left parenthesis negative normal infinity comma negative 1 right parenthesis commax ∈(−∞, −1), upper F left parenthesis x right parenthesis equals one halfF(x) = 1
2 if x element of left bracket negative 1 comma 1 right parenthesisx ∈[−1, 1) and upper F left parenthesis x right parenthesis equals 1F(x) = 1 if x element of left bracket 1 comma normal infinity right parenthesisx ∈[1, ∞); 
• 
it is right-continuous, 
upper F left parenthesis negative 1 right parenthesis equals limit Underscript h down arrow 0 Endscripts upper F left parenthesis negative 1 plus h right parenthesis equals one halfF(−1)
=
limh↓0 F(−1 + h)
=
1
2 and 
upper F left parenthesis 1 right parenthesis equals limit Underscript h down arrow 0 Endscripts upper F left parenthesis 1 plus h right parenthesis equals 1F(1)
=
limh↓0 F(1 + h) = 1, being constant then continuous over the three intervals 
above; 
• 
its limits for x right arrow negative normal infinityx →−∞and x right arrow normal infinityx →∞are 0 and 1, respectively, by construction; 
• 
for every reals a less than ba < b the probability that a less than upper X less than or slanted equals ba < X ⩽b is computed by upper F left parenthesis b right parenthesis minus upper F left parenthesis a right parenthesisF(b)−F(a), 
e.g., with a equals 0a = 0 and b equals 2b = 2 we have upper F left parenthesis 2 right parenthesis minus upper F left parenthesis 0 right parenthesis equals 1 minus one half equals one halfF(2) −F(0) = 1 −1
2 = 1
2. 
By its truly deﬁnition, this CDF gives the probability sans serif upper P left parenthesis upper X less than or slanted equals x right parenthesisP(X ⩽x) accumulated at 
each x element of double struck upper Rx ∈R: 
• 
for x less than negative 1x < −1 the probability that upper X less than or slanted equals xX ⩽x is 0; 
• 
for x equals negative 1x = −1 this probability increases to one half1
2 and remains constant up to x less than 1x < 1; 
• 
for x equals 1x = 1 the cumulative probability hits 1. 
The probability changes only at the jump discontinuities of upper F Subscript upper XFX, namely at x equals negative 1x = −1
and at x equals 1x = 1. By Theorem 2.1(d) we compute: 
• 
. P(−∞< X ⩽−1) = P({−∞< X < −1}∪{X = −1}) = P(−∞< X < −1)
plus sans serif upper P left parenthesis upper X equals negative 1 right parenthesis+ P(X = −1) as upper F Subscript upper X Baseline left parenthesis negative 1 right parenthesis minus upper F Subscript upper X Baseline left parenthesis negative normal infinity right parenthesis equals upper F Subscript upper X Baseline left parenthesis negative 1 right parenthesisFX(−1) −FX(−∞) = FX(−1); 
• 
. P(−1 < X ⩽1) = P({−1 < X < 1} ∪{X = 1}) = P(−1 < X < 1)
plus sans serif upper P left parenthesis upper X equals 1 right parenthesis+ P(X = 1) as upper F Subscript upper X Baseline left parenthesis 1 right parenthesis minus upper F Subscript upper X Baseline left parenthesis negative 1 right parenthesisFX(1) −FX(−1). 
Putting things together, we must have sans serif upper P left parenthesis negative normal infinity less than upper X less than negative 1 right parenthesis equals sans serif upper P left parenthesis negative 1 less than upper X less than 1 right parenthesis equals 0P(−∞< X < −1) = P(−1 < X < 1) = 0
and sans serif upper P left parenthesis upper X equals negative 1 right parenthesis equals sans serif upper P left parenthesis upper X equals 1 right parenthesis equals one halfP(X = −1) = P(X = 1) = 1
2, thus the sum of the latter probabilities is just 
one.
2.2
Discrete Random Variables
31
Remark 2.4 There is a zero probability that X takes values on the open interval 
left parenthesis negative normal infinity comma negative 1 right parenthesis(−∞, −1). To see this more formally, observe that upper F Subscript upper X Baseline left parenthesis x right parenthesis equals sans serif upper P left parenthesis upper X less than or slanted equals x right parenthesis equals 0FX(x) = P(X ⩽x) = 0
for every x less than negative 1x < −1: say there is an increasing sequence of zero-probability events 
left brace upper X less than or slanted equals negative 1 minus StartFraction 1 Over i EndFraction right brace{X ⩽−1 −1
i }, for i element of double struck upper Ni ∈N, s.t. their union is 
left brace x less than negative 1 right brace equals left brace negative normal infinity less than upper X less than negative 1 right brace comma{x < −1} = {−∞< X < −1},
then by continuity we have limit Underscript i right arrow normal infinity Endscripts sans serif upper P left parenthesis upper X less than or slanted equals negative 1 minus StartFraction 1 Over i EndFraction right parenthesis equals sans serif upper P left parenthesis negative normal infinity less than upper X less than negative 1 right parenthesis equals 0limi→∞P(X ⩽−1 −1
i ) = P(−∞< X < −1) =
0. Also,  sans serif upper P left parenthesis negative normal infinity less than upper X less than negative 1 right parenthesis equals upper F Subscript upper X Baseline left parenthesis minus 1 Superscript minus Baseline right parenthesisP(−∞< X < −1) = FX(−1−) is just the left-limit of the CDF at 
x equals negative 1x = −1. Moreover, there is a zero probability that X takes value between the jump 
discontinuities, i.e. on the open interval left parenthesis negative 1 comma 1 right parenthesis(−1, 1). 
As byproduct, the current CDF corresponds to a rv X with only two values negative 1−1
and 1 and no relevant values in the open intervals left parenthesis negative normal infinity comma negative 1 right parenthesis(−∞, −1), left parenthesis negative 1 comma 1 right parenthesis(−1, 1) and left parenthesis 1 comma normal infinity right parenthesis(1, ∞). 
Attached to these two values we have two probability masses sans serif upper P left parenthesis upper X equals negative 1 right parenthesisP(X = −1) and 
sans serif upper P left parenthesis upper X equals 1 right parenthesisP(X = 1) whose values are given by the jump discontinuities of the CDF, i.e. 
upper F Subscript upper X Baseline left parenthesis negative 1 right parenthesis minus upper F Subscript upper X Baseline left parenthesis minus 1 Superscript minus Baseline right parenthesisFX(−1) −FX(−1−) and upper F Subscript upper X Baseline left parenthesis 1 right parenthesis minus upper F Subscript upper X Baseline left parenthesis 1 Superscript minus Baseline right parenthesisFX(1) −FX(1−) respectively, such that they sum up to 
one, see Fig. 2.1. 
Example 2.2 (Changing the Masses) Let X be the discrete rv introduced so far 
with values upper C equals StartSet negative 1 comma 1 EndSetC = {−1, 1} but different masses sans serif upper P left parenthesis upper X equals negative 1 right parenthesis equals one thirdP(X = −1) = 1
3 and sans serif upper P left parenthesis upper X equals 1 right parenthesis equals two thirdsP(X = 1) = 2
3. 
If upper B equals left parenthesis negative 5 comma 1 right parenthesisB = (−5, 1) we compute sans serif upper P left parenthesis upper X element of upper B right parenthesis equals one thirdP(X ∈B) = 1
3, because for any x element of upper Bx ∈B the only 
nonzero probability that upper X equals xX = x is sans serif upper P left parenthesis upper X equals negative 1 right parenthesisP(X = −1). Observe that upper X equals 1X = 1 is not included 
for the interval B is open on the right. 
Theorem 2.2 For a probability space left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P) and a discrete rv X there exists a 
countable set upper C equals StartSet x 1 comma x 2 comma ellipsis EndSet subset of double struck upper RC = {x1, x2, . . .} ⊂R s.t. the probability that X assumes a value here 
is just 1. 
By Theorem 2.2 we can change the masses over corresponding points from the 
support: it sufﬁces to guarantee that all them sum up to one. 
Fig. 2.1 CDF’s graph of a 
discrete rv as a step function
32
2
Distribution of Random Variables
2.3 
Continuous Random Variables 
The probability distribution of a discrete rv is characterized by a CDF which is not 
continuous: it is a nondecreasing step function with jump discontinuities at a ﬁnite 
or countable set of points where it increases by means of jumps given by probability 
masses. In fact, for a discrete rv X the CDF is not differentiable at each point x Subscript ixi of 
its support where the derivative goes to inﬁnity. To see this, ﬁrst write 
StartLayout 1st Row 1st Column limit Underscript h right arrow 0 Endscripts StartStartFraction upper F Subscript upper X Baseline left parenthesis x Subscript i Baseline plus StartFraction h Over 2 EndFraction right parenthesis minus upper F Subscript upper X Baseline left parenthesis x Subscript i Baseline minus StartFraction h Over 2 EndFraction right parenthesis OverOver h EndEndFraction 2nd Column equals 3rd Column StartStartFraction limit Underscript h right arrow 0 Endscripts left bracket upper F Subscript upper X Baseline left parenthesis x Subscript i Baseline plus StartFraction h Over 2 EndFraction right parenthesis minus upper F Subscript upper X Baseline left parenthesis x Subscript i Baseline minus StartFraction h Over 2 EndFraction right parenthesis right bracket OverOver limit Underscript h right arrow 0 Endscripts h EndEndFraction 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction upper F Subscript upper X Baseline left parenthesis x Subscript i Baseline right parenthesis minus upper F Subscript upper X Baseline left parenthesis x Subscript i Superscript minus Baseline right parenthesis Over 0 EndFraction equals StartFraction sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis Over 0 EndFraction equals normal infinity period EndLayout lim
h→0
FX(xi + h
2) −FX(xi −h
2)
h
= limh→0
⎾
FX(xi + h
2) −FX(xi −h
2)
⏋
limh→0 h
= FX(xi) −FX(x−
i )
0
= P(X = xi)
0
= ∞.
Thus the above limit cannot provide the derivative of upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x) at the point x Subscript ixi. Moral: 
any discrete rv has CDF s.t. upper F prime Subscript upper X Baseline left parenthesis x right parenthesis equals 0F '
X(x) = 0 except on its support, i.e. the ﬁnite or 
countable set of points where upper F prime Subscript upper X Baseline left parenthesis x right parenthesisF '
X(x) does not exist. When the CDF of a rv increases 
smoothly, then it can be the indeﬁnite integral of its derivative. 
Deﬁnition 2.3 A rv  X i called continuous if the corresponding CDF is continuous 
i.e. 
upper F Subscript upper X Baseline left parenthesis x right parenthesis minus upper F Subscript upper X Baseline left parenthesis x Superscript minus Baseline right parenthesis equals 0 comma for every x element of double struck upper R commaFX(x) −FX(x−) = 0,
for every x ∈R,
and there exists an integrable function f Subscript upper X Baseline colon double struck upper R right arrow double struck upper RfX : R →R s.t. f Subscript upper X Baseline left parenthesis x right parenthesis greater than or slanted equals 0fX(x) ⩾0 for all x element of double struck upper Rx ∈R, 
and integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x equals 1
⨜∞
−∞fX(x)dx = 1. 
In Deﬁnition 2.3 the function f Subscript upper XfX is called density function of the law sans serif upper P Subscript upper XPX, or  
improperly of the rv X. It is not necessarily continuous, but due to the integrability 
condition4 it is continuous or piecewise continuous. 
Remark 2.5 By item 5 in Table 2.1, a possible jump of a CDF is just upper F Subscript upper X Baseline left parenthesis x right parenthesis minus upper F Subscript upper X Baseline left parenthesis x Superscript minus Baseline right parenthesis equals sans serif upper P left parenthesis upper X equals x right parenthesisFX(x) −
FX(x−) = P(X = x). Moreover, it can be shown that a CDF has at most countably 
many discontinuity points. Therefore, for CDFs there are countably inﬁnite x element of double struck upper Rx ∈R
where sans serif upper P left parenthesis upper X equals x right parenthesis greater than 0P(X = x) > 0. A continuous CDF may be differentiable at x element of double struck upper Rx ∈R where it 
has no jumps. 
Proposition 2.1 (Absolute Continuity) 
A rv  X has a continuous probability 
distribution iff there exists a density function f Subscript upper X Baseline colon double struck upper R right arrow double struck upper RfX : R →R which satisﬁes: 
upper F Subscript upper X Baseline left parenthesis x right parenthesis equals integral Subscript negative normal infinity Superscript x Baseline f Subscript upper X Baseline left parenthesis u right parenthesis normal d u comma x element of double struck upper R periodFX(x) =
⨜x
−∞
fX(u)du,
x ∈R.
(2.2)
4 In almost all cases, f Subscript upper XfX is meant to be Riemann-integrable. 
2.3
Continuous Random Variables
33
Thanks to this result we can compute probabilities via densities. In fact: 
StartLayout 1st Row 1st Column integral Subscript negative normal infinity Superscript b Baseline f Subscript upper X Baseline left parenthesis u right parenthesis normal d u minus integral Subscript negative normal infinity Superscript a Baseline f Subscript upper X Baseline left parenthesis u right parenthesis normal d u 2nd Column StartLayout 1st Row left parenthesis question mark question mark question mark right parenthesis 2nd Row equals EndLayout 3rd Column upper F Subscript upper X Baseline left parenthesis b right parenthesis minus upper F Subscript upper X Baseline left parenthesis a right parenthesis 2nd Row 1st Column Blank 2nd Column StartLayout 1st Row Defn period on of f Subscript upper X Baseline 2nd Row equals EndLayout 3rd Column integral Subscript a Superscript b Baseline f Subscript upper X Baseline left parenthesis u right parenthesis normal d u 3rd Row 1st Column Blank 2nd Column StartLayout 1st Row Th question mark question mark question mark left parenthesis d right parenthesis 2nd Row equals EndLayout 3rd Column sans serif upper P left parenthesis a less than upper X less than or slanted equals b right parenthesis period EndLayout
⨜b
−∞
fX(u)du −
⨜a
−∞
fX(u)du
(2.2) 
=
FX(b) − FX(a) 
Defn.on of fX 
=
⨜b 
a 
fX(u)du 
Th 2.1(d) 
=
P(a < X ⩽b). 
Loosely speaking, to compute sans serif upper P Subscript upper X Baseline left parenthesis left parenthesis a comma b right bracket right parenthesisPX((a, b]) it sufﬁces to integrate the density over 
the corresponding interval. Moreover, since the support of a continuous rv (see 
Remark 2.3) is the uncountable set of points x element of double struck upper Rx ∈R where sans serif upper P left parenthesis x minus epsilon less than upper X less than x plus epsilon right parenthesis greater than 0P(x−ϵ < X < x+ϵ) > 0
for all epsilon greater than 0ϵ > 0, the density is f Subscript upper X Baseline left parenthesis x right parenthesis greater than 0fX(x) > 0 at these points. Henceforth, sans serif upper P left parenthesis a less than or slanted equals upper X less than or slanted equals b right parenthesis equals sans serif upper P left parenthesis a less than or slanted equals upper X less than b right parenthesis equals sans serif upper P left parenthesis a less than upper X less than b right parenthesisP(a ⩽X ⩽
b) = P(a ⩽X < b) = P(a < X < b) and all are equal to sans serif upper P left parenthesis a less than upper X less than or slanted equals b right parenthesisP(a < X ⩽b). Indeed 
for a continuous probability distribution we always have sans serif upper P left parenthesis upper X equals x right parenthesis equals 0P(X = x) = 0 for every 
x element of double struck upper Rx ∈R from the support: there is a zero probability that X takes on a single value. 
More is true: it can also be shown that for a continuous CDF which is continuously 
differentiable with the exception of a ﬁnite set of points, the law sans serif upper P Subscript upper XPX has a density 
given by f Subscript upper X Baseline left parenthesis x right parenthesis equals upper F prime Subscript upper X Baseline left parenthesis x right parenthesisfX(x) = F '
X(x).5 If the density function is additionally continuous then 
by the fundamental theorem of Calculus 
upper F prime Subscript upper X Baseline left parenthesis x right parenthesis equals StartFraction normal d Over normal d x EndFraction integral Subscript negative normal infinity Superscript x Baseline f Subscript upper X Baseline left parenthesis u right parenthesis normal d u equals f Subscript upper X Baseline left parenthesis x right parenthesis periodF '
X(x) = d
dx
⨜x
−∞
fX(u)du = fX(x).
(2.3) 
Remark 2.6 if f colon left bracket a comma b right bracket right arrow double struck upper Rf
: [a, b] →R is continuous then the continuous function 
upper F left parenthesis x right parenthesis colon equals integral Subscript a Superscript x Baseline f left parenthesis u right parenthesis normal d uF(x) :=
⨜x
a f (u)du is the antiderivative of f , i.e. StartFraction normal d Over normal d x EndFraction upper F left parenthesis x right parenthesis equals f left parenthesis x right parenthesis d
dx F(x) = f (x) for x element of left bracket a comma b right bracketx ∈[a, b]
and integral Subscript a Superscript b Baseline f left parenthesis x right parenthesis normal d x equals upper F left parenthesis b right parenthesis minus upper F left parenthesis a right parenthesis
⨜b
a f (x)dx = F(b) −F(a). Relation (2.3) is given in the improper form 
with a right arrow negative normal infinitya →−∞. It is worth recalling the improper Riemann integral integral Subscript negative normal infinity Superscript b Baseline f left parenthesis x right parenthesis normal d x
⨜b
−∞f (x)dx
can be written limit Underscript a right arrow negative normal infinity Endscripts integral Subscript a Superscript b Baseline f left parenthesis x right parenthesis normal d x comma for a less than blima→−∞
⨜b
a f (x)dx,
for a < b, and similarly integral Subscript negative normal infinity Superscript normal infinity Baseline f left parenthesis x right parenthesis normal d x equals limit Underscript k right arrow normal infinity Endscripts integral Subscript negative k Superscript k Baseline f left parenthesis x right parenthesis normal d x
⨜∞
−∞f (x)dx =
limk→∞
⨜k
−k f (x)dx for k greater than 0 periodk > 0.
Hence, except for a ﬁnite number of points where upper F Subscript upper XFX is not differentiable it is always 
the case that upper F Subscript upper XFX can be recovered by f Subscript upper XfX via (2.2), i.e. integration, and conversely f Subscript upper XfX
can be recovered by upper F Subscript upper XFX through (2.3), i.e. differentiation. Observe that the density 
function alone does not yield a probability, since it could be the case f Subscript upper X Baseline left parenthesis x right parenthesis greater than 1fX(x) > 1 for 
some x element of double struck upper Rx ∈R. For an interval with inﬁnitesimal length normal d xdx, say  left bracket x minus StartFraction normal d x Over 2 EndFraction comma x plus StartFraction normal d x Over 2 EndFraction right bracket[x −dx
2 , x + dx
2 ], the  
probability that X takes on values in such a small neighborhood of x is just f Subscript upper X Baseline left parenthesis x right parenthesis normal d xfX(x)dx. 
Since StartFraction normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis Over normal d x EndFraction equals limit Underscript h right arrow 0 Endscripts StartFraction upper F Subscript upper X Baseline left parenthesis x plus h right parenthesis minus upper F Subscript upper X Baseline left parenthesis x right parenthesis Over h EndFraction dFX(x)
dx
= limh→0 FX(x+h)−FX(x)
h
and h almost equals normal d xh ≈dx, we have  StartFraction normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis Over normal d x EndFraction dFX(x)
dx
approximately 
given by StartFraction upper F Subscript upper X Baseline left parenthesis x plus h right parenthesis minus upper F Subscript upper X Baseline left parenthesis x right parenthesis Over normal d x EndFraction FX(x+h)−FX(x)
dx
. Hence for the differential we have: 
normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis equals f Subscript upper X Baseline left parenthesis x right parenthesis normal d x almost equals upper F Subscript upper X Baseline left parenthesis x plus normal d x right parenthesis minus upper F Subscript upper X Baseline left parenthesis x right parenthesis equals sans serif upper P left parenthesis upper X less than or slanted equals x plus normal d x right parenthesis minus sans serif upper P left parenthesis upper X less than or slanted equals x right parenthesis commadFX(x) = fX(x)dx ≈FX(x + dx) −FX(x) = P(X ⩽x + dx) −P(X ⩽x),
5 In this case f Subscript upper X Baseline left parenthesis x right parenthesisfX(x) may assume arbitrary values on this ﬁnite exceptional set where there does not exist upper F prime Subscript upper X Baseline left parenthesis x right parenthesis∄F '
X(x), and  
here we can let f Subscript upper X Baseline left parenthesis x right parenthesis equals 0fX(x) = 0. 
34
2
Distribution of Random Variables
Fig. 2.2 Probability that X is 
close to x approximated by 
f Subscript upper X Baseline left parenthesis x right parenthesis normal d xfX(x)dx, the area below the 
f Subscript upper XfX’s graph and between the 
dashed vertical lines. The 
total area below the f Subscript upper XfX’s 
graph amounts to 1 
Table 2.2 Types of rvs in terms of their probability distribution 
Discrete
Absolutely continuous 
upper F Subscript upper XFX
Step function
Continuous 
X’s values 
Finite or countable set upper C equals StartSet x 1 comma x 2 comma ellipsis EndSetC = {x1, x2, . . .}
Interval(s) or double struck upper RR
upper F Subscript upper XFX increases Jump upper F Subscript upper X Baseline left parenthesis x Subscript i Baseline right parenthesis minus upper F Subscript upper X Baseline left parenthesis x Subscript i Superscript minus Baseline right parenthesisFX(xi) −FX(x−
i ) for x Subscript i Baseline element of upper Cxi ∈C
Differential normal d upper F Subscript upper X Baseline left parenthesis x right parenthesisdFX(x)
upper F Subscript upper XFX changes 
Masses sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesisP(X = xi) for x Subscript i Baseline element of upper Cxi ∈C
Density f Subscript upper X Baseline left parenthesis x right parenthesis equals StartFraction normal d Over normal d x EndFraction upper F Subscript upper X Baseline left parenthesis x right parenthesis identical to upper F prime Subscript upper X Baseline left parenthesis x right parenthesisfX(x) =
d
dx FX(x) ≡F '
X(x)
sans serif upper P left parenthesis upper X less than or slanted equals x right parenthesisP(X ⩽x)
Finite or countable sum sigma summation Underscript x Subscript i Baseline less than or slanted equals x Endscripts sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis∑
xi ⩽x P(X = xi) ‘Uncountable sum’ integral Subscript negative normal infinity Superscript x Baseline f Subscript upper X Baseline left parenthesis u right parenthesis normal d x
⨜x
−∞fX(u)dx
sans serif upper P left parenthesis upper X element of upper B right parenthesisP(X ∈B)
sigma summation Underscript x Subscript i Baseline element of upper B Endscripts sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis∑
xi∈B P(X = xi)
integral Underscript upper B Endscripts f Subscript upper X Baseline left parenthesis x right parenthesis normal d x
⨜
B fX(x)dx
i.e., sans serif upper P Subscript upper X Baseline left parenthesis left parenthesis x plus StartFraction normal d x Over 2 EndFraction right bracket right parenthesisPX((x + dx
2 ]) is approximately given by the X’s law evaluated at x element of double struck upper Rx ∈R, and 
we ca formally write sans serif upper P Subscript upper X Baseline left parenthesis normal d x right parenthesis equals normal d upper F Subscript upper X Baseline left parenthesis x right parenthesisPX(dx) = dFX(x), where the left-hand side can be written 
normal d sans serif upper P Subscript upper X Baseline left parenthesis x right parenthesisdPX(x). The density function yields the instantaneous marginal change of the CDF, 
actually the slope at x element of double struck upper Rx ∈R of the upper F Subscript upper XFX’s graph. Equivalently, f Subscript upper X Baseline left parenthesis x right parenthesis normal d xfX(x)dx is understood 
as the area below the f Subscript upper XfX’s graph, more or less the area of the rectangle with height 
f Subscript upper X Baseline left parenthesis x right parenthesisfX(x) and base normal d xdx, being x the center of left bracket x minus StartFraction normal d x Over 2 EndFraction comma x plus StartFraction normal d x Over 2 EndFraction right bracket[x −dx
2 , x + dx
2 ], see Fig. 2.2. 
Example 2.3 Let upper B equals left parenthesis negative 5 comma 1 right parenthesisB = (−5, 1), and consider a continuous rv X with density 
f Subscript upper X Baseline left parenthesis x right parenthesis equals one fourthfX(x) = 1
4 for x element of left bracket negative 2 comma 2 right bracketx ∈[−2, 2] and f Subscript upper X Baseline left parenthesis x right parenthesis equals 0fX(x) = 0 otherwise. First, let us verify that 
integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x equals ModifyingBelow integral Subscript negative normal infinity Superscript negative 2 Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x With bottom brace Underscript equals 0 Endscripts plus integral Subscript negative 2 Superscript 2 Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x plus ModifyingBelow integral Subscript 2 Superscript normal infinity Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x With bottom brace Underscript equals 0 Endscripts equals 1 comma
⨜∞
−∞
fX(x)dx =
⨜−2
−∞
fX(x)dx
◟
◝◜
◞
=0
+
⨜2
−2
fX(x)dx +
⨜∞
2
fX(x)dx
◟
◝◜
◞
=0
= 1,
since f Subscript upper X Baseline left parenthesis x right parenthesisfX(x) has primitive one fourth x1
4x (up to a constant) which integrates over left bracket negative 2 comma 2 right bracket[−2, 2] to 
left bracket one fourth x right bracket Subscript negative 2 Superscript 2 Baseline equals one fourth left bracket 2 minus left parenthesis negative 2 right parenthesis right bracket equals 1
⎾
1
4x
⏋2
−2 = 1
4[2 −(−2)] = 1. Thus, integral Underscript upper B Endscripts f Subscript upper X Baseline left parenthesis x right parenthesis normal d x equals integral Subscript negative 5 Superscript 1 Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x
⨜
B fX(x)dx =
⨜1
−5 fX(x)dx and it equals 
integral Subscript negative 5 Superscript negative 2 Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x plus integral Subscript negative 2 Superscript 1 Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x equals 0 plus left bracket one fourth x right bracket Subscript negative 2 Superscript 1 Baseline equals three fourths equals sans serif upper P left parenthesis upper X element of upper B right parenthesis period
⨜−2
−5
fX(x)dx +
⨜1
−2
fX(x)dx = 0 +
⎾1
4x
⏋1
−2
= 3
4 = P(X ∈B).
In Table 2.2, discrete and continuous rvs are compared.
2.4
Indicator Random Variables
35
2.4 
Indicator Random Variables 
Here we present a special type of discrete rv with support containing only two 
values. First, we need its deterministic version. For a given subset upper B subset of double struck upper RB ⊂R the 
function 
bold upper I Subscript upper B Baseline left parenthesis x right parenthesis colon equals StartLayout Enlarged left brace 1st Row 1st Column 1 comma 2nd Column if x element of upper B 2nd Row 1st Column 0 comma 2nd Column if x not an element of upper B EndLayoutIB(x) :=
⌠1, if x ∈B
0, if x /∈B
(2.4) 
is called the indicator of the set B. Indicators can be useful for deﬁning numerical 
functions changing over subsets upper B periodB. For example, writing one fourth bold upper I Subscript left bracket negative 2 comma 2 right bracket Baseline left parenthesis x right parenthesis 1
4I[−2,2](x) we get a 
function6 equals to one fourth1
4 for every negative 2 less than or slanted equals x less than or slanted equals 2−2 ⩽x ⩽2. When it is clear, the argument left parenthesis x right parenthesis(x)
can be omitted. The random version for a given event upper A subset of upper OmegaA ⊂Ω is 
bold upper I Subscript upper A Baseline left parenthesis omega right parenthesis colon equals StartLayout Enlarged left brace 1st Row 1st Column 1 comma 2nd Column if omega element of upper A 2nd Row 1st Column 0 comma 2nd Column if omega not an element of upper A EndLayoutIA(ω) :=
⌠1, if ω ∈A
0, if ω /∈A
(2.5) 
called indicator rv . In fact, bold upper I Subscript upper AIA is a rv iff upper A element of script upper FA ∈F, see Exercise 2.3. Indicator rvs have 
the following properties, for any pair of events upper A comma upper B element of script upper FA, B ∈F: 
1. . IA∪B = IA + IB −IA∩B = max{IA, IB};
2. . IA∩B = IAIB = min{IA, IB};
3. . IA\B = max{0, IA −IB};
4. . IAc = 1 −IA;
5. .IA ⩽IB iff upper A subset of upper BA ⊂B. 
Their veriﬁcation is based on deﬁnition (2.5). For example, property 1. is: 
StartLayout 1st Row 1st Column bold upper I Subscript upper A union upper B Baseline left parenthesis omega right parenthesis equals 1 2nd Column long left right double arrow 3rd Column omega element of upper A union upper B 2nd Row 1st Column Blank 2nd Column long left right double arrow 3rd Column omega element of upper A or omega element of upper B or omega element of upper A intersection upper B EndLayoutIA∪B(ω) = 1 ⇐⇒ω ∈A ∪B
⇐⇒ω ∈A or ω ∈B or ω ∈A ∩B
and provided upper A comma upper BA, B are compatible and bold upper I Subscript upper A Baseline equals bold upper I Subscript upper B Baseline equals 1IA = IB = 1 then also bold upper I Subscript upper A intersection upper B Baseline equals 1IA∩B = 1 and the 
formula above holds; if only one of bold upper I Subscript upper A Baseline comma bold upper I Subscript upper B BaselineIA, IB is 1 or upper A comma upper BA, B are disjoint, then bold upper I Subscript upper A intersection upper B Baseline equals 0IA∩B = 0
and the formula still holds. Indicator rvs are useful in determining the structure of 
discrete rvs with ﬁnite values StartSet x 1 comma ellipsis comma x Subscript n Baseline EndSet{x1, . . . , xn}. Indeed, let upper A 1 comma ellipsis comma upper A Subscript n BaselineA1, . . . , An be events from 
script upper FF partitioning upper OmegaΩ, i.e. as usual upper Omega equals upper A 1 union midline horizontal ellipsis union upper A Subscript nΩ = A1 ∪· · · ∪An and upper A Subscript i Baseline intersection upper A Subscript j Baseline equals empty setAi ∩Aj = ∅for all i not equals ji /= j
ranging over StartSet 1 comma ellipsis comma n EndSet{1, . . . , n}. For a discrete rv with support upper C equals StartSet x 1 comma ellipsis comma x Subscript n Baseline EndSetC = {x1, . . . , xn} we can 
safely write 
upper X left parenthesis omega right parenthesis equals x 1 bold upper I Subscript upper A 1 Baseline left parenthesis omega right parenthesis plus midline horizontal ellipsis plus x Subscript n Baseline bold upper I Subscript upper A Sub Subscript n Subscript Baseline left parenthesis omega right parenthesis commaX(ω) = x1IA1(ω) + · · · + xnIAn(ω),
(2.6)
6 Actually it is a density function. 
36
2
Distribution of Random Variables
whenever upper X left parenthesis omega right parenthesis equals x Subscript iX(ω) = xi for omega element of upper A Subscript iω ∈Ai and i equals 1 comma ellipsis comma ni = 1, . . . , n. In fact by the disjointedness 
hypotheses we also have bold upper I Subscript upper A Sub Subscript i Baseline equals 1IAi = 1, while bold upper I Subscript upper A Sub Subscript j Baseline equals 0IAj = 0 for the remaining n minus 1n−1 integers j not equals ij /=
i ranging over StartSet 1 comma ellipsis comma n EndSet{1, . . . , n}. For representing these disjoint events the obvious choice7 
is upper A Subscript i Baseline equals left brace upper X equals x Subscript i Baseline right braceAi = {X = xi}, with positive masses sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis greater than 0P(Ai) > 0. Discrete rvs as represented in 
(2.6) are usually called simple rv . A related issue is the representation of discrete 
probability distributions using indicators. 
Example 2.4 (Discrete CDF via Indicators) Let X be a discrete rv modelling 
future stock prices, with values in the support upper C equals StartSet 90 comma 150 comma 190 EndSetC = {90, 150, 190} denominated 
in euros. We set x 1 equals 90 comma x 2 equals 150x1 = 90, x2 = 150 and x 3 equals 190x3 = 190; the masses are p Subscript i Baseline colon equals sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesispi := P(X = xi)
for i equals 1 comma 2 comma 3i = 1, 2, 3. Hence, the probability that the random price assumes value at most 
x element of double struck upper Rx ∈R is 
sans serif upper P left parenthesis upper X less than or slanted equals x right parenthesis equals upper F Subscript upper X Baseline left parenthesis x right parenthesis equals p 1 bold upper I Subscript left bracket x 1 comma normal infinity right parenthesis Baseline left parenthesis x right parenthesis plus p 2 bold upper I Subscript left bracket x 2 comma normal infinity right parenthesis Baseline left parenthesis x right parenthesis plus p 3 bold upper I Subscript left bracket x 3 comma normal infinity right parenthesis Baseline left parenthesis x right parenthesis periodP(X ⩽x) = FX(x) = p1I[x1,∞)(x) + p2I[x2,∞)(x) + p3I[x3,∞)(x).
(2.7) 
Here each bold upper I Subscript left bracket x Sub Subscript i Subscript comma normal infinity right parenthesis Baseline left parenthesis x right parenthesisI[xi,∞)(x) is 1 whenever x element of left bracket x Subscript i Baseline comma normal infinity right parenthesisx ∈[xi, ∞), which is equivalent to x Subscript i Baseline less than or slanted equals xxi ⩽x for 
ﬁxed x Subscript ixi. For example, with x equals 155x = 155 euro the future stock price is at most x with 
probability 
StartLayout 1st Row 1st Column upper F Subscript upper X Baseline left parenthesis 155 right parenthesis 2nd Column equals 3rd Column p 1 ModifyingBelow bold upper I Subscript left bracket x 1 comma normal infinity right parenthesis Baseline left parenthesis 155 right parenthesis With bottom brace Underscript equals 1 Endscripts plus p 2 ModifyingBelow bold upper I Subscript left bracket x 2 comma normal infinity right parenthesis Baseline left parenthesis 155 right parenthesis With bottom brace Underscript equals 1 Endscripts plus p 3 ModifyingBelow bold upper I Subscript left bracket x 3 comma normal infinity right parenthesis Baseline left parenthesis 155 right parenthesis With bottom brace Underscript equals 0 Endscripts 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper X equals 90 right parenthesis plus sans serif upper P left parenthesis upper X equals 150 right parenthesis period EndLayoutFX(155) = p1 I[x1,∞)(155)
◟
◝◜
◞
=1
+p2 I[x2,∞)(155)
◟
◝◜
◞
=1
+p3 I[x3,∞)(155)
◟
◝◜
◞
=0
= P(X = 90) + P(X = 150).
Each indicator of the type bold upper I Subscript left bracket x Sub Subscript i Subscript comma normal infinity right parenthesis Baseline left parenthesis x right parenthesisI[xi,∞)(x) is sometimes written bold upper I Subscript left brace x Sub Subscript i Subscript less than or slanted equals x right braceI{xi ⩽x}. 
Example 2.5 The CDF of a discrete rv with n element of double struck upper Nn ∈N values can be represented as 
upper F Subscript upper X Baseline left parenthesis x right parenthesis equals sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline bold upper I Subscript left brace x Sub Subscript i Subscript less than or slanted equals x right brace Baseline periodFX(x) =
n
⎲
i=1
piI{xi ⩽x}.
Observe that this is the convex combination of n step functions bold upper I Subscript left brace x Sub Subscript i Subscript less than or slanted equals x right braceI{xi ⩽x}, which are 
actually CDFs, with weights p Subscript i Baseline greater than or slanted equals 0pi ⩾0 s.t. sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline equals 1∑n
i=1 pi = 1. 
Remark 2.7 In real analysis we found the unit step function or Heaviside function: 
StartLayout 1st Row u left parenthesis x right parenthesis colon equals StartLayout Enlarged left brace 1st Row 1st Column 1 comma 2nd Column if x greater than or slanted equals 0 2nd Row 1st Column 0 comma 2nd Column if x less than 0 period EndLayout EndLayoutu(x) :=
⌠1, if x ⩾0
0, if x < 0.
(2.8) 
As byproduct bold upper I Subscript left brace x Sub Subscript i Subscript less than or slanted equals x right brace Baseline equals u left parenthesis x minus x Subscript i Baseline right parenthesisI{xi ⩽x} = u(x −xi) and we may write 
upper F Subscript upper X Baseline left parenthesis x right parenthesis equals sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline u left parenthesis x minus x Subscript i Baseline right parenthesisFX(x) = ∑n
i=1 piu(x −xi)
which is the way a discrete CDF is represented in some textbooks.
7 We will see how nonnegative rvs can be approximated by discrete rvs in the form (2.6). 
2.5
Operations on Random Variables
37
Example 2.6 From a different perspective, the indicator bold upper I Subscript upper B Baseline left parenthesis x right parenthesisIB(x) can be understood 
as a set function bold upper I Subscript x Baseline left parenthesis upper B right parenthesisIx(B), i.e. deﬁnition (2.4) is the  same  but now  x element of double struck upper Rx ∈R is ﬁxed and 
what changes is the set B. A discrete probability distribution can be written also8 
sans serif upper P Subscript upper X Baseline left parenthesis upper B right parenthesis colon equals sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline bold upper I Subscript x Sub Subscript i Subscript Baseline left parenthesis upper B right parenthesis commaPX(B) :=
n
⎲
i=1
piIxi(B),
where p Subscript i Baseline greater than or slanted equals 0pi ⩾0 and sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline equals 1∑n
i=1 pi = 1. For example, considering upper B equals left bracket 0 comma 155 right bracketB = [0, 155] and the 
previous rv X modelling future stock prices we can compute 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper X element of upper B right parenthesis equals upper P Subscript upper X Baseline left parenthesis upper B right parenthesis 2nd Column equals 3rd Column p 1 ModifyingBelow bold upper I 90 left parenthesis upper B right parenthesis With bottom brace Underscript equals 1 Endscripts plus p 2 ModifyingBelow bold upper I 150 left parenthesis upper B right parenthesis With bottom brace Underscript equals 1 Endscripts plus p 3 ModifyingBelow bold upper I 190 left parenthesis upper B right parenthesis With bottom brace Underscript equals 0 Endscripts 2nd Row 1st Column Blank 2nd Column equals 3rd Column p 1 plus p 2 equals sans serif upper P left parenthesis upper X equals 90 right parenthesis plus sans serif upper P left parenthesis upper X equals 150 right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript x element of upper B Endscripts sans serif upper P left parenthesis upper X equals x right parenthesis period EndLayoutP(X ∈B) = PX(B) = p1 I90(B)
◟◝◜◞
=1
+p2 I150(B)
◟◝◜◞
=1
+p3 I190(B)
◟◝◜◞
=0
= p1 + p2 = P(X = 90) + P(X = 150)
=
⎲
x∈B
P(X = x).
In some textbook bold upper I Subscript x Baseline left parenthesis upper B right parenthesisIx(B) is written 
delta Subscript x Baseline left parenthesis upper B right parenthesisδx(B) and called Dirac delta measure . 
We close this section with another application of indicators. 
Example 2.7 Let left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P) be a discrete uniform probability space whit sans serif upper P left parenthesis upper A right parenthesis equals StartFraction StartAbsoluteValue upper A EndAbsoluteValue Over StartAbsoluteValue upper Omega EndAbsoluteValue EndFractionP(A) =
|A|
|Ω| for every event upper A element of script upper F equals 2 Superscript upper Omega Baseline commaA ∈F = 2Ω, where upper OmegaΩ is ﬁnite. We can use the indicators 
to redeﬁne the probability measure. If we let sans serif upper P left parenthesis upper A right parenthesis equals StartFraction sigma summation Underscript omega element of upper Omega Endscripts bold upper I Subscript upper A Baseline left parenthesis omega right parenthesis Over sigma summation Underscript omega element of upper Omega Endscripts bold upper I Subscript upper Omega Baseline left parenthesis omega right parenthesis EndFraction commaP(A) =
∑
ω∈Ω IA(ω)
∑
ω∈Ω IΩ(ω), then the ratio 
‘number of scenarios in A’ to ‘number of total scenarios’ amounts to sum the 
indicators over all omegaω contained in A and upper Omega commaΩ, respectively. The ratio has a frequency 
interpretation: in computing the likelihood of A to occur we divide the number of 
‘favorable’ outcomes by the number of total outcomes. 
2.5 
Operations on Random Variables 
It is possible to scale a rv and apply algebraic operations to two or more rvs, 
obtaining a new rv. 
Theorem 2.3 Let left parenthesis upper Omega comma script upper F right parenthesis(Ω, F) be an event space and let upper X comma upper YX, Y be two rvs deﬁned here. 
Then: 
1. .X + Y is a rv 
2. .αX is a rv, for any alpha element of double struck upper Rα ∈R
3. . X
Y is a rv, for any omega element of upper Omegaω ∈Ω such that upper Y left parenthesis omega right parenthesis not equals 0Y(ω) /= 0
8 See Exercise 2.7. 
38
2
Distribution of Random Variables
4. the maximum and minimum between rvs, upper X or upper Y colon equals max left brace upper X comma upper Y right braceX ∨Y := max{X, Y} and upper X and upper Y colon equals min left brace upper X comma upper Y right brace commaX ∧Y :=
min{X, Y}, is again a rv. 
Theorem 2.3 can be proved by showing that left brace upper X plus upper Y less than or slanted equals x right brace{X + Y ⩽x} is an event in script upper FF for every 
x element of double struck upper R commax ∈R, and similarly for scaling and division. For the maximum and minimum of 
rvs, one shows that for every x element of double struck upper Rx ∈R the event left brace upper X or upper Y less than or slanted equals x right brace{X∨Y ⩽x} equals left brace upper X less than or slanted equals x right brace intersection left brace upper Y less than or slanted equals x right brace{X ⩽x}∩{Y ⩽x}
and the event left brace upper X and upper Y less than or slanted equals x right brace{X ∧Y ⩽x} equals left brace upper X less than or slanted equals x right brace union left brace upper Y less than or slanted equals x right brace{X ⩽x} ∪{Y ⩽x}. Theorem 2.3 yields the 
following consequences. Items 1 and 2 imply that a multiple integer of X is again a 
rv: n upper XnX for n element of double struck upper Nn ∈N. By item 3 with upper X equals 1X = 1, reciprocal StartFraction 1 Over upper Y EndFraction1
Y is a rv. The constant function 
upper X colon upper Omega right arrow double struck upper RX : Ω →R with upper X left parenthesis omega right parenthesis equals cX(ω) = c for every scenarios omegaω and a ﬁxed c element of double struck upper Rc ∈R is a rv, usually 
called degenerate. By item 3, we can start from upper Y equals StartFraction 1 Over upper Z EndFractionY = 1
Z , for  a rv  Z over the same 
event space, and then get multiplication upper X upper YXY. The linear combination alpha upper X plus beta upper YαX + βY is a 
special case based on items 1 and 2. Taking beta equals 1 minus alphaβ = 1 −α for some 0 less than or slanted equals alpha less than or slanted equals 10 ⩽α ⩽1, the  
convex combination alpha upper X plus left parenthesis 1 minus alpha right parenthesis upper YαX +(1−α)Y as a new rv does not necessarily share the same 
distribution as the rv with mixed CDF alpha upper F Subscript upper X Baseline left parenthesis x right parenthesis plus left parenthesis 1 minus alpha right parenthesis upper F Subscript upper Y Baseline left parenthesis x right parenthesisαFX(x) + (1 −α)FY (x), i.e. in general 
upper F Subscript alpha upper X plus left parenthesis 1 minus alpha right parenthesis upper Y Baseline left parenthesis x right parenthesis not equals alpha upper F Subscript upper X Baseline left parenthesis x right parenthesis plus left parenthesis 1 minus alpha right parenthesis upper F Subscript upper Y Baseline left parenthesis x right parenthesis comma for all x element of double struck upper R and 0 less than or slanted equals alpha less than or slanted equals 1 periodFαX+(1−α)Y (x) /= αFX(x) + (1 −α)FY (x),
for all x ∈R and 0 ⩽α ⩽1.
Remark 2.8 (Mixed CDFs) Given two CDFs upper F Subscript upper X Baseline comma upper F Subscript upper Y BaselineFX, FY corresponding to rvs upper X comma upper YX, Y
deﬁned over the same probability space, the convex combination 
alpha upper F Subscript upper X Baseline left parenthesis x right parenthesis plus left parenthesis 1 minus alpha right parenthesis upper F Subscript upper Y Baseline left parenthesis x right parenthesisαFX(x) + (1 −α)FY (x)
(2.9) 
is a new CDF, for all x element of double struck upper Rx ∈R and 0 less than or slanted equals alpha less than or slanted equals 10 ⩽α ⩽1. In fact, we can check properties (a) to 
(d) of Theorem 2.1 in Sect. 2.1, see Exercise 2.13. 
The negative negative upper X−X, a special case of item 2, has interesting features for symmetric 
distributions (see Sect. 2.7). We can consider one more special case: the difference 
upper X minus upper YX−Y. Theorem 2.3 may be strengthen by considering more general transformations 
of rvs. 
Scalar-to-scalar. Given a rv  X we can always get a new rv through a suitable 
function9 g colon double struck upper R right arrow double struck upper Rg : R →R s.t. upper Y equals g left parenthesis upper X right parenthesisY = g(X), i.e. for each scenario omega element of upper Omegaω ∈Ω the scalar value 
upper Y left parenthesis omega right parenthesisY(ω) is obtained by evaluating g left parenthesis dot right parenthesisg( · ) at the scalar value upper X left parenthesis omega right parenthesisX(ω), see Table 2.3 
Vector-to-scalar. Given two rvs10 upper X comma upper YX, Y we can always get one new rv through a 
function h colon double struck upper R times double struck upper R right arrow double struck upper Rh : R × R →R s.t. upper Z equals h left parenthesis upper X comma upper Y right parenthesisZ = h(X, Y), i.e. for each scenario omega element of upper Omegaω ∈Ω the 
scalar value upper Z left parenthesis omega right parenthesisZ(ω) is obtained by evaluating h left parenthesis dot comma dot right parenthesish( · , · ) at left parenthesis upper X left parenthesis omega right parenthesis comma upper Y left parenthesis omega right parenthesis right parenthesis(X(ω), Y(ω)), a pair of 
two rvs, see Table 2.4. 
Sums h left parenthesis upper X comma upper Y right parenthesis equals upper X plus upper Yh(X, Y) = X + Y can be obtained by linear combinations with alpha equals 1α = 1 and 
beta equals 1β = 1; if beta equals negative 1β = −1 we have differences h left parenthesis upper X comma upper Y right parenthesis equals upper X minus upper Yh(X, Y) = X −Y. Convex combinations are 
special cases with 0 less than or slanted equals alpha less than or slanted equals 10 ⩽α ⩽1 and beta equals 1 minus alphaβ = 1 −α. Scalar-to-scalar and vector-to-scalar
9 Usually it is a continuous or even a differentiable function. 
10 Actually they form a pair left parenthesis upper X comma upper Y right parenthesis(X, Y) which may be thought as a function from upper OmegaΩ to the product 
space double struck upper R times double struck upper RR × R, see Chap. 3. 
2.5
Operations on Random Variables
39
Table 2.3 Elementary scalar-to-scalar transformations 
Exponential
normal e Superscript upper XeX or a Superscript upper XaX for any a greater than 0a > 0
Logarithmic
log upper Xlog X or log Subscript a Baseline upper Xloga X for any a greater than 0 comma a not equals 1a > 0, a /= 1 for all omega element of upper Omegaω ∈Ω with upper X left parenthesis omega right parenthesis greater than 0X(ω) > 0
Powers
upper X Superscript nXn with n element of double struck upper Nn ∈N
Root
upper X Superscript StartFraction 1 Over n EndFraction Baseline equals RootIndex n StartRoot upper X EndRootX
1
n =
n√
X with n element of double struck upper Nn ∈N for all omega element of upper Omegaω ∈Ω with upper X left parenthesis omega right parenthesis greater than or slanted equals 0X(ω) ⩾0
Linear
a plus b upper Xa + bX for a element of double struck upper Ra ∈R and b not equals 0b /= 0
Table 2.4 Elementary 
vector-to-scalar 
transformations 
Multiplication
upper X upper YXY
Division
StartFraction upper X Over upper Y EndFractionX
Y for all omega element of upper Omegaω ∈Ω with upper Y left parenthesis omega right parenthesis not equals 0Y(ω) /= 0
Linear combination
alpha upper X plus beta upper YαX + βY for alpha comma beta element of double struck upper Rα, β ∈R
Maximum and minimum 
max left brace upper X comma upper Y right brace commamax{X, Y}, min left brace upper X comma upper Y right bracemin{X, Y}
transformation can be properly combined. Other scalar-to-scalar transformations are 
sine upper Xsin X or cosine upper Xcos X, which we will use in the sequel (see Chap. 4). Two further examples 
of vector-to-scalar transformation are the following. 
• 
Negative part of a rv: take the maximum upper X Superscript minus Baseline colon equals max left brace 0 comma negative upper X right braceX−:= max{0, −X} where upper Y equals 0Y = 0 is a 
degenerate rv. It can be written minus min left brace 0 comma upper X right brace−min{0, X} or minus upper X bold upper I Subscript left brace upper X less than 0 right brace−XI{X<0}. 
• 
Positive part of a rv: take the maximum upper X Superscript plus Baseline colon equals max left brace 0 comma upper X right braceX+ := max{0, X}. It can be written 
upper X bold upper I Subscript left brace upper X greater than or slanted equals 0 right braceXI{X⩾0}. 
Vector-to-scalar transformation can be in the form upper Z equals h left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesisZ = h(X1, . . . , Xn), for  a  
suitable function h left parenthesis dot comma ellipsis comma dot right parenthesish( · , . . . , · ) and an n-dimensional vector of rvs left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesis(X1, . . . , Xn). 
Example 2.8 Asset prices and returns play important role in ﬁnance. Given a 
positive rv 11 upper S Subscript t plus 1 Baseline greater than 0St+1 > 0 modelling the left parenthesis t plus 1 right parenthesis(t + 1)-price, we known that upper S Subscript t plus 1 Baseline minus upper S Subscript tSt+1 −St, 
for integers t equals 0 comma 1 comma 2 comma ellipsist
= 0, 1, 2, . . ., represents either a random proﬁt or loss. Thus, 
r Subscript t plus 1 Baseline equals StartFraction upper S Subscript t plus 1 Baseline minus upper S Subscript t Baseline Over upper S Subscript t Baseline EndFraction equals StartFraction upper S Subscript t plus 1 Baseline Over upper S Subscript t Baseline EndFraction minus 1rt+1 =
St+1−St
St
=
St+1
St
−1 is the periodic random rate of return. In particular, 
StartFraction upper S Subscript t plus 1 Baseline Over upper S Subscript t Baseline EndFraction equals 1 plus r Subscript t plus 1 St+1
St
= 1 + rt+1 is called gross return. For  h greater than 0h > 0 small enough, upper R Subscript t plus h Baseline equals ln left parenthesis StartFraction upper S Subscript t plus h Baseline Over upper S Subscript t Baseline EndFraction right parenthesisRt+h = ln
⎛
St+h
St
⎞
is the log-return. From well known properties of historical returns, it holds upper R Subscript t plus 1 Baseline equals ln left parenthesis 1 plus r Subscript t plus 1 Baseline right parenthesis almost equals r Subscript t plus 1Rt+1 =
ln(1 + rt+1) ≈rt+1, because for time window left bracket t comma t plus 1 right bracket[t, t + 1] corresponding to one day, 
on week or at most one month the periodic return r Subscript t plus 1rt+1 is near to zero, and ln left parenthesis x right parenthesis almost equals 0ln(x) ≈0
iff x almost equals 1x ≈1. 
1. Arithmetic Return. Investing the total amount e V in t equals 0t = 0 we eventually get 
upper V left parenthesis 1 plus r 1 right parenthesis left parenthesis 1 plus r 2 right parenthesis midline horizontal ellipsis left parenthesis 1 plus r Subscript upper T Baseline right parenthesis equals upper V h left parenthesis r 1 comma r 2 comma ellipsis comma r Subscript upper T Baseline right parenthesis commaV (1 + r1)(1 + r2) · · · (1 + rT ) = V h(r1, r2, . . . , rT ),
by using compound interest for upper T greater than 1T > 1 years, e.g. upper T equals 365T = 365 yields a 1-year value.
11 Recall what this means: upper S Subscript t plus 1 Baseline left parenthesis omega right parenthesis greater than 0St+1(ω) > 0 for every scenario omega element of upper Omegaω ∈Ω. 
40
2
Distribution of Random Variables
2. Continuously Compounded Return. For instantaneous rate of returns the future 
value is 
upper V normal e Superscript upper R 1 Baseline normal e Superscript upper R 2 Baseline midline horizontal ellipsis normal e Superscript upper R Super Subscript upper T Superscript Baseline equals upper V normal e Superscript upper R 1 plus upper R 2 plus midline horizontal ellipsis plus upper R Super Subscript upper T Superscript Baseline equals upper V h left parenthesis upper R 1 comma upper R 2 comma ellipsis comma upper R Subscript upper T Baseline right parenthesis commaV eR1eR2 · · · eRT = V eR1+R2+···+RT = V h(R1, R2, . . . , RT ),
where upper R Subscript t plus 1 Baseline equals ln left parenthesis StartFraction upper S Subscript t plus 1 Baseline Over upper S Subscript t Baseline EndFraction right parenthesisRt+1 = ln
⎛
St+1
St
⎞
. 
3. Payoff of European options. Let upper S Subscript upper TST be a rv representing the future price of a stock 
underlying an European call option with maturity upper T greater than 0T > 0 and strike price upper K greater than 0K > 0, 
a ﬁxed amount known in advance. Call options are ﬁnancial products giving the 
right (but not the obligation) to buy an asset at K in T , the time when they expire. 
The value in T of this derivative instrument is max left brace 0 comma upper S Subscript upper T Baseline minus upper K right brace equals left parenthesis upper S Subscript upper T Baseline minus upper K right parenthesis Superscript plusmax{0, ST −K} = (ST −K)+, 
called payoff. The holder of an European call option12 can choose between: 
• 
exercises it, whenever upper S Subscript upper T Baseline greater than upper KST > K, since buying the stock for K and sell it for upper S Subscript upper TST
he earns a proﬁt upper S Subscript upper T Baseline minus upper K greater than 0ST −K > 0; 
• 
does not exercise it, if upper S Subscript upper T Baseline less than upper KST < K, as he can get the stock at a cheaper price on 
the market, and in this case there is a zero proﬁt. 
An European put option gives the right to sell the underlying stock at K, then its 
payoff is max left brace upper K minus upper S Subscript upper T Baseline comma 0 right brace equals left parenthesis upper K minus upper S Subscript upper T Baseline right parenthesis Superscript plusmax{K −ST , 0} = (K −ST )+. 
Example 2.9 In actuarial science, if upper X greater than 0X > 0 is a positive rv modelling a future loss, 
then the amount to be paid by the insurer when X is subject to a deductible s greater than 0s > 0 is 
max left brace upper X minus s comma 0 right brace equals left parenthesis upper X minus s right parenthesis Superscript plusmax{X −s, 0} = (X −s)+, also known as stop-loss function. 
Example 2.10 (Prices from Returns) Given the positive rv upper S Subscript t Baseline greater than 0St > 0 representing 
future stock prices, we can recover prices from returns. Using log-returns upper R Subscript tRt (see 
Example 2.8), the new rv 
upper S Subscript t plus 1 Baseline equals upper S Subscript t Baseline normal e Superscript upper R Super Subscript t plus 1St+1 = SteRt+1
represents future prices one period ahead, and are well deﬁned even if upper R Subscript t plus 1 Baseline left parenthesis omega right parenthesis less than 0Rt+1(ω) < 0
for some scenarios omega element of upper Omegaω ∈Ω. On the other hand, arithmetic returns would give 
upper S Subscript t plus 1 Baseline equals upper S Subscript t Baseline left parenthesis 1 plus r Subscript t plus 1 Baseline right parenthesis commaSt+1 = St(1 + rt+1),
which works well only when r Subscript t plus 1 Baseline left parenthesis omega right parenthesis greater than or slanted equals negative 1rt+1(ω) ⩾−1, for all scenarios. Observe what happen 
when we are in t: the  rv  upper S Subscript tSt becomes degenerate, i.e. it could be considered as a 
constant function. 
Example 2.11 (Portfolio Value) 
Portfolios are basket of different ﬁnancial assets, 
e.g. stocks, bonds, derivatives, etc.13 Assume we have n element of double struck upper Nn ∈N assets in the portfolio,
12 American options can be exercised before the maturity. Options are examples of contingent 
claims. 
13 These form the asset universe, where differences among assets are based on the degree of risk 
and other additional features. As a proxy of risk-free assets we can choose bank accounts or zero-
coupon bonds. 
2.6
Comparing Random Variables
41
with holdings h Subscript ihi, for  i equals 1 comma ellipsis comma ni = 1, . . . , n, e.g., number of units held in asset i, as shares 
of a given stock, money invested in a bank account, etc. From this we can deduce 
some interesting rvs as the portfolio value 
upper V Subscript t Baseline equals h 1 upper S Subscript 1 comma t Baseline plus midline horizontal ellipsis plus h Subscript n Baseline upper S Subscript n comma t Baseline comma for t equals 0 comma 1 comma 2 comma ellipsis comma upper T commaVt = h1S1,t + · · · + hnSn,t,
for t = 0, 1, 2, . . . , T,
and the arithmetic portfolio return in t plus 1t + 1
r Subscript p comma t plus 1 Baseline colon equals StartFraction upper V Subscript t plus 1 Baseline minus upper V Subscript t Baseline Over upper V Subscript t Baseline EndFraction equals StartFraction sigma summation Underscript i equals 1 Overscript n Endscripts h Subscript i Baseline upper S Subscript i comma t plus 1 Baseline minus sigma summation Underscript i equals 1 Overscript n Endscripts h Subscript i Baseline upper S Subscript i comma t Baseline Over sigma summation Underscript i equals 1 Overscript n Endscripts h Subscript i Baseline upper S Subscript i comma t Baseline EndFraction equals sigma summation Underscript i equals 1 Overscript n Endscripts w Subscript i Baseline r Subscript i comma t plus 1 Baseline commarp,t+1 := Vt+1 −Vt
Vt
=
∑n
i=1 hiSi,t+1 −∑n
i=1 hiSi,t
∑n
i=1 hiSi,t
=
n
⎲
i=1
wiri,t+1,
which is a linear combination of arithmetic asset returns with weights w Subscript i Baseline equals StartFraction h Subscript i Baseline upper S Subscript i comma t Baseline Over upper V Subscript t Baseline EndFractionwi = hiSi,t
Vt , 
implying sigma summation Underscript i equals 1 Overscript n Endscripts w Subscript i Baseline equals 1∑n
i=1 wi = 1. It is worth noting that each h Subscript i Baseline element of double struck upper Rhi ∈R and it can be thought 
as a degenerate rv, and also w Subscript i Baseline element of double struck upper Rwi ∈R are constant once we act on the time horizon 
t comma t plus 1t, t + 1 where upper S Subscript i comma tSi,t are known.14 
2.6 
Comparing Random Variables 
Two rvs as functions from upper OmegaΩ to double struck upper RR can be pointwise equal, i.e. upper X left parenthesis omega right parenthesis equals upper Y left parenthesis omega right parenthesisX(ω) = Y(ω)
for every scenario omega element of upper Omegaω ∈Ω. But as we have seen, what matters for rvs is their 
probability distribution, thus a different kind of comparison can be set up, compare 
with Sect. 1.3, Chap. 1. 
Deﬁnition 2.4 Two rvs upper X comma upper YX, Y over left parenthesis upper Omega comma script upper F right parenthesis(Ω, F) are almost surely equal, abbreviated 
upper X equals Overscript a period s period Endscripts upper YX a.s.
= Y iff the event left brace upper X equals upper Y right brace element of script upper F{X = Y} ∈F has probability 1. 
In some textbooks the above is also written upper X equals upper YX = Y sans serif upper PP-a.s. The fact that left brace upper X equals upper Y right brace{X = Y} is an 
event in script upper FF, and then has assigned a probability, is due to Theorem 2.3 guaranteeing 
left brace upper X equals upper Y right brace equals left brace upper X minus upper Y equals 0 right brace{X = Y} = {X −Y = 0}, i.e. upper X minus upper YX −Y is a rv. Observe that sans serif upper P left parenthesis upper X not equals upper Y right parenthesis equals 0P(X /= Y) = 0, where 
the events left brace upper X equals upper Y right brace{X = Y} and left brace upper X not equals upper Y right brace{X /= Y} form a partition of upper OmegaΩ. It could be the case that two 
rvs share the same probability law. 
Deﬁnition 2.5 Two rvs 
upper X comma upper YX, Y deﬁned over 
left parenthesis upper Omega comma script upper F right parenthesis(Ω, F) are equal in distribution, 
abbreviated upper X equals Overscript d Endscripts upper YX d= Y iff 
sans serif upper P left parenthesis upper X element of upper B right parenthesis equals sans serif upper P left parenthesis upper Y element of upper B right parenthesis commaP(X ∈B) = P(Y ∈B),
for every subset upper B subset of double struck upper RB ⊂R s.t. left brace upper X element of upper B right brace{X ∈B} and left brace upper Y element of upper B right brace{Y ∈B} are in script upper FF.
14 When h Subscript i Baseline greater than 0hi > 0 we have a long position on asset i (buy); h Subscript i Baseline less than 0hi < 0 means short selling, i.e. a trade in  
the market involving an asset which we do not hold in t, although it will be bought and delivered 
in t plus 1t + 1. 
42
2
Distribution of Random Variables
As usual, choosing upper B equals left parenthesis negative normal infinity comma x right bracketB = (−∞, x] we get the equivalent condition 
upper F Subscript upper X Baseline left parenthesis x right parenthesis equals upper F Subscript upper Y Baseline left parenthesis x right parenthesis comma for every x element of double struck upper R periodFX(x) = FY (x),
for every x ∈R.
Thus, for two rvs being equal in distribution the corresponding CDFs must be 
equal as numerical functions. When two rvs X and Y are equal in distribution all 
probability statements about them will be the same, but they can be different as 
functions. 
Example 2.12 (Actually...Counterexample) Assume that X is discrete with sup-
port upper C equals StartSet negative 1 comma 1 EndSetC = {−1, 1} and masses sans serif upper P left parenthesis upper X equals negative 1 right parenthesis equals sans serif upper P left parenthesis upper X equals 1 right parenthesis equals one halfP(X = −1) = P(X = 1) = 1
2, interpreted as a bet 
giving e 1 in case of win otherwise yielding a loss of minus−e 1, with equal probability. 
Let the rv upper Y equals negative upper XY = −X given by the negative of the bet. We have Y as a discrete rv with 
masses sans serif upper P left parenthesis upper Y equals 1 right parenthesis equals sans serif upper P left parenthesis upper Y equals negative 1 right parenthesis equals one halfP(Y = 1) = P(Y = −1) = 1
2. Hence we conclude upper X equals Overscript d Endscripts upper YX d= Y, but  X and Y 
are not equal because when upper X equals negative 1X = −1 the other is upper Y equals 1Y = 1 and vice versa. Moreover, 
sans serif upper P left parenthesis upper X equals upper Y right parenthesis equals 0P(X = Y) = 0 because left brace upper X equals 1 right brace equals left brace upper Y equals negative 1 right brace{X = 1} = {Y = −1} and left brace upper X equals negative 1 right brace equals left brace upper Y equals 1 right brace{X = −1} = {Y = 1} hence 
StartLayout 1st Row 1st Column 0 less than or slanted equals sans serif upper P left parenthesis upper X equals upper Y right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis left bracket left brace upper X equals 1 right brace intersection left brace upper Y equals 1 right brace right bracket union left bracket left brace upper X equals negative 1 right brace intersection left brace upper Y equals negative 1 right brace right bracket right parenthesis 2nd Row 1st Column Blank 2nd Column less than or slanted equals 3rd Column sans serif upper P left parenthesis left brace upper X equals 1 right brace intersection left brace upper Y equals 1 right brace right parenthesis plus sans serif upper P left parenthesis left brace upper X equals negative 1 right brace intersection left brace upper Y equals negative 1 right brace right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis empty set right parenthesis plus sans serif upper P left parenthesis empty set right parenthesis equals 0 period EndLayout0 ⩽P(X = Y) = P
⎛⎾
{X = 1} ∩{Y = 1}
⏋
∪
⎾
{X = −1} ∩{Y = −1}
⏋⎞
⩽P ({X = 1} ∩{Y = 1}) + P ({X = −1} ∩{Y = −1})
= P(∅) + P(∅) = 0.
Other comparisons between two rvs involve inequalities, for example upper X less than or slanted equals upper YX ⩽Y
pointwise or upper X less than or slanted equals upper YX ⩽Y sans serif upper PP-a.s. A different kind of inequalities comes into play when 
Deﬁnition 2.5 does not hold. In fact, by considering a suitable class of CDFs of rvs 
deﬁned over the same probability space we have:15 
Deﬁnition 2.6 (Usual Stochastic Order) X is said to be smaller than Y in the 
usual stochastic order, written upper X less than or slanted equals Subscript st Baseline upper YX ⩽st Y, if  
upper F Subscript upper X Baseline left parenthesis x right parenthesis greater than or slanted equals upper F Subscript upper Y Baseline left parenthesis x right parenthesis comma for every x element of double struck upper R periodFX(x) ⩾FY (x),
for every x ∈R.
(2.10) 
This is pointwise comparison of CDFs. Despite the inequality between CDFs should 
be counterintuitive, Deﬁnition 2.6 means that Y assumes large values with higher 
probability than X does. Since upper F Subscript upper X Baseline left parenthesis x right parenthesis greater than or slanted equals upper F Subscript upper Y Baseline left parenthesis x right parenthesisFX(x) ⩾FY (x), we can choose x 1 less than x 2x1 < x2 such that 
sans serif upper P left parenthesis upper X less than or slanted equals x 1 right parenthesis equals sans serif upper P left parenthesis upper Y less than or slanted equals x 2 right parenthesisP(X ⩽x1) = P(Y ⩽x2), then by increasing x 2x2 we get larger values of Y with more 
probability (recall that a CDF is nondecreasing). The usual stochastic order is also 
called ﬁrst order stochastic dominance, and alternatively denoted upper X precedes or equal to Subscript FSD Baseline upper YX ≼FSD Y. It can  
be shown that upper X less than or slanted equals Subscript st Baseline upper YX ⩽st Y is equivalent to have upper X less than or slanted equals upper YX ⩽Y pointwise or sans serif upper P left parenthesis upper X less than or slanted equals upper Y right parenthesis equals 1P(X ⩽Y) = 1. If  
we deﬁne 
ModifyingAbove upper F With bar Subscript upper X Baseline left parenthesis x right parenthesis colon equals 1 minus upper F Subscript upper X Baseline left parenthesis x right parenthesis equals 1 minus sans serif upper P left parenthesis upper X less than or slanted equals x right parenthesis equals sans serif upper P left parenthesis upper X greater than x right parenthesis comma ¯FX(x) := 1 −FX(x) = 1 −P(X ⩽x) = P(X > x),
(2.11)
15 Over this class of CDFs, namely script upper DD, one can deﬁne a partial order, i.e. a binary relation precedes or equal to≼
between couples of CDFs which is reﬂexive, upper F Subscript upper X Baseline precedes or equal to upper F Subscript upper XFX ≼FX for all upper F Subscript upper X Baseline element of script upper DFX ∈D, antisymmetric, if upper F Subscript upper X Baseline precedes or equal to upper F Subscript upper YFX ≼FY
and upper F Subscript upper Y Baseline precedes or equal to upper F Subscript upper XFY ≼FX then upper F Subscript upper X Baseline equals upper F Subscript upper YFX = FY , transitive, if upper F Subscript upper X Baseline precedes or equal to upper F Subscript upper YFX ≼FY and upper F Subscript upper Y Baseline precedes or equal to upper F Subscript upper ZFY ≼FZ then upper F Subscript upper X Baseline precedes or equal to upper F Subscript upper ZFX ≼FZ. 
2.7
Symmetric Probability Laws
43
called survival function, then Deﬁnition 2.6 is equivalent to ModifyingAbove upper F With bar Subscript upper X Baseline left parenthesis x right parenthesis less than or slanted equals ModifyingAbove upper F With bar Subscript upper Y Baseline left parenthesis x right parenthesis ¯FX(x) ⩽¯FY (x) for all 
real x. The usual stochastic order is only partial, for it could be the case upper F Subscript upper X Baseline left parenthesis x 0 right parenthesis greater than or slanted equals upper F Subscript upper Y Baseline left parenthesis x 0 right parenthesisFX(x0) ⩾
FY (x0) for some x 0 element of double struck upper Rx0 ∈R and upper F Subscript upper X Baseline left parenthesis x right parenthesis less than upper F Subscript upper Y Baseline left parenthesis x right parenthesisFX(x) < FY (x) for the remaining x element of double struck upper Rx ∈R, where x 0x0 is 
a crossing point of the two CDFs graphs. 
Example 2.13 Let X be the strike price upper K greater than 0K > 0 of an European call option. It 
can be viewed as a degenerate rv upper X left parenthesis omega right parenthesis equals upper KX(ω) = K for every scenario omega element of upper Omegaω ∈Ω, and its 
probability distribution can be represented by a Dirac delta delta Subscript upper K Baseline left parenthesis upper B right parenthesisδK(B), for all suitable 
upper B subset of double struck upper RB ⊂R. Now, suppose we have two such options and corresponding strike prices 
upper K 1 comma upper K 2K1, K2. Thus, degenerate rvs upper X equals upper K 1X = K1 and upper Y equals upper K 2Y = K2 have distributions in usual 
stochastic order delta Subscript upper K 1 Baseline precedes or equal to Subscript FSD Baseline delta Subscript upper K 2δK1 ≼FSD δK2 iff upper K 1 less than or slanted equals upper K 2K1 ⩽K2, In fact, delta Subscript upper K 1 Baseline left parenthesis left parenthesis negative normal infinity comma x right bracket right parenthesis equals upper F Subscript upper X Baseline left parenthesis x right parenthesisδK1((−∞, x]) = FX(x) and 
delta Subscript upper K 2 Baseline left parenthesis left parenthesis negative normal infinity comma x right bracket right parenthesis equals upper F Subscript upper Y Baseline left parenthesis x right parenthesisδK2((−∞, x]) = FY (x), then upper F Subscript upper X Baseline left parenthesis x right parenthesis greater than or slanted equals upper F Subscript upper Y Baseline left parenthesis x right parenthesisFX(x) ⩾FY (x) for all x element of double struck upper Rx ∈R. Indeed, this should be 
write upper F Subscript upper X Baseline left parenthesis x right parenthesis equals bold upper I Subscript left brace upper K 1 less than or slanted equals x right braceFX(x) = I{K1 ⩽x} and similarly upper F Subscript upper Y Baseline left parenthesis x right parenthesis equals bold upper I Subscript left brace upper K 2 less than or slanted equals x right braceFY (x) = I{K2 ⩽x}, or also upper F Subscript upper X Baseline left parenthesis x right parenthesis equals u left parenthesis x minus upper K 1 right parenthesisFX(x) = u(x −K1)
and upper F Subscript upper Y Baseline left parenthesis x right parenthesis equals u left parenthesis x minus upper K 2 right parenthesisFY (x) = u(x −K2), see Sect. 2.4. 
Since less than or slanted equals Subscript st Baseline⩽st is only a partial order, it could be the case that two rvs representing 
uncertain outcomes (viz. future values) of risky assets cannot be compared under 
this stochastic order. In such a situation, a risk-adverse decision maker would prefer 
the rv with lower variability. We say that X is less than Y in the second order 
stochastic dominance, written upper X precedes or equal to Subscript SSD Baseline upper YX ≼SSD Y, or  increasing concave order, denoted 
upper X less than or slanted equals Subscript icv Baseline upper YX ⩽icv Y, if  
integral Subscript negative normal infinity Superscript x Baseline upper F Subscript upper X Baseline left parenthesis u right parenthesis normal d u greater than or slanted equals integral Subscript negative normal infinity Superscript x Baseline upper F Subscript upper Y Baseline left parenthesis u right parenthesis normal d u for all x element of double struck upper R period
⨜x
−∞
FX(u)du ⩾
⨜x
−∞
FY (u)du
for all x ∈R.
(2.12) 
For continuous rvs, this stochastic order has a geometric interpretation: when less than or slanted equals Subscript st Baseline⩽st
fails to hold and the CDFs’ graphs have at least one crossing point, say x 0 element of double struck upper Rx0 ∈R, then 
condition (2.12) can be written 
integral Subscript negative normal infinity Superscript x 0 Baseline left parenthesis upper F Subscript upper X Baseline left parenthesis u right parenthesis minus upper F Subscript upper Y Baseline left parenthesis u right parenthesis right parenthesis normal d u greater than or slanted equals 0 comma
⨜x0
−∞
(FX(u) −FY (u))du ⩾0,
i.e., the upper F Subscript upper XFX’s graph is above that of upper F Subscript upper YFY up to x 0x0, hence the area between the two 
curves is positive up to this point. Moreover, the contribution of the negative area 
computed as 
integral Subscript x 0 Superscript x Baseline left parenthesis upper F Subscript upper X Baseline left parenthesis u right parenthesis minus upper F Subscript upper Y Baseline left parenthesis u right parenthesis right parenthesis normal d u less than or slanted equals 0 comma for every x greater than or slanted equals x 0 comma
⨜x
x0
(FX(u) −FY (u))du ⩽0,
for every x ⩾x0,
is negligible with respect to the ﬁrst, see Fig. 2.3. 
2.7 
Symmetric Probability Laws 
Let upper S Subscript upper TST be the rv representing a future stock price, given the initial price upper S 0S0. As we  
have seen, upper X equals upper S Subscript upper T Baseline minus upper S 0X = ST −S0 is a model for proﬁts and losses, provided that we invest 
in the stock. A reasonable assumption should be assigning different probabilities to
44
2
Distribution of Random Variables
Fig. 2.3 
upper F Subscript upper XFX doe not always 
dominates upper F Subscript upper YFY , but  the area on  
the left (plus+) is greater than 
that on the right (minus−) 
upper X Superscript plusX+ and upper X Superscript minusX−, and indeed this is the typical situation for realized values of X over a 
ﬁxed time horizon left bracket 0 comma upper T right bracket[0, T ]. 
Deﬁnition 2.7 A rv  X is called symmetric (or symmetrically distributed) around 
a element of double struck upper Ra ∈R if 
sans serif upper P left parenthesis upper X less than or slanted equals a minus x right parenthesis equals sans serif upper P left parenthesis upper X greater than or slanted equals a plus x right parenthesis comma for every x element of double struck upper R periodP(X ⩽a −x) = P(X ⩾a + x),
for every x ∈R.
(2.13) 
If the X’s support is strictly contained in double struck upper RR, then a element of double struck upper Ra ∈R not necessarily belongs to 
it. Using the deﬁnition of CDF upper F Subscript upper X Baseline left parenthesis dot right parenthesis equals sans serif upper P left parenthesis upper X less than or slanted equals dot right parenthesisFX( · ) = P(X ⩽·) and considering its left-limit 
upper F Subscript upper X Baseline left parenthesis dot Superscript minus Baseline right parenthesis equals sans serif upper P left parenthesis upper X less than dot right parenthesis equals 1 minus sans serif upper P left parenthesis upper X greater than or slanted equals dot right parenthesisFX( · −) = P(X < ·) = 1 −P(X ⩾·), for a symmetric X we have16 
StartLayout 1st Row 1st Column upper F Subscript upper X Baseline left parenthesis a minus x right parenthesis 2nd Column equals 3rd Column 1 minus sans serif upper P left parenthesis upper X less than a plus x right parenthesis equals 1 minus upper F Subscript upper X Baseline left parenthesis left parenthesis a plus x right parenthesis Superscript minus Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column long left right double arrow 3rd Column upper F Subscript upper X Baseline left parenthesis a minus x right parenthesis plus upper F Subscript upper X Baseline left parenthesis a plus x Superscript minus Baseline right parenthesis equals 1 comma for every x element of double struck upper R period EndLayoutFX(a −x)
=
1 −P(X < a + x) = 1 −FX((a + x)−)
⇐⇒FX(a −x) + FX(a + x−) = 1,
for every x ∈R. (2.14) 
As byproduct, two conditions for symmetric probability distributions around a ﬁxed 
point a element of double struck upper Ra ∈R are: 
• 
Discrete rvs, 
sans serif upper P left parenthesis upper X equals a minus x right parenthesis equals sans serif upper P left parenthesis upper X equals a plus x right parenthesisP(X = a −x) = P(X = a + x) , for all x element of double struck upper Rx ∈R; 
• 
Absolutely Continuous rvs, 
f Subscript upper X Baseline left parenthesis a minus x right parenthesis equals f Subscript upper X Baseline left parenthesis a plus x right parenthesisfX(a −x) = fX(a + x) , for all x element of double struck upper Rx ∈R. 
The second condition is obtained by the chain rule of differentiation: we differentiate 
upper F Subscript upper X Baseline left parenthesis g left parenthesis x right parenthesis right parenthesisFX(g(x)) where g left parenthesis x right parenthesis equals a minus xg(x) = a −x, thus StartFraction normal d Over normal d x EndFraction upper F Subscript upper X Baseline left parenthesis g left parenthesis x right parenthesis right parenthesis equals upper F prime Subscript upper X Baseline left parenthesis g left parenthesis x right parenthesis right parenthesis g prime left parenthesis x right parenthesis d
dx FX(g(x)) = F '
X(g(x))g'(x) with g prime left parenthesis x right parenthesis equals negative 1g'(x) =
−1, and similarly for g left parenthesis x right parenthesis equals a plus xg(x) = a + x. Observe that upper F Subscript upper X Baseline left parenthesis a plus x Superscript minus Baseline right parenthesis equals upper F Subscript upper X Baseline left parenthesis a plus x right parenthesisFX(a + x−) = FX(a + x) for 
continuous distributions. Therefore, symmetry around zero is respectively: 
• 
.P(X = −x) = P(X = x), for all x element of double struck upper Rx ∈R; 
• 
.fX(−x) = fX(x), for all x element of double struck upper Rx ∈R, i.e. the density need not to be an even function. 
For symmetric distributions the rvs a minus upper Xa −X and upper X minus aX −a have the same probability law, 
a minus upper X equals Overscript d Endscripts upper X minus aa −X d= X −a . The precise reasoning is the following. Let X be symmetrically 
distributed around a element of double struck upper Ra ∈R, then condition (2.14) holds. Observe that upper X minus aX −a has CDF 
upper F Subscript upper X minus a Baseline left parenthesis x right parenthesis equals sans serif upper P left parenthesis upper X minus a less than or slanted equals x right parenthesis equals sans serif upper P left parenthesis upper X less than or slanted equals a plus x right parenthesis equals upper F Subscript upper X Baseline left parenthesis a plus x right parenthesis periodFX−a(x) = P(X −a ⩽x) = P(X ⩽a + x) = FX(a + x).
16 Observe that left parenthesis a plus x right parenthesis Superscript minus Baseline equals limit Underscript h down arrow 0 Endscripts left parenthesis a plus x right parenthesis minus h equals limit Underscript h down arrow 0 Endscripts a plus left parenthesis x minus h right parenthesis equals a plus x Superscript minus(a + x)−= limh↓0(a + x) −h = limh↓0 a + (x −h) = a + x−, for h greater than 0h > 0. 
2.8
Quantile Function
45
Now, a minus upper Xa −X has CDF 
StartLayout 1st Row 1st Column upper F Subscript a minus upper X Baseline left parenthesis x right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis a minus upper X less than or slanted equals x right parenthesis equals sans serif upper P left parenthesis upper X greater than or slanted equals a minus x right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column 1 minus sans serif upper P left parenthesis upper X less than a minus x right parenthesis equals 1 minus upper F Subscript upper X Baseline left parenthesis left parenthesis a minus x right parenthesis Superscript minus Baseline right parenthesis period EndLayoutFa−X(x) = P(a −X ⩽x) = P(X ⩾a −x)
= 1 −P(X < a −x) = 1 −FX((a −x)−).
Since we found that upper F Subscript upper X Baseline left parenthesis left parenthesis a minus x right parenthesis Superscript minus Baseline right parenthesis equals upper F Subscript upper X Baseline left parenthesis a minus x Superscript plus Baseline right parenthesisFX((a −x)−) = FX(a −x+) and the symmetry condition can 
be equivalently written upper F Subscript upper X Baseline left parenthesis a minus x Superscript plus Baseline right parenthesis plus upper F Subscript upper X Baseline left parenthesis a plus x right parenthesis equals 1FX(a −x+) + FX(a + x) = 1, which implies upper F Subscript upper X Baseline left parenthesis a plus x right parenthesis equals 1 minus upper F Subscript upper X Baseline left parenthesis a minus x Superscript plus Baseline right parenthesisFX(a + x) =
1 −FX(a −x+), we conclude upper F Subscript a minus upper X Baseline left parenthesis x right parenthesis equals upper F Subscript upper X Baseline left parenthesis a plus x right parenthesisFa−X(x) = FX(a + x) for every a element of double struck upper Ra ∈R and thus 
a minus upper X equals Overscript d Endscripts upper X minus aa −X d= X −a as required, see Appendix. 
Remark 2.9 (Stylized Facts Part 1) 
Since prices can be recovered from returns 
(see Sect. 2.5, Example 2.11), when we face the task of building a model for random 
stock prices some well known statistical properties of historical returns can be taken 
into account. Thus, being upper R Subscript t plus 1 Baseline equals ln left parenthesis StartFraction upper S Subscript t plus 1 Baseline Over upper S Subscript t Baseline EndFraction right parenthesisRt+1 = ln
⎛
St+1
St
⎞
the rv modelling log-returns over the 
time horizon left bracket t comma t plus 1 right bracket[t, t + 1], we have:  
• 
The probability distribution sans serif upper P Subscript upper R Sub Subscript t plus 1PRt+1 is not symmetric; 
• 
.PRt+1 has fatter tails. 
In ﬁnancial applications, these two features are synonymous of not symmetrically 
distributed rvs. E.g., if sans serif upper P Subscript upper R Sub Subscript t plus 1PRt+1 is absolutely continuous with density f Subscript upper R Sub Subscript t plus 1fRt+1, then the 
latter need not to be an even function. 
2.8 
Quantile Function 
For a given rv X it could be useful to start with a probability level c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1) from the 
y-axis of the corresponding upper F Subscript upper XFX’s plot, and obtain possibly a value x in the support. 
Deﬁnition 2.8 The cth quantile of the distribution sans serif upper P Subscript upper XPX is 
upper Q Subscript upper X Baseline left parenthesis c right parenthesis colon equals inf left brace x element of double struck upper R vertical bar upper F Subscript upper X Baseline left parenthesis x right parenthesis greater than or slanted equals c right brace comma for every 0 less than c less than 1 periodQX(c) := inf{x ∈R | FX(x) ⩾c},
for every 0 < c < 1.
(2.15) 
By convention upper Q Subscript upper X Baseline left parenthesis 0 right parenthesis equals negative normal infinity periodQX(0) = −∞. The quantile function upper Q colon left parenthesis 0 comma 1 right parenthesis right arrow double struck upper RQ : (0, 1) →R is given by 
formula (2.15) as the probability level c varies. 
Sometimes upper Q Subscript upper X Baseline left parenthesis c right parenthesisQX(c) is written q Subscript cqc or upper F Subscript upper X Superscript left arrow Baseline left parenthesis c right parenthesisF ←
X (c). 
Remark 2.10 (Features of the Quantile Function) The behavior of 
upper Q Subscript upper X Baseline left parenthesis c right parenthesisQX(c)
depends upon the functional form of the CDF, see Figs. 2.4 and 2.5. 
• 
When upper F Subscript upper XFX is strictly increasing and continuous (i.e. 1-to-1 ) then upper Q Subscript upper X Baseline left parenthesis c right parenthesisQX(c) is just 
the inverse function upper F Subscript upper X Superscript negative 1 Baseline left parenthesis c right parenthesisF −1
X (c) of the CDF and we have upper Q Subscript upper X Baseline left parenthesis c right parenthesis equals xQX(c) = x where x is 
the unique value in the X’s support mapped to c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1) by upper F Subscript upper XFX. In this case 
StartSet x element of double struck upper R vertical bar upper F Subscript upper X Baseline left parenthesis x right parenthesis greater than or slanted equals c EndSet{x ∈R | FX(x) ⩾c} is the same set as StartSet x element of double struck upper R vertical bar x greater than or slanted equals upper F Subscript upper X Superscript negative 1 Baseline left parenthesis c right parenthesis EndSet{x ∈R | x ⩾F −1
X (c)}.
46
2
Distribution of Random Variables
Fig. 2.4 CDF with a ﬂat on 
left parenthesis 0 comma b right parenthesis(0, b) and a jump 
Fig. 2.5 
upper Q Subscript upper XQX’s graph has a 
left-continuity point at the 
upper F Subscript upper XFX’s jump. The upper F Subscript upper XFX’s ﬂat is 
now the upper Q Subscript upper XQX’s jump 
• 
If the probability level c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1) is crossed by the horizontal line upper F Subscript upper X Baseline left parenthesis x right parenthesis equals cFX(x) = c
whose intersection with the upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x)’s plot is a ﬂat part of the graph, for any x in 
an open interval left parenthesis a comma b right parenthesis(a, b) with ﬁnite endpoints, then upper Q Subscript upper X Baseline left parenthesis c right parenthesisQX(c) is the leftmost point of 
this interval. 
• 
A value c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1) not corresponding to a value of the CDF (i.e. there is no x element of double struck upper Rx ∈R
s.t. upper F Subscript upper X Baseline left parenthesis x right parenthesis equals cFX(x) = c) yields upper Q Subscript upper X Baseline left parenthesis c right parenthesisQX(c) as the smallest value in the x-axis mapped to a 
probability level at least equal to c. This is veriﬁed when c is in between a jump 
of upper F Subscript upper XFX. 
CDFs and quantiles are linked by construction. 
Proposition 2.2 Let upper Q Subscript upper X Baseline left parenthesis c right parenthesisQX(c) be the quantile function corresponding to a CDF 
upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x). Then: 
1. .QX(FX(x)) ⩽x, for all x element of double struck upper Rx ∈R
2. .FX(QX(c)) ⩾c, for all c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1)
3. .QX(c) ⩽x if and only if upper F Subscript upper X Baseline left parenthesis x right parenthesis greater than or slanted equals cFX(x) ⩾c
4. .QX(c) is increasing.17 
Remark 2.11 It is worth noting that continuity of upper F Subscript upper XFX implies upper Q Subscript upper XQX is increasing, 
and vice versa. Moreover, upper F Subscript upper XFX is strictly increasing iff upper Q Subscript upper XQX is continuous; strictly
17 This means: c 1 less than c 2c1 < c2 implies upper Q Subscript upper X Baseline left parenthesis c 1 right parenthesis less than or slanted equals upper Q Subscript upper X Baseline left parenthesis c 2 right parenthesisQX(c1) ⩽QX(c2). If the latter inequality is strict, then quantile 
functions are strictly increasing. 
2.8
Quantile Function
47
monotonicity of upper F Subscript upper XFX implies upper Q Subscript upper X Baseline left parenthesis upper F Subscript upper X Baseline left parenthesis x right parenthesis right parenthesis equals xQX(FX(x)) = x. Eventually, continuity of upper Q Subscript upper XQX implies 
upper F Subscript x Baseline left parenthesis upper Q Subscript upper X Baseline left parenthesis c right parenthesis right parenthesis equals cFx(QX(c)) = c. 
Moreover, as for upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x) the quantile function upper Q Subscript upper X Baseline left parenthesis c right parenthesisQX(c) determines the distribution of 
a rv  X. 
Lemma 2.1 Let X and Y be two rvs over the same probability space left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis period(Ω, F, P). Let 
upper Q Subscript upper X Baseline left parenthesis c right parenthesis comma upper Q Subscript upper Y Baseline left parenthesis c right parenthesisQX(c), QY (c) be their quantile functions. If upper Q Subscript upper X Baseline left parenthesis c right parenthesis equals upper Q Subscript upper Y Baseline left parenthesis c right parenthesisQX(c) = QY (c) for every c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1), 
then X and Y have the same distribution, i.e. upper X equals Overscript d Endscripts upper YX d= Y. 
Remark 2.12 There are some interesting interpretation of quantile functions when 
computed for certain values of c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1). 
• 
When upper F Subscript upper XFX is absolutely continuous with density f Subscript upper XfX, then a large value c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1)
of the probability level (e.g. c equals 0.95c = 0.95 or 95%) with a corresponding positive large 
value upper Q Subscript upper X Baseline left parenthesis c right parenthesisQX(c) gives raise to a long right-tail of the density. Similarly, a small value 
c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1) of the probability level (e.g. c equals 0.05c = 0.05 or 5%) with a corresponding 
negative large value upper Q Subscript upper X Baseline left parenthesis c right parenthesisQX(c) gives raise to a long left-tail of the density. 
• 
The special case c equals one halfc = 1
2 (50% of probability level) yields the median upper Q Subscript upper X Baseline left parenthesis one half right parenthesisQX( 1
2), also  
written sans serif m e d left parenthesis upper X right parenthesismed(X). 
• 
.QX( 1
4) is called the ﬁrst quartile, and upper Q Subscript upper X Baseline left parenthesis three fourths right parenthesisQX( 3
4) is the third quartile. Obviously, 
sans serif m e d left parenthesis upper X right parenthesismed(X) is the second quartile. 
The median sans serif m e d left parenthesis upper X right parenthesismed(X) is the number m element of double struck upper Rm ∈R satisfying 
sans serif upper P left parenthesis upper X less than or slanted equals m right parenthesis greater than or slanted equals one half and sans serif upper P left parenthesis upper X greater than or slanted equals m right parenthesis greater than or slanted equals one half periodP(X ⩽m) ⩾1
2
and
P(X ⩾m) ⩾1
2.
(2.16) 
Here m equals sans serif m e d left parenthesis upper X right parenthesism = med(X) is a measure of the center of the distribution sans serif upper P Subscript upper XPX, since there 
is a 50% of probability that X will exceed m. Actually, the median represents a 
value that splits sans serif upper P Subscript upper XPX into two halves. It is not necessarily unique, unless upper F Subscript upper XFX is 1-to-
1. Writing sans serif upper P left parenthesis upper X greater than or slanted equals m right parenthesis equals 1 minus sans serif upper P left parenthesis upper X less than m right parenthesis greater than or slanted equals one halfP(X ⩾m) = 1 −P(X < m) ⩾1
2 we get sans serif upper P left parenthesis upper X less than m right parenthesis less than or slanted equals one halfP(X < m) ⩽1
2 which leads to 
the equivalent condition 
upper F Subscript upper X Baseline left parenthesis m minus right parenthesis less than or slanted equals one half less than or slanted equals upper F Subscript upper X Baseline left parenthesis m right parenthesis periodFX(m−) ⩽1
2 ⩽FX(m).
(2.17) 
If upper F Subscript upper XFX is continuous it holds upper F Subscript upper X Baseline left parenthesis m minus right parenthesis equals upper F Subscript upper X Baseline left parenthesis m right parenthesis equals one halfFX(m−) = FX(m) = 1
2. As a result, the c-quantile 
given by Eq. (2.15) can be equivalently deﬁned as 
sans serif upper P left parenthesis upper X less than upper Q Subscript upper X Baseline left parenthesis c right parenthesis right parenthesis less than or slanted equals c less than or slanted equals sans serif upper P left parenthesis upper X less than or slanted equals upper Q Subscript upper X Baseline left parenthesis c right parenthesis right parenthesis periodP(X < QX(c)) ⩽c ⩽P(X ⩽QX(c)).
(2.18) 
We conclude this section by noting that for any increasing function f colon double struck upper R right arrow double struck upper Rf : R →R, 
event left brace upper X less than or slanted equals x right brace{X ⩽x}, for  a ﬁxed x element of double struck upper Rx ∈R, is a strict subset of left brace f left parenthesis upper X right parenthesis less than or slanted equals f left parenthesis x right parenthesis right brace{f (X) ⩽f (x)}. For example, 
let upper Omega equals left parenthesis 0 comma 1 right bracketΩ = (0, 1] and consider the rv upper X left parenthesis omega right parenthesis equals xX(ω) = x, for every omega element of upper Omegaω ∈Ω, then take f left parenthesis upper X left parenthesis omega right parenthesis right parenthesis equals 2 upper X left parenthesis omega right parenthesis bold upper I Subscript left brace omega less than one fourth right brace Baseline plus one half bold upper I Subscript left brace one fourth less than or slanted equals omega less than one half right brace Baseline plus upper X left parenthesis omega right parenthesis bold upper I Subscript left brace one half less than or slanted equals omega less than or slanted equals 1 right bracef (X(ω)) =
2X(ω)I{ω< 1
4 } + 1
2I{ 1
4  ⩽ω< 1
2 } + X(ω)I{ 1
2  ⩽ω ⩽1}, and observe that left brace upper X less than or slanted equals one fourth right brace equals left parenthesis 0 comma one fourth right bracket{X ⩽1
4} = (0, 1
4], 
while left brace 2 upper X less than or slanted equals one half right brace equals left parenthesis 0 comma one half right parenthesis{2X ⩽1
2} = (0, 1
2). Only when f is strictly increasing we have left brace upper X less than or slanted equals x right brace equals left brace f left parenthesis upper X right parenthesis less than or slanted equals f left parenthesis x right parenthesis right brace{X ⩽x} =
48
2
Distribution of Random Variables
{f (X) ⩽f (x)}. Moreover, left brace upper X less than or slanted equals x right brace{X ⩽x} and left brace f left parenthesis upper X right parenthesis equals f left parenthesis x right parenthesis right brace intersection left brace upper X greater than x right brace{f (X) = f (x)} ∩{X > x} are disjoint, 
then it is easily seen that 
sans serif upper P left parenthesis f left parenthesis upper X right parenthesis less than or slanted equals f left parenthesis x right parenthesis right parenthesis equals sans serif upper P left parenthesis upper X less than or slanted equals x right parenthesis plus sans serif upper P left parenthesis left brace f left parenthesis upper X right parenthesis equals f left parenthesis x right parenthesis right brace intersection left brace upper X greater than x right brace right parenthesis periodP(f (X) ⩽f (x)) = P(X ⩽x) + P({f (X) = f (x)} ∩{X > x}).
(2.19) 
Now, for a CDF it holds sans serif upper P left parenthesis left brace upper F Subscript upper X Baseline left parenthesis upper X right parenthesis equals upper F Subscript upper X Baseline left parenthesis x right parenthesis right brace intersection left brace upper X greater than x right brace right parenthesis equals 0P({FX(X) = FX(x)} ∩{X > x}) = 0 since the underlying 
event corresponds to a ﬂat of the CFD’s graph, then it must have zero probability. 
As a consequence, for any rv X the set of values x element of double struck upper Rx ∈R s.t. upper Q Subscript upper X Baseline left parenthesis upper F Subscript upper X Baseline left parenthesis x right parenthesis right parenthesis not equals xQX(FX(x)) /= x is again 
a ﬂat and we have: 
sans serif upper P left parenthesis upper Q Subscript upper X Baseline left parenthesis upper F Subscript upper X Baseline left parenthesis upper X right parenthesis right parenthesis equals upper X right parenthesis equals 1 commaP(QX(FX(X)) = X) = 1,
(2.20) 
in words upper Q Subscript upper X Baseline left parenthesis upper F Subscript upper X Baseline left parenthesis upper X right parenthesis right parenthesis equals Overscript a period s period Endscripts upper XQX(FX(X)) a.s.
= X. Eventually: 
Proposition 2.3 Let X be a rv and f colon double struck upper R right arrow double struck upper Rf
: R →R be an increasing and left-
continuous function (or strictly increasing instead). Then, the new rv f left parenthesis upper X right parenthesisf (X) has 
quantile function 
upper Q Subscript f left parenthesis upper X right parenthesis Baseline left parenthesis c right parenthesis equals f left parenthesis upper Q Subscript upper X Baseline left parenthesis c right parenthesis right parenthesis commaQf (X)(c) = f (QX(c)),
(2.21) 
for every probability level c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1). 
2.9 
Mixed Random Variables and Distributions 
In some ﬁnancial and actuarial applications, we can deﬁne rvs having a probability 
law characterized by CDFs which are convex combination of discrete and absolutely 
continuous CDFs. The corresponding rvs are called mixed rvs. Before we show the 
exact construction, it is useful to know that a convex combination of two distinct 
probability measure is a probability measure too. 
Remark 2.13 Given a random experiment modelled via left parenthesis upper Omega comma script upper F right parenthesis(Ω, F), let us introduce 
two different probability functions sans serif upper P 1 comma sans serif upper P 2P1, P2 together with a number 0 less than or slanted equals alpha less than or slanted equals 10 ⩽α ⩽1. The  
set function 
sans serif upper P left parenthesis upper A right parenthesis colon equals alpha sans serif upper P 1 left parenthesis upper A right parenthesis plus left parenthesis 1 minus alpha right parenthesis sans serif upper P 2 left parenthesis upper A right parenthesis comma for each upper A element of script upper FP(A) := αP1(A) + (1 −α)P2(A),
for each A ∈F
is actually a probability function. We only have to show the above sans serif upper P left parenthesis dot right parenthesisP( · ) satisﬁes 
Deﬁnition 1.3 of Sect. 1.3, i.e. it fulﬁlls properties PA1 and PA2. In fact: 
• 
.P(∅) := αP1(∅) + (1 −α)P2(∅) = 0, while sans serif upper P left parenthesis upper Omega right parenthesis colon equals alpha sans serif upper P 1 left parenthesis upper Omega right parenthesis plus left parenthesis 1 minus alpha right parenthesis sans serif upper P 2 left parenthesis upper Omega right parenthesisP(Ω) := αP1(Ω) + (1 −α)P2(Ω)
is just alpha plus left parenthesis 1 minus alpha right parenthesis equals 1α + (1 −α) = 1;
2.9
Mixed Random Variables and Distributions
49
• 
for pairwise sequence of events upper A 1 comma upper A 2 comma ellipsisA1, A2, . . . in script upper FF we have 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i Baseline right parenthesis 2nd Column equals 3rd Column alpha sans serif upper P 1 left parenthesis union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i Baseline right parenthesis plus left parenthesis 1 minus alpha right parenthesis sans serif upper P 2 left parenthesis union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column alpha sigma summation Underscript i equals 1 Overscript normal infinity Endscripts sans serif upper P 1 left parenthesis upper A Subscript i Baseline right parenthesis plus sigma summation Underscript i equals 1 Overscript normal infinity Endscripts left parenthesis 1 minus alpha right parenthesis sans serif upper P 2 left parenthesis upper A Subscript i Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript normal infinity Endscripts left bracket alpha sans serif upper P 1 left parenthesis upper A Subscript i Baseline right parenthesis plus left parenthesis 1 minus alpha right parenthesis sans serif upper P 2 left parenthesis upper A Subscript i Baseline right parenthesis right bracket equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis period EndLayoutP(∪∞
i=1Ai) = αP1(∪∞
i=1Ai) + (1 −α)P2(∪∞
i=1Ai)
= α
∞
⎲
i=1
P1(Ai) +
∞
⎲
i=1
(1 −α)P2(Ai)
=
∞
⎲
i=1
⎾
αP1(Ai) + (1 −α)P2(Ai)
⏋
=
∞
⎲
i=1
P(Ai).
Deﬁnition 2.9 A rv  X is called mixed if its CDF has a ﬁnite18 number of jump 
discontinuities at x equals x 1 comma ellipsis comma x Subscript n Baselinex = x1, . . . , xn, where the masses are p Subscript i Baseline equals sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesispi = P(X = xi) for 
i equals 1 comma ellipsis comma ni = 1, . . . , n with sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline less than or slanted equals 1∑n
i=1 pi ⩽1. Then: 
upper F Subscript upper X Baseline left parenthesis x right parenthesis equals alpha upper F Subscript d Baseline left parenthesis x right parenthesis plus left parenthesis 1 minus alpha right parenthesis upper F Subscript c Baseline left parenthesis x right parenthesis comma 0 less than or slanted equals alpha less than or slanted equals 1 commaFX(x) = αFd(x) + (1 −α)Fc(x),
0 ⩽α ⩽1,
(2.22) 
where upper F Subscript dFd is the discrete part and upper F Subscript cFc is the continuous part. The former can be 
given as a linear combination of unit step functions, upper F Subscript d Baseline left parenthesis x right parenthesis equals sigma summation Underscript i equals 1 Overscript n Endscripts StartFraction p Subscript i Baseline Over alpha EndFraction u left parenthesis x minus x Subscript i Baseline right parenthesisFd(x) = ∑n
i=1
pi
α u(x −xi). 
The latter can be given through a density f Subscript c Baseline left parenthesis x right parenthesis greater than or slanted equals 0fc(x) ⩾0. 
If alpha equals 0α = 0 the rv is continuous; if alpha equals 1α = 1 it is discrete. Since upper F Subscript upper XFX corresponds 1-to-1 
to sans serif upper PP, then upper F Subscript dFd and upper F Subscript cFc correspond19 1-to-1 to sans serif upper P Subscript dPd and sans serif upper P Subscript cPc and sans serif upper P equals alpha sans serif upper P Subscript d Baseline plus left parenthesis 1 minus alpha right parenthesis sans serif upper P Subscript cP = αPd + (1 −α)Pc. 
The following is crucial in the mixing procedure. 
• 
The continuous part can be recovered as upper F Subscript c Baseline left parenthesis x right parenthesis equals StartFraction upper F Subscript upper X Baseline left parenthesis x right parenthesis minus sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline u left parenthesis x minus x Subscript i Baseline right parenthesis Over 1 minus sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline EndFractionFc(x) = FX(x)−∑n
i=1 piu(x−xi)
1−∑n
i=1 pi
. 
• 
. α in Deﬁnition 2.9 is equal to sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i∑n
i=1 pi. 
• 
The weights of the discrete part in Deﬁnition 2.9 are given by StartFraction p Subscript i Baseline Over alpha EndFractionpi
α s.t. sigma summation Underscript i equals 1 Overscript n Endscripts StartFraction p Subscript i Baseline Over alpha EndFraction equals 1∑n
i=1
pi
α =
1. 
Here the formal derivation. First, upper F Subscript upper X Baseline left parenthesis x right parenthesis minus sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline u left parenthesis x minus x Subscript i Baseline right parenthesisFX(x)−∑n
i=1 piu(x −xi) so we remove the jump 
discontinuities from the continuous part of the mixed CDF. The resulting function 
is not yet a CDF: 
StartLayout 1st Row 1st Column limit Underscript x right arrow normal infinity Endscripts left bracket upper F Subscript upper X Baseline left parenthesis x right parenthesis minus sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline u left parenthesis x minus x Subscript i Baseline right parenthesis right bracket 2nd Column equals limit Underscript x right arrow normal infinity Endscripts upper F Subscript upper X Baseline left parenthesis x right parenthesis Underscript bottom brace Underscript equals 1 Endscripts minus sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline left bracket limit Underscript x right arrow normal infinity Endscripts u left parenthesis x minus x Subscript i Baseline right parenthesis Underscript bottom brace Underscript equals 1 Endscripts right bracket 2nd Row 1st Column Blank 2nd Column equals 1 minus alpha less than or slanted equals 1 period EndLayout lim
x→∞
⎾
FX(x) −
n
⎲
i=1
piu(x −xi)
⏋
= lim
x→∞FX(x)
◟
◝◜
◞
=1
−
n
⎲
i=1
pi
⎾
lim
x→∞u(x −xi)
◟
◝◜
◞
=1
⏋
= 1 −α ⩽1.
18 We can extend this deﬁnition to a countable number of discontinuities with minor modiﬁcations. 
19 Thus the law sans serif upper P Subscript upper XPX is split into a discrete law sans serif upper P Subscript upper X comma 1PX,1 and an absolutely continuous law sans serif upper P Subscript upper X comma 2PX,2, to  
which correspond a set of masses and a density, respectively. 
50
2
Distribution of Random Variables
Thus we need to scale the above function dividing by 1 minus sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline equals 1 minus alpha1 −∑n
i=1 pi = 1 −α. 
Rearranging the formula for upper F Subscript c Baseline left parenthesis x right parenthesisFc(x) we get 
StartEnclose box upper F Subscript upper X Baseline left parenthesis x right parenthesis equals sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline u left parenthesis x minus x Subscript i Baseline right parenthesis plus left parenthesis 1 minus alpha right parenthesis upper F Subscript c Baseline left parenthesis x right parenthesis EndEnclose comma FX(x) =
n
⎲
i=1
piu(x −xi) + (1 −α)Fc(x) ,
and writing sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline u left parenthesis x minus x Subscript i Baseline right parenthesis equals alpha sigma summation Underscript i equals 1 Overscript n Endscripts StartFraction p Subscript i Baseline Over alpha EndFraction u left parenthesis x minus x Subscript i Baseline right parenthesis∑n
i=1 piu(x −xi) = α ∑n
i=1
pi
α u(x −xi) we ﬁnally obtain expression 
(2.22). Now we introduce the generalized20 delta function centered at a element of double struck upper Ra ∈R: 
delta Subscript a Baseline left parenthesis x right parenthesis equals StartLayout Enlarged left brace 1st Row 1st Column 0 comma 2nd Column if x not equals a 2nd Row 1st Column normal infinity comma 2nd Column if x equals a EndLayout comma integral Subscript negative normal infinity Superscript normal infinity Baseline delta Subscript a Baseline left parenthesis x right parenthesis normal d x equals 1 comma StartFraction normal d Over normal d x EndFraction u left parenthesis x minus a right parenthesis equals delta Subscript a Baseline left parenthesis x right parenthesis periodδa(x) =
⌠0,
if x /= a
∞, if x = a ,
⨜∞
−∞
δa(x)dx = 1,
d
dx u(x −a) = δa(x).
Observe that we use the same symbol as for the Dirac delta measure, see Sect. 2.4. 
With this in mind we can formally differentiate the CDF and get the generalized 
density of the mixed distribution in formula (2.22): 
StartLayout 1st Row 1st Column f Subscript upper X Baseline left parenthesis x right parenthesis equals StartFraction normal d Over normal d x EndFraction upper F Subscript upper X Baseline left parenthesis x right parenthesis 2nd Column equals 3rd Column alpha StartFraction normal d Over normal d x EndFraction upper F Subscript d Baseline left parenthesis x right parenthesis plus left parenthesis 1 minus alpha right parenthesis StartFraction normal d Over normal d x EndFraction upper F Subscript c Baseline left parenthesis x right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column alpha sigma summation Underscript i equals 1 Overscript n Endscripts StartFraction p Subscript i Baseline Over alpha EndFraction ModifyingBelow StartFraction normal d Over normal d x EndFraction u left parenthesis x minus x Subscript i Baseline right parenthesis With bottom brace Underscript equals delta Subscript x Sub Subscript i Baseline left parenthesis x right parenthesis Endscripts plus left parenthesis 1 minus alpha right parenthesis f Subscript c Baseline left parenthesis x right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline delta Subscript x Sub Subscript i Baseline left parenthesis x right parenthesis plus left parenthesis 1 minus alpha right parenthesis f Subscript c Baseline left parenthesis x right parenthesis EndLayoutfX(x) =
d
dx FX(x) = α d
dx Fd(x) + (1 −α) d
dx Fc(x)
= α
n
⎲
i=1
pi
α
d
dx u(x −xi)
◟
◝◜
◞
=δxi (x)
+(1 −α)fc(x)
=
n
⎲
i=1
piδxi(x) + (1 −α)fc(x)
Hence, we may always write the expression 
StartEnclose box f Subscript upper X Baseline left parenthesis x right parenthesis equals sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline delta Subscript x Sub Subscript i Baseline left parenthesis x right parenthesis plus left parenthesis 1 minus alpha right parenthesis f Subscript c Baseline left parenthesis x right parenthesis EndEnclose fX(x) =
n
⎲
i=1
piδxi(x) + (1 −α)fc(x)
as the ‘density’ of a mixed rv. In fact, by the deﬁning properties of the delta function 
we have: 
• 
.∑n
i=1 piδxi(x) + (1 −α)fc(x) ⩾0 for every x element of double struck upper Rx ∈R;
20 In real analysis, there could exist functions whose deﬁnition is not standard. These are called 
generalized functions. The rules of integration and differentiation are different, and require an 
excursion to functional analysis concerning vector spaces of test functions and the so called 
distributions (which are not deﬁned in probabilistic terms). 
2.9
Mixed Random Variables and Distributions
51
Fig. 2.6 CDF’s graph of a 
mixed distribution 
• 
.
⨜∞
−∞
⎾∑n
i=1 piδxi(x) + (1 −α)fc(x)
⏋
dx is equal to 
sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline left bracket ModifyingBelow integral Subscript negative normal infinity Superscript normal infinity Baseline delta Subscript x Sub Subscript i Subscript Baseline left parenthesis x right parenthesis normal d x With bottom brace Underscript equals 1 Endscripts right bracket plus left parenthesis 1 minus alpha right parenthesis ModifyingBelow integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript c Baseline left parenthesis x right parenthesis normal d x With bottom brace Underscript equals 1 Endscripts
n
⎲
i=1
pi
⎾⨜∞
−∞
δxi(x)dx
◟
◝◜
◞
=1
⏋
+ (1 −α)
⨜∞
−∞
fc(x)dx
◟
◝◜
◞
=1
which in turn is given by sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline plus left parenthesis 1 minus alpha right parenthesis equals alpha plus left parenthesis 1 minus alpha right parenthesis equals 1∑n
i=1 pi + (1 −α) = α + (1 −α) = 1. 
It is worth noting that the area under the graph of f Subscript cfc over a subset excluding the set 
of points x Subscript ixi where delta Subscript x Sub Subscript iδxi are concentrated is less than 1: in fact it is 1 minus sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i1 −∑n
i=1 pi. Each 
p Subscript i Baseline delta Subscript x Sub Subscript i Baseline left parenthesis x right parenthesispiδxi(x) in the expression sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline delta Subscript x Sub Subscript i Baseline left parenthesis x right parenthesis plus left parenthesis 1 minus alpha right parenthesis f Subscript c Baseline left parenthesis x right parenthesis∑n
i=1 piδxi(x) + (1 −α)fc(x) can be interpreted as the 
probability p Subscript i Baseline equals sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesispi = P(X = xi) concentrated at x Subscript i Baseline element of upper Cxi ∈C where the jump discontinuity of 
the corresponding CDF has inﬁnity derivative StartFraction normal d Over normal d x EndFraction upper F Subscript upper X Baseline left parenthesis x right parenthesis vertical bar Subscript x equals x Sub Subscript i Subscript Baseline equals delta Subscript x Sub Subscript i Subscript Baseline left parenthesis x Subscript i Baseline right parenthesis equals StartFraction normal d Over normal d x EndFraction u left parenthesis x minus x Subscript i Baseline right parenthesis vertical bar Subscript x equals x Sub Subscript i Subscript Baseline equals normal infinity d
dx FX(x)
||
x=xi = δxi(xi) =
d
dx u(x −
xi)
||
x=xi = ∞. 
Example 2.14 (Insurance Model) Suppose an individual has purchased an insur-
ance contract against a random loss21 for which the rv X represents the monetary 
reimbursement with maximum payment s denominated in euros. A candidate CDF 
for this rv is: 
upper F Subscript upper X Baseline left parenthesis x right parenthesis equals StartLayout Enlarged left brace 1st Row 1st Column 0 comma 2nd Column if x less than 0 2nd Row 1st Column 1 minus normal e Superscript minus lamda x Baseline comma 2nd Column if 0 less than or slanted equals x less than s 3rd Row 1st Column 1 comma 2nd Column if x greater than or slanted equals s EndLayoutFX(x) =
⎧
⎨
⎩
0,
if x < 0
1 −e−λx, if 0 ⩽x < s
1,
if x ⩾s
where lamda greater than 0λ > 0 and s greater than 0s > 0 are parameters. Interpretation: Random losses are 
measured with positive values, see Fig. 2.6. Since the reimbursement X equals the 
loss occurred except when its amount is at least e s, then X is zero for negative 
losses while it assumes values in left bracket 0 comma s right parenthesis[0, s) for positive losses less than e s. If losses 
exceed the latter level then upper X equals sX = s. It is easily veriﬁed that upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x) is a CDF: 
• 
it is non decreasing, x 1 less than x 2x1 < x2 implies upper F Subscript upper X Baseline left parenthesis x 1 right parenthesis less than or slanted equals upper F Subscript upper X Baseline left parenthesis x 2 right parenthesisFX(x1) ⩽FX(x2) since the CDF is zero up 
to x less than 0x < 0, is strictly increasing over left bracket 0 comma s right parenthesis[0, s) and is 1 for x greater than or slanted equals sx ⩾s; 
• 
it is continuous up to x less than sx < s and has a jump discontinuity at x equals sx = s, hence it is 
right continuous; 
• 
.limx→−∞FX(x) = 0 and limit Underscript x right arrow normal infinity Endscripts upper F Subscript upper X Baseline left parenthesis x right parenthesis equals 1limx→∞FX(x) = 1 by construction.
21 In case of an unpredictable loss, as for example due to a car accident. 
52
2
Distribution of Random Variables
We claim upper F Subscript upper XFX corresponding to the mixed rv X is of the form (2.22) as in Deﬁnition 
(2.9). The only jump discontinuity is 
sans serif upper P left parenthesis upper X equals s right parenthesis equals upper F Subscript upper X Baseline left parenthesis s right parenthesis minus upper F Subscript upper X Baseline left parenthesis s Superscript minus Baseline right parenthesis equals 1 minus left parenthesis 1 minus normal e Superscript minus lamda s Baseline right parenthesis equals normal e Superscript minus lamda s Baseline equals alpha periodP(X = s) = FX(s) −FX(s−) = 1 −
(
1 −e−λs)
= e−λs = α.
The CDF’s continuous part upper F Subscript c Baseline left parenthesis x right parenthesis equals StartFraction upper F Subscript upper X Baseline left parenthesis x right parenthesis minus alpha u left parenthesis x minus s right parenthesis Over 1 minus alpha EndFractionFc(x) = FX(x)−αu(x−s)
1−α
is given by 
upper F Subscript c Baseline left parenthesis x right parenthesis equals StartLayout Enlarged left brace 1st Row 1st Column 0 comma 2nd Column if x less than 0 comma u left parenthesis x minus s right parenthesis equals 0 comma upper F Subscript upper X Baseline left parenthesis x right parenthesis equals 0 2nd Row 1st Column StartFraction 1 minus normal e Superscript minus lamda x Baseline Over 1 minus alpha EndFraction comma 2nd Column if 0 less than or slanted equals x less than s comma u left parenthesis x minus s right parenthesis equals 0 comma upper F Subscript upper X Baseline left parenthesis x right parenthesis equals 1 minus normal e Superscript minus lamda x Baseline 3rd Row 1st Column 1 comma 2nd Column if x greater than or slanted equals s comma u left parenthesis x minus s right parenthesis equals 1 comma upper F Subscript upper X Baseline left parenthesis x right parenthesis equals 1 period EndLayoutFc(x) =
⎧
⎪⎨
⎪⎩
0,
if x < 0, u(x −s) = 0, FX(x) = 0
1−e−λx
1−α , if 0 ⩽x < s, u(x −s) = 0, FX(x) = 1 −e−λx
1,
if x ⩾s, u(x −s) = 1, FX(x) = 1.
Now f Subscript c Baseline left parenthesis x right parenthesis equals StartFraction normal d Over normal d x EndFraction upper F Subscript c Baseline left parenthesis x right parenthesis equals StartFraction lamda normal e Superscript minus lamda x Baseline Over 1 minus alpha EndFractionfc(x) =
d
dx Fc(x) = λe−λx
1−α , for 0 less than or slanted equals x less than s0 ⩽x < s, and the derivative (viz. the density) 
is zero otherwise. Hence we have: 
upper F Subscript upper X Baseline left parenthesis x right parenthesis equals alpha u left parenthesis x minus s right parenthesis plus left parenthesis 1 minus alpha right parenthesis upper F Subscript c Baseline left parenthesis x right parenthesis equals normal e Superscript minus lamda s Baseline u left parenthesis x minus s right parenthesis plus left parenthesis 1 minus normal e Superscript minus lamda x Baseline right parenthesis commaFX(x) = αu(x −s) + (1 −α)Fc(x) = e−λsu(x −s) +
(
1 −e−λx)
,
with generalized density f Subscript upper X Baseline left parenthesis x right parenthesis equals normal e Superscript minus lamda s Baseline delta Subscript s Baseline left parenthesis x right parenthesis plus lamda normal e Superscript minus lamda xfX(x) = e−λsδs(x) + λe−λx. 
More generally, a mixture is a rv with CDF given in the following form: upper F Subscript upper X Baseline equals sigma summation Underscript i equals 1 Overscript n Endscripts alpha Subscript i Baseline upper F Subscript upper X Sub Subscript iFX =
∑n
i=1 αiFXi, for  rvs  upper X Subscript iXi and weights s.t. sigma summation Underscript i equals 1 Overscript n Endscripts alpha Subscript i Baseline equals 1 comma∑n
i=1 αi = 1, where the CDFs upper F Subscript upper X Sub Subscript iFXi can be 
of different type. 
Remark 2.14 In a far general setting (viz. measure theory) it can be shown that any 
probability law sans serif upper P Subscript upper XPX of a rv (acting as a probability on double struck upper RR) has a unique representation 
sans serif upper P Subscript upper X Baseline equals alpha 1 sans serif upper P Subscript d Baseline plus alpha 2 sans serif upper P Subscript c Baseline plus alpha 3 sans serif upper P Subscript s Baseline comma alpha 1 comma alpha 2 comma alpha 3 greater than or slanted equals 0 comma alpha 1 plus alpha 2 plus alpha 3 equals 1 commaPX = α1Pd + α2Pc + α3Ps,
α1, α2, α3 ⩾0, α1 + α2 + α3 = 1,
where the probability sans serif upper P Subscript sPs is called singular, i.e. there exists a CDF upper F Subscript s Baseline left parenthesis x right parenthesisFs(x) such that 
its derivative upper F prime Subscript s Baseline left parenthesis x right parenthesis equals 0F '
s(x) = 0 except at those x forming a set of measure zero. Therefore, 
any discrete rv has a distribution which is singular, since the derivative of its CDF 
exists and is zero except at each jump discontinuity (whose set has measure zero, 
and where the derivative does not exist). However there are singular continuous 
probability distributions which corresponds 1-to-1 to a continuous CDF that is not 
discrete but nevertheless has no density function. 
Remark 2.15 For a mixed rv X with countably many jumps over the set 
StartSet x 1 comma x 2 comma ellipsis EndSet{x1, x2, . . .}, we can succinctly write its law as: 
sans serif upper P Subscript upper X Baseline equals alpha sigma summation Underscript i equals 1 Overscript n Endscripts delta Subscript x Sub Subscript i Subscript Baseline plus left parenthesis 1 minus alpha right parenthesis sans serif upper P Subscript upper Y Baseline commaPX = α
n
⎲
i=1
δxi + (1 −α)PY ,
where Y is an (absolutely) continuous rv.22 This is again a set function deﬁned for 
suitable upper B subset of double struck upper RB ⊂R.
22 sans serif upper P Subscript upper YPY has CDF s.t. upper F prime Subscript upper Y Baseline left parenthesis x right parenthesis equals f Subscript upper Y Baseline left parenthesis x right parenthesisF '
Y (x) = fY (x), at all points x element of double struck upper Rx ∈R except a ﬁnite number. 
2.10
Exercises
53
Another kind of mixture, say of a rv X’s CDF, with mixing weights given by the 
values that another rv, say upper Y commaY, might assume is deﬁned as follows: 
upper F Subscript upper X Baseline left parenthesis x right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline upper H left parenthesis x semicolon y right parenthesis normal d upper G left parenthesis y right parenthesis commaFX(x) =
⨜∞
−∞
H(x; y)dG(y),
(2.23) 
where upper H left parenthesis x semicolon y right parenthesis equals sans serif upper P left parenthesis upper X less than or slanted equals x semicolon upper Y equals y right parenthesisH(x; y) = P(X ⩽x; Y = y) denotes the CDF23 of X indexed by the real 
values of upper Y commaY, and upper G left parenthesis y right parenthesisG(y) is just the CDF of upper Y commaY, called the mixing distribution, governing 
in a random way the weighting scheme which entails upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x) as a CDF of the same 
type of upper H left parenthesis x semicolon y right parenthesis periodH(x; y). The integral in Eq. (2.23) is of the Stieltjes type. We can write 
down the density or mass function as 
f Subscript upper X Baseline left parenthesis x right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline h left parenthesis x semicolon y right parenthesis normal d upper G left parenthesis y right parenthesis commafX(x) =
⨜∞
−∞
h(x; y)dG(y),
(2.24) 
where h left parenthesis x semicolon y right parenthesish(x; y) is the corresponding density or mass function in the mixing scheme. 
In fact, integrating f Subscript upper X Baseline left parenthesis x right parenthesis commafX(x), i.e., 
StartLayout 1st Row 1st Column integral Subscript negative normal infinity Superscript x Baseline f Subscript upper X Baseline left parenthesis u right parenthesis 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript x Baseline left bracket integral Subscript negative normal infinity Superscript normal infinity Baseline h left parenthesis u semicolon y right parenthesis normal d upper G left parenthesis y right parenthesis right bracket normal d u 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline ModifyingBelow left bracket integral Subscript negative normal infinity Superscript x Baseline h left parenthesis u semicolon y right parenthesis normal d u right bracket With bottom brace Underscript equals upper H left parenthesis x semicolon y right parenthesis Endscripts normal d upper G left parenthesis y right parenthesis period EndLayout
⨜x
−∞
fX(u) =
⨜x
−∞
⎾⨜∞
−∞
h(u; y)dG(y)
⏋
du
=
⨜∞
−∞
⎾⨜x
−∞
h(u; y)du
⏋
◟
◝◜
◞
=H(x;y)
dG(y).
The exchange in the order of integration is permitted by Fubini’s theorem, see 
Appendix in Chap. 3 and Appendix I. When upper F Subscript upper XFX and H are both continuous we 
can write formulas (2.23) and (2.24) by replacing normal d upper G left parenthesis y right parenthesisdG(y) with g left parenthesis y right parenthesis normal d y commag(y)dy, where g left parenthesis y right parenthesisg(y)
is the density function of the mixing CDF upper G left parenthesis y right parenthesis periodG(y). In the discrete case we replace 
g left parenthesis y right parenthesis normal d yg(y)dy with g left parenthesis y right parenthesisg(y) and the integral integral Subscript negative normal infinity Superscript normal infinity Baseline
⨜∞
−∞with the summation sigma summation Underscript y element of script upper Y Endscripts comma∑
y∈Y, where script upper YY is the 
support of upper Y periodY.
2.10 
Exercises 
2.1 (One-Sided Limits of a CDF) Let FX be the CDF of a rv X. Prove the 
following: 
(e) P(X > a) = 1 − FX(a) for every a ∈ R. 
(f) P(X = a) = FX(a) −FX(a−) for every a ∈R.
23 It can be deﬁned in term of conditional CDF, see Chap. 6. 
54
2
Distribution of Random Variables
2.2 (Continuous Distribution) Let fX(x) be a continuous density function. Con-
sider the interval [x − h 
2, x  + h 
2] with length h >  0. Compute the probability 
P(X ∈[x − h 
2, x  + h 
2]). 
2.3 Show that the indicator IA is a rv iff A ∈F. 
2.4 Show that the composition IB ◦ X : Ω → R is the indicator rv I{X∈B}, for  a  
suitable B ⊂ R and a rv over (Ω, F). 
2.5 (Borel Sets) Recall that the Borel σ-algebra is the smallest σ-algebra contain-
ing all the ﬁnite and inﬁnite intervals of R. Show that ∪∞
i=1(a, b − 1 
i ] =  (a, b) and 
∩∞
i=1(a − 1 
i , b] = [a, b], for a <  b,  i.e. open and closed interval are Borel sets. 
2.6 Let P0 be deﬁned by formula (2.26), and let G be the class containing all ﬁnite 
disjoint unions of (a, b] together with ∅. Show that: 
(1) 
R ∈G; 
(2) 
P0(∅) = 0; 
(3) 
P0(R) = 1. 
2.7 (Dirac Delta Measure and Probability) Recall that a Dirac delta measure can 
be used to model a probability distribution over R corresponding in a 1-to-1 fashion 
to the law PX of a given rv X. Let  δx(B) be the Dirac delta measure whose deﬁnition 
we recall for the reader’s convenience: 
StartLayout 1st Row delta Subscript x Baseline left parenthesis upper B right parenthesis colon equals StartLayout Enlarged left brace 1st Row 1st Column 1 comma 2nd Column if x element of upper B 2nd Row 1st Column 0 comma 2nd Column if x not an element of upper B EndLayout EndLayoutδx(B) :=
⌠1, if x ∈B
0, if x /∈B
(2.25) 
Equation (2.25) deﬁnes a function δx( · ) : B → R. Prove the following: PX(B) :=
∑∞ 
i=1 piδxi (B) is the probability distribution of a discrete rv X with countable many 
values {x1, x2, . . .} and masses P(X = xi) = pi. 
Remark 2.16 We have seen that a rv X(ω) = k, for  some  k ∈ R, behaves like a 
constant. To see this more formally observe that the CDF is FX(x) = 1 for every 
x ⩾k, and FX(x) = 0 otherwise. We have: 
upper F Subscript upper X Baseline left parenthesis k Superscript minus Baseline right parenthesis equals sans serif upper P left parenthesis upper X less than k right parenthesis equals limit Underscript h down arrow 0 Endscripts sans serif upper P left parenthesis upper X less than or slanted equals k minus h right parenthesis equals 0 commaFX(k−) = P(X < k) = lim
h↓0 P(X ⩽k −h) = 0,
while FX(k) = P(X ⩽k) = 1. This implies 
sans serif upper P left parenthesis upper X equals k right parenthesis equals upper F Subscript upper X Baseline left parenthesis k right parenthesis minus upper F Subscript upper X Baseline left parenthesis k Superscript minus Baseline right parenthesis equals 1P(X = k) = FX(k) −FX(k−) = 1
and we can safely claim that X acts like a constant. Its probability distribution is 
characterized by a Dirac-delta δk(B), for any reasonable subset of real numbers 
B ⊂ R. 
2.8 (Positive and Negative Parts) Let X be a rv describing the daily rate of return 
of a traded stock. Find the expression of its magnitude.
Appendix
55
Remark 2.17 Any simple rv as deﬁned by Eq. (2.6) is bounded, i.e. we can ﬁnd 
k >  0 s.t. |X(ω)| ⩽k, thus −k ⩽X(ω) ⩽k for all scenarios ω ∈Ω. 
2.9 Let X >  0 be a positive rv describing the future price of a stock or the future 
loss of an insurance claim. Prove that, for all s, c ∈ R: 
• 
max{X, s} ±  c = max{X ± c, s ± c}; 
• 
(X −s)+ + c = max{X − s + c, c}; 
• 
(X −s)+ − (s − X)+ = X − s. 
2.10 Let FX, FY be two CDFs s.t. X
⩽st 
Y. Show this is equivalent to 
QX(FY (x)) ⩽x, for every x ∈ R. 
2.11 (Symmetric Distributions) Write the equivalent deﬁnition (2.14) of symme-
try for discrete and continuous rvs. 
2.12 Let X be a discrete rv with symmetric distribution around zero. Prove the new 
rv Y = −X has the same distribution of X. Provide a prove also for continuous X. 
2.13 (Mixed CDF) Show that the function 
upper F left parenthesis x right parenthesis colon equals alpha upper F Subscript upper X Baseline left parenthesis x right parenthesis plus left parenthesis 1 minus alpha right parenthesis upper F Subscript upper Y Baseline left parenthesis x right parenthesis comma for every x element of double struck upper R comma 0 less than or slanted equals alpha less than or slanted equals 1F(x) := αFX(x) + (1 −α)FY (x), for every x ∈R, 0 ⩽α ⩽1
is a CDF, given two CDFs FX, FY . 
Appendix 
Some Details on CDF’s Right Continuity 
It is worth recalling that continuity of a real-valued function might be equivalently 
given by epsilon minus deltaϵ −δ deﬁnition or by sequential characterization. In the ﬁrst case, for upper F left parenthesis x right parenthesisF(x)
being continuous at a point x 0x0 lying in its domain it is required that 
for each epsilon greater than 0 there exists delta greater than 0 s period t period StartAbsoluteValue x minus x 0 EndAbsoluteValue less than delta long right double arrow StartAbsoluteValue upper F left parenthesis x right parenthesis minus upper F left parenthesis x 0 right parenthesis EndAbsoluteValue less than epsilon commafor each ϵ > 0 there exists δ > 0 s.t. |x −x0| < δ =⇒|F(x) −F(x0)| < ϵ,
written limit Underscript x right arrow x 0 Endscripts upper F left parenthesis x right parenthesis equals upper F left parenthesis x 0 right parenthesislimx→x0 F(x) = F(x0), i.e. for any x near to x 0x0 also upper F left parenthesis x right parenthesisF(x) is near to 
upper F left parenthesis x 0 right parenthesisF(x0). All this applies to upper F identical to upper F Subscript upper XF ≡FX. We see more formally why the sequential 
characterization of CDF’s right-continuity is equivalent to the epsilon minus deltaϵ−δ deﬁnition. Given 
a decreasing sequence x 1 greater than or slanted equals x 2 greater than or slanted equals midline horizontal ellipsisx1 ⩾x2 ⩾· · · of values in the domain of upper F Subscript upper XFX, s.t. x Subscript i Baseline down arrow xxi ↓x
for i right arrow normal infinityi →∞and x not equals x Subscript ix /= xi, we know that upper F Subscript upper X Baseline left parenthesis x Superscript plus Baseline right parenthesis equals limit Underscript i right arrow normal infinity Endscripts upper F Subscript upper X Baseline left parenthesis x plus StartFraction 1 Over i EndFraction right parenthesis equals upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x+) = lim
i→∞FX(x + 1
i ) = FX(x) with 
x Subscript i Baseline equals x plus StartFraction 1 Over i EndFractionxi = x + 1
i . Choosing another value y in the CDF’s domain with x less than y less than x Subscript ix < y < xi, 
then upper F Subscript upper X Baseline left parenthesis x right parenthesis less than or slanted equals upper F Subscript upper X Baseline left parenthesis y right parenthesis less than or slanted equals upper F Subscript upper X Baseline left parenthesis x Subscript i Baseline right parenthesisFX(x) ⩽FX(y) ⩽FX(xi) because upper F Subscript upper XFX is nondecreasing. Since for x Subscript i Baseline down arrow xxi ↓x we 
have upper F Subscript upper X Baseline left parenthesis x Subscript i Baseline right parenthesis down arrow upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(xi) ↓FX(x), then StartAbsoluteValue upper F Subscript upper X Baseline left parenthesis x Subscript i Baseline right parenthesis minus upper F Subscript upper X Baseline left parenthesis x right parenthesis EndAbsoluteValue right arrow 0|FX(xi) −FX(x)| →0 and also StartAbsoluteValue upper F Subscript upper X Baseline left parenthesis y right parenthesis minus upper F Subscript upper X Baseline left parenthesis x right parenthesis EndAbsoluteValue right arrow 0|FX(y) −FX(x)| →0
provided that y decreases to x, i.e. y down arrow xy ↓x. This is the required epsilon minus deltaϵ −δ deﬁnition of
56
2
Distribution of Random Variables
right-continuity, alternatively given by setting y equals x plus hy = x + h for h greater than 0h > 0 and writing as 
usual upper F Subscript upper X Baseline left parenthesis x right parenthesis equals limit Underscript h down arrow 0 Endscripts upper F Subscript upper X Baseline left parenthesis x plus h right parenthesisFX(x) = limh↓0 FX(x + h). 
Five Properties of a CDF 
Proof of Theorem 2.1 We prove the implication =⇒, the other direction being a 
much subtle result from measure theory. 
(a) Take two real numbers a <  b  and observe that {X ⩽a} ⊂{X ⩽b}, thus 
FX(a) = P(X ⩽a) is less than or equal to FX(b) = P(X ⩽b) by the 
monotonicity of P( · ) for increasing events. 
(b) Recall that P( · ) is continuous for a decreasing sequence of events with given 
intersection. Now take Ai = {X ⩽x + 1 
i } and observe that ∩∞
i=1{X ⩽x + 1 
i } 
is just {X ⩽x}. Then 
StartLayout 1st Row 1st Column upper F Subscript upper X Baseline left parenthesis x right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis upper X less than or slanted equals x right parenthesis equals limit Underscript i right arrow normal infinity Endscripts sans serif upper P left parenthesis upper X less than or slanted equals x plus StartFraction 1 Over i EndFraction right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column limit Underscript i right arrow normal infinity Endscripts upper F Subscript upper X Baseline left parenthesis x plus StartFraction 1 Over i EndFraction right parenthesis comma EndLayoutFX(x) = P(X ⩽x) = lim
i→∞P(X ⩽x + 1
i )
= lim
i→∞FX(x + 1
i ),
and since the CDF is nondecreasing the last limit exists and must be FX(x). 
The following proof of the other implication can be skipped, and require the notion 
of trace σ-algebra (see Exercise 1.16 in Chap. 1). Thus, we are going to prove that a 
map F : R →[0, 1] satisfying properties (a)–(c) of Theorem 2.1 is the CDF of the 
probability PX(B) induced by some rv X for every Borel set B ∈B, i.e., F ≡ FX. 
Let X be a rv deﬁned on a probability space (Ω, F, P) where Ω = (0, 1], F = B(0,1] 
and P = m, the Lebesgue measure restricted to the unit interval. For each scenario 
ω ∈ (0, 1] deﬁne the map X(ω) := sup{z | F(z) < ω}. We ﬁrst verify that X is 
indeed a rv. To any x /∈{z | F(z) < ω} will correspond ω ⩽F(x). Taking the 
supremum requires X(ω) ⩽x. By assumption F is right-continuous at x implying 
that we can ﬁnd h >  0 such that F(x +h) ⩽F(x) < ω but also x <  x +h ⩽X(ω), 
since X is the supremum of the set {z | F(z) < ω}, even if  z = x +h. Putting things 
together we have 
StartSet omega vertical bar upper X left parenthesis omega right parenthesis less than or slanted equals x EndSet equals StartSet omega vertical bar omega less than or slanted equals upper F left parenthesis x right parenthesis EndSet comma{ω | X(ω) ⩽x} = {ω | ω ⩽F(x)},
i.e. the inverse image {X ⩽x} is a Borel set in B(0,1]. Eventually we can write 
P(X ⩽x) = m((0, F(x)]) = F(x) and the proof is complete.
█
Appendix
57
Checking Probabilities in Table 2.1 
Number # 1 is Deﬁnition 2.1 and # 3 is Theorem 2.1(d). To verify # 2 we consider the 
increasing sequence of events left brace upper X less than or slanted equals a minus StartFraction 1 Over i EndFraction right brace{X ⩽a −1
i } for i equals 1 comma 2 comma ellipsisi = 1, 2, . . . with union union Subscript i equals 1 Superscript normal infinity Baseline left brace upper X less than or slanted equals a minus StartFraction 1 Over i EndFraction right brace equals left brace upper X less than a right brace∪∞
i=1{X ⩽
a −1
i } = {X < a}. By continuity of sans serif upper P left parenthesis dot right parenthesisP( · ) we have 
sans serif upper P left parenthesis upper X less than a right parenthesis equals limit Underscript i right arrow normal infinity Endscripts sans serif upper P left parenthesis upper X less than or slanted equals a minus StartFraction 1 Over i EndFraction right parenthesis equals limit Underscript i right arrow normal infinity Endscripts upper F Subscript upper X Baseline left parenthesis a minus StartFraction 1 Over i EndFraction right parenthesis equals upper F Subscript upper X Baseline left parenthesis a Superscript minus Baseline right parenthesis periodP(X < a) = lim
i→∞P(X ⩽a −1
i ) = lim
i→∞FX(a −1
i ) = FX(a−).
To prove # 5 we use the decreasing sequence of events left brace a minus StartFraction 1 Over i EndFraction less than upper X less than or slanted equals a right brace{a −1
i < X ⩽a} with 
intersection intersection Subscript i equals 1 Superscript normal infinity Baseline left brace a minus StartFraction 1 Over i EndFraction less than upper X less than or slanted equals a right brace equals left brace a less than or slanted equals upper X less than or slanted equals a right brace equals left brace upper X equals a right brace∩∞
i=1{a −1
i < X ⩽a} = {a ⩽X ⩽a} = {X = a}. Again, using the 
continuity of sans serif upper P left parenthesis dot right parenthesisP( · ) and Theorem 2.1(d) we have 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper X equals a right parenthesis 2nd Column equals limit Underscript i right arrow normal infinity Endscripts sans serif upper P left parenthesis a minus StartFraction 1 Over i EndFraction less than upper X less than or slanted equals a right parenthesis 2nd Row 1st Column Blank 2nd Column equals limit Underscript i right arrow normal infinity Endscripts left bracket upper F Subscript upper X Baseline left parenthesis a right parenthesis minus upper F Subscript upper X Baseline left parenthesis a minus StartFraction 1 Over i EndFraction right parenthesis right bracket equals upper F Subscript upper X Baseline left parenthesis a right parenthesis minus upper F Subscript upper X Baseline left parenthesis a Superscript minus Baseline right parenthesis period EndLayoutP(X = a) = lim
i→∞P(a −1
i < X ⩽a)
= lim
i→∞
⎾
FX(a) −FX(a −1
i )
⏋
= FX(a) −FX(a−).
Now we can prove # 9 by considering left brace a less than upper X less than b right brace equals left brace a less than upper X less than or slanted equals b right brace minus left brace upper X equals b right brace{a < X < b} = {a < X ⩽b} \ {X = b} and 
then by Pr3 and the previous result we have 
sans serif upper P left parenthesis a less than upper X less than b right parenthesis equals upper F Subscript upper X Baseline left parenthesis b right parenthesis minus upper F Subscript upper X Baseline left parenthesis a right parenthesis minus left bracket upper F Subscript upper X Baseline left parenthesis b right parenthesis minus upper F Subscript upper X Baseline left parenthesis b Superscript minus Baseline right parenthesis right bracket equals upper F Subscript upper X Baseline left parenthesis b Superscript minus Baseline right parenthesis minus upper F Subscript upper X Baseline left parenthesis a right parenthesis periodP(a < X < b) = FX(b) −FX(a) −
⎾
FX(b) −FX(b−)
⏋
= FX(b−) −FX(a).
Number # 4 is based on the decreasing sequence of events left brace a minus StartFraction 1 Over i EndFraction less than upper X less than or slanted equals b right brace{a −1
i < X ⩽b} with 
intersection intersection Subscript i equals 1 Superscript normal infinity Baseline left brace a minus StartFraction 1 Over i EndFraction less than upper X less than or slanted equals b right brace equals left brace a less than or slanted equals upper X less than or slanted equals b right brace∩∞
i=1{a −1
i < X ⩽b} = {a ⩽X ⩽b} and the continuity of the 
probability measure: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis a less than or slanted equals upper X less than or slanted equals b right parenthesis 2nd Column equals limit Underscript i right arrow normal infinity Endscripts sans serif upper P left parenthesis a minus StartFraction 1 Over i EndFraction less than upper X less than or slanted equals b right parenthesis equals limit Underscript i right arrow normal infinity Endscripts left bracket upper F Subscript upper X Baseline left parenthesis b right parenthesis minus upper F Subscript upper X Baseline left parenthesis a minus StartFraction 1 Over i EndFraction right parenthesis right bracket 2nd Row 1st Column Blank 2nd Column equals upper F Subscript upper X Baseline left parenthesis b right parenthesis minus upper F Subscript upper X Baseline left parenthesis a Superscript minus Baseline right parenthesis period EndLayoutP(a ⩽X ⩽b) = lim
i→∞P(a −1
i < X ⩽b) = lim
i→∞
⎾
FX(b) −FX(a −1
i )
⏋
= FX(b) −FX(a−).
Number # 6 is (e) of Exercise 2.1. To prove # 7 it sufﬁces to note that left brace upper X greater than or slanted equals b right brace equals left brace upper X equals b right brace union left brace upper X greater than b right brace{X ⩾b} =
{X = b} ∪{X > b}, so applying sans serif upper P left parenthesis dot right parenthesisP( · ) together with #5 and # 6 we have 
sans serif upper P left parenthesis upper X greater than or slanted equals b right parenthesis equals sans serif upper P left parenthesis upper X equals b right parenthesis plus sans serif upper P left parenthesis upper X greater than b right parenthesis equals upper F Subscript upper X Baseline left parenthesis b right parenthesis minus upper F Subscript upper X Baseline left parenthesis b Superscript minus Baseline right parenthesis plus 1 minus upper F Subscript upper X Baseline left parenthesis b right parenthesis equals 1 minus upper F Subscript upper X Baseline left parenthesis b Superscript minus Baseline right parenthesis periodP(X ⩾b) = P(X = b)+P(X > b) = FX(b)−FX(b−)+1−FX(b) = 1−FX(b−).
Finally we prove # 8 considering the increasing sequence of events left brace a less than or slanted equals upper X less than or slanted equals b minus StartFraction 1 Over i EndFraction right brace{a ⩽X ⩽b−1
i }
with union left brace a less than or slanted equals upper X less than b right brace{a ⩽X < b}, thus thanks to # 4: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis a less than or slanted equals upper X less than b right parenthesis 2nd Column equals limit Underscript i right arrow normal infinity Endscripts sans serif upper P left parenthesis a less than or slanted equals upper X less than or slanted equals b minus StartFraction 1 Over i EndFraction right parenthesis equals limit Underscript i right arrow normal infinity Endscripts left bracket upper F Subscript upper X Baseline left parenthesis b minus StartFraction 1 Over i EndFraction right parenthesis minus upper F Subscript upper X Baseline left parenthesis a Superscript minus Baseline right parenthesis right bracket 2nd Row 1st Column Blank 2nd Column equals upper F Subscript upper X Baseline left parenthesis b Superscript minus Baseline right parenthesis minus upper F Subscript upper X Baseline left parenthesis a Superscript minus Baseline right parenthesis period EndLayoutP(a ⩽X < b) = lim
i→∞P(a ⩽X ⩽b −1
i ) = lim
i→∞
⎾
FX(b −1
i ) −FX(a−)
⏋
= FX(b−) −FX(a−).
58
2
Distribution of Random Variables
Details on Discrete Distributions 
Proof of Theorem 2.2 (Identiﬁcation) We know that X is discrete if its support 
(the set where the CDF FX is strictly increasing) is C = {x1, x2, . . .}. Since by 
construction each ﬁxed ω ∈Ω which belongs to {X = xi} cannot be in another 
{X = xj}, for  i /= j, the sample space is partitioned by all these events: 
left brace upper X equals x 1 right brace union left brace upper X equals x 2 right brace union midline horizontal ellipsis equals upper Omega period{X = x1} ∪{X = x2} ∪· · · = Ω.
As byproduct we have (pairwise disjoint events) 
1 equals sans serif upper P left parenthesis upper Omega right parenthesis equals sans serif upper P left parenthesis union Subscript i Baseline left brace upper X equals x Subscript i Baseline right brace right parenthesis equals sans serif upper P left parenthesis upper X equals x 1 right parenthesis plus sans serif upper P left parenthesis upper X equals x 2 right parenthesis plus midline horizontal ellipsis equals sans serif upper P left parenthesis upper X element of upper C right parenthesis period1 = P(Ω) = P
(
∪i {X = xi}
)
= P(X = x1) + P(X = x2) + · · · = P(X ∈C).
█
Details on Continuous Distributions 
Proof of Proposition 2.1 If X has a continuous probability distribution, then as a 
consequence of Deﬁnition 2.1 its PX is given in term of a density function s.t. 
P(−i ⩽X ⩽i) = P(−i <  X ⩽i) =
⨜i 
−i fX(x)dx for some integer i ∈ N. 
Thus, {−i ⩽X ⩽i} is an increasing sequence of events and by continuity of P( · ) 
we have limi→∞ P(−i ⩽X ⩽i) = P(−∞⩽X ⩽∞) =
⨜∞ 
−∞ fX(x)dx = 1. 
Moreover, FX(x) = P(X ⩽x) can be written as P(−∞ < X ⩽x) which 
in turn is equal to limi→∞
⨜x 
−i fX(u)du hence (2.2) holds true. Conversely, if
⨜∞ 
−∞ fX(x)dx = 1 then by (2.2) the nonnegative function fX delivery FX as a 
CDF: 
• 
it is nondecreasing, FX(x1) ⩽FX(x2) for reals x1 < x2; 
• 
it is continuous, thus also right-continuous; 
• 
FX(∞) = 1 and FX(−∞) =
⨜∞ 
−∞ FX(x)dx = 0; 
• 
the probability of {a <  X ⩽b} is FX(b) − FX(a). 
█
Probability Measure on R 
To begin with, let upper F colon double struck upper R right arrow left bracket 0 comma 1 right bracketF : R →[0, 1] be a nondecreasing, right-continuous functions 
for which it is not necessary that limit Underscript x right arrow negative normal infinity Endscripts upper F left parenthesis x right parenthesis equals 0limx→−∞F(x) = 0 and limit Underscript x right arrow normal infinity Endscripts upper F left parenthesis x right parenthesis equals 1limx→∞F(x) = 1. Such 
an F is called càdlàg, the French acronym of continue à droite (continuous on the
Appendix
59
right), limité à gauche (with ﬁnite left-hand limit).24 Next, collect all ﬁnite disjoint 
unions of intervals left parenthesis a comma b right bracket(a, b] together with empty set∅into a class script upper G commaG, where negative normal infinity less than or slanted equals a less than b less than normal infinity−∞⩽a < b < ∞
and by convention left parenthesis a comma normal infinity right parenthesis equals left parenthesis a comma normal infinity right bracket period(a, ∞) = (a, ∞]. Thus a nonempty upper A element of script upper GA ∈G may be written 
as union Subscript i equals 1 Superscript n Baseline left parenthesis a Subscript i Baseline comma b Subscript i Baseline right bracket∪n
i=1(ai, bi] with left parenthesis a Subscript i Baseline comma b Subscript i Baseline right bracket intersection left parenthesis a Subscript j Baseline comma b Subscript j Baseline right bracket equals empty set(ai, bi] ∩(aj, bj] = ∅for every i not equals ji /= j. Now, deﬁne the set 
function sans serif upper P 0 left parenthesis upper A right parenthesis colon script upper G right arrow left bracket 0 comma 1 right bracketP0(A) : G →[0, 1] by 
sans serif upper P 0 left parenthesis upper A right parenthesis colon equals sigma summation Underscript k equals 1 Overscript n Endscripts upper F left parenthesis b Subscript i Baseline right parenthesis minus upper F left parenthesis a Subscript i Baseline right parenthesis commaP0(A) :=
n
⎲
k=1
F(bi) −F(ai),
(2.26) 
which is ﬁnitely additive, i.e. sans serif upper P 0 left parenthesis union Subscript i equals 1 Superscript m Baseline upper A Subscript i Baseline right parenthesis equals sigma summation Underscript i equals 1 Overscript m Endscripts sans serif upper P 0 left parenthesis upper A Subscript i Baseline right parenthesisP0(∪m
i=1Ai) = ∑m
i=1 P0(Ai) for every upper A Subscript i Baseline element of script upper GAi ∈G. 
It can be shown that sans serif upper P 0P0 in formula (2.26) is also countable additive on script upper GG (see 
Deﬁnition 1.3, axiom PA2, in Sect. 1.3). To get a probability measure we need sans serif upper P 0P0
to be extended on a sigma hyphen algebraσ-algebra script upper FF containing script upper GG: it sufﬁces to perform countable 
many unions, intersections, complements of sets A from script upper GG to get script upper F equals sigma left parenthesis script upper G right parenthesisF = σ(G), the  
sigma hyphen algebraσ-algebra generated by the class script upper GG. An appeal to the following result entails the 
desired extension denoted sans serif upper QQ. 
Theorem 2.4 (Carathéodory) 
Suppose script upper GG is an algebra of subsets of double struck upper RR and 
sans serif upper P 0 colon script upper G right arrow left bracket 0 comma 1 right bracketP0 : G →[0, 1] is a countable additive set function. Then, there exists∃a measure sans serif upper QQ on 
the sigma hyphen algebraσ-algebra sigma left parenthesis script upper G right parenthesisσ(G) generated by script upper GG such that they agree, sans serif upper Q left parenthesis upper A right parenthesis equals sans serif upper P 0 left parenthesis upper A right parenthesis commaQ(A) = P0(A), for all upper A element of script upper G period∀A ∈G.
If sans serif upper P 0P0 is sigmaσ-ﬁnite, then sans serif upper QQ is its unique extension. 
It is worth noting script upper GG is deﬁned to be an algebra, i.e. a collection of subsets from double struck upper RR
such that properties (S1) and (S2) of a sigma hyphen algebraσ-algebra hold but property (S3) becomes: 
(S3’) 
For any ﬁnite sequence upper A 1 comma upper A 2 comma ellipsis comma upper A Subscript n BaselineA1, A2, . . . , An of events belonging to script upper GG also 
union Subscript i equals 1 Superscript n Baseline upper A Subscript i Baseline element of script upper G period∪n
i=1Ai ∈G.
In general, an algebra is smaller than a sigma hyphen algebraσ-algebra and any sigma hyphen algebraσ-algebra is also an 
algebra, but the converse is not true: an algebra may contain countable sequences 
of sets left parenthesis upper A Subscript i Baseline right parenthesis Subscript i element of double struck upper N(Ai)i∈N but there is not guarantee that their union union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i∪∞
i=1Ai is in here. 
Theorem 2.4 is a general result from measure theory: in our application sans serif upper QQ is 
understood as a probability. Here sigma left parenthesis script upper G right parenthesisσ(G) deserves the special name of Borel bold italic sigmaσ-
algebra, usually denoted by script upper BB; its members are called Borel sets . Observe that 
sans serif upper P 0 left parenthesis empty set right parenthesis equals sans serif upper Q left parenthesis empty set right parenthesis equals 0P0(∅) = Q(∅) = 0. 
Remark 2.18 For (a premeasure sans serif upper P 0P0 or) a measure sans serif upper Q commaQ, the term sigmaσ-ﬁnite means that 
sans serif upper Q left parenthesis upper A Subscript i Baseline right parenthesis less than normal infinityQ(Ai) < ∞for any covering union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i Baseline equals upper Omega comma∪∞
i=1Ai = Ω, i.e. upper A Subscript i Baseline subset of upper OmegaAi ⊂Ω for all i element of double struck upper Ni ∈N. Any  
probability sans serif upper QQ is a ﬁnite measure, i.e. sans serif upper Q left parenthesis upper Omega right parenthesis less than normal infinity commaQ(Ω) < ∞, and this in turn implies sigmaσ-
ﬁniteness. 
Remark 2.19 Our construction of a probability measure sans serif upper QQ on the real measurable 
space left parenthesis double struck upper R comma script upper B right parenthesis(R, B) uses the concept of a generated sigma hyphen algebraσ-algebra sigma left parenthesis script upper G right parenthesisσ(G): given  script upper G subset of 2 Superscript double struck upper RG ⊂2R the 
generated sigma hyphen algebraσ-algebra always exists and equals the intersection of all sigma hyphen algebraσ-algebras
24 If in addition limit Underscript x right arrow negative normal infinity Endscripts upper F left parenthesis x right parenthesis equals 0limx→−∞F(x) = 0 and limit Underscript x right arrow normal infinity Endscripts upper F left parenthesis x right parenthesis equals 1limx→∞F(x) = 1 we call the c ModifyingAbove a With grave dl ModifyingAbove a With grave gcàdlàg F a distribution 
function. 
60
2
Distribution of Random Variables
containing script upper GG, i.e. sigma left parenthesis script upper G right parenthesisσ(G) is the smallest sigma hyphen algebraσ-algebra containing script upper GG. If  script upper GG and script upper DD are 
different families of subsets in double struck upper RR and script upper G subset of sigma left parenthesis script upper D right parenthesis commaG ⊂σ(D), then sigma left parenthesis script upper G right parenthesis subset of sigma left parenthesis script upper D right parenthesisσ(G) ⊂σ(D). 
For the Curious 
The class script upper GG containing all ﬁnite disjoint unions of left parenthesis a comma b right bracket(a, b] together with empty set∅is an 
algebra but not a sigma hyphen algebraσ-algebra. More formally: 
1. Every upper A equals union Subscript k equals 1 Superscript m Baseline left parenthesis a Subscript k Baseline comma b Subscript k Baseline right bracket element of script upper GA = ∪m
k=1(ak, bk] ∈G is itself of the form left parenthesis right bracket(
] iff b Subscript k Baseline equals a Subscript k plus 1bk = ak+1 for k equals 1 comma ellipsis comma m minus 1 periodk =
1, . . . , m−1. Moreover, upper A Superscript cAc is left parenthesis negative normal infinity comma a 1 right bracket union left parenthesis b 1 comma a 2 right bracket union midline horizontal ellipsis union left parenthesis b Subscript m minus 1 Baseline comma a Subscript m Baseline right bracket union left parenthesis b Subscript m Baseline comma normal infinity right bracket(−∞, a1]∪(b1, a2]∪· · ·∪(bm−1, am]∪(bm, ∞]
and then belong to script upper GG. 
2. If upper B equals left parenthesis c 1 comma d 1 right bracket union midline horizontal ellipsis union left parenthesis c Subscript n Baseline comma d Subscript n Baseline right bracket element of script upper G commaB = (c1, d1] ∪· · · ∪(cn, dn] ∈G, then upper A union upper B element of script upper G periodA ∪B ∈G.
3. .A ∩B = ∪m
i=1 ∪n
j=1 (ai, bi] ∩(cj, dj] is made of ﬁnite disjoint unions, thus 
upper A intersection upper B element of script upper GA ∩B ∈G; intersections can be empty set∅or left parenthesis right bracket( ]. 
4. Taking upper A Subscript n Baseline equals left parenthesis 0 comma 1 minus StartFraction 1 Over n EndFraction right bracket commaAn = (0, 1 −1
n], each n element of double struck upper N comman ∈N, we have union Subscript n equals 1 Superscript normal infinity Baseline upper A Subscript n Baseline equals left parenthesis 0 comma 1 right parenthesis∪∞
n=1An = (0, 1) is not in script upper GG; 
intersection Subscript n equals 1 Superscript normal infinity Baseline left parenthesis a minus StartFraction 1 Over n EndFraction comma a right bracket equals StartSet a EndSet∩∞
n=1(a −1
n, a] = {a} and neither singletons are in script upper GG. 
Items 1–3 give properties (S1),(S2), but 4 shows that script upper GG may not contain countable 
unions (and also intersections). Though, taking unions and complements of elements 
from script upper GG, uncountably often, we generate script upper BB. Observe that singletons StartSet a EndSet{a} belongs to 
script upper BB by item 4 above. The Borel sigma hyphen algebraσ-algebra can be generated in different ways. 
• 
Open ﬁnite intervals generate script upper BB, since taking c equals StartFraction b minus a Over 2 EndFractionc =
b−a
2
we have left parenthesis a comma b right parenthesis equals union Subscript i equals 1 Superscript normal infinity Baseline left parenthesis a comma b minus StartFraction c Over i EndFraction right bracket(a, b) =
∪∞
i=1(a, b −c
i ] as a countable union of elements from script upper GG. 
• 
Open subsets25 of double struck upper RR generate script upper BB. Indeed, every open set can be written as 
countable union upper A equals union Subscript i equals 1 Superscript normal infinity Baseline left parenthesis a Subscript i Baseline comma b Subscript i Baseline right parenthesis periodA = ∪∞
i=1(ai, bi). Conversely, we have left parenthesis a comma b right bracket equals intersection Subscript i equals 1 Superscript normal infinity Baseline left parenthesis a comma b plus StartFraction 1 Over i EndFraction right parenthesis(a, b] = ∩∞
i=1(a, b+ 1
i ). 
In fact, the standard deﬁnition of script upper BB is based on open sets like left parenthesis negative normal infinity comma a right parenthesis union left parenthesis b comma normal infinity right parenthesis(−∞, a) ∪(b, ∞)
which are not open ﬁnite intervals. 
• 
Half-rays left parenthesis negative normal infinity comma x right bracket(−∞, x] generate script upper BB for every x element of double struck upper Rx ∈R. 
Actually, script upper BB can be generated by closed sets, see Exercise 2.5. Now we show that 
the family script upper DD of half-rays together with empty set∅generate the Borel sigma hyphen algebraσ-algebra. Clearly 
left parenthesis negative normal infinity comma x right bracket equals left parenthesis x comma normal infinity right parenthesis Superscript c Baseline comma(−∞, x] = (x, ∞)c, for all x element of double struck upper R periodx ∈R. Then intervals left parenthesis negative normal infinity comma x right bracket(−∞, x] are contained in script upper BB, as  
complements of open ﬁnite intervals. By assumption they generate sigma left parenthesis script upper G right parenthesisσ(𝒢) and then, 
see Remark 2.19, we have  sigma left parenthesis script upper G right parenthesis subset of script upper B periodσ(𝒢) ⊂B. It sufﬁces to show the reverse inclusion. 
Intervals 
left parenthesis x comma y right bracket equals left parenthesis negative normal infinity comma y right bracket intersection left parenthesis negative normal infinity comma x right bracket Superscript c Baseline for all x less than y(x, y] = (−∞, y] ∩(−∞, x]c
for all x < y
are contained in sigma left parenthesis script upper G right parenthesisσ(𝒢). Moreover, for any open interval we can write left parenthesis a comma b right parenthesis equals union Subscript i equals 1 Superscript normal infinity Baseline left parenthesis a comma b minus StartFraction c Over i EndFraction right bracket(a, b) =
∪∞
i=1(a, b −c
i ] with c equals StartFraction left parenthesis b minus a right parenthesis Over 2 EndFractionc = (b−a)
2
. It follows left parenthesis a comma b right parenthesis element of sigma left parenthesis script upper G right parenthesis(a, b) ∈σ(𝒢). But every open set in 
script upper BB is given by a countable union of open intervals left parenthesis a comma b right parenthesis(a, b), then the collection of open
25 See Appendix. 
Appendix
61
subsets of double struck upper RR is contained in sigma left parenthesis script upper G right parenthesisσ(𝒢). By Remark 2.19 we have script upper B subset of sigma left parenthesis script upper G right parenthesisB ⊂σ(𝒢) and this 
together with the above inclusion shows that script upper B equals sigma left parenthesis script upper G right parenthesisB = σ(𝒢). 
Measurable Maps and Image Measures 
In the main text we have deﬁned a random function upper X colon upper Omega right arrow double struck upper RX : Ω →R to get a numerical 
representation, namely a random number x equals upper X left parenthesis omega right parenthesisx = X(ω), for all possible scenarios omega element of upper Omegaω ∈
Ω. To compute sans serif upper P left parenthesis upper A right parenthesisP(A) for every upper A element of script upper FA ∈F we restrict ourselves to the following kind of 
random functions. 
Deﬁnition 2.10 Let left parenthesis upper Omega comma script upper F right parenthesis(Ω, F) be an event space and let left parenthesis double struck upper R comma script upper B right parenthesis(R, B) be the real measurable 
space. A random function upper X colon upper Omega right arrow double struck upper RX : Ω →R is  a rv iff  
upper X Superscript negative 1 Baseline left parenthesis upper B right parenthesis colon equals StartSet omega element of upper Omega vertical bar upper X left parenthesis omega right parenthesis element of upper B EndSet element of script upper F comma for all upper B element of script upper B commaX−1(B) := {ω ∈Ω | X(ω) ∈B} ∈F,
for all B ∈B,
(2.27) 
and we say X is a measurable map, or it is script upper FF-measurable. 
Remark 2.20 Deﬁnition 2.10 is still valid with left parenthesis upper Omega comma script upper F right parenthesis(Ω, F) replaced by left parenthesis double struck upper R comma script upper B right parenthesis(R, B), i.e. any 
map g colon double struck upper R right arrow double struck upper Rg : R →R s.t. (2.27) holds is measurable, and we call it Borel-measurable 
function. E.g., upper B equals left parenthesis x comma y right bracket element of script upper BB = (x, y] ∈B, with x less than yx < y yields g Superscript negative 1 Baseline left parenthesis left parenthesis x comma y right bracket right parenthesis equals StartSet x element of double struck upper R vertical bar g left parenthesis x right parenthesis element of left parenthesis x comma y right bracket EndSet element of script upper Bg−1((x, y]) = {x ∈R | g(x) ∈
(x, y]} ∈B. 
Every collection of scenarios omega element of upper Omegaω ∈Ω forming an event  upper A element of script upper FA ∈F is transformed by X 
into a ‘measurable’ object, i.e. a subset of double struck upper RR which belongs to the Borel sigma hyphen algebraσ-algebra: 
StartLayout 1st Row 1st Column upper Omega 2nd Column right arrow Overscript upper X Endscripts 3rd Column double struck upper R From scenarios to random numbers 2nd Row 1st Column script upper F 2nd Column left arrow Overscript upper X Superscript negative 1 Endscripts 3rd Column script upper B Pull back a Borel set to an event EndLayoutΩ
X
−−−−→R
From scenarios to random numbers
F
X−1
←−−−−B
Pull back a Borel set to an event
Now, for the reader’s convenience we recall the following. For any random function 
upper X colon upper Omega right arrow double struck upper RX : Ω →R we have: 
• 
.X(A) = {b ∈R | b = X(ω) for some ω ∈Ω} is the image of upper A subset of upper OmegaA ⊂Ω under X. 
Clearly upper X left parenthesis upper A right parenthesis subset of double struck upper RX(A) ⊂R. The special case upper X left parenthesis upper Omega right parenthesis X(Ω) is called the range of X; 
• 
.X−1(B) = {ω ∈Ω | X(ω) ∈R} is the inverse image of upper B subset of double struck upper RB ⊂R; clearly 
upper X Superscript negative 1 Baseline left parenthesis upper B right parenthesis subset of upper OmegaX−1(B) ⊂Ω; 
• 
The inverse image is always deﬁned as a set function upper X Superscript negative 1 Baseline colon 2 Superscript double struck upper R Baseline right arrow 2 Superscript upper OmegaX−1 : 2R →2Ω, the  
domain being the power set of double struck upper RR. When upper X Superscript negative 1X−1 maps every Borel set upper B element of script upper B subset of 2 Superscript double struck upper RB ∈B ⊂2R
into an event upper A element of script upper F subset of 2 Superscript upper OmegaA ∈F ⊂2Ω, then as a measurable function it is also a rv. 
Remark 2.21 (Properties of Image and Inverse Image) Let 
left parenthesis upper A Subscript i Baseline right parenthesis Subscript i element of upper I Baseline subset of 2 Superscript upper Omega Baseline comma left parenthesis upper B Subscript j Baseline right parenthesis Subscript j element of upper J Baseline subset of 2 Superscript double struck upper R(Ai)i∈I
⊂
2Ω, (Bj)j∈J ⊂2R be two families of subsets of upper OmegaΩ and double struck upper RR, respectively. Then, 
deﬁne a random function upper X colon upper Omega right arrow double struck upper RX : Ω →R. The image of X commutes with unions but 
not with intersections, while the inverse image commutes with unions, intersections 
and set complement:
62
2
Distribution of Random Variables
1. . X(∪i∈IAi) = ∪i∈IX(Ai)
2. . X(∩i∈IAi) ⊂∩i∈IX(Ai)
3. . X−1(∪j∈J Bi) = ∪j∈J X−1(Bj)
4. . X−1(∩j∈J Bi) = ∩j∈J X−1(Bj)
5. .X−1(Bc) = (X−1(B))c. 
In fact, not every mapping upper X colon upper Omega right arrow double struck upper RX : Ω →R is a rv. 
Example 2.15 Toss a fair coin twice and let upper Omega equals StartSet upper H upper H comma upper H upper T comma upper T upper H comma upper T upper T EndSetΩ = {HH, HT, TH, TT} coupled with 
the sigma hyphen algebraσ-algebra script upper F equals StartSet empty set comma StartSet upper H upper T comma upper T upper H EndSet comma StartSet upper H upper H comma upper T upper T EndSet comma StartSet upper H upper H comma upper H upper T comma upper T upper H comma upper T upper T EndSet EndSet periodF = {∅, {HT, TH}, {HH, TT}, {HH, HT, TH, TT}} . You either win 
e 1 if a head is showed twice or loose e 1 if a tail is showed twice, otherwise you 
neither win nor loose. Deﬁne the map 
upper X left parenthesis omega right parenthesis equals StartLayout Enlarged left brace 1st Row 1st Column 1 comma 2nd Column if omega equals upper H upper H 2nd Row 1st Column 0 comma 2nd Column if omega equals upper H upper T or omega equals upper T upper H 3rd Row 1st Column negative 1 comma 2nd Column if omega equals upper T upper T period EndLayoutX(ω) =
⎧
⎨
⎩
1,
if
ω = HH
0,
if
ω = HT
or
ω = TH
−1, if
ω = TT.
Choosing the Borel set upper B equals left parenthesis negative normal infinity comma negative 1 right bracket union left parenthesis negative 1 comma 0 right parenthesis union left parenthesis 1 comma normal infinity right parenthesisB = (−∞, −1] ∪(−1, 0) ∪(1, ∞) we have left brace upper X element of upper B right brace equals StartSet upper T upper T EndSet not an element of script upper F period{X ∈B} =
{TT} /∈F. Similarly, upper B equals left parenthesis negative normal infinity comma negative 1 right parenthesis union left parenthesis negative 1 comma 0 right parenthesis union left bracket 1 comma normal infinity right parenthesisB = (−∞, −1) ∪(−1, 0) ∪[1, ∞) gives left brace upper X element of upper B right brace equals StartSet upper H upper H EndSet not an element of script upper F period{X ∈B} =
{HH} /∈F. In both cases the choice of a Borel set in the image space left parenthesis double struck upper R comma script upper B right parenthesis(R, B) does 
not guarantee that the inverse image upper X Superscript negative 1X−1 is in the sigma hyphen algebraσ-algebra script upper FF of events. 
Example 2.16 (i) The identity map id colon upper Omega right arrow upper Omegaid : Ω →Ω deﬁned by id left parenthesis omega right parenthesis equals omegaid(ω) = ω is 
measurable, since for every upper B element of script upper FB ∈F we have id Superscript negative 1 Baseline left parenthesis upper B right parenthesis equals upper B element of script upper F periodid−1(B) = B ∈F. (ii) Any map X 
between left parenthesis upper Omega comma script upper F right parenthesis(Ω, F) and left parenthesis double struck upper R comma script upper S right parenthesis(R, S) such that script upper F equals 2 Superscript upper OmegaF = 2Ω or script upper S equals StartSet empty set comma double struck upper R EndSetS = {∅, R} is always measurable. 
In the former case, for every upper B element of script upper SB ∈S we have upper X Superscript negative 1 Baseline left parenthesis upper B right parenthesis element of 2 Superscript upper Omega Baseline periodX−1(B) ∈2Ω. In the latter case, either 
upper X Superscript negative 1 Baseline left parenthesis empty set right parenthesis equals empty setX−1(∅) = ∅or upper X Superscript negative 1 Baseline left parenthesis double struck upper R right parenthesis equals upper OmegaX−1(R) = Ω by deﬁnition, and both inverse images are in script upper F periodF.
Example 2.17 Let left parenthesis upper Omega comma script upper F right parenthesis(Ω, F) be an event space. Deﬁne the map upper X colon upper Omega right arrow double struck upper RX : Ω →R by 
upper X left parenthesis omega right parenthesis equals cX(ω) = c for every omega element of upper Omegaω ∈Ω and c element of double struck upper Rc ∈R ﬁxed. Then X is measurable, since for 
every upper B element of script upper BB ∈B we have either c element of upper Bc ∈B or c element of upper B Superscript cc ∈Bc so that upper X Superscript negative 1 Baseline left parenthesis upper B right parenthesis equals left brace upper X element of upper B right braceX−1(B) = {X ∈B} is 
in script upper F periodF. The collection of its inverse images is the trivial sigma hyphen algebraσ-algebra StartSet empty set comma upper Omega EndSet period{∅, Ω}. We have 
upper X Superscript negative 1 Baseline left parenthesis StartSet c EndSet right parenthesis equals upper Omega commaX−1({c}) = Ω, with empty set∅as its complement. 
When a random function if indeed a rv X, then the abstract probability space 
left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P) is translated into a real probability space left parenthesis double struck upper R comma script upper B comma sans serif upper P Subscript upper X Baseline right parenthesis(R, B, PX), where the law 
of X is actually a composed map: 
sans serif upper P Subscript upper X Baseline left parenthesis upper B right parenthesis colon equals sans serif upper P left parenthesis upper X Superscript negative 1 Baseline left parenthesis upper B right parenthesis right parenthesis equals sans serif upper Q left parenthesis upper B right parenthesis comma for all Borel sets upper B element of script upper B periodPX(B) := P(X−1(B)) = Q(B),
for all Borel sets B ∈B.
(2.28) 
Therefore, the set function sans serif upper P Subscript upper XPX is a probability measure sans serif upper QQ deﬁned on script upper BB, also called 
the image measure of sans serif upper PP. The intuition behind this is depicted in Fig. 2.7 .
Appendix
63
Fig. 2.7 A rv  X as a 
measurable function: its 
image X entails upper B subset of double struck upper RB ⊂R, 
while its inverse image upper X Superscript negative 1X−1
pullbacks it to script upper BB, since it is a 
Borel set, and eventually the 
composed map sans serif upper P ring upper X Superscript negative 1P ◦X−1
delivers the law sans serif upper P Subscript upper X Baseline left parenthesis upper B right parenthesisPX(B)
X 
0
1 
X 
B
X 
B
       X 
X 
B 
Distribution Function on R 
As in probability spaces left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P), the role of distribution function (DF) is similar 
to that of CDF but now for probabilities on double struck upper RR.26 
Theorem 2.5 Let upper F colon double struck upper R right arrow left bracket 0 comma 1 right bracketF : R →[0, 1] be a DF. Then, there exists a unique probability 
measure sans serif upper QQ on the event space left parenthesis double struck upper R comma script upper B right parenthesis(R, B) s.t. 
sans serif upper Q left parenthesis left parenthesis a comma b right bracket right parenthesis equals upper F left parenthesis b right parenthesis minus upper F left parenthesis a right parenthesis commaQ((a, b]) = F(b) −F(a),
(2.29) 
for all negative normal infinity less than or slanted equals a less than b less than normal infinity period−∞⩽a < b < ∞.
If sans serif upper QQ is a probability measure on left parenthesis double struck upper R comma script upper B right parenthesis(R, B) we have also the converse: to sans serif upper QQ there 
corresponds a DF upper F colon double struck upper R right arrow left bracket 0 comma 1 right bracketF : R →[0, 1] through: 
upper F left parenthesis x right parenthesis equals sans serif upper Q left parenthesis left parenthesis negative normal infinity comma x right bracket right parenthesis comma for all x element of double struck upper R periodF(x) = Q((−∞, x]),
∀x ∈R.
(2.30) 
By the above and Theorem 2.5 we conclude that there exists a 1-to-1 correspondence 
between probability measures sans serif upper QQ and DFs on left parenthesis double struck upper R comma script upper B right parenthesis(R, B). 
StartLayout 1st Row 1st Column upper F is a DF 2nd Column long right double arrow 3rd Column formula sans serif upper Q left parenthesis left parenthesis a comma b right bracket right parenthesis colon equals upper F left parenthesis b right parenthesis minus upper F left parenthesis a right parenthesis 2nd Row 1st Column Blank 2nd Column Blank 3rd Column defines a probability measure on left parenthesis double struck upper R comma script upper B right parenthesis 3rd Row 1st Column sans serif upper Q is a probability 2nd Column long right double arrow 3rd Column upper F left parenthesis x right parenthesis colon equals sans serif upper Q left parenthesis left parenthesis negative normal infinity comma x right bracket right parenthesis is a DF 4th Row 1st Column Blank 2nd Column Blank 3rd Column from double struck upper R to left bracket 0 comma 1 right bracket EndLayoutF is a DF =⇒formula Q((a, b]) := F(b) −F(a)
deﬁnes a probability measure on (R, B)
Q is a probability =⇒F(x) := Q((−∞, x]) is a DF
from R to [0, 1]
The ultimate connection between left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P) and probability spaces deﬁned on double struck upper RR is 
given by considering double struck upper RR as the sample space, script upper FF replaced by script upper BB and sans serif upper P equals sans serif upper Q equals sans serif upper P Subscript upper XP = Q = PX,
26 The term DF replaces CDF when we consider probabilities deﬁned over the event space left parenthesis double struck upper R comma script upper B right parenthesis(R, B). 
Thus, any DF satisﬁes properties (a)–(c) of Theorem 2.1. 
64
2
Distribution of Random Variables
i.e. the probability measure on double struck upper RR can be taken as the law of a ﬁxed rv X so that 
upper F identical to upper F Subscript upper XF ≡FX. Moral: we can compute probabilities on double struck upper RR without explicitly mention any 
rv, but instead by working with Borel sets (what in the main text we have called 
suitable subsets upper B subset of double struck upper RB ⊂R). 
Example 2.18 (Discrete Distribution on double struck upper RR) Given a piecewise constant DF F 
let us consider the set StartSet q 1 comma q 2 comma ellipsis EndSet{q1, q2, . . .} with q Subscript i Baseline colon equals sans serif upper Q left parenthesis StartSet x Subscript i Baseline EndSet right parenthesis commaqi := Q({xi}), for i equals 1 comma 2 comma ellipsisi = 1, 2, . . . made of 
probability weights given by the F’s jumps: 
sans serif upper Q left parenthesis StartSet x Subscript i Baseline EndSet right parenthesis equals upper F left parenthesis x Subscript i Baseline right parenthesis minus upper F left parenthesis x Subscript i minus 1 Baseline right parenthesis greater than 0 comma with upper F left parenthesis x Subscript i minus 1 Baseline right parenthesis equals upper F left parenthesis x Subscript i Baseline minus right parenthesis periodQ({xi}) = F(xi) −F(xi−1) > 0, with F(xi−1) = F(xi−).
Indeed, using formula (2.29) we claim 
sans serif upper Q left parenthesis left parenthesis a comma b right bracket right parenthesis equals sans serif upper Q left parenthesis left parenthesis a comma b right parenthesis union StartSet b EndSet right parenthesis equals sans serif upper Q left parenthesis left parenthesis a comma b right parenthesis right parenthesis plus sans serif upper Q left parenthesis StartSet b EndSet right parenthesis commaQ((a, b]) = Q((a, b) ∪{b}) = Q((a, b)) + Q({b}),
for a equals x Subscript i minus 1a = xi−1 and b equals x Subscript ib = xi. This is equivalent to have: sans serif upper Q left parenthesis left parenthesis x Subscript i minus 1 Baseline comma x Subscript i Baseline right parenthesis right parenthesis equals 0Q((xi−1, xi)) = 0 and 
sigma summation Underscript i equals 1 Overscript normal infinity Endscripts q Subscript i Baseline equals 1∑∞
i=1 qi = 1. On the other hand, upper F left parenthesis x right parenthesis equals sans serif upper Q left parenthesis left parenthesis negative normal infinity comma x right bracket right parenthesis equals sigma summation Underscript x Subscript i Baseline less than or slanted equals x Endscripts q Subscript i Baseline periodF(x) = Q((−∞, x]) = ∑
xi ⩽x qi.
Example 2.19 (Continuous Distribution on double struck upper RR) Let F be a continuous DF, upper F left parenthesis x right parenthesis minus upper F left parenthesis x minus right parenthesis equals 0F(x)−
F(x−) = 0 each x element of double struck upper Rx ∈R. Thus, given another real-valued integrable (in some sense) 
function f such that f left parenthesis x right parenthesis greater than or slanted equals 0 commaf (x) ⩾0, for x element of double struck upper Rx ∈R, we can build a probability measure by 
deﬁning upper F left parenthesis x right parenthesis equals integral Subscript negative normal infinity Superscript x Baseline f left parenthesis u right parenthesis normal d u commaF(x) =
⨜x
−∞f (u)du, provided integral Subscript negative normal infinity Superscript normal infinity Baseline f left parenthesis x right parenthesis normal d x equals 1
⨜∞
−∞f (x)dx = 1. Thus, 
sans serif upper Q left parenthesis left parenthesis a comma b right bracket right parenthesis equals upper F left parenthesis b right parenthesis minus upper F left parenthesis a right parenthesis equals integral Subscript negative normal infinity Superscript b Baseline f left parenthesis x right parenthesis normal d x minus integral Subscript negative normal infinity Superscript a Baseline f left parenthesis x right parenthesis normal d x commaQ((a, b]) = F(b) −F(a) =
⨜b
−∞
f (x)dx −
⨜a
−∞
f (x)dx,
and F is said to be absolutely continuous. Now, we have StartSet x EndSet equals left parenthesis negative normal infinity comma x right bracket minus left parenthesis negative normal infinity comma x right parenthesis{x} = (−∞, x] \ (−∞, x)
and upper F left parenthesis x minus right parenthesis equals limit Underscript i right arrow normal infinity Endscripts sans serif upper Q left parenthesis left parenthesis negative normal infinity comma x Subscript i Baseline right bracket right parenthesis equals sans serif upper Q left parenthesis left parenthesis negative normal infinity comma x right parenthesis right parenthesis commaF(x−) = limi→∞Q((−∞, xi]) = Q((−∞, x)), for x Subscript i Baseline up arrow x commaxi ↑x, and then 
StartLayout 1st Row 1st Column upper F left parenthesis x right parenthesis minus upper F left parenthesis x minus right parenthesis 2nd Column equals 3rd Column sans serif upper Q left parenthesis left parenthesis negative normal infinity comma x right bracket right parenthesis minus sans serif upper Q left parenthesis left parenthesis negative normal infinity comma x right parenthesis right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper Q left parenthesis StartSet x EndSet right parenthesis equals 0 EndLayoutF(x) −F(x−) = Q((−∞, x]) −Q((−∞, x))
= Q({x}) = 0
which is equivalent to sans serif upper Q left parenthesis StartSet x EndSet right parenthesis equals integral Subscript x Superscript x Baseline f left parenthesis u right parenthesis normal d u equals 0 commaQ({x}) =
⨜x
x f (u)du = 0, and the corresponding probability 
sans serif upper QQ put a zero weight on singletons. 
Stieltjes Measure 
Let sans serif upper PP be a probability measure27 on left parenthesis double struck upper R comma script upper B right parenthesis(R, B), Then, sans serif upper PP determines a c ModifyingAbove a With grave dl ModifyingAbove a With grave gcàdlàg function. 
First, deﬁne upper F colon double struck upper R right arrow double struck upper RF : R →R by 
upper F left parenthesis x right parenthesis equals StartLayout Enlarged left brace 1st Row 1st Column sans serif upper P left parenthesis left parenthesis 0 comma x right bracket right parenthesis comma 2nd Column if x greater than or slanted equals 0 2nd Row 1st Column minus sans serif upper P left parenthesis left parenthesis x comma 0 right bracket right parenthesis comma 2nd Column if x less than or slanted equals 0 period EndLayoutF(x) =
⌠
P((0, x]), if x ⩾0
−P((x, 0]), if x ⩽0.
27 Or more generally a ﬁnite measure. 
Appendix
65
By Deﬁnition 1.3, item PA2, Chap. 1, we have:  
upper F left parenthesis x 1 right parenthesis less than or slanted equals upper F left parenthesis x 2 right parenthesis long left right double arrow sans serif upper P left parenthesis left parenthesis 0 comma x 1 right bracket right parenthesis less than or slanted equals sans serif upper P left parenthesis left parenthesis 0 comma x 2 right bracket right parenthesisF(x1) ⩽F(x2) ⇐⇒P((0, x1]) ⩽P((0, x2])
when 0 less than or slanted equals x 1 less than x 2 element of double struck upper R0 ⩽x1 < x2 ∈R. If  x greater than or slanted equals 0x ⩾0 and x Subscript i Baseline down arrow xxi ↓x, then intervals left parenthesis 0 comma x Subscript i Baseline right bracket(0, xi] decrease to 
left parenthesis 0 comma x right bracket(0, x], the case x less than or slanted equals 0x ⩽0 being similar. Therefore, using continuity from above, see 
Appendix in Chap. 1, we see that 
upper F left parenthesis x Subscript i Baseline right parenthesis equals sans serif upper P left parenthesis left parenthesis 0 comma x Subscript i Baseline right bracket right parenthesis down arrow sans serif upper P left parenthesis left parenthesis 0 comma x right bracket right parenthesis equals upper F left parenthesis x right parenthesisF(xi) = P((0, xi]) ↓P((0, x]) = F(x)
and then limit Underscript i Endscripts upper F left parenthesis x Subscript i Baseline right parenthesis equals upper F left parenthesis x right parenthesis periodlimi F(xi) = F(x). Using continuity from below gives a similar result for 
x less than or slanted equals 0x ⩽0. Thus F is both continuous from the right and non-decreasing, so it is c ModifyingAbove a With grave dl ModifyingAbove a With grave gcàdlàg. 
Finally, since left parenthesis a comma b right bracket equals left parenthesis negative normal infinity comma b right bracket minus left parenthesis negative normal infinity comma a right bracket(a, b] = (−∞, b] \ (−∞, a] we have 
sans serif upper P left parenthesis left parenthesis a comma b right bracket right parenthesis equals upper F left parenthesis b right parenthesis minus upper F left parenthesis a right parenthesis comma a less than b element of double struck upper R commaP((a, b]) = F(b) −F(a),
a < b ∈R,
(2.31) 
for every interval with ﬁnite endpoints,28 which is nothing else (2.29) in Theo-
rem 2.5. On the other hand, a bounded c ModifyingAbove a With grave dl ModifyingAbove a With grave gcàdlàg function upper F colon double struck upper R right arrow double struck upper RF : R →R determines 
a measure on left parenthesis double struck upper R comma script upper B right parenthesis(R, B). Indeed, deﬁne a set function sans serif upper PP by Eq. (2.31) and then extend 
it29 to the Borel sigma hyphen algebraσ-algebra script upper BB. If  F and upper F overTilde˜F are two c ModifyingAbove a With grave dl ModifyingAbove a With grave gcàdlàg functions such that upper F equals upper F overTildeF = ˜F, 
then they deﬁne two set functions through (2.31) extending to a unique measure sans serif upper PP
on script upper BB. But we should deﬁne ModifyingAbove upper F With tilde left parenthesis x right parenthesis equals upper F left parenthesis x right parenthesis plus c ˜F(x) = F(x) + c for c element of double struck upper Rc ∈R, thus two c ModifyingAbove a With grave dl ModifyingAbove a With grave gcàdlàg functions 
F and upper F overTilde˜F differing by a constant induce the same ﬁnite measure which assigns ﬁnite 
values to bounded intervals. This is also called a Stieltjes measure. 
Absolutely Continuous Functions 
The concept of absolutely continuous probability distribution has a counterpart in 
real analysis which we present here for the sake of completeness. A real-valued 
function upper F colon left bracket a comma b right bracket right arrow double struck upper RF : [a, b] →R is said to be absolutely continuous if for every epsilon greater than 0ϵ > 0
there exists delta greater than 0δ > 0 s.t. for every n element of double struck upper Nn ∈N and all collections left parenthesis a 1 comma b 1 right parenthesis comma ellipsis comma left parenthesis a Subscript n Baseline comma b Subscript n Baseline right parenthesis(a1, b1), . . . , (an, bn) of 
disjoint open subintervals of left bracket a comma b right bracket[a, b], of total length at most deltaδ, i.e. sigma summation Underscript i equals 1 Overscript n Endscripts StartAbsoluteValue b Subscript i Baseline minus a Subscript i Baseline EndAbsoluteValue less than or slanted equals delta∑n
i=1 |bi −ai| ⩽δ, 
we have sigma summation Underscript i equals 1 Overscript n Endscripts StartAbsoluteValue upper F left parenthesis b Subscript i Baseline right parenthesis minus upper F left parenthesis a Subscript i Baseline right parenthesis EndAbsoluteValue less than or slanted equals epsilon∑n
i=1 |F(bi) −F(ai)| ⩽ϵ. This always implies upper F left parenthesis x right parenthesisF(x) is continuous on 
left bracket a comma b right bracket[a, b]. A function upper F colon double struck upper R right arrow double struck upper RF : R →R is said to be absolutely continuous if its restriction on 
left bracket a comma b right bracket[a, b] is. If upper F left parenthesis x right parenthesisF(x) has a bounded derivative upper F prime left parenthesis x right parenthesisF '(x) for every x then StartAbsoluteValue upper F left parenthesis x 2 right parenthesis minus upper F left parenthesis x 1 right parenthesis EndAbsoluteValue less than or slanted equals upper M left parenthesis x 2 minus x 1 right parenthesis|F(x2)−F(x1)| ⩽
M(x2 −x1) for x 1 less than x 2x1 < x2, where upper M greater than 0M > 0 is some constant depending on F. This is
28 Using the one-dimensional Lebesgue measure, sans serif upper P identical to mP ≡m, it holds m left parenthesis left parenthesis 0 comma x right bracket right parenthesis equals xm((0, x]) = x, for  x greater than or slanted equals 0x ⩾0 and 
minus m left parenthesis left parenthesis x comma 0 right bracket right parenthesis equals minus left parenthesis negative x right parenthesis−m((x, 0]) = −(−x) for x less than or slanted equals 0x ⩽0, so we must have upper F left parenthesis x right parenthesis equals xF(x) = x. 
29 The standard machine works: Carathéodory extension theorem together with Dynkin piπ-d 
theorem stating that a generator script upper GG which is a piπ-system entails sigma left parenthesis script upper G right parenthesisσ(G) equal to the generated d-
system, d left parenthesis script upper G right parenthesisd(G) . Actually, sans serif upper PP should be deﬁned on the class script upper G𝒢of all ﬁnite disjoint unions of intervals 
left parenthesis a comma b right bracket(a, b] which is a piπ-system generating script upper BB. 
66
2
Distribution of Random Variables
called Lipschitz condition. Indeed, by the boundedness of the derivative and the 
mean value theorem we have: 
StartAbsoluteValue upper F prime left parenthesis x right parenthesis EndAbsoluteValue less than or slanted equals upper M long left right double arrow StartFraction StartAbsoluteValue upper F left parenthesis x 2 right parenthesis minus upper F left parenthesis x 1 right parenthesis EndAbsoluteValue Over StartAbsoluteValue x 2 minus x 1 EndAbsoluteValue EndFraction less than or slanted equals upper M comma for some x element of left parenthesis x 1 comma x 2 right parenthesis period|F '(x)| ⩽M ⇐⇒|F(x2)−F(x1)|
|x2−x1|
⩽M,
for some x ∈(x1, x2).
The above condition further implies 
sigma summation Underscript i equals 1 Overscript n Endscripts StartAbsoluteValue upper F left parenthesis b Subscript i Baseline right parenthesis minus upper F left parenthesis a Subscript i Baseline right parenthesis EndAbsoluteValue less than or slanted equals upper M sigma summation Underscript i equals 1 Overscript n Endscripts StartAbsoluteValue b Subscript i Baseline minus a Subscript i Baseline EndAbsoluteValue less than or slanted equals delta upper M comma
n
⎲
i=1
|F(bi) −F(ai)| ⩽M
n
⎲
i=1
|bi −ai| ⩽δM,
where delta equals StartFraction epsilon Over upper M EndFraction periodδ =
ϵ
M . Thus the Lipschitz condition is sufﬁcient for a function F to be 
absolutely continuous. It can be shown that for any such function there exists another 
function f left parenthesis x right parenthesisf (x) such that the former can be deﬁned by integration: 
upper F left parenthesis x right parenthesis equals upper F left parenthesis a right parenthesis plus integral Subscript a Superscript x Baseline f left parenthesis u right parenthesis normal d u periodF(x) = F(a) +
⨜x
a
f (u)du.
As byproduct, any CDF of a continuous rv X, with law having density f Subscript upper XfX, is an  
absolutely continuous function with upper F equals upper F Subscript upper X Baseline comma f equals f Subscript upper X BaselineF = FX, f = fX and a equals negative normal infinitya = −∞so that 
upper F Subscript upper X Baseline left parenthesis negative normal infinity right parenthesis equals 0FX(−∞) = 0. Since upper F Subscript upper XFX represents the probability law sans serif upper P Subscript upper XPX we also say, with slight 
abuse, that the law of X is absolutely continuous with density f Subscript upper XfX, 
More on Quantile Function 
Proof of Proposition 2.2 (1) Deﬁne Lc := {x | FX(x) ⩾c} and observe that x ∈ 
LFX(x). It follows QX(FX(x)) = inf LFX(x) ⩽x and the claim is proved. (2) By 
deﬁnition any choice x ∈ Lc implies FX(x) ⩾c. This holds for every sequence 
(xi)i∈N ⊂ Lc decreasing to inf Lc = QX(c). Then by right-continuity of FX we 
have limi→∞ FX(xi) = FX(limi→∞ xi) = FX(QX(c)) and by the sign rule we are 
done. (3) Assume FX(x) ⩾c. Then x ∈ Lc and QX(c) = inf Lc ⩽x. On the 
other hand, FX is nondecreasing and applying (2) gives c ⩽FX(QX(c)) ⩽FX(x) 
proving the claim. (4) If c1 ⩽c2 then Lc2 ⊂Lc1 by deﬁnition (draw a graph). This 
is equivalent to inf Lc1 ⩽inf Lc2 and we are done. 
█
Proof of of Lemma 2.1 Pick x ∈ R and let QY (c) = QX(c). If  FX(x) < FY (x), 
then by items 1. and 4. of Proposition 2.2 we have Q(FX(x)) ⩽Q(FY (x)) ⩽x. But 
item 3. of the same Proposition gives FX(x) ⩽FY (x), a contradiction. A similar 
argument shows that FX(x) > FY (x) is another contradiction. Thus we must have 
FX(x) = FY (x) for any x ∈ R and the lemma is proved. 
█
Proof of Proposition 2.3 By Proposition 2.2, Item 3 we readily compute: 
upper Q Subscript f left parenthesis upper X right parenthesis Baseline left parenthesis c right parenthesis less than or slanted equals x long left right double arrow upper F Subscript f left parenthesis upper X right parenthesis Baseline left parenthesis x right parenthesis greater than or slanted equals c periodQf (X)(c) ⩽x ⇐⇒Ff (X)(x) ⩾c.
Appendix
67
Consider sup{z | f (z) ⩽x} and denote it z0, for  a ﬁxed  x ∈ R. Since f is left-
continuous (or strictly increasing) we readily have 
f left parenthesis z right parenthesis less than or slanted equals x long left right double arrow z less than or slanted equals z 0 periodf (z) ⩽x ⇐⇒z ⩽z0.
As byproduct, {f (X) ⩽x} = {X ⩽z0} then 
upper F Subscript f left parenthesis upper X right parenthesis Baseline left parenthesis x right parenthesis greater than or slanted equals c long left right double arrow upper F Subscript upper X Baseline left parenthesis z 0 right parenthesis greater than or slanted equals c periodFf (X)(x) ⩾c ⇐⇒FX(z0) ⩾c.
The two equivalences above, together with item 3 in Proposition 2.2, which gives 
FX(z0) ⩾c iff QX(x) ⩽z0, and 
upper Q Subscript upper X Baseline left parenthesis c right parenthesis less than or slanted equals z 0 long left right double arrow f left parenthesis upper Q Subscript upper X Baseline left parenthesis c right parenthesis right parenthesis less than or slanted equals x comma by the second equivalence above commaQX(c) ⩽z0 ⇐⇒f (QX(c)) ⩽x,
by the second equivalence above,
complete the proof for an arbitrary x ∈ R. 
█
Uniform Probability Spaces Again 
We have seen in Exercise 1.16, Chap. 1, that sigma Subscript upper E Baseline colon equals StartSet upper A intersection upper E vertical bar upper A element of script upper F EndSetσE := {A ∩E | A ∈F} is a sigma hyphen algebraσ-algebra
on upper OmegaΩ called trace-sigmaσ-algebra. Now, consider the experiment of choosing at random 
a number in upper Omega equals left parenthesis 0 comma 1 right bracketΩ = (0, 1] and endow the sample space with script upper B Subscript left parenthesis 0 comma 1 right bracketB(0,1] deﬁned as the 
Borel-trace-sigma hyphen algebraσ-algebra containing all Borel sets in script upper BB intersected with the unit interval 
left parenthesis 0 comma 1 right bracket(0, 1]. 
Remark 2.22 Given a sample space upper OmegaΩ and a generator script upper G𝒢, let  script upper G intersection upper E colon equals StartSet upper A intersection upper E vertical bar upper A element of script upper G EndSet𝒢∩E := {A ∩E |
A ∈𝒢} contains all intersections between each event in script upper G𝒢and a ﬁxed event upper E subset of upper OmegaE ⊂Ω. 
It can be shown that sigma left parenthesis script upper G intersection upper E right parenthesis equals sigma left parenthesis script upper G right parenthesis intersection upper E equals colon StartSet upper A intersection upper E vertical bar upper A element of sigma left parenthesis script upper G right parenthesis EndSet commaσ(𝒢∩E) = σ(𝒢) ∩E =: {A ∩E | A ∈σ(𝒢)}, i.e. the 
class of all intersections between each event A in the generated sigma hyphen algebraσ-algebra sigma left parenthesis script upper G right parenthesisσ(𝒢) and 
a ﬁxed event E is again a sigma hyphen algebraσ-algebra, which is generated by script upper G intersection upper E𝒢∩E. Taking script upper G𝒢as the 
collection of open (or left-open, right-closed) intervals in double struck upper RR and using the notation 
above, we have script upper B Subscript left parenthesis 0 comma 1 right bracket Baseline equals script upper B intersection left parenthesis 0 comma 1 right bracketB(0,1] = B ∩(0, 1]: a Borel set  in double struck upper RR in the form upper A subset of left parenthesis 0 comma 1 right bracketA ⊂(0, 1] belongs 
to sigma hyphen algebraσ-algebra script upper B Subscript left parenthesis 0 comma 1 right bracketB(0,1]. 
Next, consider the probability space left parenthesis left parenthesis 0 comma 1 right bracket comma script upper B Subscript left parenthesis 0 comma 1 right bracket Baseline comma sans serif upper P right parenthesis((0, 1], B(0,1], P), where sans serif upper PP is a probability 
measure30 Then, we have a new formulation of a continuous uniform probability 
space where, in particular, the likelihood of ﬁnding a point into an interval is 
computed as its length, see Appendix in Chap. 1. Observe how this corresponds 
to sans serif upper P left parenthesis upper I right parenthesis equals integral Underscript upper I Endscripts p left parenthesis omega right parenthesis normal d omegaP(I) =
⨜
I p(ω)dω, where p is a density and I is any interval picked from script upper B Subscript left parenthesis 0 comma 1 right bracketB(0,1]. 
Actually, this probability measure is similar to the law sans serif upper P Subscript upper XPX of a uniform rv X, see  
Chap. 5. We can extend this framework to the n-dimensional case.
30 Actually, it is the Lebesgue measure restricted to the unit interval and the corresponding trace-
sigma hyphen algebraσ-algebra. 
68
2
Distribution of Random Variables
Further Details on Indicators 
Indicator rvs better describe the behavior of a sequence of events upper A 1 comma upper A 2 comma ellipsis comma upper A Subscript n Baseline comma ellipsis element of script upper F commaA1, A2, . . . , An,
. . . ∈F, not necessarily monotonic. We have: 
bold upper I Subscript limit sup upper A Sub Subscript n Baseline equals StartLayout Enlarged left brace 1st Row 1st Column 1 2nd Column se omega element of limit sup upper A Subscript n Baseline 2nd Row 1st Column 0 2nd Column se omega not an element of limit sup upper A Subscript n Baseline period EndLayoutIlim sup An =
⌠
1
se ω ∈lim sup An
0
se ω /∈lim sup An.
(2.32) 
Indeed, bold upper I Subscript limit sup upper A Sub Subscript n Baseline equals 1Ilim sup An = 1 if for every n element of double struck upper Nn ∈N there exists k greater than or slanted equals nk ⩾n such that omega element of upper A Subscript kω ∈Ak. This  
is easily seen to be equivalent to: 
limit sup bold upper I Subscript upper A Sub Subscript n Subscript Baseline equals inf Underscript n Endscripts left brace sup Underscript k greater than or slanted equals n Endscripts bold upper I Subscript upper A Sub Subscript k Subscript Baseline right brace period lim sup IAn = inf
n
⌠
sup
k⩾n
IAk
⎫
.
(2.33) 
Thus, if k greater than or slanted equals nk ⩾n and omega element of upper A Subscript k Baseline commaω ∈Ak, by (2.33) we have  
sup Underscript k greater than or slanted equals n Endscripts bold upper I Subscript upper A Sub Subscript k Subscript Baseline equals sup left brace bold upper I Subscript upper A Sub Subscript n Subscript Baseline comma bold upper I Subscript upper A Sub Subscript n plus 1 Subscript Baseline comma ellipsis right brace equals 1 commasup
k⩾n
IAk = sup
{
IAn, IAn+1, . . .
}
= 1,
which implies inf Underscript n Endscripts left brace sup Underscript k greater than or slanted equals n Endscripts bold upper I Subscript upper A Sub Subscript k Subscript Baseline right brace equals inf Underscript n Endscripts left brace 1 right brace equals 1 commainfn
{
supk⩾n IAk
}
= infn{1} = 1, for every n element of double struck upper N periodn ∈N. We conclude 
that bold upper I Subscript limit sup upper A Sub Subscript n Baseline equals limit sup bold upper I Subscript upper A Sub Subscript nIlim sup An = lim sup IAn and analogously bold upper I Subscript limit inf upper A Sub Subscript n Subscript Baseline equals limit inf bold upper I Subscript upper A Sub Subscript n Subscript Baseline periodIlim inf An = lim inf IAn. We are now in 
position to prove: 
Lemma 2.2 Let left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P) be a probability space and left parenthesis upper A Subscript n Baseline right parenthesis Subscript n element of double struck upper N Baseline subset of script upper F(An)n∈N ⊂F be an arbitrary 
sequence of events. Then, upper A equals limit inf upper A Subscript n Baseline equals limit sup upper A Subscript n Baseline equals limit Underscript n right arrow normal infinity Endscripts upper A Subscript nA = lim inf An = lim sup An = limn→∞An is the limit 
event in script upper FF if and only if limit Underscript n right arrow normal infinity Endscripts bold upper I Subscript upper A Sub Subscript n Subscript Baseline left parenthesis omega right parenthesis equals bold upper I Subscript upper A Baseline left parenthesis omega right parenthesis commalimn→∞IAn(ω) = IA(ω), for all omega element of upper Omega periodω ∈Ω.
Proof 
left parenthesis right double arrow right parenthesis(⇒)
Assume upper A equals limit inf upper A Subscript n Baseline equals limit sup upper A Subscript n Baseline equals limit upper A Subscript n Baseline periodA = lim inf An = lim sup An = lim An. Then, bold upper I Subscript limit inf upper A Sub Subscript n Baseline equals bold upper I Subscript limit sup upper A Sub Subscript n Baseline equals 1Ilim inf An =
Ilim sup An = 1 provided that omega element of upper A commaω ∈A, otherwise its value is zero. Since bold upper I Subscript limit inf upper A Sub Subscript n Baseline equals limit inf bold upper I Subscript upper A Sub Subscript nIlim inf An =
lim inf IAn and bold upper I Subscript limit sup upper A Sub Subscript n Baseline equals limit sup bold upper I Subscript upper A Sub Subscript nIlim sup An = lim sup IAn we have limit inf bold upper I Subscript upper A Sub Subscript n Subscript Baseline equals limit sup bold upper I Subscript upper A Sub Subscript n Subscript Baseline commalim inf IAn = lim sup IAn, which 
implies: 
limit bold upper I Subscript upper A Sub Subscript n Subscript Baseline left parenthesis omega right parenthesis equals limit inf bold upper I Subscript upper A Sub Subscript n Subscript Baseline left parenthesis omega right parenthesis equals limit sup bold upper I Subscript upper A Sub Subscript n Subscript Baseline left parenthesis omega right parenthesis equals bold upper I Subscript upper A Baseline left parenthesis omega right parenthesis comma for every omega element of upper Omega periodlim IAn(ω) = lim inf IAn(ω) = lim sup IAn(ω) = IA(ω),
for every
ω ∈Ω.
left parenthesis left double arrow right parenthesis(⇐)
Suppose limit bold upper I Subscript upper A Sub Subscript n Subscript Baseline equals bold upper I Subscript upper A Baseline commalim IAn = IA, for every omega element of upper Omega periodω ∈Ω. Then, it follows limit inf bold upper I Subscript upper A Sub Subscript n Subscript Baseline equals limit sup bold upper I Subscript upper A Sub Subscript n Subscript Baseline equals bold upper I Subscript upper A Baseline periodlim inf IAn =
lim sup IAn = IA. But we know that bold upper I Subscript limit inf upper A Sub Subscript n Baseline equals limit inf bold upper I Subscript upper A Sub Subscript nIlim inf An = lim inf IAn and bold upper I Subscript limit sup upper A Sub Subscript n Subscript Baseline equals limit sup bold upper I Subscript upper A Sub Subscript n Subscript Baseline periodIlim sup An =
lim sup IAn. Hence: 
bold upper I Subscript limit inf upper A Sub Subscript n Subscript Baseline equals bold upper I Subscript limit sup upper A Sub Subscript n Subscript Baseline equals bold upper I Subscript upper A Baseline commaIlim inf An = Ilim sup An = IA,
so that limit inf upper A Subscript n Baseline equals limit sup upper A Subscript n Baseline equals upper Alim inf An = lim sup An = A and we are done.
█
Appendix
69
By lemma 2.2, convergence of a monotonic sequence of events is extended to more 
general cases. Another consequence is: 
Theorem 2.6 Let left parenthesis upper A Subscript n Baseline right parenthesis Subscript n element of double struck upper N Baseline subset of script upper F(An)n∈N ⊂F be a sequence of events over a probability space 
left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis period(Ω, F, P). If left parenthesis upper A Subscript n Baseline right parenthesis Subscript n element of double struck upper N(An)n∈N converges to the set upper A commaA, then upper A element of script upper FA ∈F and limit Underscript n right arrow normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript n Baseline right parenthesis equals sans serif upper P left parenthesis upper A right parenthesis periodlimn→∞P(An) =
P(A).
Proof Assume upper A Subscript n Baseline right arrow upper AAn →A and Lemma 2.2. We have  limit Underscript n right arrow normal infinity Endscripts bold upper I Subscript upper A Sub Subscript n Baseline left parenthesis omega right parenthesis equals bold upper I Subscript upper A Baseline left parenthesis omega right parenthesislimn→∞IAn(ω) = IA(ω) for 
every omega element of upper Omegaω ∈Ω. This is equivalent to upper A equals limit inf upper A Subscript n Baseline equals limit sup upper A Subscript nA = lim inf An = lim sup An and then upper A element of script upper F periodA ∈F.
Now, let upper B Subscript n Baseline equals intersection Subscript k greater than or slanted equals n Baseline upper A Subscript nBn = ∩k⩾nAn and upper C Subscript n Baseline equals union Subscript k greater than or slanted equals n Baseline upper A Subscript n Baseline periodCn = ∪k⩾nAn. The two sequences left parenthesis upper B Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Bn)n∈N and 
left parenthesis upper C Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Cn)n∈N are increasing and decreasing, respectively. Then, upper B Subscript n Baseline up arrow upper ABn ↑A and upper C Subscript n Baseline down arrow upper ACn ↓A and 
limit Underscript n right arrow normal infinity Endscripts sans serif upper P left parenthesis upper B Subscript n Baseline right parenthesis equals limit Underscript n right arrow normal infinity Endscripts sans serif upper P left parenthesis upper C Subscript n Baseline right parenthesis equals sans serif upper P left parenthesis upper A right parenthesis period lim
n→∞P(Bn) = lim
n→∞P(Cn) = P(A).
But upper B Subscript n Baseline subset of upper A Subscript n Baseline subset of upper C Subscript n Baseline commaBn ⊂An ⊂Cn, then sans serif upper P left parenthesis upper B Subscript n Baseline right parenthesis less than or slanted equals sans serif upper P left parenthesis upper A Subscript n Baseline right parenthesis less than or slanted equals sans serif upper P left parenthesis upper C Subscript n Baseline right parenthesis periodP(Bn) ⩽P(An) ⩽P(Cn). By the squeeze theorem for 
real sequences we eventually obtain limit Underscript n Endscripts sans serif upper P left parenthesis upper A Subscript n Baseline right parenthesis equals sans serif upper P left parenthesis upper A right parenthesislimn P(An) = P(A) and the proof is completed. 
█
Measurability of Rvs 
Recall that for any Borel-measurable function upper Y colon double struck upper R right arrow double struck upper RY : R →R the composition upper Y left parenthesis upper X left parenthesis omega right parenthesis right parenthesisY(X(ω))
is again a rv for every omega element of upper Omegaω ∈Ω. A variant of this result is valid for continuous 
functions. Any continuous function upper Y colon double struck upper R Superscript n Baseline right arrow double struck upper RY : Rn →R is left parenthesis script upper B Superscript n Baseline comma script upper B right parenthesis(Bn, B)-measurable: for any 
open set in script upper BB the inverse image is again an open set in script upper B Superscript nBn, the latter being the 
n-dimensional Bore sigma hyphen algebraσ-algebra generated by the open subsets of double struck upper R Superscript nRn. Hence, when 
n equals 1n = 1 and Y is continuous its inverse image upper Y Superscript negative 1 Baseline left parenthesis upper O right parenthesisY −1(O) is an open subset of double struck upper RR for 
any open subset O and upper X Superscript negative 1 Baseline left parenthesis upper Y Superscript negative 1 Baseline left parenthesis upper O right parenthesis right parenthesisX−1(Y −1(O)) is actually an event in script upper FF. This remains true 
when replacing O by any other Borel set,31 since open sets generate the Borel 
sigma hyphen algebraσ-algebra. A slightly generalization is the following. Given a non empty set upper Omega commaΩ,
a map  bold italic upper X colon upper Omega right arrow double struck upper R Superscript nX : Ω →Rn is a vector function, for it transforms a point omega element of upper Omegaω ∈Ω into 
an Euclidean vector bold italic upper X left parenthesis omega right parenthesis equals left parenthesis upper X 1 left parenthesis omega right parenthesis comma ellipsis comma upper X Subscript n Baseline left parenthesis omega right parenthesis right parenthesis periodX(ω) = (X1(ω), . . . , Xn(ω)). If further we assume bold italic upper XX is a 
left parenthesis script upper F comma script upper B Superscript n Baseline right parenthesis(F, Bn)-measurable map, then it is nothing but a n-dimensional rv whose image 
space is left parenthesis double struck upper R Superscript n Baseline comma script upper B Superscript n Baseline right parenthesis comma(Rn, Bn), see Chap. 3. An obvious question is when the measurability of 
each coordinate map upper X Subscript iXi is implied by that of bold italic upper XX and viceversa, for i equals 1 comma ellipsis comma ni = 1, . . . , n. 
This is the content of the next: 
Theorem 2.7 Let left parenthesis upper Omega comma script upper F right parenthesis(Ω, F) be a measurable space and let upper X 1 comma ellipsis comma upper X Subscript n BaselineX1, . . . , Xn be maps colon upper Omega right arrow double struck upper R period:
Ω →R. Deﬁne a vector function bold italic upper X colon upper Omega right arrow double struck upper R Superscript n Baseline periodX : Ω →Rn. Each upper X Subscript iXi is left parenthesis script upper F comma script upper B right parenthesis(F, B)-measurable if 
and only if bold italic upper XX is left parenthesis script upper F comma script upper B Superscript n Baseline right parenthesis(F, Bn)-measurable. 
For the proof of Theorem 2.7 we need the following deﬁnition. We call pi Subscript i Baseline colon double struck upper R Superscript n Baseline right arrow double struck upper Rπi : Rn →R
a projection map if pi Subscript i Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis equals x Subscript iπi(x1, . . . , xn) = xi for i equals 1 comma ellipsis comma ni = 1, . . . , n and bold italic x equals left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis element of double struck upper R Superscript n Baseline periodx = (x1, . . . , xn) ∈
31 In general, any continuous function upper G colon double struck upper R Superscript m Baseline right arrow double struck upper R Superscript mG : Rm →Rm is measurable. 
70
2
Distribution of Random Variables
Rn . Thus pi Subscript iπi projects the vector bold italic xx on the ith coordinate. It can be easily seen that pi Subscript iπi
is a continuous function. 
Proof of Theorem 2.7 .(⇒) For any bold italic b element of double struck upper R Superscript n Baseline commab ∈Rn, we can write 
StartLayout 1st Row 1st Column bold italic upper X Superscript negative 1 Baseline left parenthesis left parenthesis negative normal infinity comma bold italic b right bracket right parenthesis 2nd Column equals 3rd Column StartSet omega element of upper Omega colon left parenthesis upper X 1 left parenthesis omega right parenthesis comma ellipsis comma upper X Subscript n Baseline left parenthesis omega right parenthesis right parenthesis element of left parenthesis negative normal infinity comma bold italic b right bracket EndSet 2nd Row 1st Column Blank 2nd Column equals 3rd Column left brace omega element of upper Omega colon upper X 1 left parenthesis omega right parenthesis less than or slanted equals b 1 comma ellipsis comma upper X Subscript n Baseline left parenthesis omega right parenthesis less than or slanted equals b Subscript n Baseline right brace 3rd Row 1st Column Blank 2nd Column equals 3rd Column left brace upper X 1 less than or slanted equals b 1 right brace intersection midline horizontal ellipsis intersection left brace upper X Subscript n Baseline less than or slanted equals b Subscript n Baseline right brace equals intersection Subscript i equals 1 Superscript n Baseline upper X Subscript i Superscript negative 1 Baseline left parenthesis left parenthesis negative normal infinity comma b Subscript i Baseline right bracket right parenthesis period EndLayoutX−1((−∞, b]) = {ω ∈Ω : (X1(ω), . . . , Xn(ω)) ∈(−∞, b]}
= {ω ∈Ω : X1(ω) ⩽b1, . . . , Xn(ω) ⩽bn}
= {X1 ⩽b1} ∩· · · ∩{Xn ⩽bn} = ∩n
i=1X−1
i
((−∞, bi]).
By assumption, each upper X Subscript iXi is measurable and then bold italic upper X Superscript negative 1 Baseline left parenthesis left parenthesis negative normal infinity comma bold italic b right bracket right parenthesisX−1((−∞, b]) is in script upper F periodF. This implies 
that bold italic upper XX is measurable as the half-rays left parenthesis negative normal infinity comma bold italic b right bracket(−∞, b] generate script upper B Superscript n Baseline periodBn. left parenthesis left double arrow right parenthesis(⇐) Assume that bold italic upper XX is 
measurable. For each i equals 1 comma ellipsis comma ni = 1, . . . , n let pi Subscript iπi be the projection on the ith coordinate, 
which is a continuous function and then left parenthesis script upper B Superscript n Baseline comma script upper B right parenthesis(Bn, B)-measurable. Thus, the composition 
upper X Subscript i Baseline equals pi Subscript i Baseline ring bold italic upper XXi = πi ◦X is a measurable map. 
█
The main application of these results is to arithmetic operations among rvs. We 
formulate the next theorem in n-dimensions, although its main application is in the 
case n equals 1n = 1. 
Theorem 2.8 Let left parenthesis upper Omega comma script upper F right parenthesis(Ω, F) be a measurable space on which we deﬁne a rv upper Z colon upper Omega right arrow double struck upper RZ : Ω →
R and two random vectors bold italic upper X comma bold italic upper Y colon upper Omega right arrow double struck upper R Superscript n Baseline periodX, Y : Ω →Rn. Then also the maps bold italic upper X plus bold italic upper YX + Y and upper Z bold italic upper YZY are 
rvs. 
Observe that the product upper Z bold italic upper YZY between a one-dimensional rv Z and a random vector 
bold italic upper XX is deﬁned componentwise, left parenthesis upper Z upper Y 1 comma ellipsis comma upper Z upper Y Subscript n Baseline right parenthesis period(ZY1, . . . , ZYn). Recall that a vector in double struck upper R Superscript n plus 1Rn+1 can be 
written as left parenthesis alpha comma bold italic x right parenthesis(α, x) where alpha element of double struck upper Rα ∈R and bold italic x element of double struck upper R Superscript n Baseline periodx ∈Rn.
Proof of Theorem 2.8 The map bold italic h colon double struck upper R times double struck upper R Superscript n Baseline right arrow double struck upper R Superscript nh : R × Rn →Rn deﬁned by bold italic h left parenthesis alpha comma bold italic y right parenthesis equals alpha bold italic y equals left parenthesis alpha y 1 comma ellipsis comma alpha y Subscript n Baseline right parenthesish(α, y) = αy =
(αy1, . . . , αyn) is continuous and of course measurable. Deﬁne the map bold italic upper G colon upper Omega right arrow double struck upper R times double struck upper R Superscript nG : Ω →
R × Rn by bold italic upper G left parenthesis omega right parenthesis equals left parenthesis upper Z left parenthesis omega right parenthesis comma bold italic upper Y left parenthesis omega right parenthesis right parenthesis equals left parenthesis upper Z left parenthesis omega right parenthesis comma upper Y 1 left parenthesis omega right parenthesis comma ellipsis comma upper Y Subscript n Baseline left parenthesis omega right parenthesis right parenthesis periodG(ω) = (Z(ω), Y(ω)) = (Z(ω), Y1(ω), . . . , Yn(ω)). By Theorem 2.7 it 
is measurable, hence the composed map upper Z dot bold italic upper Y equals bold italic h ring bold italic upper GZ · Y = h ◦G is again measurable. Similar 
reasoning applies to bold italic upper X plus bold italic upper YX + Y. 
█
Theorem 2.8 enable us to prove the measurability of arithmetic operations 
between rvs. Let n equals 1n = 1 and replace bold italic upper X comma bold italic upper YX, Y with two rvs upper X comma upper Y colon upper Omega right arrow double struck upper R periodX, Y : Ω →R. Thus 
the sum upper X plus upper YX + Y and the product upper Z upper YZY between rvs is again a rv. The latter specialize 
to the case of a constant map upper Z equals aZ = a, whence the product of a rv Y by a constant 
is again a rv. Taking a equals negative 1a = −1 we can combine sums and products to get upper X minus upper YX −Y
as a rv. Once more, dividing two rvs StartFraction upper X Over upper Z EndFractionX
Z gives a rv. Indeed, we can write StartFraction upper X Over upper Z EndFractionX
Z as the 
composition upper X left parenthesis h ring upper Z right parenthesis commaX(h ◦Z), using the function h colon double struck upper R minus StartSet 0 EndSet right arrow double struck upper Rh : R \ {0} →R deﬁned by h left parenthesis x right parenthesis equals StartFraction 1 Over x EndFraction periodh(x) = 1
x .
If we adopt the convention that diving by zero gives zero and let h left parenthesis 0 right parenthesis equals 0 commah(0) = 0, the only 
thing we have to show is that h is measurable. But in fact it is continuous on double struck upper R minus StartSet 0 EndSet periodR\{0}.
To prove this, ﬁrst recall that left parenthesis double struck upper R comma tau right parenthesis(R, τ) is a topological space. Then, for any open set 
upper O element of tauO ∈τ the proper difference upper O overTilde equals upper O minus StartSet 0 EndSet ˜O = O \ {0} is also an open set32 which lies in the
32 Indeed upper O overTilde equals upper O intersection left brace 0 right brace Superscript c Baseline comma ˜O = O ∩{0}c, but left brace 0 right brace Superscript c{0}c equals the open set left parenthesis negative normal infinity comma 0 right parenthesis union left parenthesis 0 comma normal infinity right parenthesis period(−∞, 0) ∪(0, ∞).
Appendix
71
Borel sigma hyphen algebraσ-algebra script upper B periodB. This implies that the disjoint union upper O equals upper O overTilde union left parenthesis upper O intersection StartSet 0 EndSet right parenthesisO = ˜O ∪(O ∩{0}) is in script upper B commaB,
since upper O intersection StartSet 0 EndSetO ∩{0} is the intersection of two Borel sets. Furthermore, h Superscript negative 1 Baseline left parenthesis upper O overTilde right parenthesis element of script upper Bh−1( ˜O) ∈B and 
h Superscript negative 1 Baseline left parenthesis StartSet 0 EndSet right parenthesis equals StartSet 0 EndSet element of script upper B periodh−1({0}) = {0} ∈B. Finally, by the preserving property of inverse images we have 
h Superscript negative 1 Baseline left parenthesis upper O right parenthesis equals h Superscript negative 1 Baseline left parenthesis upper O overTilde right parenthesis union h Superscript negative 1 Baseline left parenthesis upper O intersection StartSet 0 EndSet right parenthesis element of script upper Bh−1(O) = h−1( ˜O) ∪h−1(O ∩{0}) ∈B and this proves that h is measurable and 
thus upper X left parenthesis h ring upper Z right parenthesisX(h ◦Z) is a rv. 
Remark 2.23 When arithmetic operations among rvs are involved, the following 
rules are adopted. 
• 
For upper X upper YXY we have: 
– 
. 0 × ±∞= ±∞× 0 = 0
– 
. x × ±∞= ±∞× x = ±∞
if
0 < x < ∞
– 
. x × ±∞= ±∞× x = ∓∞
if
−∞< x < 0
– 
.±∞× ±∞= ∞and plus or minus normal infinity minus or plus normal infinity equals negative normal infinity period±∞∓∞= −∞.
• 
.X ± Y remains undeﬁned in the case normal infinity minus normal infinity period∞−∞.
• 
For StartFraction upper X Over upper Y EndFractionX
Y the same rules for products applies, but StartFraction plus or minus normal infinity Over plus or minus normal infinity EndFraction comma StartFraction plus or minus normal infinity Over 0 EndFraction ±∞
±∞, ±∞
0
remain undeﬁned. 
Limits of Rvs 
We know that a sequence of rvs can converge pointwise, and we aim at showing that 
the limit is indeed a rv. 
Proposition 2.4 If a sequence left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Xn)n∈N of rvs is deﬁned on the measurable space 
left parenthesis upper Omega comma script upper F right parenthesis(Ω, F) and converges pointwise to the limit function upper X colon upper Omega right arrow double struck upper R commaX : Ω →R, then X is a rv. 
This result is actually a corollary of more general limiting procedures. Before 
introduce them we give an example. 
Example 2.20 The minimum between two rvs, min left brace upper X left parenthesis omega right parenthesis comma upper Y left parenthesis omega right parenthesis right brace commamin{X(ω), Y(ω)}, is again a rv. To 
put things in a more general setting deﬁne inf left brace upper X 1 left parenthesis omega right parenthesis comma upper X 2 left parenthesis omega right parenthesis comma ellipsis right brace equals colon inf Underscript n Endscripts upper X Subscript ninf{X1(ω), X2(ω), . . .} =: infn Xn for 
each outcome omega element of upper Omegaω ∈Ω. This is a map from  upper OmegaΩ to double struck upper RR which value should be negative normal infinity period−∞. If 
all terms of the sequence left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Xn)n∈N are strictly greater than a number x element of double struck upper Rx ∈R for all 
omega commaω, we have upper X Subscript n Baseline left parenthesis omega right parenthesis greater than xXn(ω) > x for all n element of double struck upper Nn ∈N and then also inf Underscript n Endscripts upper X Subscript n Baseline left parenthesis omega right parenthesis greater than x periodinfn Xn(ω) > x. Otherwise, 
inf Underscript n Endscripts upper X Subscript n Baseline less than or slanted equals xinfn Xn ⩽x where the inﬁmum is taken for some terms in the sequence such that 
upper X Subscript n Baseline less than or slanted equals xXn ⩽x. Thus we can write: 
StartLayout 1st Row 1st Column omega element of left brace inf Underscript n Endscripts upper X Subscript n Baseline less than or slanted equals x right brace 2nd Column long left right double arrow 3rd Column omega element of left brace upper X Subscript n Baseline less than or slanted equals x right brace for some n element of double struck upper N 2nd Row 1st Column Blank 2nd Column long left right double arrow 3rd Column omega element of union Subscript n Baseline left brace upper X Subscript n Baseline less than or slanted equals x right brace period EndLayoutω ∈
{
inf
n Xn ⩽x
}
⇐⇒ω ∈{Xn ⩽x} for some n ∈N
⇐⇒ω ∈∪n{Xn ⩽x}.
Since each left brace upper X Subscript n Baseline less than or slanted equals x right brace{Xn ⩽x} is an event, the last countable union is an event too. We showed 
that the map inf Underscript n Endscripts upper X Subscript ninfn Xn is left parenthesis script upper F comma script upper B right parenthesis(F, B)-measurable and then is a rv. Similarly, sup Underscript n Endscripts upper X Subscript nsupn Xn is a 
rv as left brace sup Underscript n Endscripts upper X Subscript n Baseline greater than or slanted equals x right brace{supn Xn ⩾x} equals union Subscript n Baseline left brace upper X Subscript n Baseline greater than or slanted equals x right brace∪n{Xn ⩾x} which by is an event  for every x element of double struck upper R periodx ∈R.
Based on the preceding example we are in position to prove:
72
2
Distribution of Random Variables
Theorem 2.9 Let upper X 1 comma upper X 2 comma ellipsisX1, X2, . . . be rvs deﬁned on the same measurable space left parenthesis upper Omega comma script upper F right parenthesis period(Ω, F).
Then the maps inf Underscript n Endscripts upper X Subscript n Baseline comma sup Underscript n Endscripts upper X Subscript n Baseline comma limit inf Underscript n Endscripts upper X Subscript n Baseline comma limit sup Underscript n Endscripts upper X Subscript n Baseline infn Xn, supn Xn, lim infn Xn, lim supn Xn are also rvs.  
Proof By Example 2.20 the maps inf Underscript n Endscripts upper X Subscript ninfn Xn e sup Underscript n Endscripts upper X Subscript nsupn Xn are rvs. For each omega element of upper Omegaω ∈Ω let us 
consider the limit inferior and the limit superior of the sequence left parenthesis upper X Subscript n Baseline right parenthesis Subscript n Baseline colon(Xn)n :
limit inf Underscript n Endscripts upper X Subscript n Baseline equals sup Underscript n Endscripts left brace inf Underscript k greater than or slanted equals n Endscripts upper X Subscript k Baseline right brace comma limit sup upper X Subscript n Baseline equals inf Underscript n Endscripts left brace sup Underscript k greater than or slanted equals n Endscripts upper X Subscript k Baseline right brace periodlim inf
n
Xn = sup
n
{
inf
k⩾n Xk
}
,
lim sup Xn = inf
n
{
sup
k⩾n
Xk
}
.
If we let upper Y Subscript n Baseline equals inf Underscript k greater than or slanted equals n Endscripts upper X Subscript kYn = infk⩾n Xk and upper Z Subscript n Baseline equals sup Underscript k greater than or slanted equals n Endscripts upper X Subscript kZn = supk⩾n Xk then sup Underscript n Endscripts upper Y Subscript nsupn Yn e inf Underscript n Endscripts upper Z Subscript ninfn Zn are also rv 
and we are done. 
█
Thanks to Theorem 2.9 we can prove that also max Underscript n less than or slanted equals k Endscripts upper X Subscript nmaxn ⩽k Xn and min Underscript n less than or slanted equals k Endscripts upper X Subscript nminn ⩽k Xn are rvs. 
Finally, we give: 
Proof of Proposition 2.4 For every outcome omega element of upper Omegaω ∈Ω the assumption of point-
wise convergence enable us to take 
limit upper X Subscript n Baseline left parenthesis omega right parenthesis equals upper X left parenthesis omega right parenthesis periodlim Xn(ω)
=
X(ω). But the sequence 
upper X 1 left parenthesis omega right parenthesis comma upper X 2 left parenthesis omega right parenthesis comma ellipsisX1(ω), X2(ω), . . . of real numbers converges to the number upper X left parenthesis omega right parenthesisX(ω) if and only if 
limit inf Underscript n Endscripts upper X Subscript n Baseline equals limit sup Underscript n Endscripts upper X Subscript n Baseline equals upper X periodlim infn Xn = lim supn Xn = X. By Theorem 2.9 limit inf Underscript n Endscripts upper X Subscript nlim infn Xn and limit sup Underscript n Endscripts upper X Subscript nlim supn Xn are 
rvs and the proof is complete. 
█
Observe that for left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Xn)n∈N be a sequence of rvs all deﬁned on the same measurable 
space left parenthesis upper Omega comma script upper F right parenthesis(Ω, F), the  set  left brace sup Underscript n Endscripts upper X Subscript n Baseline greater than x right brace Superscript c{supn Xn > x}c is the event intersection Subscript n Baseline left brace upper X Subscript n Baseline less than or slanted equals x right brace∩n{Xn ⩽x} for every x element of double struck upper Rx ∈R. In  
fact, omega element of left brace sup Underscript n Endscripts upper X Subscript n Baseline greater than x right brace Superscript cω ∈{supn Xn > x}c iff omega not an element of left brace sup Underscript n Endscripts upper X Subscript n Baseline greater than x right braceω /∈{supn Xn > x} and this implies omega element of left brace sup Underscript n Endscripts upper X Subscript n Baseline less than or slanted equals x right braceω ∈{supn Xn ⩽
x}. More formally, write 
left brace sup Underscript n Endscripts upper X Subscript n Baseline greater than x right brace Superscript c Baseline equals left parenthesis union Subscript n Baseline left brace upper X Subscript n Baseline greater than x right brace right parenthesis Superscript c Baseline equals intersection Subscript n Baseline left brace upper X Subscript n Baseline greater than x right brace Superscript c Baseline equals intersection Subscript n Baseline left brace upper X Subscript n Baseline less than or slanted equals x right brace
{
sup
n
Xn > x
}c =
(
∪n {Xn > x}
)c = ∩n{Xn > x}c = ∩n{Xn ⩽x}
and we are done. Eventually, the event 
StartSet omega element of upper Omega vertical bar upper X Subscript n Baseline left parenthesis omega right parenthesis conv period point period EndSet{ω ∈Ω | Xn(ω) conv. point.}
equals left brace upper X Subscript n Baseline right arrow upper X right brace comma{Xn →X}, where upper X equals limit inf Underscript n Endscripts upper X Subscript n Baseline equals limit sup Underscript n Endscripts upper X Subscript n Baseline periodX = lim infn Xn = lim supn Xn. Hence, left brace upper X Subscript n Baseline right arrow upper X right brace Superscript c Baseline equals left brace limit inf Underscript n Endscripts upper X Subscript n Baseline less than limit sup Underscript n Endscripts upper X Subscript n Baseline right brace period{Xn →
X}c = {lim infn Xn < lim supn Xn}. Observe that for each omega element of upper Omegaω ∈Ω we may 
ﬁnd a rational number q that lies between the numbers Underine x equals limit inf Underscript n Endscripts upper X Subscript n Baseline left parenthesis omega right parenthesisx = lim infn Xn(ω) and 
ModifyingAbove x With quotation dash equals limit sup Underscript n Endscripts upper X Subscript n Baseline left parenthesis omega right parenthesis periodx = lim supn Xn(ω). This induces the events left brace limit inf Underscript n Endscripts upper X Subscript n Baseline less than or slanted equals q less than limit sup Underscript n Endscripts upper X Subscript n Baseline right brace comma{lim infn Xn ⩽q < lim supn Xn},
which indeed form a countable collection depending upon rationals. Thus we can 
rewrite left brace upper X Subscript n Baseline right arrow upper X right brace Superscript c{Xn →X}c as: 
union Subscript q element of double struck upper Q Baseline left brace limit inf Underscript n Endscripts upper X Subscript n Baseline less than or slanted equals q less than limit sup Underscript n Endscripts upper X Subscript n Baseline right brace equals union Subscript q element of double struck upper Q Baseline left parenthesis left brace limit inf Underscript n Endscripts upper X Subscript n Baseline less than or slanted equals q right brace intersection left brace limit sup Underscript n Endscripts upper X Subscript n Baseline less than or slanted equals q right brace Superscript c Baseline right parenthesis period∪q∈Q{lim inf
n
Xn ⩽q < lim sup
n
Xn} = ∪q∈Q
(
{lim inf
n
Xn ⩽q}∩{lim sup
n
Xn ⩽q}c)
.
Then, the set left brace upper X Subscript n Baseline conv period point period right brace{Xn conv. point.} is an event since both sets in the second equality are 
contained in script upper FF. 
Remark 2.24 We tacitly assumed the measurability of the limit X. Observe that 
left brace upper X Subscript n Baseline right arrow upper X right brace long left right double arrow StartSet omega element of upper Omega vertical bar upper X Subscript n Baseline left parenthesis omega right parenthesis converge pointwise EndSet comma{Xn →X} ⇐⇒{ω ∈Ω | Xn(ω) converge pointwise},
Appendix
73
and its complement left brace upper X Subscript n Baseline right arrow upper X right brace Superscript c Baseline equals left brace upper X Subscript n Baseline right arrow with stroke upper X right brace{Xn →X}c = {Xn ↛X} is the set where convergence fails 
to hold. But this need not to be an event in script upper FF even if the convergence set belong 
to the sigma hyphen algebraσ-algebra. Loosely speaking, if we ﬁnd a sans serif upper PP-null event upper A element of script upper FA ∈F such that 
left brace upper X Subscript n Baseline right arrow with stroke upper X right brace subset of upper A{Xn ↛X} ⊂A and assume the probability measure is complete, sans serif upper P left parenthesis upper A right parenthesis equals 0 commaP(A) = 0,
this implies sans serif upper P left parenthesis upper X Subscript n Baseline right arrow with stroke upper X right parenthesis equals 0P(Xn ↛X) = 0 too. This is a delicate issue which we turn around by 
assuming the necessary condition that also the limit function X is a random variable, 
i.e. it is measurable.
Chapter 3 
Multidimensional Random Variables 
3.1 
Random Vectors 
What is the probability that a pair of future asset prices left parenthesis upper S Subscript 1 comma t plus 1 Baseline left parenthesis omega right parenthesis comma upper S Subscript 2 comma t plus 1 Baseline left parenthesis omega right parenthesis right parenthesis(S1,t+1(ω), S2,t+1(ω)) will 
satisfy 
a less than upper S Subscript 1 comma t plus 1 Baseline less than or slanted equals b and c less than upper S Subscript 2 comma t plus 1 Baseline less than or slanted equals d commaa < S1,t+1 ⩽b and c < S2,t+1 ⩽d,
for real a less than ba < b and c less than dc < d, whatever time t equals 0 comma 1 comma 2 comma ellipsist = 0, 1, 2, . . .? Situations like this 
require a conjoint measurement of quantities depending on the same sample space 
upper OmegaΩ. Despite we do not know how many and what are the scenarios underlying the 
random experiment, we need to predict both possible values upper S Subscript 1 comma t plus 1S1,t+1 and upper S Subscript 2 comma t plus 1S2,t+1 to 
gain useful information for ﬁnancial decision making. 
Example 3.1 Assume the rvs upper S Subscript i comma t plus 1Si,t+1 represent future prices of two distinct ﬁnancial 
assets, for i equals 1 comma 2i = 1, 2. Further, assume we buy h 1h1 shares of asset # 1 and h 2h2 shares of 
asset # 2, i.e. h Subscript ihi are holdings on the corresponding asset. Whence, we have the new 
rv 
upper V Subscript t plus 1 Baseline colon equals h 1 upper S Subscript 1 comma t plus 1 Baseline plus h 2 upper S Subscript 2 comma t plus 1 Baseline equals h left parenthesis upper S Subscript 1 comma t plus 1 Baseline comma upper S Subscript 2 comma t plus 1 Baseline right parenthesisVt+1 := h1S1,t+1 + h2S2,t+1 = h(S1,t+1, S2,t+1)
modelling future values of the portfolio comprising both assets, see Sect. 2.5, 
Example 2.5. Clearly, upper V Subscript t plus 1 Baseline left parenthesis omega right parenthesisVt+1(ω) is an univariate rv with a probability distribution 
sans serif upper P Subscript upper V Sub Subscript t plus 1PVt+1 and a CDF upper F Subscript upper V Sub Subscript t plus 1FVt+1 both derived from the single distributions sans serif upper P Subscript upper S Sub Subscript i comma t plus 1 Subscript Baseline comma upper F Subscript upper S Sub Subscript i comma t plus 1 Subscript BaselinePSi,t+1, FSi,t+1 and 
some mechanism aggregating them into a joint law governing the random pair of 
future prices. 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4_3
75
76
3
Multidimensional Random Variables
As Example 3.1 suggests, starting from a probability space left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P) now we need 
events in script upper FF that are induced by a function bold italic upper X colon upper Omega right arrow double struck upper R Superscript nX : Ω →Rn, called random vector, s.t. 
for every scenario omega element of upper Omegaω ∈Ω it gives a conjoint measurement 
bold italic upper X left parenthesis omega right parenthesis equals left parenthesis upper X 1 left parenthesis omega right parenthesis comma ellipsis comma upper X Subscript n Baseline left parenthesis omega right parenthesis right parenthesis equals left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis equals bold italic x commaX(ω) = (X1(ω), . . . , Xn(ω)) = (x1, . . . , xn) = x,
each coordinate being a univariate rv upper X Subscript i Baseline colon upper Omega right arrow double struck upper RXi : Ω →R, for  i equals 1 comma ellipsis comma ni = 1, . . . , n. Events given 
by bold italic upper XX are usually in the form 
upper A equals StartSet omega vertical bar left parenthesis upper X 1 left parenthesis omega right parenthesis comma ellipsis comma upper X Subscript n Baseline left parenthesis omega right parenthesis right parenthesis element of upper B EndSet identical to left brace bold upper X element of upper B right braceA =
{
ω | (X1(ω), . . . , Xn(ω)) ∈B
}
≡{X ∈B}
and B is a suitable subset of double struck upper R Superscript nRn s.t. left brace bold upper X element of upper B right brace element of script upper F{X ∈B} ∈F and thus has a probability 
sans serif upper P left parenthesis bold upper X element of upper B right parenthesisP(X ∈B). 
Remark 3.1 The subset upper B 2B2 in Fig. 3.1 can be expressed as the Cartesian product of 
two intervals in double struck upper RR. E.g., upper B 1 equals left parenthesis a comma b right bracket times left parenthesis c comma d right bracketB1 = (a, b] × (c, d] is the collection of those pairs left parenthesis x 1 comma x 2 right parenthesis(x1, x2)
s.t. a less than x 1 less than or slanted equals ba < x1 ⩽b and c less than x 2 less than or slanted equals dc < x2 ⩽d, to be meant as the possible pairs left parenthesis upper X 1 left parenthesis omega right parenthesis comma upper X 2 left parenthesis omega right parenthesis right parenthesis(X1(ω), X2(ω))
for some scenarios omega element of upper Omegaω ∈Ω with upper X Subscript i Baseline left parenthesis omega right parenthesis equals x Subscript iXi(ω) = xi and i equals 1 comma 2i = 1, 2. The subset upper B 1B1 cannot 
be given as a Cartesian product, but in most application subsets of double struck upper R Superscript nRn for n greater than or slanted equals 2n ⩾2
representing events induced by a random vector are Cartesian products. 
Remark 3.2 (Bi-Variate Rv) When upper B subset of double struck upper R squaredB ⊂R2 can be expressed as upper B 1 times upper B 2B1 × B2, with 
each upper B 1 comma upper B 2 subset of double struck upper RB1, B2 ⊂R we have: 
StartLayout 1st Row 1st Column left brace bold italic upper X element of upper B right brace 2nd Column equals 3rd Column left brace bold italic upper X element of upper B 1 times upper B 2 right brace 2nd Row 1st Column Blank 2nd Column equals 3rd Column left brace left parenthesis upper X 1 comma upper X 2 right parenthesis element of upper B 1 times upper B 2 right brace 3rd Row 1st Column Blank 2nd Column equals 3rd Column left brace omega vertical bar upper X 1 left parenthesis omega right parenthesis element of upper B 1 comma upper X 2 left parenthesis omega right parenthesis element of upper B 2 right brace 4th Row 1st Column Blank 2nd Column equals 3rd Column left brace upper X 1 element of upper B 1 right brace intersection left brace upper X 2 element of upper B 2 right brace period EndLayout{X ∈B} =
{
X ∈B1 × B2
}
=
{
(X1, X2) ∈B1 × B2
}
=
{
ω | X1(ω) ∈B1, X2(ω) ∈B2
}
= {X1 ∈B1} ∩{X2 ∈B2}.
Fig. 3.1 Subsets upper B 1 comma upper B 2B1, B2 of 
the Cartesian plane double struck upper R squaredR2
depicting geometrically 
events upper A 1 equals left brace bold italic upper X element of upper B 1 right braceA1 = {X ∈B1} and 
upper A 2 equals left brace bold italic upper X element of upper B 2 right braceA2 = {X ∈B2}
X 
X 
A 
A 
B 
B 
x
x 
y 
y
 X
 X
 X 
X
3.2
Discrete Random Vectors
77
Thus, events like these are intersections of left brace upper X Subscript i Baseline element of upper B Subscript i Baseline right brace element of script upper F{Xi ∈Bi} ∈F. Notice that the 
intersection also belongs to script upper FF. In general, choosing upper B Subscript i Baseline equals left parenthesis negative normal infinity comma x Subscript i Baseline right bracketBi = (−∞, xi] we have 
left brace upper X 1 less than or slanted equals x 1 right brace intersection midline horizontal ellipsis intersection left brace upper X Subscript n Baseline less than or slanted equals x Subscript n Baseline right brace period{X1 ⩽x1} ∩· · · ∩{Xn ⩽xn}.
In some textbooks this is written left brace bold upper X less than or slanted equals bold x right brace{X ⩽x}, where upper X Subscript i Baseline less than or slanted equals x Subscript iXi ⩽xi for all indices i and at 
least one inequality is strict. The sigmaσ-algebra generated by bold italic upper XX, denoted sigma left parenthesis bold italic upper X right parenthesisσ(X), is the  
smallest collection of events left brace bold italic upper X element of upper B right brace{X ∈B}. We always have sigma left parenthesis bold italic upper X right parenthesis subset of script upper Fσ(X) ⊂F. 
For a random vector bold italic upper XX over left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P) the probabilities sans serif upper P left parenthesis bold italic upper X element of upper B right parenthesisP(X ∈B) for upper B subset of double struck upper R Superscript nB ⊂Rn, 
s.t. the events left brace bold italic upper X element of upper B right brace{X ∈B} are in script upper FF, determines the law sans serif upper P Subscript bold italic upper XPX. Viewed as a function of 
suitable n-dimensional sets, sans serif upper P Subscript bold italic upper X Baseline left parenthesis upper B right parenthesisPX(B) translates the probability of left brace bold italic upper X element of upper B right brace{X ∈B} into the 
probability of upper B subset of double struck upper R Superscript nB ⊂Rn. For  n equals 2n = 2 this yields a geometric ﬂavor often in terms of 
area of appropriate regions inside the Cartesian plane double struck upper R squaredR2, see Fig. 3.1. Also in the  
current multidimensional setting there is a 1-to-1 correspondence between sans serif upper PP and 
the CDF of the random vector bold upper XX deﬁned as 
upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis colon equals sans serif upper P left parenthesis upper X 1 less than or slanted equals x 1 comma ellipsis comma upper X Subscript n Baseline less than or slanted equals x Subscript n Baseline right parenthesis commaFX(x1, . . . , xn) := P(X1 ⩽x1, . . . , Xn ⩽xn),
(3.1) 
called the joint or multivariate CDF. The event inside sans serif upper P left parenthesis dot right parenthesisP( · ) is the shorthand 
notation for the intersection met in the fourth equality of the previous Remark (for 
n greater than or slanted equals 2n ⩾2). For n equals 2n = 2, the bi-variate CDF upper F Subscript bold italic upper X Baseline colon double struck upper R squared right arrow left bracket 0 comma 1 right bracketFX : R2 →[0, 1] CDF satisﬁes the following 
properties: 
1. is nondecreasing, i.e. for any bold italic x equals left parenthesis x 1 comma x 2 right parenthesisx = (x1, x2) and bold italic y equals left parenthesis y 1 comma y 2 right parenthesisy = (y1, y2) s.t. bold italic x less than or slanted equals bold italic yx ⩽y it follows 
upper F Subscript bold italic upper X Baseline left parenthesis bold italic x right parenthesis less than or slanted equals upper F Subscript bold italic upper X Baseline left parenthesis bold italic y right parenthesis commaFX(x) ⩽FX(y), where the vector inequality means that x Subscript i Baseline less than or slanted equals y Subscript ixi ⩽yi for i equals 1 comma 2i = 1, 2 and 
at least one inequality is strict; 
2. is right-continuous, i.e. limit Underscript h down arrow 0 Endscripts left parenthesis limit Underscript k down arrow 0 Endscripts upper F Subscript bold italic upper X Baseline left parenthesis x 1 plus h comma x 2 plus k right parenthesis right parenthesis equals upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma x 2 right parenthesislimh↓0
(
limk↓0 FX(x1 + h, x2 + k)
)
= FX(x1, x2), for  
h comma k greater than 0h, k > 0; 
3. .limx1,x2→∞FX(x1, x2) := FX(∞, ∞) = 1 and limit Underscript x Subscript i Baseline right arrow negative normal infinity Endscripts upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma x 2 right parenthesis equals 0limxi→−∞FX(x1, x2) = 0 for 
i equals 1 comma 2i = 1, 2; 
4. .P(a1 < X1 ⩽b1, a2 < X2 ⩽b2) is computed as 
StartLayout 1st Row upper F Subscript bold italic upper X Baseline left parenthesis b 1 comma b 2 right parenthesis minus upper F Subscript bold italic upper X Baseline left parenthesis a 1 comma b 2 right parenthesis minus upper F Subscript bold italic upper X Baseline left parenthesis b 1 comma a 2 right parenthesis plus upper F Subscript bold italic upper X Baseline left parenthesis a 1 comma a 2 right parenthesis greater than or slanted equals 0 period EndLayoutFX(b1, b2) −FX(a1, b2) −FX(b1, a2) + FX(a1, a2) ⩾0.
Properties 1–3 also hold for n greater than 2n > 2. Here a geometric interpretation based on 
identifying left brace bold italic upper X element of upper B right brace{X ∈B} with regions in the Cartesian plane. Recall that bold italic a equals left parenthesis a 1 comma a 2 right parenthesis less than or slanted equals left parenthesis b 1 comma b 2 right parenthesis equals bold italic ba = (a1, a2) ⩽
(b1, b2) = b, and let bold italic a 1 equals left parenthesis a 1 comma b 2 right parenthesis comma bold italic a 2 equals left parenthesis b 1 comma a 2 right parenthesisa1 = (a1, b2), a2 = (b1, a2), see Fig. 3.2. 
3.2 
Discrete Random Vectors 
Assume that bold italic upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y) and each of the component rvs has a countable support, 
script upper X equals StartSet x 1 comma x 2 comma ellipsis EndSetX = {x1, x2, . . .} and script upper Y equals StartSet y 1 comma y 2 comma ellipsis EndSetY = {y1, y2, . . .} respectively. The range of bold italic upper XX is the set 
bold italic upper X left parenthesis upper Omega right parenthesis equals left brace left parenthesis x comma y right parenthesis vertical bar x element of script upper X comma y element of script upper Y right brace commaX(Ω) = {(x, y) | x ∈X, y ∈Y},
78
3
Multidimensional Random Variables
a 
a 
b 
b 
a 
a 
b 
a 
a 
a 
b 
b 
a 
a 
b 
a 
a 
b 
b 
a 
a 
b 
a 
a 
b 
b 
a 
a 
b 
a 
a 
b 
b 
a 
a 
b 
Fig. 3.2 Geometrical identiﬁcation of event left brace a 1 less than upper X 1 less than or slanted equals b 1 right brace intersection left brace a 2 less than upper X 2 less than or slanted equals b 2 right brace{a1 < X1 ⩽b1} ∩{a2 < X2 ⩽b2}: from the region 
on top-left subtract the union of regions on top-right and on middle-left, i.e., region on middle-
right, then get the ‘rectangle’ left parenthesis bold italic a comma bold italic b right bracket equals left parenthesis a 1 comma b 1 right bracket times left parenthesis a 2 comma b 2 right bracket(a, b] = (a1, b1] × (a2, b2] on bottom-left as the desired event 
which equals the Cartesian product script upper X times script upper YX × Y of two countable sets, and is itself a 
countable set.1 Coordinates X and Y have their own discrete distributions given by 
masses sans serif upper P left parenthesis upper X equals x right parenthesisP(X = x) and sans serif upper P left parenthesis upper Y equals y right parenthesisP(Y = y), and their CDFs upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x) and upper F Subscript upper Y Baseline left parenthesis y right parenthesisFY (y) are as usual 
step functions called marginal distributions, thus, bold italic upper XX is said to have a discrete 
distribution with joint masses2 sans serif upper P left parenthesis upper X equals x comma upper Y equals y right parenthesisP(X = x, Y = y). It holds: 
sigma summation Underscript x element of script upper X Endscripts sigma summation Underscript y element of script upper Y Endscripts sans serif upper P left parenthesis upper X equals x comma upper Y equals y right parenthesis equals 1 period
⎲
x∈X
⎲
y∈Y
P(X = x, Y = y) = 1.
(3.2)
1 There is a bijection double struck upper N times double struck upper N right arrow script upper X times script upper YN × N →X × Y. 
2 The event inside sans serif upper PP is left brace upper X equals x right brace intersection left brace upper Y equals y right brace{X = x} ∩{Y = y}. 
3.2
Discrete Random Vectors
79
Table 3.1 Joint masses of a 
bi-variate random vector 
script upper XX
30 
50 
90 
100 
0.1 
0.3 
0.1 
script upper YY
110 
0.1 
0.2 
0 
165 
0
0.1 
0.1 
Indeed, for a ﬁxed x element of script upper Xx ∈X the events left brace upper X equals x right brace intersection left brace upper Y equals y 1 right brace{X = x} ∩{Y = y1}, left brace upper X equals x right brace intersection left brace upper Y equals y 2 right brace comma ellipsis{X = x} ∩{Y = y2}, . . .
form a partition of upper OmegaΩ. The same is true for left brace upper X equals x 1 right brace intersection left brace upper Y equals y right brace{X = x1} ∩{Y = y}, left brace upper X equals x 2 right brace intersection left brace upper Y equals y right brace comma ellipsis{X = x2} ∩{Y =
y}, . . . whenever y element of script upper Yy ∈Y is ﬁxed. Hence, the union of each of these sequence of 
events is the entire sample space. To compute the probability that bold italic upper XX lies in some 
suitable subset upper B subset of script upper X times script upper Y subset of double struck upper R squaredB ⊂X × Y ⊂R2 we simply sum sigma summation Underscript left parenthesis x comma y right parenthesis Endscripts sigma summation Underscript element of upper B Endscripts sans serif upper P left parenthesis upper X equals x comma upper Y equals y right parenthesis ∑
(x,y)
∑
∈B
P(X = x, Y = y). 
Eventually, to recover the CDF of bold italic upper XX from the joint masses we take: 
upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma x 2 right parenthesis equals sigma summation Underscript x less than or slanted equals x 1 Endscripts sigma summation Underscript y less than or slanted equals x 2 Endscripts sans serif upper P left parenthesis upper X equals x comma upper Y equals y right parenthesis periodFX(x1, x2) =
⎲
x⩽x1
⎲
y⩽x2
P(X = x, Y = y).
Note that sans serif upper P left parenthesis bold italic upper X element of bold italic upper X left parenthesis upper Omega right parenthesis Superscript c Baseline right parenthesis equals 0 periodP(X ∈X(Ω)c) = 0.
Example 3.2 To forecast the future asset prices of two stock indexes, let deﬁne 
the discrete random vector bold italic upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y) over left parenthesis upper Omega comma script upper F right parenthesis(Ω, F) with script upper X equals StartSet 30 comma 50 comma 90 EndSetX = {30, 50, 90} and 
script upper Y equals StartSet 100 comma 110 comma 165 EndSet periodY = {100, 110, 165}. Let us assign the probabilities 
StartLayout 1st Row sans serif upper P left parenthesis upper X equals 30 right parenthesis equals 0.2 comma sans serif upper P left parenthesis upper X equals 50 right parenthesis equals 0.6 comma sans serif upper P left parenthesis upper X equals 90 right parenthesis equals 0.2 2nd Row sans serif upper P left parenthesis upper Y equals 100 right parenthesis equals 0.5 comma sans serif upper P left parenthesis upper Y equals 110 right parenthesis equals 0.3 comma sans serif upper P left parenthesis upper Y equals 165 right parenthesis equals 0.2 EndLayoutP(X = 30) = 0.2, P(X = 50) = 0.6, P(X = 90) = 0.2
P(Y = 100) = 0.5, P(Y = 110) = 0.3, P(Y = 165) = 0.2
to each random future quotes. The masses in the ﬁrst line form the marginal 
distribution of X, and the second line corresponds to the marginal distribution of 
Y. 
Example 3.3 Each entry in Table 3.1 is a joint mass sans serif upper P left parenthesis upper X equals x comma upper Y equals y right parenthesisP(X = x, Y = y) for every 
pair left parenthesis x comma y right parenthesis element of script upper X times script upper Y(x, y) ∈X × Y. 
• 
Adding the entries in each row we get the probability masses sans serif upper P left parenthesis upper X equals x right parenthesisP(X = x). E.g., for 
upper X equals 30X = 30 we get sans serif upper P left parenthesis upper X equals 30 comma upper Y equals 100 right parenthesis plus sans serif upper P left parenthesis upper X equals 30 comma upper Y equals 110 right parenthesis plus sans serif upper P left parenthesis upper X equals 30 comma upper Y equals 165 right parenthesisP(X = 30, Y = 100) + P(X = 30, Y = 110) + P(X = 30, Y =
165) is equal to 
sans serif upper P left parenthesis StartSet upper X equals 30 comma upper Y equals 100 EndSet union StartSet upper X equals 30 comma upper Y equals 110 EndSet union left brace upper X equals 30 comma upper Y equals 165 right brace right parenthesisP ({X = 30, Y = 100} ∪{X = 30, Y = 110}∪{X
=
30,
Y = 165}), which in turn gets sans serif upper P left parenthesis upper X equals 30 right parenthesis equals 0.2P(X = 30) = 0.2. This is because the union 
is based on pairwise disjoint events3 and union Subscript y element of script upper Y Baseline StartSet upper X equals 30 comma upper Y equals y EndSet equals left brace upper X equals 30 right brace∪y∈Y{X = 30, Y = y} = {X = 30}. 
• 
Adding the entries in each column we get the probability masses sans serif upper P left parenthesis upper Y equals y right parenthesisP(Y = y), by  
the same reasoning as above.
3 Recall that StartSet upper X equals 30 comma upper Y equals y EndSet{X = 30, Y = y} is the intersection left brace upper X equals 30 right brace intersection left brace upper Y equals y right brace{X = 30} ∩{Y = y}. 
80
3
Multidimensional Random Variables
Fig. 3.3 Joint masses of the 
bi-variate random vector in 
Example 3.2. Plotting the 
couples left parenthesis x comma y right parenthesis(x, y) against 
probability masses 
sans serif upper P left parenthesis upper X equals x comma upper Y equals y right parenthesisP(X = x, Y = y) gives a 
ﬁnite number of points in the 
three-dimensional Euclidean 
space double struck upper R cubedR3. Their heights are 
just the values of 
sans serif upper P left parenthesis upper X equals x comma upper Y equals y right parenthesisP(X = x, Y = y)
105 
100 
165 
30 
50 
90
X 
Y 
• 
The double sum in (3.2) can be performed in whatever order: we can ﬁrst sum 
the joint masses either as in item (a) or as in item (b), then summing again we get 
1. 
Choosing upper B equals left parenthesis 10 comma 55 right bracket times left parenthesis 105 comma 170 right bracketB = (10, 55] × (105, 170], to compute 
sans serif upper P left parenthesis bold italic upper X element of upper B right parenthesis equals sans serif upper P left parenthesis left parenthesis upper X comma upper Y right parenthesis element of upper B right parenthesis equals sans serif upper P left parenthesis 10 less than upper X less than or slanted equals 55 comma 105 less than upper Y less than or slanted equals 170 right parenthesis commaP(X ∈B) = P((X, Y) ∈B) = P(10 < X ⩽55, 105 < Y ⩽170),
we simply take the double sum 
sigma summation Underscript left parenthesis x comma y right parenthesis Endscripts sigma summation Underscript element of upper B Endscripts sans serif upper P left parenthesis upper X equals x comma upper Y equals y right parenthesis equals sigma summation Underscript x equals 30 comma 50 Endscripts sigma summation Underscript y equals 110 comma 165 Endscripts sans serif upper P left parenthesis upper X equals x comma upper Y equals y right parenthesis equals 0.4 period
⎲
(x,y)
⎲
∈B
P(X = x, Y = y) =
⎲
x=30,50
⎲
y=110,165
P(X = x, Y = y) = 0.4.
A graphical illustration is depicted in Fig. 3.3. 
3.3 
Continuous Random Vectors 
A random vector bold italic upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y) with (absolutely) continuous components upper X comma upper YX, Y is said 
to be continuous. The marginal distributions are given by the densities f Subscript upper X Baseline left parenthesis x right parenthesisfX(x) and 
f Subscript upper Y Baseline left parenthesis x right parenthesisfY (x) s.t. their CDFs are upper F Subscript upper X Baseline left parenthesis x right parenthesis equals integral Subscript negative normal infinity Superscript x Baseline f Subscript upper X Baseline left parenthesis u right parenthesis normal d uFX(x) =
⌠x
−∞fX(u)du and upper F Subscript upper Y Baseline left parenthesis y right parenthesis equals integral Subscript negative normal infinity Superscript y Baseline f Subscript upper Y Baseline left parenthesis u right parenthesis normal d uFY (y) =
⌠y
−∞fY (u)du. Vice  
versa, we also have f Subscript upper X Baseline left parenthesis x right parenthesis equals upper F prime Subscript upper X Baseline left parenthesis x right parenthesisfX(x) = F '
X(x) and f Subscript upper Y Baseline left parenthesis y right parenthesis equals upper F prime Subscript upper Y Baseline left parenthesis y right parenthesisfY (y) = F '
Y (y). There is a continuous 
joint distribution if the multivariate CDF upper F Subscript bold italic upper XFX is continuous and 
StartLayout 1st Row 1st Column upper F Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis 2nd Column equals 3rd Column integral Underscript left parenthesis negative normal infinity comma x right bracket times left parenthesis negative normal infinity comma y right bracket Endscripts f Subscript bold upper X Baseline left parenthesis u comma v right parenthesis normal d u normal d v 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript x Baseline integral Subscript negative normal infinity Superscript y Baseline f Subscript bold upper X Baseline left parenthesis u comma v right parenthesis normal d u normal d v comma EndLayoutFX(x, y) =
⌠
(−∞,x]×(−∞,y]
fX(u, v)dudv
(3.3)
=
⌠x
−∞
⌠y
−∞
fX(u, v)dudv,
3.3
Continuous Random Vectors
81
Fig. 3.4 The bell shaped 
surface is the density’s 
graphic StartSet left parenthesis x comma y comma z right parenthesis element of double struck upper R cubed vertical bar z equals f Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis EndSet{(x, y, z) ∈R3 | z =
fX(x, y)}. The probability 
that bold italic upper XX attains values in B 
equals the volume of the solid 
S, computed via double 
integration 
a 
a 
b 
b 
B 
fX (x y) 
X
0 
S 
A 
B
x 
X 
x 
X 
where f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis greater than or slanted equals 0fX(x, y) ⩾0, for every left parenthesis x comma y right parenthesis element of double struck upper R squared(x, y) ∈R2, is the  joint density function of two 
variables, which must be integrable and satisfying4 
integral Subscript negative normal infinity Superscript normal infinity Baseline integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis normal d x normal d y equals 1 period
⌠∞
−∞
⌠∞
−∞
fX(x, y)dxdy = 1.
Figure 3.4 depicts an example of a bi-variate joint density function. Given f Subscript bold italic upper XfX, we  
can compute the probability that a bi-variate random vector bold italic upper XX takes values on the 
rectangle upper B equals left parenthesis a 1 comma b 1 right bracket times left parenthesis a 2 comma b 2 right bracketB = (a1, b1] × (a2, b2] as 
sans serif upper P left parenthesis a 1 less than upper X less than or slanted equals b 1 comma a 2 less than upper Y less than or slanted equals b 2 right parenthesis equals integral Subscript a 1 Superscript b 1 Baseline integral Subscript a 2 Superscript b 2 Baseline f Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis normal d x normal d y periodP(a1 < X ⩽b1, a2 < Y ⩽b2) =
⌠b1
a1
⌠b2
a2
fX(x, y)dxdy.
(3.4) 
The probability remains the same over rectangles with ‘sides’ left bracket a Subscript i Baseline comma b Subscript i Baseline right bracket[ai, bi] or left bracket a Subscript i Baseline comma b Subscript i Baseline right parenthesis[ai, bi) or 
left parenthesis a Subscript i Baseline comma b Subscript i Baseline right parenthesis(ai, bi), for  i equals 1 comma 2i = 1, 2. In the discrete case we can recover5 the marginal masses by 
the joint masses. Similarly, in the continuous case the two densities f Subscript upper X Baseline left parenthesis x right parenthesis comma f Subscript upper Y Baseline left parenthesis y right parenthesisfX(x), fY (y)
satisﬁes: 
integral Subscript negative normal infinity Superscript normal infinity Baseline integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis normal d x normal d y equals integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x equals integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript upper Y Baseline left parenthesis y right parenthesis normal d y equals 1 period
⌠∞
−∞
⌠∞
−∞
fX(x, y)dxdy =
⌠∞
−∞
fX(x)dx =
⌠∞
−∞
fY (y)dy = 1.
The marginal densities are f Subscript upper X Baseline left parenthesis x right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis normal d yfX(x) =
⌠∞
−∞fX(x, y)dy and f Subscript upper Y Baseline left parenthesis y right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis normal d xfY (y) =
⌠∞
−∞fX(x, y)dx. 
To compute sans serif upper P left parenthesis bold italic upper X element of upper B right parenthesisP(X ∈B) over upper B equals left parenthesis a 1 comma b 1 right bracket times left parenthesis a 2 comma b 2 right bracketB = (a1, b1] × (a2, b2] we may ﬁrst integrate the joint 
density over left parenthesis a 1 comma b 1 right bracket(a1, b1] and then over left parenthesis a 2 comma b 2 right bracket(a2, b2], i.e. integral Subscript a 2 Superscript b 2 Baseline left parenthesis integral Subscript a 1 Superscript b 1 Baseline f Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis normal d x right parenthesis normal d y
⌠b2
a2
⎛⌠b1
a1 fX(x, y)dx
⎞
dy; we may  
as well reverse the order of integration. A geometric illustration is depicted in 
Fig. 3.5. 
The joint CDF and density deﬁned for bi-variate random vectors can be easily 
extended to the n-dimensional case. To get the joint density by the multivariate
4 The ﬁrst integral above is a double integral and is equal to two iterated integrals by Fubini’s 
Theorem, see Appendix to this chapter and Appendix I. 
5 We need only to sum once, e.g. sans serif upper P left parenthesis upper X equals x right parenthesis equals sigma summation Underscript y element of script upper Y Endscripts sans serif upper P left parenthesis upper X equals x comma upper Y equals y right parenthesisP(X = x) = ∑
y∈Y P(X = x, Y = y) for a ﬁxed x element of script upper Xx ∈X. 
82
3
Multidimensional Random Variables
Fig. 3.5 The volume of S 
approximated by that of a 
parallelepiped with base 
given by the rectangle 
upper B equals left parenthesis a 1 comma b 1 right bracket times left parenthesis a 2 comma b 2 right bracketB = (a1, b1] × (a2, b2] and 
height given by the value 
f Subscript bold upper X Baseline left parenthesis c 1 comma c 2 right parenthesisfX(c1, c2) of the joint density 
at some point left parenthesis c 1 comma c 2 right parenthesis(c1, c2) inside 
B
 fX c c 
P a
X 
b a 
Y 
b 
= a b
a b
(c c )
 fX (c c ) 
b 
a
b 
a 
a 
b
  f X x x dxdy 
a 
b 
x 
x 
CDF we proceed as follow. Take bold italic x element of double struck upper R Superscript nx ∈Rn and deﬁne bold italic e Subscript i Baseline element of double struck upper R Superscript nei ∈Rn as the n-dimensional 
vector with all entries zero except the ith which is 1. The partial derivative of6 upper F Subscript bold italic upper XFX
with respect to the ith coordinate x Subscript ixi is7 
StartFraction partial differential upper F Subscript bold italic upper X Baseline Over partial differential x Subscript i Baseline EndFraction left parenthesis bold italic x right parenthesis equals limit Underscript h right arrow 0 Endscripts StartFraction upper F Subscript bold italic upper X Baseline left parenthesis bold italic x plus h bold italic e Subscript i Baseline right parenthesis minus upper F Subscript bold italic upper X Baseline left parenthesis bold italic x right parenthesis Over h EndFraction comma h element of double struck upper R period∂FX
∂xi
(x) = lim
h→0
FX(x + hei) −FX(x)
h
,
h ∈R.
If upper F Subscript bold italic upper XFX is differentiable, then there exist all partial derivatives.8 The continuity of 
f Subscript bold italic upper X Baseline left parenthesis bold italic x right parenthesisfX(x) sufﬁces to guarantee that it can be recovered from the multivariate CDF 
performing n partial differentiation: 
ContinuedFraction partial differential Superscript n Baseline upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis Over partial differential x 1 midline horizontal ellipsis partial differential x Subscript n Baseline equals f Subscript bold italic upper X Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis period∂nFX(x1, . . . , xn)
∂x1 · · · ∂xn
= fX(x1, . . . , xn).
(3.5) 
The order of partial derivatives is irrelevant. For example, 
StartFraction partial differential squared upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma x 2 right parenthesis Over partial differential x 1 partial differential x 2 EndFraction equals StartFraction partial differential Over partial differential x 2 EndFraction left bracket StartFraction partial differential Over partial differential x 1 EndFraction left bracket upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma x 2 right parenthesis right bracket right bracket equals f Subscript bold italic upper X Baseline left parenthesis x 1 comma x 2 right parenthesis equals StartFraction partial differential squared upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma x 2 right parenthesis Over partial differential x 2 partial differential x 1 EndFraction period∂2FX(x1, x2)
∂x1∂x2
=
∂
∂x2
⎾∂
∂x1 [FX(x1, x2)]
⏋
= fX(x1, x2) = ∂2FX(x1, x2)
∂x2∂x1
.
If the joint CDF is continuous at bold italic y element of double struck upper R Superscript ny ∈Rn we could write 
limit Underscript x 1 comma ellipsis comma x Subscript n Baseline right arrow y 1 comma ellipsis comma y Subscript n Baseline Endscripts upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis equals upper F Subscript bold italic upper X Baseline left parenthesis y 1 comma ellipsis comma y Subscript n Baseline right parenthesis iff limit Underscript bold italic x right arrow bold italic y Endscripts upper F Subscript bold italic upper X Baseline left parenthesis bold italic x right parenthesis equals upper F Subscript bold italic upper X Baseline left parenthesis bold italic y right parenthesis period
lim
x1,...,xn→y1,...,yn FX(x1, . . . , xn) = FX(y1, . . . , yn) iff lim
x→y FX(x) = FX(y).
This means that we can made upper F Subscript bold italic upper X Baseline left parenthesis bold italic x right parenthesisFX(x) stay as close to upper F Subscript bold italic upper X Baseline left parenthesis bold italic y right parenthesisFX(y) as we like by restricting9 
bold italic xx to be close enough to bold italic yy. Using the Euclidean distance 
d left parenthesis bold italic x comma bold italic y right parenthesis equals StartRoot left parenthesis x 1 minus y 1 right parenthesis squared plus midline horizontal ellipsis plus left parenthesis x Subscript n Baseline minus y Subscript n Baseline right parenthesis squared EndRoot comma for every bold italic x comma bold italic y element of double struck upper R Superscript nd(x, y) =
/
(x1 −y1)2 + · · · + (xn −yn)2,
for every x, y ∈Rn
6 Formally the derivative of the function g left parenthesis h right parenthesis colon equals StartFraction upper F Subscript bold italic upper X Baseline left parenthesis bold italic x plus h bold italic e Subscript i Baseline right parenthesis minus upper F Subscript bold italic upper X Baseline left parenthesis bold italic x right parenthesis Over h EndFractiong(h) := FX(x+hei)−FX(x)
h
. 
7 Observe that bold italic x plus h bold italic e Subscript ix + hei is the vector with all the entries equal to those of bold italic xx, except the ith which is 
x Subscript i Baseline plus hxi + h. 
8 Moreover, each StartFraction partial differential upper F Subscript bold italic upper X Baseline Over partial differential x Subscript i Baseline EndFraction left parenthesis bold italic x right parenthesis ∂FX
∂xi (x) is a continuous function of bold italic xx. 
9 The vector bold italic xx can approach bold italic yy over different directions. 
3.3
Continuous Random Vectors
83
we can rephrase the above deﬁnition as: for any epsilon greater than 0 ϵ > 0 the choice d left parenthesis bold italic x comma bold italic y right parenthesis less than delta commad(x, y) < δ, for 
delta greater than 0 commaδ > 0, does imply StartAbsoluteValue upper F Subscript bold italic upper X Baseline left parenthesis bold italic x right parenthesis minus upper F Subscript bold italic upper X Baseline left parenthesis bold italic y right parenthesis EndAbsoluteValue less than epsilon period|FX(x) −FX(y)| < ϵ. A continuous joint CDF bold upper F Subscript bold upper XFX is continuous 
in each variable separately. E.g., for n equals 2n = 2 we have g left parenthesis dot right parenthesis colon equals upper F Subscript bold italic upper X Baseline left parenthesis dot comma x 2 right parenthesisg( · ) := FX( · , x2) is continuous 
as a function of the ﬁrst variable only, for every ﬁxed x 2 element of double struck upper Rx2 ∈R, and similarly for the 
second variable.10 
Remark 3.3 For general multivariate CDF upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesisFX(x1, . . . , xn) that are (absolutely) 
continuous we have 
f Subscript bold italic upper X Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis equals ContinuedFraction partial differential Superscript n Baseline upper F Subscript bold italic upper X Baseline Over partial differential x 1 midline horizontal ellipsis partial differential x Subscript n Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesisfX(x1, . . . , xn) =
∂nFX
∂x1···∂xn (x1, . . . , xn)
and normal d Superscript n Baseline upper F Subscript bold italic upper X Baseline left parenthesis x right parenthesis equals partial differential Superscript n Baseline upper F Subscript bold italic upper X Baseline left parenthesis x right parenthesis equals colon partial differential Subscript x 1 Baseline midline horizontal ellipsis partial differential Subscript x Sub Subscript n Subscript Baseline upper F Subscript bold italic upper X Baseline left parenthesis x right parenthesisdnFX(x) = ∂nFX(x) =: ∂x1 · · · ∂xnFX(x), where for bold italic x equals left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesisx = (x1, . . . , xn)
the subscripts denotes the variable w.r.t. which we take partial differentiation. It 
is conventional to write normal d Superscript n Baseline upper F Subscript bold italic upper X Baseline left parenthesis x right parenthesisdnFX(x) as normal d upper F Subscript bold italic upper X Baseline left parenthesis x right parenthesisdFX(x) is no confusion arises w.r.t. partial 
differentiation and total differentiation. We adhere to this usage from now on. 
With all these in mind, one obtains the ﬁrst marginal density function f Subscript upper X 1 Baseline left parenthesis x 1 right parenthesisfX1(x1) from 
the multivariate CDF of a random vector bold italic upper X equals left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesisX = (X1, . . . , Xn) as follows: 
StartLayout 1st Row 1st Column f Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis 2nd Column equals 3rd Column StartFraction normal d upper F Subscript bold italic upper X Baseline Over normal d x 1 EndFraction left parenthesis x 1 comma normal infinity comma ellipsis comma normal infinity right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction normal d Over normal d x 1 EndFraction integral Subscript negative normal infinity Superscript x 1 Baseline integral Subscript negative normal infinity Superscript normal infinity Baseline midline horizontal ellipsis integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript bold italic upper X Baseline left parenthesis u 1 comma u 2 comma ellipsis comma u Subscript n Baseline right parenthesis normal d u 1 normal d u 2 midline horizontal ellipsis normal d u Subscript n Baseline 3rd Row 1st Column Blank 2nd Column equals 3rd Column ModifyingBelow integral Subscript negative normal infinity Superscript normal infinity Baseline midline horizontal ellipsis integral Subscript negative normal infinity Superscript normal infinity Baseline With bottom brace Underscript n minus 1 iterated integrals Endscripts f Subscript bold italic upper X Baseline left parenthesis x 1 comma u 2 comma ellipsis comma u Subscript n Baseline right parenthesis normal d u 2 midline horizontal ellipsis normal d u Subscript n Baseline period EndLayoutfX1(x1) = dFX
dx1 (x1, ∞, . . . , ∞)
=
d
dx1
⌠x1
−∞
⌠∞
−∞
· · ·
⌠∞
−∞
fX(u1, u2, . . . , un)du1du2 · · · dun
=
⌠∞
−∞
· · ·
⌠∞
−∞
◟
◝◜
◞
n−1 iterated integrals
fX(x1, u2, . . . , un)du2 · · · dun.
The second equality is due to the Leibniz’s formula for differentiating integrals, see 
Appendix L. Interpretation: after we write 
StartLayout 1st Row upper F Subscript upper X Baseline left parenthesis x 1 comma x 2 comma ellipsis comma x Subscript n Baseline right parenthesis equals integral Subscript negative normal infinity Superscript x 1 Baseline integral Subscript negative normal infinity Superscript x 2 Baseline midline horizontal ellipsis integral Subscript negative normal infinity Superscript x Subscript n Baseline Baseline f Subscript bold italic upper X Baseline left parenthesis u Subscript x Baseline comma u 2 comma ellipsis comma u Subscript n Baseline right parenthesis normal d u 1 normal d u 2 midline horizontal ellipsis normal d u Subscript n Baseline EndLayoutFX(x1, x2, . . . , xn) =
⌠x1
−∞
⌠x2
−∞
· · ·
⌠xn
−∞
fX(ux, u2, . . . , un)du1du2 · · · dun
(3.6) 
and evaluate x 2 comma ellipsis comma x Subscript n Baselinex2, . . . , xn at normal infinity∞, to get the marginal density (w.r.t. x 1x1) from the  
joint CDF we just differentiate this expression (w.r.t. x 1x1) so that the corresponding 
integral cancel out. Then, we integrate the joint density inside the remaining n minus 1n −1
iterated integrals ranging all over u Subscript i Baseline element of double struck upper Rui ∈R, for  i equals 2 comma ellipsis comma ni = 2, . . . , n. Obtaining the other 
marginal densities is done similarly. 
Remark 3.4 (Probability Zero Over Special Subsets) When f Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesisfX(x, y) is contin-
uous as a function of two variables, we know that the marginal densities f Subscript upper X Baseline left parenthesis x right parenthesisfX(x) and
10 Warning: do not confuse normal d Superscript n Baseline upper F Subscript bold italic upper X Baseline left parenthesis x right parenthesisdnFX(x) with the total differential, e.g. in the bi-variate case normal d squared upper F Subscript bold italic upper Xd2FX is 
not StartFraction partial differential upper F Subscript bold italic upper X Baseline Over partial differential x EndFraction normal d x plus StartFraction partial differential upper F Subscript bold italic upper X Baseline Over partial differential y EndFraction normal d y ∂FX
∂x dx + ∂FX
∂y dy. 
84
3
Multidimensional Random Variables
f Subscript upper Y Baseline left parenthesis y right parenthesisfY (y) are continuous functions. Henceforth, sans serif upper P left parenthesis upper X equals x right parenthesis equals sans serif upper P left parenthesis upper Y equals y right parenthesis equals 0P(X = x) = P(Y = y) = 0 and 
sans serif upper P left parenthesis upper X equals x comma upper Y equals y right parenthesis equals 0P(X = x, Y = y) = 0 because left brace upper X equals x right brace intersection left brace upper Y equals y right brace{X = x} ∩{Y = y} is a subset of zero-probability 
events left brace upper X equals x right brace comma left brace upper Y equals y right brace{X = x}, {Y = y} yielding sans serif upper P left parenthesis upper X equals x comma upper Y equals y right parenthesis less than or slanted equals sans serif upper P left parenthesis upper X equals x right parenthesis equals sans serif upper P left parenthesis upper Y equals y right parenthesisP(X = x, Y = y) ⩽P(X = x) = P(Y = y), 
see Proposition 1.1, Pr2, in Sect. 1.5 . As a generalization of the well know result in 
the one-dimensional case we have: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis a 1 less than upper X less than or slanted equals b 1 comma a 2 less than upper Y less than or slanted equals b 2 right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis a 1 less than or slanted equals upper X less than or slanted equals b 1 comma a 2 less than or slanted equals upper Y less than or slanted equals b 2 right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis a 1 less than or slanted equals upper X less than b 1 comma a 2 less than or slanted equals upper Y less than b 2 right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis a 1 less than upper X less than b 1 comma a 2 less than upper Y less than b 2 right parenthesis 4th Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript a 1 Superscript b 1 Baseline integral Subscript a 2 Superscript b 2 Baseline f Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis normal d x normal d y period EndLayoutP(a1 < X ⩽b1, a2 < Y ⩽b2) = P(a1 ⩽X ⩽b1, a2 ⩽Y ⩽b2)
= P(a1 ⩽X < b1, a2 ⩽Y < b2)
= P(a1 < X < b1, a2 < Y < b2)
=
⌠b1
a1
⌠b2
a2
fX(x, y)dxdy.
In fact, singletons left brace left parenthesis x comma y right parenthesis right brace{(x, y)}, segments, lines and planes are subsets of double struck upper R squaredR2 where a 
bi-variate continuous density assigns a zero probability if properly integrated. 
Remark 3.5 It is well known that sans serif upper P left parenthesis x less than upper X less than or slanted equals x plus normal upper Delta x right parenthesis almost equals f Subscript upper X Baseline left parenthesis x right parenthesis normal upper Delta upper XP(x < X ⩽x + Δx) ≈fX(x)ΔX, i.e. 
sans serif upper P left parenthesis x less than upper X less than or slanted equals x plus normal upper Delta x right parenthesis equals f Subscript upper X Baseline left parenthesis x right parenthesis normal upper Delta upper X plus o left parenthesis normal upper Delta x right parenthesisP(x < X ⩽x + Δx) = fX(x)ΔX + o(Δx)
for normal upper Delta x greater than 0Δx > 0 and limit Underscript normal upper Delta x right arrow 0 Endscripts StartFraction o left parenthesis normal upper Delta x right parenthesis Over normal upper Delta x EndFraction equals 0limΔx→0 o(Δx)
Δx
= 0. In the bi-variate case the situation is more 
involved: 
sans serif upper P left parenthesis x less than upper X less than or slanted equals x plus normal upper Delta x comma y less than upper Y less than or slanted equals y plus normal upper Delta y right parenthesis equals f Subscript upper X Baseline left parenthesis x comma y right parenthesis normal upper Delta x normal upper Delta y plus o left parenthesis left parenthesis normal upper Delta x comma normal upper Delta y right parenthesis right parenthesisP(x < X ⩽x +Δx, y < Y ⩽y +Δy) = fX(x, y)ΔxΔy +o((Δx, Δy))
(3.7) 
where now limit Underscript normal upper Delta x right arrow 0 comma normal upper Delta y right arrow 0 Endscripts StartFraction o left parenthesis left parenthesis normal upper Delta x comma normal upper Delta y right parenthesis right parenthesis Over normal upper Delta x normal upper Delta y EndFraction equals 0limΔx→0,Δy→0
o((Δx,Δy))
ΔxΔy
= 0. Thus, dividing both sides of equation 
(3.7) by  normal upper Delta x normal upper Delta yΔxΔy and writing the expression of sans serif upper P left parenthesis x less than upper X less than or slanted equals normal upper Delta x comma y less than upper Y less than or slanted equals normal upper Delta y right parenthesisP(x < X ⩽Δx, y < Y ⩽Δy) in 
term of the bi-variate CDF we get alternatively that f Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis equals StartFraction partial differential squared upper F Subscript bold italic upper X Baseline Over partial differential x partial differential y EndFraction left parenthesis x comma y right parenthesisfX(x, y) = ∂2FX
∂x∂y (x, y). 
3.4 
Stochastic Dependence/Independence 
We know how joint masses or CDFs can generate univariate marginal masses or 
densities. The converse is not true in general, unless some stronger condition is 
imposed on the rvs forming the random vector bold italic upper XX, since knowledge of the marginal 
distributions is not sufﬁcient in determining the joint distribution. However, there is 
a special condition that could do the job. When events left brace upper X less than or slanted equals x right brace{X ⩽x} and left brace upper Y less than or slanted equals y right brace{Y ⩽y} can 
occur together, i.e. left brace upper X less than or slanted equals x right brace intersection left brace upper Y less than or slanted equals y right brace{X ⩽x} ∩{Y ⩽y} is not necessarily the impossible event, it 
could be the case that they do not inﬂuence each other. This may be formalized by 
saying that their joint probability of occurrence factors: 
sans serif upper P left parenthesis upper X less than or slanted equals x comma upper Y less than or slanted equals y right parenthesis equals sans serif upper P left parenthesis upper X less than or slanted equals x right parenthesis sans serif upper P left parenthesis upper Y less than or slanted equals y right parenthesis periodP(X ⩽x, Y ⩽y) = P(X ⩽x)P(Y ⩽y).
(3.8) 
The interpretation is straightforward: conditions upper X less than or slanted equals xX ⩽x and upper Y less than or slanted equals yY ⩽y are both veriﬁed 
with a probability computed through the the individual sans serif upper P left parenthesis upper X less than or slanted equals x right parenthesisP(X ⩽x) and sans serif upper P left parenthesis upper Y less than or slanted equals y right parenthesisP(Y ⩽y),
3.4
Stochastic Dependence/Independence
85
and this sounds like left brace upper X less than or slanted equals x right brace{X ⩽x} does not affect left brace upper Y less than or slanted equals y right brace{Y ⩽y}, and vice versa regardless the 
common content of the resulting joint event.11 Thus, although the joint behavior of 
X and Y is driven by a joint probability distribution the knowledge of X’s values 
does not affect the knowledge of Y’s values, provided condition (3.8) holds. Then 
there is no mutual information on the events induced by component rvs in bold italic upper XX. The  
opposite happens when for any pair of scenarios omega 1 comma omega 2 element of upper Omegaω1, ω2 ∈Ω: 
• 
.(X(ω1) −X(ω2))(Y(ω1) −Y(ω2)) ⩾0; 
• 
.(X(ω1) −X(ω2))(Y(ω1) −Y(ω2)) ⩽0. 
In the ﬁrst case the rvs are called comonotone and they move in the same direction, 
while in the second case they are called antimonotone and move in opposite 
direction. This simply means they are dependent, and knowing events concerning 
X affects events induced by Y. If  upper X comma upper YX, Y are neither comonotone nor antimonotone 
and the mutual information is not maximal, we can consider the following degree of 
mutual dependence: let upper A equals left brace upper X element of upper B 1 right brace comma upper B equals left brace upper Y element of upper B 2 right braceA = {X ∈B1}, B = {Y ∈B2} where upper B 1 comma upper B 2 subset of double struck upper RB1, B2 ⊂R, then we 
always have: 
max left brace 0 comma sans serif upper P left parenthesis upper A right parenthesis plus sans serif upper P left parenthesis upper B right parenthesis minus 1 right brace less than or slanted equals sans serif upper P left parenthesis upper A intersection upper B right parenthesis less than or slanted equals min left brace sans serif upper P left parenthesis upper A right parenthesis comma sans serif upper P left parenthesis upper B right parenthesis right brace period max{0, P(A) + P(B) −1} ⩽P(A ∩B) ⩽min{P(A), P(B)}.
(3.9) 
In fact, upper A intersection upper B subset of upper AA ∩B ⊂A and upper A intersection upper B subset of upper BA ∩B ⊂B so applying the probability function entails 
sans serif upper P left parenthesis upper A intersection upper B right parenthesis less than or slanted equals sans serif upper P left parenthesis upper A right parenthesis and sans serif upper P left parenthesis upper A intersection upper B right parenthesis less than or slanted equals sans serif upper P left parenthesis upper B right parenthesis commaP(A ∩B) ⩽P(A) and P(A ∩B) ⩽P(B),
and we have the inequality in the right-hand side of (3.9). Moreover by Proposi-
tion 1.1, Pr4, we have  
sans serif upper P left parenthesis upper A intersection upper B right parenthesis equals sans serif upper P left parenthesis upper A right parenthesis plus sans serif upper P left parenthesis upper B right parenthesis minus sans serif upper P left parenthesis upper A union upper B right parenthesisP(A ∩B) = P(A) + P(B) −P(A ∪B)
and replacing sans serif upper P left parenthesis upper A union upper B right parenthesisP(A ∪B) with sans serif upper P left parenthesis upper Omega right parenthesis equals 1P(Ω) = 1 we have sans serif upper P left parenthesis upper A intersection upper B right parenthesis greater than or slanted equals sans serif upper P left parenthesis upper A right parenthesis plus sans serif upper P left parenthesis upper B right parenthesis minus 1P(A ∩B) ⩾P(A) + P(B) −1, 
unless sans serif upper P left parenthesis upper A right parenthesis plus sans serif upper P left parenthesis upper B right parenthesis minus 1 less than 0P(A) + P(B) −1 < 0 thus we obtain the inequality in the left-hand side of 
(3.9). If upper A intersection upper B not equals empty setA ∩B /= ∅, and the two events may occur together, the joint probability is 
bounded above by one of the individual probability. Now, the following is crucial in 
the ﬁnal understanding of possible dependence. 
Theorem 3.1 (Conditional Probability) 
Let left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P) a probability space. The 
set function sans serif upper P left parenthesis dot vertical bar upper B right parenthesis colon script upper F right arrow left bracket 0 comma 1 right bracketP( · | B) : F →[0, 1] deﬁned by 
sans serif upper P left parenthesis upper A vertical bar upper B right parenthesis colon equals StartFraction sans serif upper P left parenthesis upper A intersection upper B right parenthesis Over sans serif upper P left parenthesis upper B right parenthesis EndFraction comma for all upper A comma upper B element of script upper F comma s period t period sans serif upper P left parenthesis upper B right parenthesis greater than 0 commaP(A | B) := P(A ∩B)
P(B)
,
for all A, B ∈F, s.t. P(B) > 0,
(3.10) 
is a probability measure. 
Since the idea underlying conditional probability is to suppose B is occurred and 
then use this assumption as ‘new information’ to update the value of sans serif upper P left parenthesis upper A right parenthesisP(A), whenever
11 We emphasize how this concept is based on evaluating probability, instead of looking at the joint 
event as a (not necessarily empty) set of certain scenarios. 
86
3
Multidimensional Random Variables
Table 3.2 Summary of dependence/independence 
upper A intersection upper B equals empty setA ∩B = ∅
upper A intersection upper B not equals empty setA ∩B /= ∅
sans serif upper P left parenthesis upper A right parenthesis greater than 0P(A) > 0 and sans serif upper P left parenthesis upper B right parenthesis greater than 0P(B) > 0
Dependent
Independent if 0 less than sans serif upper P left parenthesis upper A intersection upper B right parenthesis equals sans serif upper P left parenthesis upper A right parenthesis sans serif upper P left parenthesis upper B right parenthesis0 < P(A ∩B) = P(A)P(B)
Dependent if 0 equals sans serif upper P left parenthesis upper A intersection upper B right parenthesis0 = P(A ∩B) or 
0 less than sans serif upper P left parenthesis upper A intersection upper B right parenthesis not equals sans serif upper P left parenthesis upper A right parenthesis sans serif upper P left parenthesis upper B right parenthesis0 < P(A ∩B) /= P(A)P(B)
sans serif upper P left parenthesis upper A right parenthesis equals 0P(A) = 0 and/or sans serif upper P left parenthesis upper B right parenthesis equals 0P(B) = 0
Independent 
Independent if 0 equals sans serif upper P left parenthesis upper A intersection upper B right parenthesis0 = P(A ∩B)
Dependent if 0 less than sans serif upper P left parenthesis upper A intersection upper B right parenthesis0 < P(A ∩B)
these events do not affect each other probabilities (though they are compatible) we 
have: 
sans serif upper P left parenthesis upper A vertical bar upper B right parenthesis equals sans serif upper P left parenthesis upper A right parenthesis long left right double arrow sans serif upper P left parenthesis upper A intersection upper B right parenthesis equals sans serif upper P left parenthesis upper A right parenthesis sans serif upper P left parenthesis upper B right parenthesis periodP(A | B) = P(A) ⇐⇒P(A ∩B) = P(A)P(B).
(3.11) 
So there is no inﬂuence of B on A but they may occur together and we say they are 
independent and write upper A perpendicular perpendicular upper BA ⊥⊥B. Moreover, assuming sans serif upper P left parenthesis upper A right parenthesis greater than 0P(A) > 0 the conditioning 
can be reversed, sans serif upper P left parenthesis upper B vertical bar upper A right parenthesis colon equals StartFraction sans serif upper P left parenthesis upper A intersection upper B right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFractionP(B | A) := P(A∩B)
P(A) , and with no mutual inﬂuence we again have 
sans serif upper P left parenthesis upper B vertical bar upper A right parenthesis equals sans serif upper P left parenthesis upper B right parenthesisP(B | A) = P(B) iff the joint probability factors. Hence, if the knowledge of one 
event does not affect the knowledge of the other both inequalities in (3.9) become 
equalities and we conclude that upper A comma upper BA, B are independent events, see Table 3.2 for a 
summary. 
Remark 3.6 When two events are incompatible, upper A intersection upper B equals empty setA ∩B = ∅, then their joint 
probability is zero and independence holds iff at least one of the individual 
probability is zero too. But for sans serif upper P left parenthesis upper A right parenthesis equals 0P(A) = 0 the condition 0 equals sans serif upper P left parenthesis upper A intersection upper B right parenthesis equals sans serif upper P left parenthesis upper A right parenthesis sans serif upper P left parenthesis upper B right parenthesis equals 00 = P(A ∩B) =
P(A)P(B) = 0 implies the conditional probability in (3.10) cannot be deﬁned if 
in addition sans serif upper P left parenthesis upper B right parenthesis equals 0P(B) = 0. The same is true for the reversed conditional probability with 
sans serif upper P left parenthesis upper B right parenthesis equals 0P(B) = 0. In words, we can deﬁne independence without conditional probability, 
unless we require sans serif upper P left parenthesis upper A vertical bar upper B right parenthesis equals sans serif upper P left parenthesis upper A right parenthesisP(A | B) = P(A) if sans serif upper P left parenthesis upper B right parenthesis equals 0P(B) = 0 and the same for reversed 
conditioning. 
For a random vector bold italic upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y) with two independent rvs, 
ModifyingBelow sans serif upper P left parenthesis upper X element of upper B 1 comma upper Y element of upper B 2 right parenthesis With bottom brace Underscript equals sans serif upper P Subscript bold italic upper X Baseline left parenthesis upper B 1 times upper B 2 right parenthesis Endscripts equals ModifyingBelow sans serif upper P left parenthesis upper X element of upper B 1 right parenthesis With bottom brace Underscript equals sans serif upper P Subscript upper X Baseline left parenthesis upper B 1 right parenthesis Endscripts ModifyingBelow sans serif upper P left parenthesis upper Y element of upper B 2 right parenthesis With bottom brace Underscript equals sans serif upper P Subscript upper Y Baseline left parenthesis upper B 2 right parenthesis Endscripts for every upper B 1 comma upper B 2 subset of double struck upper R commaP(X ∈B1, Y ∈B2)
◟
◝◜
◞
=PX(B1×B2)
= P(X ∈B1)
◟
◝◜
◞
=PX(B1)
P(Y ∈B2)
◟
◝◜
◞
=PY (B2)
for every B1, B2 ⊂R,
i.e. the joint distribution sans serif upper P Subscript bold italic upper X Baseline left parenthesis upper B 1 times upper B 2 right parenthesisPX(B1 × B2) describing upper X comma upper YX, Y as a pair left parenthesis upper X left parenthesis omega right parenthesis comma upper Y left parenthesis omega right parenthesis right parenthesis equals left parenthesis x comma y right parenthesis element of upper B 1 times upper B 2(X(ω), Y(ω)) =
(x, y) ∈B1 × B2 within a subset of the plane double struck upper R squaredR2 given by a Cartesian product,12 
is just the product of the probabilities sans serif upper P Subscript upper X Baseline left parenthesis upper B 1 right parenthesisPX(B1) and sans serif upper P Subscript upper Y Baseline left parenthesis upper B 2 right parenthesisPY (B2) based on the marginal 
distributions. Thus the joint CDF factors too (see Eq. (3.8)): 
upper F Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis equals upper F Subscript upper X Baseline left parenthesis x right parenthesis upper F Subscript upper Y Baseline left parenthesis y right parenthesis comma for every pair left parenthesis x comma y right parenthesis element of double struck upper R squared periodFX(x, y) = FX(x)FY (y),
for every pair (x, y) ∈R2.
(3.12)
12 E.g. left bracket a 1 comma b 1 right bracket times left bracket a 2 comma b 2 right bracket[a1, b1] × [a2, b2]. 
3.4
Stochastic Dependence/Independence
87
Moral: the independence assumption enable us to build the joint distribution of a 
random vector starting from the marginals. 
• 
If the bi-variate random vector bold italic upper XX is continuous then using the marginal densities 
we get the joint density as f Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis equals f Subscript upper X Baseline left parenthesis x right parenthesis f Subscript upper Y Baseline left parenthesis y right parenthesisfX(x, y) = fX(x)fY (y). Indeed by differentiating 
(3.12) we get 
StartFraction partial differential squared upper F Subscript bold italic upper X Baseline Over partial differential x partial differential y EndFraction left parenthesis x comma y right parenthesis equals StartFraction normal d upper F Subscript upper X Baseline Over normal d x EndFraction left parenthesis x right parenthesis StartFraction normal d upper F Subscript upper Y Baseline Over normal d y EndFraction left parenthesis y right parenthesis comma∂2FX
∂x∂y (x, y) = dFX
dx (x) dFY
dy (y),
which is just the product of the marginal densities. 
• 
For a discrete bi-variate random vector we easily have 
sigma summation Underscript x Subscript i Baseline less than or slanted equals x Endscripts sigma summation Underscript y Subscript j Baseline less than or slanted equals y Endscripts sans serif upper P left parenthesis upper X equals x Subscript i Baseline comma upper Y equals y Subscript j Baseline right parenthesis equals sigma summation Underscript x Subscript i Baseline less than or slanted equals x Endscripts sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis sigma summation Underscript y Subscript j Baseline less than or slanted equals y Endscripts sans serif upper P left parenthesis upper Y equals y Subscript j Baseline right parenthesis
⎲
xi⩽x
⎲
yj ⩽y
P(X = xi, Y = yj) =
⎲
xi⩽x
P(X = xi)
⎲
yj ⩽y
P(Y = yj)
and the joint masses are given by the product of the marginals sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesisP(X = xi) and 
sans serif upper P left parenthesis upper Y equals y Subscript j Baseline right parenthesisP(Y = yj). 
Any family of rvs StartSet upper X 1 comma ellipsis comma upper X Subscript n Baseline EndSet{X1, . . . , Xn} is said to be independent whenever their joint 
distribution factors, 
sans serif upper P left parenthesis upper X 1 element of upper B 1 comma ellipsis comma upper X Subscript n Baseline element of upper B Subscript n Baseline right parenthesis equals sans serif upper P left parenthesis upper X 1 element of upper B 1 right parenthesis midline horizontal ellipsis sans serif upper P left parenthesis upper X Subscript n Baseline element of upper B Subscript n Baseline right parenthesis commaP(X1 ∈B1, . . . , Xn ∈Bn) = P(X1 ∈B1) · · · P(Xn ∈Bn),
(3.13) 
for all suitable subsets upper B 1 comma ellipsis comma upper B Subscript n Baseline subset of double struck upper RB1, . . . , Bn ⊂R. This can be extended to more than a ﬁnite 
family of rvs. We may take an indexed family left parenthesis upper X Subscript i Baseline right parenthesis Subscript i element of upper I(Xi)i∈I, where upper I not equals empty setI /= ∅is a set 
of indices, and say that the whole family is independent iff any ﬁnite subfamily 
StartSet upper X Subscript i 1 Baseline comma ellipsis comma upper X Subscript i Sub Subscript n Subscript Baseline EndSet{Xi1, . . . , Xin}, for indices i 1 comma ellipsis comma i Subscript n Baseline element of upper Ii1, . . . , in ∈I, is independent in the sense of (3.13): 
StartEnclose box upper X Subscript i Baseline perpendicular perpendicular upper X Subscript j Baseline comma for every i comma j element of StartSet i 1 comma ellipsis comma i Subscript n Baseline EndSet EndEnclose period Xi ⊥⊥Xj,
for every i, j ∈{i1, . . . , in} .
If a family of rvs is independent, then any pair, triple, etc. of rvs taken from this 
family is also independent. The converse is not true, since we may take upper X Subscript i Baseline comma upper X Subscript j BaselineXi, Xj as 
independent rvs for every i not equals ji /= j and i comma j equals 1 comma ellipsis comma ni, j = 1, . . . , n but the whole family will not 
be independent. 
Remark 3.7 For a class of n rvs independence implies pairwise independence as 
follows: write equality (3.13), choose two rvs, say upper X Subscript i Baseline comma upper X Subscript j BaselineXi, Xj for i not equals ji /= j, then choose 
upper B Subscript k Baseline equals double struck upper RBk = R for all k not equals i comma jk /= i, j and recall that sans serif upper P left parenthesis upper X Subscript k Baseline element of double struck upper R right parenthesis equals 1P(Xk ∈R) = 1. 
Moreover, independence is not transitive: if left brace upper X 1 element of upper B 1 right brace comma left brace upper X 2 element of upper B 2 right brace{X1 ∈B1}, {X2 ∈B2} are independent, 
and left brace upper X 2 element of upper B 2 right brace comma left brace upper X 3 element of upper B 3 right brace{X2 ∈B2}, {X3 ∈B3} are independent, we may have left brace upper X 1 element of upper B 1 right brace comma left brace upper X 3 element of upper B 3 right brace{X1 ∈B1}, {X3 ∈B3} as 
dependent events. The pairs upper X 1 comma upper X 2X1, X2 and upper X 2 comma upper X 3X2, X3 of rvs are independent but the pair 
upper X 1 comma upper X 3X1, X3 is not.
88
3
Multidimensional Random Variables
Remark 3.8 Two events upper A comma upper B element of script upper FA, B ∈F are independent iff A and upper B Superscript cBc are independent 
and also upper A Superscript cAc and upper B Superscript cBc are. In fact, sans serif upper P left parenthesis upper B Superscript c Baseline right parenthesis equals 1 minus sans serif upper P left parenthesis upper B right parenthesisP(Bc) = 1 −P(B) and sans serif upper P left parenthesis upper A right parenthesis equals sans serif upper P left parenthesis upper A intersection upper B right parenthesis plus sans serif upper P left parenthesis upper A intersection upper B Superscript c Baseline right parenthesisP(A) = P(A ∩B) + P(A ∩
Bc) and it follows: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper A intersection upper B Superscript c Baseline right parenthesis 2nd Column equals sans serif upper P left parenthesis upper A right parenthesis minus sans serif upper P left parenthesis upper A intersection upper B right parenthesis equals sans serif upper P left parenthesis upper A right parenthesis minus sans serif upper P left parenthesis upper A right parenthesis sans serif upper P left parenthesis upper B right parenthesis 2nd Row 1st Column Blank 2nd Column equals sans serif upper P left parenthesis upper A right parenthesis left parenthesis 1 minus sans serif upper P left parenthesis upper B right parenthesis right parenthesis equals sans serif upper P left parenthesis upper A right parenthesis sans serif upper P left parenthesis upper B Superscript c Baseline right parenthesis period EndLayoutP(A ∩Bc) = P(A) −P(A ∩B) = P(A) −P(A)P(B)
= P(A)(1 −P(B)) = P(A)P(Bc).
Since upper A comma upper BA, B are independent iff upper A comma upper B Superscript cA, Bc are too, it follows that upper B Superscript c Baseline comma upper ABc, A are independent 
iff upper B Superscript c Baseline comma upper A Superscript cBc, Ac are independent. 
Now, let upper A equals left brace upper X 1 element of upper B 1 right braceA = {X1 ∈B1}, upper B equals left brace upper X 2 element of upper B 2 right braceB = {X2 ∈B2} and upper C equals left brace upper X 3 element of upper B 3 right braceC = {X3 ∈B3}. We can assume 
upper C equals upper A Superscript cC = Ac and by Remark 3.8 independence of A and B is equivalent to independence 
of B and C. However A is not independent of its own complement C, since sans serif upper P left parenthesis upper A intersection upper C right parenthesis equals sans serif upper P left parenthesis empty set right parenthesis equals 0P(A ∩
C) = P(∅) = 0 which is not equal to sans serif upper P left parenthesis upper A right parenthesis sans serif upper P left parenthesis upper C right parenthesisP(A)P(C) in general. The following is 
especially useful in the treatment of conditional distributions, see Chap. 6. 
Lemma 3.1 (Sequential Conditioning) 
Let upper A 1 comma ellipsis comma upper A Subscript n BaselineA1, . . . , An be events in script upper FF. Then 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper A 1 intersection midline horizontal ellipsis intersection upper A Subscript n Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis upper A 1 right parenthesis 2nd Row 1st Column Blank 2nd Column times 3rd Column sans serif upper P left parenthesis upper A 2 vertical bar upper A 1 right parenthesis 3rd Row 1st Column Blank 2nd Column times 3rd Column sans serif upper P left parenthesis upper A 3 vertical bar upper A 1 intersection upper A 2 right parenthesis 4th Row 1st Column Blank 2nd Column vertical ellipsis 3rd Column Blank 5th Row 1st Column Blank 2nd Column times 3rd Column sans serif upper P left parenthesis upper A Subscript n Baseline vertical bar upper A 1 intersection midline horizontal ellipsis intersection upper A Subscript n minus 1 Baseline right parenthesis period EndLayoutP(A1 ∩· · · ∩An) = P(A1)
(3.14)
× P(A2 | A1)
× P(A3 | A1 ∩A2)
...
× P(An | A1 ∩· · · ∩An−1).
Indeed, for n equals 2n = 2 formula (3.14) reduces to formula (3.10). Next, assume the 
statement holds for some integer n minus 1 greater than 1n −1 > 1 and deﬁne upper B equals upper A 1 intersection midline horizontal ellipsis intersection upper A Subscript n minus 1B = A1 ∩· · · ∩An−1. 
We have: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper B intersection upper A Subscript n Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis upper B right parenthesis sans serif upper P left parenthesis upper A Subscript n Baseline vertical bar upper B right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper A 1 intersection midline horizontal ellipsis intersection upper A Subscript n minus 1 Baseline right parenthesis sans serif upper P left parenthesis upper A Subscript n Baseline vertical bar upper A 1 intersection midline horizontal ellipsis intersection upper A Subscript n minus 1 Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper A 1 right parenthesis sans serif upper P left parenthesis upper A 2 vertical bar upper A 1 right parenthesis 4th Row 1st Column Blank 2nd Column vertical ellipsis 3rd Column Blank 5th Row 1st Column Blank 2nd Column times 3rd Column sans serif upper P left parenthesis upper A Subscript n minus 1 Baseline vertical bar upper A 1 intersection midline horizontal ellipsis intersection upper A Subscript n minus 2 Baseline right parenthesis sans serif upper P left parenthesis upper A Subscript n Baseline vertical bar upper A 1 intersection midline horizontal ellipsis intersection upper A Subscript n minus 1 Baseline right parenthesis period EndLayoutP(B ∩An) = P(B)P(An | B)
= P(A1 ∩· · · ∩An−1)P(An | A1 ∩· · · ∩An−1)
= P(A1)P(A2 | A1)
...
× P(An−1 | A1 ∩· · · ∩An−2)P(An | A1 ∩· · · ∩An−1).
This proves that the statement also holds for n element of double struck upper Nn ∈N. Independence among rvs 
is preserved under transformations: there is no reason why a rv f left parenthesis upper X right parenthesisf (X) provides 
information on a rv g left parenthesis upper Y right parenthesisg(Y), whenever upper X comma upper YX, Y provides no information about each other, 
i.e., when they are independent.
3.5
More on Discrete and Continuous Random Vectors
89
Theorem 3.2 Given two independent rvs upper X comma upper YX, Y over the same probability space, 
then f left parenthesis upper X right parenthesisf (X) is independent of g left parenthesis upper Y right parenthesisg(Y), for any choice of suitable functions13 f comma g colon double struck upper R right arrow double struck upper Rf, g :
R →R. 
If upper X comma upper YX, Y are discrete rvs we can prove Theorem 3.2 easily. First, let upper A equals StartSet x element of double struck upper R vertical bar f left parenthesis x right parenthesis equals u EndSetA = {x ∈R |
f (x) = u} and upper B equals StartSet x element of double struck upper R vertical bar g left parenthesis y right parenthesis equals v EndSetB = {x ∈R | g(y) = v}, then write down the joint mass of the 
bi-variate random vector bold italic upper Z equals left parenthesis f left parenthesis upper X right parenthesis comma g left parenthesis upper Y right parenthesis right parenthesisZ = (f (X), g(Y)): 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis f left parenthesis upper X right parenthesis equals u comma g left parenthesis upper Y right parenthesis equals v right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis upper X element of upper A comma upper Y element of upper B right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript x element of upper A Endscripts sigma summation Underscript y element of upper B Endscripts sans serif upper P left parenthesis upper X equals x comma upper Y equals y right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript x element of upper A Endscripts sans serif upper P left parenthesis upper X equals x right parenthesis sigma summation Underscript y element of upper B Endscripts sans serif upper P left parenthesis upper Y equals y right parenthesis 4th Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper X element of upper A right parenthesis sans serif upper P left parenthesis upper Y element of upper B right parenthesis equals sans serif upper P left parenthesis f left parenthesis upper X right parenthesis equals u right parenthesis sans serif upper P left parenthesis g left parenthesis upper Y right parenthesis equals v right parenthesis period EndLayoutP(f (X) = u, g(Y) = v) = P(X ∈A, Y ∈B)
=
⎲
x∈A
⎲
y∈B
P(X = x, Y = y)
=
⎲
x∈A
P(X = x)
⎲
y∈B
P(Y = y)
= P(X ∈A)P(Y ∈B) = P(f (X) = u)P(g(Y) = v).
Theorem 3.2 might be extended to n greater than 2n > 2, see Appendix. A note on terminology: 
n independent rvs upper X 1 comma ellipsis comma upper X Subscript n BaselineX1, . . . , Xn having the same distribution are denoted IID, the  
acronym of independent and identically distributed. Be warned that whether two 
rvs are independent has no relation with whether they share the same distribution: 
we can have any combination of independence/dependence and identical law/not 
identical law, out of four possible cases. 
3.5 
More on Discrete and Continuous Random Vectors 
Given a random vector bold italic upper X equals left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesisX = (X1, . . . , Xn), we recall the following. 
• 
. X is discrete iff there is an (at most) countable upper C subset of double struck upper R Superscript nC ⊂Rn s.t. 
sans serif upper P left parenthesis bold italic upper X element of upper C right parenthesis equals sans serif upper P left parenthesis left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesis element of upper C right parenthesis equals 1 commaP(X ∈C) = P((X1, . . . , Xn) ∈C) = 1,
where C may be taken as the Cartesian product of n countable subsets script upper X Subscript i Baseline equals StartSet x Subscript i Baseline 1 Baseline comma x Subscript i Baseline 2 Baseline comma ellipsis EndSetXi =
{xi1, xi2, . . .} for i equals 1 comma ellipsis comma ni = 1, . . . , n so that left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesis element of upper C(X1, . . . , Xn) ∈C means upper X Subscript i Baseline equals x Subscript i jXi = xij for j equals 1 comma 2 comma ellipsisj =
1, 2, . . . and ﬁxed i. Thus the event left brace bold italic upper X element of upper C right brace{X ∈C} is the disjoint union of intersection 
of events left brace upper X Subscript i Baseline equals x Subscript i j Baseline right brace{Xi = xij} for all indices i comma ji, j. Indeed, if its probability is 1 then also 
sans serif upper P left parenthesis upper X Subscript i Baseline element of script upper X Subscript i Baseline right parenthesis equals 1P(Xi ∈Xi) = 1, compare with Theorem 2.2 Sect. 2.2. 
• 
. X is absolutely continuous iff there exists a joint density s.t. 
sans serif upper P left parenthesis upper X 1 less than or slanted equals x 1 comma ellipsis comma upper X Subscript n Baseline less than or slanted equals x Subscript n Baseline right parenthesis equals integral Subscript negative normal infinity Superscript x 1 Baseline midline horizontal ellipsis integral Subscript negative normal infinity Superscript x Subscript n Baseline Baseline f Subscript bold italic upper X Baseline left parenthesis u 1 comma ellipsis comma u Subscript n Baseline right parenthesis normal d u 1 midline horizontal ellipsis normal d u Subscript n Baseline periodP(X1 ⩽x1, . . . , Xn ⩽xn) =
⌠x1
−∞
· · ·
⌠xn
−∞
fX(u1, . . . , un)du1 · · · dun.
(3.15)
13 The functions must be Borel-measurable. 
90
3
Multidimensional Random Variables
Be warned that: 
• 
if bold italic upper XX is discrete in the sense above, then each rv upper X Subscript iXi is discrete and the converse is 
also true; 
• 
if bold italic upper XX is absolutely continuous then each rv upper X Subscript iXi is also absolutely continuous and 
each marginal density f Subscript upper X Sub Subscript i Baseline left parenthesis x Subscript i Baseline right parenthesisfXi(xi) is obtained by sending to normal infinity∞all x Subscript jxj in (3.15), for 
j not equals ij /= i, then differentiating w.r.t. x Subscript ixi, since the left-hand side is just the multivariate 
CDF upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesisFX(x1, . . . , xn). But the converse ‘each upper X Subscript iXi is absolutely continuous then bold italic upper XX
is absolutely continuous too’ is false in general unless the family StartSet upper X 1 comma ellipsis comma upper X Subscript n Baseline EndSet{X1, . . . , Xn}
forming the random vector is independent. 
For independent rvs upper X Subscript iXi picked from bold italic upper XX it holds14 
upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis equals upper F Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis midline horizontal ellipsis upper F Subscript upper X Sub Subscript n Subscript Baseline left parenthesis x Subscript n Baseline right parenthesis commaFX(x1, . . . , xn) = FX1(x1) · · · FXn(xn),
(3.16) 
which extends formula (3.12), Sect. 3.4, to dimension n greater than 2n > 2. 
Theorem 3.3 For an absolutely continuous random vector bold italic upper X equals left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesisX = (X1, . . . , Xn) the 
rvs upper X 1 comma ellipsis comma upper X Subscript n BaselineX1, . . . , Xn are independent iff the joint density factors, 
f Subscript bold italic upper X Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis equals f Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis midline horizontal ellipsis f Subscript upper X Sub Subscript n Subscript Baseline left parenthesis x Subscript n Baseline right parenthesis periodfX(x1, . . . , xn) = fX1(x1) · · · fXn(xn).
(3.17) 
Taking independent and absolutely continuous 
upper X 1 comma ellipsis comma upper X Subscript n BaselineX1, . . . , Xn, multiplying their 
marginal densities we always obtain the joint density of an absolutely continuous 
random vector bold italic upper X equals left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesisX = (X1, . . . , Xn). For the multidimensional setting we can 
summarize independence in terms of CDFs. 
Theorem 3.4 Let upper F Subscript i Baseline colon double struck upper R right arrow left bracket 0 comma 1 right bracketFi
: R →[0, 1] be nondecreasing, right-continuous and 
s.t. upper F Subscript i Baseline left parenthesis negative normal infinity right parenthesis equals 0Fi(−∞) = 0 and upper F Subscript i Baseline left parenthesis normal infinity right parenthesis equals 1Fi(∞) = 1, for  i equals 1 comma ellipsis comma ni = 1, . . . , n. Then there exists a 
probability space left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P) and rvs upper X 1 comma ellipsis comma upper X Subscript n BaselineX1, . . . , Xn here deﬁned that are independent 
with upper F Subscript i Baseline equals upper F Subscript upper X Sub Subscript iFi = FXi. The probabilities on double struck upper RR to which they corresponds 1-to-1 are the 
upper X Subscript iXi’s laws and sans serif upper P Subscript upper X Sub Subscript i Baseline left parenthesis left parenthesis negative normal infinity comma bold italic x right bracket right parenthesis equals upper F Subscript upper X Sub Subscript i Baseline left parenthesis x Subscript i Baseline right parenthesisPXi((−∞, x]) = FXi(xi). Moreover, there exists a random vector 
bold italic upper X equals left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesisX = (X1, . . . , Xn) s.t. upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis equals product Underscript i equals 1 Overscript n Endscripts upper F Subscript upper X Sub Subscript i Baseline left parenthesis x Subscript i Baseline right parenthesisFX(x1, . . . , xn) = ∏n
i=1 FXi(xi). 
More generally, let left parenthesis upper X Subscript i Baseline right parenthesis Subscript i element of upper I(Xi)i∈I be an indexed collection of rvs and consider a ﬁnite 
number of indices i 1 comma ellipsis comma i Subscript n Baseline element of upper Ii1, . . . , in ∈I. The joint distribution on double struck upper R Superscript nRn
sans serif upper P Subscript i 1 ellipsis i Sub Subscript n Subscript Baseline left parenthesis upper B 1 times midline horizontal ellipsis times upper B Subscript n Baseline right parenthesis colon equals sans serif upper P left parenthesis upper X Subscript i 1 Baseline element of upper B 1 comma ellipsis upper X Subscript i Sub Subscript n Subscript Baseline element of upper B Subscript n Baseline right parenthesisPi1...in(B1 × · · · × Bn) := P(Xi1 ∈B1, . . . Xin ∈Bn)
(3.18) 
is said to be a ﬁnite dimensional distribution (hereafter FIDIS) of the collection 
for any n greater than or slanted equals 2n ⩾2. In term of joint CDF this reads: 
upper F Subscript i 1 ellipsis i Sub Subscript n Subscript Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis colon equals sans serif upper P left parenthesis upper X Subscript i 1 Baseline less than or slanted equals x 1 comma ellipsis upper X Subscript i Sub Subscript n Subscript Baseline less than or slanted equals x Subscript n Baseline right parenthesis commaFi1...in(x1, . . . , xn) := P(Xi1 ⩽x1, . . . Xin ⩽xn),
14 The sufﬁciency is obvious. For the necessity, the fact that the product of upper F Subscript upper X Sub Subscript i Baseline left parenthesis x Subscript i Baseline right parenthesisFXi (xi) equals a joint 
CDF is a more delicate issue of real analysis. 
3.6
Block Dependence
91
corresponding to the random vector 
bold italic upper X equals left parenthesis upper X Subscript i 1 Baseline comma ellipsis comma upper X Subscript i Sub Subscript n Subscript Baseline right parenthesisX
=
(Xi1, . . . , Xin) obtained from the 
indexed family. The family is independent iff any FIDIS factors and thus 
upper F Subscript i 1 ellipsis i Sub Subscript n Subscript Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis equals product Underscript k equals 1 Overscript n Endscripts upper F Subscript upper X Sub Subscript i Sub Sub Subscript k Sub Subscript Subscript Baseline left parenthesis x Subscript k Baseline right parenthesis commaFi1...in(x1, . . . , xn) = ∏n
k=1 FXik (xk), for any choice i 1 comma ellipsis comma i Subscript n Baselinei1, . . . , in with n greater than or slanted equals 2n ⩾2. We  
conclude this section with a classical result on obtaining the univariate density of a 
rv given by the sum (vector-to-scalar transformation) of two other rvs. Let upper X 1 comma upper X 2X1, X2 be 
two independent and absolutely continuous rvs. Thus we know that bold italic upper X equals left parenthesis upper X 1 comma upper X 2 right parenthesisX = (X1, X2)
is an absolutely continuous random vector with joint density f Subscript bold italic upper X Baseline left parenthesis x 1 comma x 2 right parenthesisfX(x1, x2), therefore 
we have: 
Theorem 3.5 The sum upper X 1 plus upper X 2X1 + X2 of two independent and absolutely continuous rvs 
is an absolutely continuous rv with density 
f Subscript upper X 1 plus upper X 2 Baseline left parenthesis u right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript upper X 1 Baseline left parenthesis u minus x 2 right parenthesis f Subscript upper X 2 Baseline left parenthesis x 2 right parenthesis normal d x 2 comma u element of double struck upper R periodfX1+X2(u) =
⌠∞
−∞
fX1(u −x2)fX2(x2)dx2,
u ∈R.
(3.19) 
Observe that g left parenthesis u right parenthesis equals f Subscript upper X 1 plus upper X 2 Baseline left parenthesis u right parenthesisg(u) = fX1+X2(u) is a density w.r.t. variable u equals x 1u = x1 since we integrate 
out the other variable x 2x2. 
Remark 3.9 It is worth noting that the convolution formula (3.19) for densities, 
also written f Subscript upper X 1 plus upper X 2 Baseline left parenthesis x right parenthesis equals colon f Subscript upper X 1 Baseline asterisk f Subscript upper X 2 Baseline left parenthesis x right parenthesisfX1+X2(x) =: fX1 ∗fX2(x), is commutative i.e. f Subscript upper X 2 Baseline asterisk f Subscript upper X 2 Baseline equals f Subscript upper X 1 Baseline asterisk f Subscript upper X 2fX2 ∗fX2 = fX1 ∗fX2. 
It is also associative. 
3.6 
Block Dependence 
Let bold italic upper X equals left parenthesis upper X 1 comma upper X 2 right parenthesisX = (X1, X2) and bold italic upper Y equals left parenthesis upper X overTilde Subscript 1 Baseline comma upper X overTilde Subscript 2 Baseline right parenthesisY = ( ˜X1, ˜X2) be two random vectors with CDFs upper F Subscript bold italic upper X Baseline comma upper F Subscript bold italic upper Y BaselineFX, FY. 
We say that bold italic upper XX is independent of bold italic upper YY, written bold italic upper X perpendicular perpendicular bold italic upper YX ⊥⊥Y, if  
upper F Subscript bold italic upper X comma bold italic upper Y Baseline left parenthesis a comma b comma c comma d right parenthesis equals upper F Subscript bold italic upper X Baseline left parenthesis a comma b right parenthesis upper F Subscript bold italic upper Y Baseline left parenthesis c comma d right parenthesis comma for every a comma b comma c comma d element of double struck upper R commaFX,Y(a, b, c, d) = FX(a, b)FY(c, d),
for every a, b, c, d ∈R,
(3.20) 
where the left-hand side equals the join probability sans serif upper P left parenthesis upper X 1 less than or slanted equals a comma upper X 2 less than or slanted equals b comma upper X overTilde Subscript 1 Baseline less than or slanted equals c comma upper X overTilde Subscript 2 Baseline less than or slanted equals d right parenthesisP(X1 ⩽a, X2 ⩽b, ˜X1 ⩽
c, ˜X2 ⩽d). This  block independence is sufﬁcient for the independence of bold italic upper XX from 
upper X overTilde Subscript 1˜X1, in the sense that 
StartLayout 1st Row 1st Column upper F Subscript bold italic upper X comma upper X overTilde Sub Subscript 1 Subscript Baseline left parenthesis a comma b comma c right parenthesis 2nd Column equals 3rd Column upper F Subscript bold italic upper X comma bold italic upper Y Baseline left parenthesis a comma b comma c comma normal infinity right parenthesis 2nd Row 1st Column Blank 2nd Column equals Overscript ind period left parenthesis question mark question mark question mark right parenthesis Endscripts 3rd Column upper F Subscript bold italic upper X Baseline left parenthesis a comma b right parenthesis upper F Subscript bold italic upper Y Baseline left parenthesis c comma normal infinity right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column upper F Subscript bold italic upper X Baseline left parenthesis a comma b right parenthesis upper F Subscript upper X overTilde Sub Subscript 1 Subscript Baseline left parenthesis c right parenthesis period EndLayoutFX, ˜X1(a, b, c)
=
FX,Y(a, b, c, ∞)
ind. (3.20)
=
FX(a, b)FY(c, ∞) 
=
FX(a, b)F ˜X1 (c).
92
3
Multidimensional Random Variables
The interesting point here is that this also implies upper X 1X1 is independent of upper X overTilde Subscript 1˜X1 and upper X 2X2 is 
independent of upper X overTilde Subscript 1˜X1. We show only the ﬁrst statement is true, since the independence 
of upper X 2X2 and upper X overTilde Subscript 1˜X1 can be proved similarly. Therefore: 
StartLayout 1st Row 1st Column upper F Subscript left parenthesis upper X 1 comma upper X overTilde Sub Subscript 1 Subscript right parenthesis Baseline left parenthesis a comma c right parenthesis 2nd Column equals 3rd Column upper F Subscript bold italic upper X comma bold italic upper Y Baseline left parenthesis a comma normal infinity comma c comma normal infinity right parenthesis 2nd Row 1st Column Blank 2nd Column equals Overscript ind period left parenthesis question mark question mark question mark right parenthesis Endscripts 3rd Column upper F Subscript bold italic upper X Baseline left parenthesis a comma normal infinity right parenthesis upper F Subscript bold italic upper Y Baseline left parenthesis c comma normal infinity right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column upper F Subscript upper X 1 Baseline left parenthesis a right parenthesis upper F Subscript upper X overTilde Sub Subscript 1 Subscript Baseline left parenthesis c right parenthesis period EndLayoutF(X1, ˜X1)(a, c)
=
FX,Y(a, ∞, c, ∞)
ind. (3.20)
=
FX(a, ∞)FY(c, ∞) 
=
FX1(a)F ˜X1 (c). 
Hence, if two bi-variate random vectors bold italic upper X comma bold italic upper YX, Y are independent then each component 
upper X Subscript iXi of bold italic upper XX is independent of each component upper X overTilde Subscript i˜Xi of bold italic upper YY, for  i equals 1 comma 2i = 1, 2. It is worth noting 
that the components of bold italic upper XX are not necessarily independent each other, and the same 
is true for the second random vector. If in addition to the independence of bold italic upper XX from bold italic upper YY
it also holds 
bold italic upper X equals Overscript d Endscripts bold italic upper Y comma i period e period upper F Subscript bold italic upper X Baseline left parenthesis a comma b right parenthesis equals upper F Subscript bold italic upper Y Baseline left parenthesis a comma b right parenthesis comma for every a comma b element of double struck upper R periodX d= Y,
i.e. FX(a, b) = FY(a, b),
for every a, b ∈R.
(3.21) 
then upper F Subscript upper X Sub Subscript i Baseline left parenthesis x right parenthesis equals upper F Subscript upper X overTilde Sub Subscript i Baseline left parenthesis x right parenthesisFXi(x) = F ˜Xi(x) for i equals 1 comma 2i = 1, 2 and every x element of double struck upper Rx ∈R. In fact, using (3.21) and letting 
a equals xa = x we have 
upper F Subscript bold italic upper X Baseline left parenthesis x comma normal infinity right parenthesis equals upper F Subscript bold italic upper Y Baseline left parenthesis x comma normal infinity right parenthesisFX(x, ∞) = FY(x, ∞)
and for b equals xb = x
upper F Subscript bold italic upper X Baseline left parenthesis normal infinity comma x right parenthesis equals upper F Subscript bold italic upper Y Baseline left parenthesis normal infinity comma x right parenthesis periodFX(∞, x) = FY(∞, x).
As byproduct, we also have: 
StartLayout 1st Row upper F Subscript upper X 1 Baseline upper F Subscript upper X overTilde Sub Subscript 2 Subscript Baseline 2nd Row upper F Subscript upper X overTilde Sub Subscript 1 Subscript Baseline upper F Subscript upper X 2 Baseline EndLayout right brace equals upper F Subscript upper X 1 Baseline upper F Subscript upper X 2 FX1F ˜X2
F ˜X1FX2
⌠
= FX1FX2
3.7 
Exercises 
3.1 Let a = (a1, a2), b = (b1, b2), a1 = (a1, b2) and a2 = (a2, b1) be three 
vectors in R2. Furthermore, let (−∞, b] :=  (−∞, b1] × (−∞, b2], (−∞, a1] :=  
(−∞, a1] ×  (−∞, b2] and (−∞, a2] :=  (−∞, b1] ×  (−∞, a2]. Show that 
left parenthesis bold italic a comma bold italic b right bracket equals left parenthesis negative normal infinity comma bold italic b right bracket minus left parenthesis negative normal infinity comma bold italic a 1 right bracket union left parenthesis negative normal infinity comma bold italic a 2 right bracket comma(a, b] = (−∞, b] \ (−∞, a1] ∪(−∞, a2],
(3.22) 
where the union is not disjoint.
3.7
Exercises
93
3.2 Given a, b, a1 and a2 as in Exercise 3.1. Prove the following: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis bold italic a less than bold italic upper X less than or slanted equals bold italic b right parenthesis 2nd Column equals 3rd Column upper F Subscript bold italic upper X Baseline left parenthesis b 1 comma b 2 right parenthesis minus upper F Subscript bold italic upper X Baseline left parenthesis a 1 comma b 2 right parenthesis 2nd Row 1st Column Blank 2nd Column minus 3rd Column upper F Subscript bold italic upper X Baseline left parenthesis b 1 comma a 2 right parenthesis plus upper F Subscript bold italic upper X Baseline left parenthesis a 1 comma a 2 right parenthesis period EndLayoutP(a < X ⩽b) = FX(b1, b2) −FX(a1, b2)
−FX(b1, a2) + FX(a1, a2).
3.3 Let X = (X1, X2) be a random vector and consider events A1 = {X1 + X2 ⩽
1}, A2 = {X2 
1 + X2 
2 ⩽1} and A3 = {max{X1, X2} ⩽1}. Plot the regions in the 
plane R2 corresponding to these events. 
3.4 Show that for a bi-variate CDF it is true that P(a1 < X ⩽b1, Y ⩽y) equals 
FX(b1, y) − FX(a1, y)  and P(X ⩽x, a2 < Y ⩽b2) equals FX(x, b2) − FX(x, a2). 
3.5 Show that for a bi-variate CDF we have FX(b1, b2)−FX(a1, b2)−FX(b1, a2)+ 
FX(a1, a2) ⩾0. 
3.6 Let X = (X, Y) be a random vector with CDF FX(x, y). It is worth noting 
that if the second order partial ∂2FX 
∂x∂y (x, y) exists and is continuous, expect at a ﬁnite 
number of points (x, y), then also the ﬁrst order partials exist and are continuous, the 
CDF is differentiable and also continuous itself with the aforementioned exceptions. 
Verify the following: 
(a) fX(x, y) ⩾0; 
(b) P(a1 < X ⩽b1, a2 < Y ⩽b2) =
⌠b1 
a1
⌠b2 
a2 fX(x, y)dxdy; 
(c) FX(x, y) =
⌠x 
−∞
⌠y 
−∞ fX(u, v)dudv; 
(d)
⌠∞ 
−∞
⌠∞ 
−∞ fX(x, y)dxdy = 1. 
3.7 (Further Details on Conditional Probability) Prove Theorem 3.1 and give 
the appropriate interpretation. 
3.8 A ﬁnancial analyst is faced with the problem of forecasting the future prices 
of two securities, labeled #1 and #2 respectively. He assume 9 outcomes based on 
upward and downward price movements together with the hypotheses that prices 
remain unchanged: 
upper Omega equals StartSet d d comma d s comma d u comma s d comma s s comma s u comma u d comma u s comma u u EndSet periodΩ = {dd, ds, du, sd, ss, su, ud, us, uu}.
Here ‘s’ stands for ‘same price’. If the analyst assigns the probabilities 
• 
P({dd}) = P({ds}) = P({su}) = P({ud}) = P({uu}) = 0.1 
• 
P({du}) = P({us}) = 0; P({sd}) = 0.48; P({ss}) = 0.02, 
what is the probability that price #1 will end down, under the condition that price 
#2 will be either the same or raised? 
3.9 Let X, Y be rvs deﬁned over the same probability space, and let f (x), g(y)  two 
continuous functions of only x and y, respectively. Show that the rvs U = f (X)  and 
V = g(Y) are independent, provided they are assumed to be continuous.
94
3
Multidimensional Random Variables
Appendix 
Double Integration and Fubini’s Theorem 
The double integral double integral Underscript upper B Endscripts normal d upper F Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis
⌠⌠
B dFX(x, y) cannot in general be equal to iterated integrals, 
but can be interpreted geometrically as the weighting of area left parenthesis upper B right parenthesisarea(B) using a bi-variate 
CDF s.t. normal d upper F Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesisdFX(x, y) is to be thought of as the limiting case of 
normal upper Delta upper F Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis equals upper F Subscript bold italic upper X Baseline left parenthesis x plus normal upper Delta x comma y plus normal upper Delta y right parenthesis minus upper F Subscript bold italic upper X Baseline left parenthesis x plus normal upper Delta x comma y right parenthesis minus upper F Subscript bold italic upper X Baseline left parenthesis x comma y plus normal upper Delta y right parenthesis plus upper F Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis greater than or slanted equals 0 periodΔFX(x, y) = FX(x+Δx, y+Δy)−FX(x+Δx, y)−FX(x, y+Δy)+FX(x, y) ⩾0.
In fact we have the following version of the Fubini’s Theorem. 
Theorem 3.6 (‘Light’ Fubini) Let upper F left parenthesis x comma y right parenthesis equals upper F 1 left parenthesis x right parenthesis upper F 2 left parenthesis y right parenthesisF(x, y) = F1(x)F2(y), where upper F 1 comma upper F 2F1, F2 are two 
bounded functions deﬁned over left bracket a comma b right bracket[a, b] and left bracket c comma d right bracket[c, d], respectively, Then 
StartLayout 1st Row 1st Column double integral Underscript left bracket a comma b right bracket times left bracket c comma d right bracket Endscripts g left parenthesis x comma y right parenthesis normal d upper F left parenthesis x comma y right parenthesis 2nd Column equals 3rd Column integral Subscript c Superscript d Baseline left bracket integral Subscript a Superscript b Baseline g left parenthesis x comma y right parenthesis upper F 1 left parenthesis x right parenthesis normal d x right bracket upper F 2 left parenthesis y right parenthesis normal d y 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript a Superscript b Baseline left bracket integral Subscript c Superscript d Baseline g left parenthesis x comma y right parenthesis upper F 2 left parenthesis y right parenthesis normal d y right bracket upper F 1 left parenthesis x right parenthesis normal d x comma EndLayout
⌠⌠
[a,b]×[c,d]
g(x, y)dF(x, y) =
⌠d
c
⎾⌠b
a
g(x, y)F1(x)dx
⏋
F2(y)dy (3.23)
=
⌠b
a
⎾⌠d
c
g(x, y)F2(y)dy
⏋
F1(x)dx,
where the function g left parenthesis x comma y right parenthesisg(x, y) is bounded on left bracket a comma b right bracket times left bracket c comma d right bracket[a, b] × [c, d]. 
Obviously, we can choose upper F equals upper F Subscript bold italic upper XF = FX and upper F 1 equals upper F Subscript upper XF1 = FX, upper F 2 equals upper F Subscript upper YF2 = FY , i.e. we can refer 
to a joint CDF of a random vector bold italic upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y) with independent rvs upper X comma upper YX, Y having 
marginal CDFs upper F Subscript upper X Baseline comma upper F Subscript upper Y BaselineFX, FY . We can integrate ﬁrst w.r.t. the variable x and then w.r.t. 
y or vice versa. We only need the following generalization of the Riemann double 
integral. Let upper B Subscript n Baseline colon equals left bracket negative n comma n right bracket times left bracket negative n comma n right bracketBn := [−n, n] × [−n, n] for any integer n element of double struck upper Nn ∈N and write 
limit Underscript n right arrow normal infinity Endscripts double integral Underscript upper B Subscript n Baseline Endscripts f left parenthesis x comma y right parenthesis normal d x normal d y equals integral Subscript negative normal infinity Superscript normal infinity Baseline integral Subscript negative normal infinity Superscript normal infinity Baseline f left parenthesis x comma y right parenthesis normal d x normal d y period lim
n→∞
⌠⌠
Bn
f (x, y)dxdy =
⌠∞
−∞
⌠∞
−∞
f (x, y)dxdy.
As byproduct, we can always deﬁne the double improper Stieltjes integral15 
StartEnclose box double integral Underscript double struck upper R squared Endscripts g left parenthesis x comma y right parenthesis normal d upper F left parenthesis x comma y right parenthesis EndEnclose
⌠⌠
R2 g(x, y)dF(x, y)
as equal to integral Subscript negative normal infinity Superscript normal infinity Baseline integral Subscript negative normal infinity Superscript normal infinity Baseline g left parenthesis x comma y right parenthesis normal d upper F left parenthesis x comma y right parenthesis
⌠∞
−∞
⌠∞
−∞g(x, y)dF(x, y), which eventually can be computed by 
formula (3.23). Indeed, for upper F Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis not equals upper F Subscript upper X Baseline left parenthesis x right parenthesis upper F Subscript upper Y Baseline left parenthesis y right parenthesisFX(x, y) /= FX(x)FY (y) we can consider the bi-variate
15 For an overview of Stieltjes integration see Appendix in Chap. 4. 
Appendix
95
CDF function upper F Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis equals upper F Subscript upper X vertical bar upper Y Baseline left parenthesis x comma y right parenthesis upper F Subscript upper Y Baseline left parenthesis y right parenthesisFX(x, y) = FX | Y (x, y)FY (y) with upper F Subscript upper X vertical bar upper Y Baseline left parenthesis dot comma y right parenthesisFX | Y ( · , y) being a CDF on double struck upper RR in 
the variable x for a ﬁxed y element of double struck upper Ry ∈R and compute: 
double integral Underscript double struck upper R squared Endscripts g left parenthesis x comma y right parenthesis normal d upper F Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket integral Subscript negative normal infinity Superscript normal infinity Baseline g left parenthesis x comma y right parenthesis normal d upper F Subscript upper X vertical bar upper Y Baseline left parenthesis x comma y right parenthesis right bracket upper F Subscript upper Y Baseline left parenthesis y right parenthesis normal d y period
⌠⌠
R2 g(x, y)dFX(x, y) =
⌠∞
−∞
⎾⌠∞
−∞
g(x, y)dFX | Y (x, y)
⏋
FY (y)dy.
The same is true for  upper F Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis equals upper F Subscript upper Y vertical bar upper X Baseline left parenthesis x comma y right parenthesis upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x, y) = FY | X(x, y)FX(x) with upper F Subscript upper Y vertical bar upper X Baseline left parenthesis x comma dot right parenthesisFY | X(x, · ) being a CDF 
on double struck upper RR in the variable y for a ﬁxed x element of double struck upper Rx ∈R: 
double integral Underscript double struck upper R squared Endscripts g left parenthesis x comma y right parenthesis normal d upper F Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket integral Subscript negative normal infinity Superscript normal infinity Baseline g left parenthesis x comma y right parenthesis normal d upper F Subscript upper Y vertical bar upper X Baseline left parenthesis x comma y right parenthesis right bracket upper F Subscript upper X Baseline left parenthesis x right parenthesis normal d x period
⌠⌠
R2 g(x, y)dFX(x, y) =
⌠∞
−∞
⎾⌠∞
−∞
g(x, y)dFY | X(x, y)
⏋
FX(x)dx.
Remark 3.10 Later we will recognize 
upper F Subscript upper X vertical bar upper Y Baseline left parenthesis x comma y right parenthesis colon equals StartFraction upper F Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis Over upper F Subscript upper Y Baseline left parenthesis y right parenthesis EndFractionFX | Y (x, y) := FX(x,y)
FY (y)
and 
upper F Subscript upper Y vertical bar upper X Baseline left parenthesis x comma y right parenthesis colon equals StartFraction upper F Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis Over upper F Subscript upper X Baseline left parenthesis x right parenthesis EndFractionFY | X(x, y) := FX(x,y)
FX(x)
as the conditional CDF of one rv w.r.t. values assumed by the other, see Chap. 6. 
For the sake of completeness we provide another version of the Fubini’s Theorem. 
Theorem 3.7 (‘Weak’ Fubini) If f colon left bracket a comma b right bracket times left bracket c comma d right bracket right arrow double struck upper Rf : [a, b]×[c, d] →R is continuous on left bracket a comma b right bracket times left bracket c comma d right bracket[a, b]×
[c, d], then the iterated integrals 
integral Subscript c Superscript d Baseline integral Subscript a Superscript b Baseline f left parenthesis x comma y right parenthesis normal d x normal d y and integral Subscript a Superscript b Baseline integral Subscript c Superscript d Baseline f left parenthesis x comma y right parenthesis normal d y normal d x
⌠d
c
⌠b
a
f (x, y)dxdy
and
⌠b
a
⌠d
c
f (x, y)dydx
exist and are equal. 
1-to-1 Correspondence Between P and FX 
Theorem 3.8 (Joint or Multivariate CDF) Let P be some probability over (Ω, F) 
and let FX : Rn →[0, 1] be a function given by formula (3.1). Then we have: 
1. FX is nondecreasing, i.e. for any x = (x1, . . . , xn) and y = (y1, . . . , yn) s.t. 
x ⩽y it follows FX(x) ⩽FX(y), where the vector inequality means that xi ⩽yi 
for every i = 1, . . . , n  and at least one inequality is strict; 
2. FX is right-continuous, i.e. for any sequence of vectors (xm)m∈N s.t. xm ↓ x ∈ 
Rn it holds FX(xm) ↓ FX(x), where xm ⩾x with xm = (x1m, . . . , xnm), each 
m ∈ N, and xim ↓ xi for i = 1, . . . , n  where in general n /= m;
96
3
Multidimensional Random Variables
3. limx1,...,xn→∞ FX(x1, . . . , xn) 
:= 
FX(∞, . . . , ∞) 
= 
1 and limxi→−∞ 
FX(x1, . . . , xn) = 0 for i = 1, . . . , n; 
4. for every pair of vectors a = (a1, . . . , an) ⩽(b1, . . . , bn) = b, i.e. ai ⩽bi for 
i = 1, . . . , n, deﬁning the difference operator as 
StartLayout 1st Row 1st Column normal upper Delta Subscript a Sub Subscript i Subscript comma b Sub Subscript i Subscript Baseline upper F left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis 2nd Column equals 3rd Column upper F left parenthesis x 1 comma ellipsis comma x Subscript i minus 1 Baseline comma b Subscript i Baseline comma x Subscript i plus 1 Baseline comma ellipsis comma x Subscript n Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column minus 3rd Column upper F left parenthesis x 1 comma ellipsis comma x Subscript i minus 1 Baseline comma a Subscript i Baseline comma x Subscript i plus 1 Baseline comma ellipsis comma x Subscript n Baseline right parenthesis comma EndLayoutΔai,biF(x1, . . . , xn) = F(x1, . . . , xi−1, bi, xi+1, . . . , xn)
−F(x1, . . . , xi−1, ai, xi+1, . . . , xn),
entails Δa1,b1 · · ·  Δan,bnFX(x1, . . . , xn) = P(a < X ⩽b). 
Conversely, if a function FX : Rn →[0, 1] satisﬁes properties (a)–(d) then there 
exists a probability P over some event space (Ω, F) s.t. FX is the joint CDF of a 
random vector X, i.e. PX(B) = P(X ∈ B) for a suitable B ⊂ Rn. 
For the sake of intuition we illustrate properties 2,3 and 4 for the bi-dimensional 
case. 
1. The characterization of right-continuity requires a sequence of vectors x1 = 
(x11, x21) ⩾x2 = (x12, x22) ⩾· · · ⩾xm = (x1m, x2m) s.t. for each i = 1, . . . , n  
the corresponding real-valued sequence xi1 ⩾xi2 ⩾· · · ⩾xim converges 
(in decreasing order) to xi, i.e. limm→∞ xim = xi, and x = (x1, x2). Thus, 
the vectors xm = (x1m, x2m) ‘approach the vector’ x ‘from the right’ and 
correspondingly FX(x1m, x2m) are decreasing real values tending to FX(x1, x2). 
Alternatively we could write 
limit Underscript h down arrow 0 Endscripts left parenthesis limit Underscript k down arrow 0 Endscripts upper F Subscript bold italic upper X Baseline left parenthesis x 1 plus h comma x 2 plus k right parenthesis right parenthesis equals upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma x 2 right parenthesis comma h comma k greater than 0 periodlim
h↓0
⎛
lim
k↓0 FX(x1 + h, x2 + k)
⎞
= FX(x1, x2),
h, k > 0.
Without loss of generality we can take k = h. Note that d(xm, x) → 0 as  m → 
∞ or d((x1 + h, x2 + h), (x1, x2)) → 0 as  h ↓ 0. 
2. The limit 
limit Underscript x 1 right arrow normal infinity Endscripts left parenthesis limit Underscript x 1 right arrow normal infinity Endscripts upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma x 2 right parenthesis right parenthesis equals upper F Subscript bold italic upper X Baseline left parenthesis normal infinity comma normal infinity right parenthesis equals 1 lim
x1→∞
⎛
lim
x1→∞FX(x1, x2)
⎞
= FX(∞, ∞) = 1
can be obtained using the sequential characterization. In fact, xi →∞ is 
equivalent to xi + m →∞and m →∞, for  i = 1, 2. Thus: 
StartLayout 1st Row 1st Column Blank 2nd Column Blank 3rd Column limit Underscript m right arrow normal infinity Endscripts sans serif upper P left parenthesis upper X 1 less than or slanted equals x 1 plus m comma upper X 2 less than or slanted equals x 2 plus m right parenthesis 2nd Row 1st Column Blank 2nd Column equals Overscript contin period of sans serif upper P Endscripts 3rd Column sans serif upper P left parenthesis limit Underscript m right arrow normal infinity Endscripts left brace upper X 1 less than or slanted equals x 1 plus m right brace intersection left brace upper X 2 less than or slanted equals x 2 plus m right brace right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper Omega right parenthesis equals 1 period EndLayout
lim
m→∞P(X1 ⩽x1 + m, X2 ⩽x2 + m)
contin. of P
=
P
⎛
lim
m→∞{X1 ⩽x1 + m} ∩{X2 ⩽x2 + m}
⎞
=
P(Ω) = 1.
Appendix
97
With the same reasoning we get (which is true also for the variable x2): 
StartLayout 1st Row 1st Column limit Underscript m right arrow normal infinity Endscripts sans serif upper P left parenthesis upper X 1 less than or slanted equals x 1 minus m comma upper X 2 less than or slanted equals x 2 right parenthesis 2nd Column equals Overscript contin period of sans serif upper P Endscripts 3rd Column sans serif upper P left parenthesis limit Underscript m right arrow normal infinity Endscripts left brace upper X 1 less than or slanted equals x 1 minus m right brace intersection left brace upper X 2 less than or slanted equals x 2 right brace right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis empty set intersection left brace upper X 2 less than or slanted equals x 2 right brace right parenthesis equals 0 comma EndLayout lim
m→∞P(X1 ⩽x1 −m, X2 ⩽x2) contin. of P
=
P
⎛
lim
m→∞{X1 ⩽x1 −m} ∩{X2 ⩽x2}
⎞
=
P (∅∩{X2 ⩽x2}) = 0,
where the ﬁrst limit on the left equals limx1→−∞ FX(x1, x2) = FX(−∞, x2) = 
0. 
3. The difference operator acts iteratively.16 Thus we have: 
StartLayout 1st Row 1st Column normal upper Delta Subscript a 1 comma b 1 Baseline normal upper Delta Subscript a 2 comma b 2 Baseline upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma x 2 right parenthesis 2nd Column colon equals 3rd Column normal upper Delta Subscript a 1 comma b 1 Baseline left parenthesis normal upper Delta Subscript a 2 comma b 2 Baseline upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma x 2 right parenthesis right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column normal upper Delta Subscript a 1 comma b 1 Baseline left parenthesis upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma b 2 right parenthesis minus upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma a 2 right parenthesis right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column normal upper Delta Subscript a 1 comma b 1 Baseline upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma b 2 right parenthesis minus normal upper Delta Subscript a 1 comma b 1 Baseline upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma a 2 right parenthesis 4th Row 1st Column Blank 2nd Column equals 3rd Column upper F Subscript bold italic upper X Baseline left parenthesis b 1 comma b 2 right parenthesis minus upper F Subscript bold italic upper X Baseline left parenthesis a 1 comma b 2 right parenthesis 5th Row 1st Column Blank 2nd Column minus 3rd Column upper F Subscript bold italic upper X Baseline left parenthesis b 1 comma a 2 right parenthesis plus upper F Subscript bold italic upper X Baseline left parenthesis a 1 comma a 2 right parenthesis period EndLayoutΔa1,b1Δa2,b2FX(x1, x2) := Δa1,b1
(
Δa2,b2FX(x1, x2)
)
(3.24)
= Δa1,b1 (FX(x1, b2) −FX(x1, a2))
= Δa1,b1FX(x1, b2) −Δa1,b1FX(x1, a2)
= FX(b1, b2) −FX(a1, b2)
−FX(b1, a2) + FX(a1, a2).
It is worth noting that the event {a < X ⩽b} means that the random vector takes 
values on the Cartesian product (a, b] =  (a1, b1]×(a2, b2], i.e. (X1, X2) ∈ (a, b] 
iff ai < Xi ⩽bi for i = 1, 2. 
The necessary part (=⇒) of Theorem 3.8 for independent rvs is Theorem 3.4 in 
Sect. 3.5. 
Remark 3.11 Property 1 of Theorem 3.8 can be restated by saying that FX is n-
increasing, i.e., Δa1,b1 · · ·  Δan,bnFX(x1, . . . , xn) ⩾0, for every rectangle (a, b] 
with a = (a1, . . . , an) and b = (b1, . . . , bn). Here the difference operator gives 
raise to the sum S0 − S1 + S2 −· · · +  (−1)n Sn, where Si is itself a sum of all 
terms FX(s1, . . . , sn) with sk = ak for exactly i integers from {1, . . . , n}, and 
sk = bk for the remaining n − i integers; there are
(n 
i
)
of such terms. In fact, this is 
just the FX-volume of the rectangle (a, b] which can be equivalently computed as
∑
v∈V sign(v)FX(v), where 
sign left parenthesis bold italic v right parenthesis equals StartLayout Enlarged left brace 1st Row 1st Column 1 comma 2nd Column if v Subscript i Baseline equals a Subscript i Baseline for an even number of indices 2nd Row 1st Column negative 1 comma 2nd Column if v Subscript i Baseline equals a Subscript i Baseline for an odd number of indices comma EndLayoutsign(v) =
⌠
1, if vi = ai for an even number of indices
−1, if vi = ai for an odd number of indices,
and V = {a1, b1} × · · · × {an, bn} is the set containing all vertices of (a, b], each 
given as v = (v1, . . . , vn). Observe that right-continuity (b) is equivalent to have 
FX right-continuous in all variables.
16 Δai,bi acts on FX by substituting the number bi to the ith coordinate xi in FX(x1, . . . , xn) then 
substituting the number ai to the same coordinate and eventually taking the difference. 
98
3
Multidimensional Random Variables
Some Details on Independence 
Given independent events upper A 1 comma ellipsis comma upper A Subscript n Baseline element of script upper FA1, . . . , An ∈F we have sigma left parenthesis upper A 1 right parenthesis comma ellipsis comma sigma left parenthesis upper A Subscript n Baseline right parenthesisσ(A1), . . . , σ(An) are indepen-
dent and also bold upper I Subscript upper A 1 Baseline comma ellipsis comma bold upper I Subscript upper A Sub Subscript n Subscript BaselineIA1, . . . , IAn are independent. These three conditions are equivalent. 
Observe that indexed classes of events script upper G Subscript i Baseline subset of script upper FGi ⊂F, for  i element of upper Ii ∈I, are said independent 
iff upper A Subscript i 1 Baseline element of script upper G Subscript i 1 Baseline comma ellipsis comma upper A Subscript i Sub Subscript n Subscript Baseline element of script upper G Subscript i Sub Subscript n Subscript BaselineAi1 ∈Gi1, . . . , Ain ∈Gin are independent for any ﬁnite choice of indices17 
i 1 comma ellipsis comma i Subscript n Baseline element of upper Ii1, . . . , in ∈I. For example, rvs upper X 1 comma ellipsis comma upper X Subscript n BaselineX1, . . . , Xn are independent iff sigma left parenthesis upper X 1 right parenthesis comma ellipsis comma sigma left parenthesis upper X Subscript n Baseline right parenthesisσ(X1), . . . , σ(Xn)
are independent as families of events sigma left parenthesis upper X Subscript i Baseline right parenthesis equals StartSet left brace upper X Subscript i Baseline element of upper B Subscript i Baseline right brace vertical bar upper B Subscript i Baseline element of double struck upper R suitable EndSetσ(Xi) = {{Xi ∈Bi} | Bi ∈R suitable}, 
see also Example 1.15 in Sects. 1.6 and 6.4. Now, a multidimensional version of 
Theorem 3.2 for classes of events induced by indexed families of rvs, can be 
proved based on the fact that certain independent classes script upper G Subscript iGi of events in script upper FF, each 
containing intersection of all pairs upper A comma upper B element of script upper G Subscript i BaselineA, B ∈Gi, generate sigma hyphen algebraσ-algebra sigma left parenthesis script upper G Subscript i 1 Baseline comma ellipsis comma script upper G Subscript i Sub Subscript n Subscript Baseline right parenthesisσ(Gi1, . . . , Gin)
that are independent for all choice of indices i 1 comma ellipsis comma i Subscript n Baselinei1, . . . , in, and this yields rvs upper Y equals f left parenthesis upper X Subscript i 1 Baseline comma ellipsis comma upper X Subscript i Sub Subscript n Subscript Baseline right parenthesisY =
f (Xi1, . . . , Xin) are independent because their generated sigma hyphen algebraσ-algebras sigma left parenthesis upper Y right parenthesisσ(Y) are. This 
is a more general form of block independence, see Sect. 3.6. 
Remark 3.12 In the proof of Theorem 3.2 we used special sets upper A comma upper BA, B for the values 
of f left parenthesis upper X right parenthesisf (X) and g left parenthesis upper Y right parenthesisg(Y). Actually, using the deﬁnition of inverse image (see Appendix in 
Chap. 2) we can consider two composed maps 
upper Omega right arrow Overscript upper X Endscripts double struck upper R right arrow Overscript f Endscripts double struck upper R comma upper Omega right arrow Overscript upper Y Endscripts double struck upper R right arrow Overscript g Endscripts double struck upper R commaΩ
X
−−−−→R
f
−−−−→R,
Ω
Y
−−−−→R
g
−−−−→R,
and observing that upper X comma upper YX, Y and f comma gf, g are Borel-measurable, passing to their correspond-
ing inverse images and composed mappings we have: 
left brace f left parenthesis upper X right parenthesis equals u right brace equals upper X Superscript negative 1 Baseline left parenthesis f Superscript negative 1 Baseline left parenthesis StartSet u EndSet right parenthesis right parenthesis equals left brace upper X element of f Superscript negative 1 Baseline left parenthesis StartSet u EndSet right parenthesis right brace comma upper A equals f Superscript negative 1 Baseline left parenthesis StartSet u EndSet right parenthesis comma{f (X) = u} = X−1(f −1({u})) = {X ∈f −1({u})}, A = f −1({u}),
and 
left brace g left parenthesis upper Y right parenthesis equals v right brace equals upper Y Superscript negative 1 Baseline left parenthesis g Superscript negative 1 Baseline left parenthesis StartSet v EndSet right parenthesis right parenthesis equals left brace upper Y element of g Superscript negative 1 Baseline left parenthesis StartSet v EndSet right parenthesis right brace comma upper B equals g Superscript negative 1 Baseline left parenthesis StartSet v EndSet right parenthesis comma{g(Y) = v} = Y −1(g−1({v})) = {Y ∈g−1({v})}, B = g−1({v}),
then taking intersection left brace f left parenthesis upper X right parenthesis equals u right brace intersection left brace g left parenthesis upper Y right parenthesis equals v right brace{f (X) = u}∩{g(Y) = v} we get the same result. It is worth 
noting that 
script upper B right arrow Overscript f Superscript negative 1 Baseline Endscripts script upper B right arrow Overscript upper X Superscript negative 1 Baseline Endscripts upper OmegaB
f −1
−−−−−−→B
X−1
−−−−−−→Ω
has composed inverse image script upper B right arrow Overscript left parenthesis f ring upper X right parenthesis Superscript negative 1 Baseline Endscripts upper OmegaB
(f ◦X)−1
−−−−−−−−→Ω, where left parenthesis f ring upper X right parenthesis Superscript negative 1 Baseline colon equals upper X Superscript negative 1 Baseline ring f Superscript negative 1(f ◦X)−1 := X−1 ◦f −1. 
We can formulate a result about independence also for different probability spaces.
17 Independence of sigma left parenthesis upper A 1 right parenthesis comma ellipsis comma sigma left parenthesis upper A Subscript n Baseline right parenthesisσ(A1), . . . , σ(An) implies Independence of upper A 1 comma ellipsis comma upper A Subscript n BaselineA1, . . . , An trivially. Indepen-
dence among sigma left parenthesis upper A Subscript i Baseline right parenthesisσ(Ai) and independence among bold upper I Subscript upper A Sub Subscript iIAi are equivalent since independence of rvs can 
be stated in terms of their generated sigma hyphen algebraσ-algebras. The fact that independence of events upper A Subscript iAi implies 
independence of their generated sigma hyphen algebraσ-algebras is more subtle, and we omit the proof. 
Appendix
99
Theorem 3.9 Let the rvs upper X comma upper YX, Y be deﬁned over left parenthesis upper Omega 1 comma script upper F 1 right parenthesis(Ω1, F1) and over left parenthesis upper Omega 2 comma script upper F 2 right parenthesis(Ω2, F2), 
respectively. For every pair of Borel-measurable functions f comma g colon double struck upper R right arrow double struck upper Rf, g : R →R, the  rvs  
f left parenthesis upper X right parenthesis comma g left parenthesis upper Y right parenthesisf (X), g(Y) are independent iff upper X comma upper YX, Y are. 
Proof Recall that a composition between a rv (which is measurable itself) and a 
Borel-measurable function if measurable. left parenthesis right double arrow right parenthesis(⇒) Assuming f left parenthesis upper X right parenthesis comma g left parenthesis upper Y right parenthesisf (X), g(Y) are indepen-
dent we simply let f left parenthesis x right parenthesis equals xf (x) = x and g left parenthesis y right parenthesis equals yg(y) = y. left parenthesis left double arrow right parenthesis(⇐) Assuming upper X comma upper YX, Y are independent 
we known that their generated sigma hyphen algebraσ-algebra sigma left parenthesis upper X right parenthesis comma sigma left parenthesis upper Y right parenthesisσ(X), σ(Y) are independent too. Now, let 
upper U equals f left parenthesis upper X right parenthesisU = f (X) and upper V equals g left parenthesis upper Y right parenthesisV = g(Y), then 
left brace f left parenthesis upper X right parenthesis element of upper C right brace equals upper X Superscript negative 1 Baseline left parenthesis f Superscript negative 1 Baseline left parenthesis upper C right parenthesis right parenthesis equals left brace upper X element of upper A right brace comma upper A equals f Superscript negative 1 Baseline left parenthesis upper C right parenthesis comma{f (X) ∈C} = X−1(f −1(C)) = {X ∈A}, A = f −1(C),
and 
left brace g left parenthesis upper Y right parenthesis element of upper D right brace equals upper Y Superscript negative 1 Baseline left parenthesis g Superscript negative 1 Baseline left parenthesis upper D right parenthesis right parenthesis equals left brace upper Y element of upper B right brace comma upper B equals g Superscript negative 1 Baseline left parenthesis upper D right parenthesis period{g(Y) ∈D} = Y −1(g−1(D)) = {Y ∈B}, B = g−1(D).
Since sigma left parenthesis upper U right parenthesis subset of sigma left parenthesis upper X right parenthesisσ(U) ⊂σ(X) and sigma left parenthesis upper V right parenthesis subset of sigma left parenthesis upper Y right parenthesisσ(V ) ⊂σ(Y), events left brace upper X element of upper A right brace element of sigma left parenthesis upper X right parenthesis{X ∈A} ∈σ(X) and left brace upper Y element of upper B right brace element of sigma left parenthesis upper Y right parenthesis{Y ∈B} ∈
σ(Y) are independent as well as sigma left parenthesis upper X right parenthesis comma sigma left parenthesis upper Y right parenthesisσ(X), σ(Y), we are done. 
█
Conditional Independence 
From Sect. 3.4 we see that two rvs upper X comma upper YX, Y can be: 
• 
independent but not identically distributed; 
• 
independent and identically distributed; 
• 
dependent but not identically distributed; 
• 
dependent and identically distributed. 
For example, X being the lifetime of a randomly selected newborn and upper Y equals upper S 1Y = S1 the 
daily closing price of the S&P500 are independent but not identically distributed. 
If X represents tick movements plus or minus 0.5±0.5 of the S&P500’s closing price at the end of 
day 1, and Y represents tick movements of the same stock index at the end of day 
2, then upper X comma upper YX, Y are IID. Moreover, let upper X equals bold upper I Subscript left brace upper S 1 greater than 0 at the end of day 3 right braceX = I{S1>0 at the end of day 3} and let Y be the 
number of downward tick movements negative 0.5−0.5 in 3 consecutive trading days, then upper X comma upper YX, Y
are dependent but they do not have the same distribution. Eventually, let X be the 
number of upward tick movements 0.50.5 in one trading day and let Y be the number of 
downward tick movements negative 0.5−0.5 over the same time horizon, then upper X comma upper YX, Y might safely 
have the same distribution (see Sect. 5.4) and they are clearly dependent. There is 
another form of dependence among rvs that we can state by requiring 
sans serif upper P left parenthesis upper X less than or slanted equals x comma upper Y less than or slanted equals y vertical bar upper Z equals z right parenthesis equals sans serif upper P left parenthesis upper X less than or slanted equals x comma vertical bar upper Z equals z right parenthesis sans serif upper P left parenthesis upper Y less than or slanted equals y vertical bar upper Z equals z right parenthesis comma for all x comma y element of double struck upper RP(X ⩽x, Y ⩽y | Z = z) = P(X ⩽x, | Z = z)P(Y ⩽y | Z = z), for all x, y ∈R
for any pair of rvs upper X comma upper YX, Y deﬁned over the same probability space, and any z in the 
support of a third rv Z. This is called conditional independence, and has nothing to
100
3
Multidimensional Random Variables
do with (unconditional) independence. The requirement above can be generalized 
by considering the notion of general conditional probability, see Sect. 6.4. 
Proof of Theorem 3.5 
Proof We simply write the CDF of the rv X1 + X2 and differentiating the proof is 
complete. Thus for the event {X1 + X2 ⩽x} we consider the subset given by 
upper B equals StartSet left parenthesis x 1 comma x 2 right parenthesis vertical bar x 1 plus x 2 less than or slanted equals x EndSet subset of double struck upper R squaredB = {(x1, x2) | x1 + x2 ⩽x} ⊂R2
involving the random vector X = (X1, X2): 
StartLayout 1st Row 1st Column upper F Subscript upper X 1 plus upper X 2 Baseline left parenthesis x right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis upper X 1 plus upper X 2 less than or slanted equals x right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Underscript upper B Endscripts f Subscript bold italic upper X Baseline left parenthesis x 1 comma x 2 right parenthesis normal d x 1 normal d x 2 equals Overscript Indep period Endscripts integral Underscript upper B Endscripts f Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis f Subscript upper X 2 Baseline left parenthesis x 2 right parenthesis normal d x 1 normal d x 2 3rd Row 1st Column Blank 2nd Column equals Overscript Fubini right single quotation mark s Th Endscripts 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket integral Subscript negative normal infinity Superscript x minus x 2 Baseline f Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis normal d x 1 right bracket f Subscript upper X 2 Baseline left parenthesis x 2 right parenthesis normal d x 2 4th Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket integral Subscript negative normal infinity Superscript x Baseline f Subscript upper X 1 Baseline left parenthesis x 1 minus x 2 right parenthesis normal d x 1 right bracket f Subscript upper X 2 Baseline left parenthesis x 2 right parenthesis normal d x 2 5th Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript x Baseline left bracket integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript upper X 1 Baseline left parenthesis x 1 minus x 2 right parenthesis normal d x 2 right bracket f Subscript upper X 2 Baseline left parenthesis x 2 right parenthesis normal d x 1 comma EndLayoutFX1+X2(x)
=
P(X1 + X2 ⩽x)
=
⌠
B
fX(x1, x2)dx1dx2
Indep.
=
⌠
B
fX1(x1)fX2(x2)dx1dx2
Fubini’s Th
=
⌠∞
−∞
⎾⌠x−x2
−∞
fX1(x1)dx1
⏋
fX2(x2)dx2
=
⌠∞
−∞
⎾⌠x
−∞
fX1(x1 −x2)dx1
⏋
fX2(x2)dx2
=
⌠x
−∞
⎾⌠∞
−∞
fX1(x1 −x2)dx2
⏋
fX2(x2)dx1,
so choosing u = x1 and applying d 
dx FX1+X2 we are done. 
█
Proof of Theorem 3.3 
Proof Assume X1, . . . , Xn are independent. By (3.16) and (3.15) we may write: 
StartLayout 1st Row 1st Column Blank 2nd Column Blank 3rd Column ModifyingBelow integral Subscript negative normal infinity Superscript x 1 Baseline f Subscript upper X 1 Baseline left parenthesis u 1 right parenthesis normal d u 1 times midline horizontal ellipsis times integral Subscript negative normal infinity Superscript x Subscript n Baseline f Subscript upper X Sub Subscript n Baseline left parenthesis u Subscript n Baseline right parenthesis normal d u Subscript n With bottom brace Underscript equals product Underscript i equals 1 Overscript n Endscripts integral Subscript negative normal infinity Superscript x Subscript i Baseline Baseline f Subscript upper X Sub Subscript i Baseline left parenthesis u Subscript i Baseline right parenthesis normal d u Subscript i Baseline Endscripts 2nd Row 1st Column Blank 2nd Column equals 3rd Column product Underscript i equals 1 Overscript n Endscripts sans serif upper P left parenthesis upper X Subscript i Baseline less than or slanted equals x Subscript i Baseline right parenthesis equals sans serif upper P left parenthesis upper X 1 less than or slanted equals x 1 comma ellipsis comma upper X Subscript n Baseline less than or slanted equals x Subscript n Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column equals Overscript abs period cont period Endscripts 3rd Column integral Subscript negative normal infinity Superscript x 1 Baseline midline horizontal ellipsis integral Subscript negative normal infinity Superscript x Subscript n Baseline Baseline f Subscript bold italic upper X Baseline left parenthesis u 1 comma ellipsis comma u Subscript n Baseline right parenthesis normal d u 1 midline horizontal ellipsis normal d u Subscript n Baseline comma EndLayout
⌠x1
−∞
fX1(u1)du1 × · · · ×
⌠xn
−∞
fXn(un)dun
◟
◝◜
◞
=∏n
i=1
⌠xi
−∞fXi (ui)dui
=
n
∏
i=1
P(Xi ⩽xi) = P(X1 ⩽x1, . . . , Xn ⩽xn)
abs. cont.
=
⌠x1
−∞
· · ·
⌠xn
−∞
fX(u1, . . . , un)du1 · · · dun,
Appendix
101
for every x1, . . . , xn. Subtracting the former expression, which by Fubini’s Theorem 
is written as
⌠x1 
−∞· · ·
⌠xn 
−∞
⎾∏n 
i=1 fXi (ui)
⏋
du1 · · · dun, from the latter we get 
integral Subscript negative normal infinity Superscript x 1 Baseline midline horizontal ellipsis integral Subscript negative normal infinity Superscript x Subscript n Baseline Baseline left bracket f Subscript bold italic upper X Baseline left parenthesis u 1 comma ellipsis comma u Subscript n Baseline right parenthesis minus product Underscript i equals 1 Overscript n Endscripts f Subscript upper X Sub Subscript i Subscript Baseline left parenthesis u Subscript i Baseline right parenthesis right bracket normal d u 1 midline horizontal ellipsis normal d u Subscript n Baseline equals 0 period
⌠x1
−∞
· · ·
⌠xn
−∞
⎾
fX(u1, . . . , un) −
n
∏
i=1
fXi(ui)
⏋
du1 · · · dun = 0.
Differentiating w.r.t. the variables x1, . . . , xn we are done. Conversely, if the joint 
density factors we have: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper X 1 less than or slanted equals x 1 comma ellipsis comma upper X Subscript n Baseline less than or slanted equals x Subscript n Baseline right parenthesis 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript x 1 Baseline midline horizontal ellipsis integral Subscript negative normal infinity Superscript x Subscript n Baseline Baseline left bracket product Underscript i equals 1 Overscript n Endscripts f Subscript upper X Sub Subscript i Subscript Baseline left parenthesis u Subscript i Baseline right parenthesis right bracket normal d u 1 midline horizontal ellipsis normal d u Subscript n Baseline 2nd Row 1st Column Blank 2nd Column equals 3rd Column product Underscript i equals 1 Overscript n Endscripts integral Subscript negative normal infinity Superscript x Subscript i Baseline Baseline f Subscript upper X Sub Subscript i Subscript Baseline left parenthesis u Subscript i Baseline right parenthesis normal d u Subscript i Baseline equals product Underscript i equals 1 Overscript n Endscripts sans serif upper P left parenthesis upper X Subscript i Baseline less than or slanted equals x Subscript i Baseline right parenthesis comma EndLayoutP(X1 ⩽x1, . . . , Xn ⩽xn) =
⌠x1
−∞
· · ·
⌠xn
−∞
⎾n
∏
i=1
fXi(ui)
⏋
du1 · · · dun
=
n
∏
i=1
⌠xi
−∞
fXi(ui)dui =
n
∏
i=1
P(Xi ⩽xi),
which is independence by (3.16). 
█
As a corollary we also get that independent rvs Xi which are absolutely continuous 
provide a random vector X = (X1, . . . , Xn) that is absolutely continuous. It sufﬁces 
to start from P(X1 ⩽x1, . . . , Xn ⩽xn), writes it as ∏n 
i=1 P(Xi ⩽xi) =
∏n 
i=1
⌠xi 
−∞ fXi (ui)dui and then by Fubini’s Theorem we get the iterated integrals 
integral Subscript negative normal infinity Superscript x 1 Baseline midline horizontal ellipsis integral Subscript negative normal infinity Superscript x Subscript n Baseline Baseline left bracket product Underscript i equals 1 Overscript n Endscripts f Subscript upper X Sub Subscript i Subscript Baseline left parenthesis u Subscript i Baseline right parenthesis right bracket normal d u 1 midline horizontal ellipsis normal d u Subscript n Baseline
⌠x1
−∞
· · ·
⌠xn
−∞
⎾n
∏
i=1
fXi(ui)
⏋
du1 · · · dun
showing that ∏n 
i=1 fXi (ui) satisﬁes the property of a joint density fX.
Chapter 4 
Moments and the Alike 
4.1 
A Motivating Starting Point 
Let left parenthesis upper Omega comma script upper F right parenthesis(Ω, F ) be an event space representing the following random experiment: a 
gamble s.t. you win e 1000 with probability p greater than 0p > 0 and you loose e 900 with 
probability 1 minus p1−p. How much you wish to get a gain or you fear to suffer a loss, from 
this gamble on average? First, we can deﬁne the discrete rv X having distribution 
with masses sans serif upper P left parenthesis upper X equals 1000 right parenthesis equals pP(X = 1000) = p and sans serif upper P left parenthesis upper X equals negative 900 right parenthesis equals 1 minus pP(X = −900) = 1−p. Then, we can compute 
the forecasted win/loss as 
ModifyingAbove upper X With quotation dash equals p Baseline 1000 plus left parenthesis negative 900 right parenthesis left parenthesis 1 minus p right parenthesis periodX = p1000 + (−900)(1 −p).
E.g., assuming p equals one halfp = 1
2 you expect to win e ModifyingAbove upper X With quotation dash equals 50X = 50. A physical interpretation of ModifyingAbove upper X With quotation dashX is 
that it represents the center of gravity of the numbers negative 900−900 and 1000 in double struck upper RR, on which 
you put two probabilities determining sans serif upper P Subscript upper X Baseline left parenthesis upper B right parenthesis equals p delta 1000 left parenthesis upper B right parenthesis plus left parenthesis 1 minus p right parenthesis delta Subscript negative 900 Baseline left parenthesis upper B right parenthesisPX(B) = pδ1000(B) + (1 −p)δ−900(B) as 
the law of X, for every suitable subset1 upper B subset of double struck upper RB ⊂R. Observe that ModifyingAbove upper X With quotation dashX is a number lying 
between negative 900−900 and 1000 comma1000, for every p element of left parenthesis 0 comma 1 right parenthesisp ∈(0, 1), i.e. it is a convex combination with 
weights 1 minus p1 −p and p. 
The number ModifyingAbove upper X With quotation dashX synthesizes possible values that the rv X takes on, using partial 
information given by its probability masses. In fact, interpreting 
p equals sans serif upper P left parenthesis upper X equals 1000 right parenthesis almost equals StartFraction f Subscript n Baseline left parenthesis upper A right parenthesis Over n EndFraction and 1 minus p equals sans serif upper P left parenthesis upper X equals negative 900 right parenthesis almost equals StartFraction f Subscript n Baseline left parenthesis upper A Superscript c Baseline right parenthesis Over n EndFractionp = P(X = 1000) ≈fn(A)
n
and
1 −p = P(X = −900) ≈fn(Ac)
n
as the relative frequencies of the events upper A equals left brace upper X equals 1000 right braceA = {X = 1000} and upper A Superscript c Baseline equals left brace upper X equals 1000 right braceAc = {X =
1000}, respectively,2 ModifyingAbove upper X With quotation dashX deserves the name average and represents what one expects 
1 Recall: delta Subscript x Baseline left parenthesis upper B right parenthesis equals bold upper I Subscript upper B Baseline left parenthesis x right parenthesisδx(B) = IB(x). 
2 Assuming the independent repetition n element of double struck upper Nn ∈N times of the underlying random experiment. 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4_4
103
104
4
Moments and the Alike
Fig. 4.1 (Top) The 
distribution sans serif upper P Subscript upper XPX is discrete 
with total mass 1 and ModifyingAbove upper X With quotation dashX being 
its center of gravity, with 
p equals 0.65p = 0.65. (Bottom) Discrete 
uniform distribution with 
masses p equals two sixthsp = 2
6
from the random experiment governing X. Figure 4.1 illustrates the physical 
interpretation of ModifyingAbove upper X With quotation dashX. 
4.2 
Expectation 
Mathematical expectation can be deﬁned for a rv as a predicted value with average 
probability. We will distinguish between discrete and continuous rvs. 
Deﬁnition 4.1 Let X be a discrete rv with ﬁnite or countable values and probability 
masses sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesisP(X = xi), for every x Subscript ixi in the support C, and let g colon double struck upper R right arrow double struck upper Rg : R →R be a real-valued 
function s.t. g left parenthesis upper X right parenthesisg(X) is a rv.3 The expectation of g left parenthesis upper X right parenthesisg(X) is 
sans serif upper E left parenthesis g left parenthesis upper X right parenthesis right parenthesis colon equals sigma summation Underscript i s period t period x Subscript i Baseline element of upper C Endscripts g left parenthesis x Subscript i Baseline right parenthesis sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis commaE(g(X)) :=
⎲
i s.t. xi∈C
g(xi)P(X = xi),
(4.1) 
provided that g left parenthesis upper X right parenthesis greater than or slanted equals 0g(X) ⩾0 or the sum is4 absolutely convergent, sigma summation Underscript i Endscripts StartAbsoluteValue g left parenthesis x Subscript i Baseline right parenthesis EndAbsoluteValue sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis less than normal infinity∑
i |g(xi)|P(X =
xi) < ∞. 
Using the identity function g left parenthesis x right parenthesis equals xg(x) = x, expectation of discrete rvs satisﬁes the 
following properties. 
1. If upper X left parenthesis omega right parenthesis equals kX(ω) = k for every scenario omega element of upper Omegaω ∈Ω, with k element of double struck upper Rk ∈R, then there is only left brace upper X equals k right brace equals upper Omega{X =
k} = Ω in the sum (4.1) and sans serif upper E left parenthesis upper X right parenthesis equals k sans serif upper P left parenthesis upper X equals k right parenthesis equals kE(X) = kP(X = k) = k. Also, sans serif upper P left parenthesis upper X equals k right parenthesis equals 1P(X = k) = 1, i.e., 
upper X equals kX = k sans serif upper PP-a.s. does imply sans serif upper E left parenthesis upper X right parenthesis equals kE(X) = k. 
2. If a comma b element of double struck upper Ra, b ∈R then sans serif upper E left parenthesis a plus b upper X right parenthesis equals a plus b sans serif upper E left parenthesis upper X right parenthesisE(a + b X) = a + b E(X), i.e. expectation is linear, provided 
sans serif upper E left parenthesis upper X right parenthesisE(X) is well deﬁned.
3 This is especially true for continuous g. 
4 We use StartAbsoluteValue g left parenthesis x Subscript i Baseline right parenthesis sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis EndAbsoluteValue equals|g(xi)P(X = xi)| = StartAbsoluteValue g left parenthesis x Subscript i Baseline right parenthesis EndAbsoluteValue StartAbsoluteValue sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis EndAbsoluteValue|g(xi)||P(X = xi)| and StartAbsoluteValue sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis EndAbsoluteValue equals sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis|P(X = xi)| = P(X = xi). 
4.2
Expectation
105
3. If upper X left parenthesis omega right parenthesis less than or slanted equals upper Y left parenthesis omega right parenthesisX(ω) ⩽Y(ω) for every scenario then sans serif upper E left parenthesis upper X right parenthesis less than or slanted equals sans serif upper E left parenthesis upper Y right parenthesisE(X) ⩽E(Y), i.e. expectation preserves 
ordering, where Y is another discrete rv with well-deﬁned sans serif upper E left parenthesis upper Y right parenthesisE(Y). 
For a discrete rv X there are interesting relationships between indicators and 
expectation. 
• 
Let g left parenthesis x right parenthesis equals bold upper I Subscript upper B Baseline left parenthesis x right parenthesisg(x) = IB(x) be the indicator of a suitable subset upper B subset of double struck upper RB ⊂R. Thus sans serif upper E left parenthesis bold upper I Subscript upper B Baseline left parenthesis upper X right parenthesis right parenthesis equals sans serif upper P left parenthesis upper X element of upper B right parenthesisE(IB(X)) =
P(X ∈B). In fact, by Deﬁnition 4.1 the expectation on the left-hand side is 
sigma summation Underscript i Endscripts bold upper I Subscript upper B Baseline left parenthesis x Subscript i Baseline right parenthesis sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis equals sigma summation Underscript x Subscript i Baseline element of upper B Endscripts sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis∑
i IB(xi)P(X = xi) = ∑
xi∈B P(X = xi), and since the events left brace upper X equals x Subscript i Baseline right brace{X = xi}
are pairwise disjoint the last sum is equal to sans serif upper P left parenthesis union Subscript x Sub Subscript i Subscript element of upper B Baseline left brace upper X equals x Subscript i Baseline right brace right parenthesisP
(
∪xi∈B{X = xi}
)
which is just 
sans serif upper P left parenthesis upper X element of upper B right parenthesisP(X ∈B). 
• 
An indicator rv upper X equals bold upper I Subscript upper AX = IA with upper A element of script upper FA ∈F is discrete with support upper C equals StartSet 0 comma 1 EndSetC = {0, 1}. Thus, 
upper A equals left brace upper X equals 1 right braceA = {X = 1} and upper A Superscript c Baseline equals left brace upper X equals 0 right braceAc = {X = 0} and we can write 
sans serif upper E left parenthesis upper X right parenthesis equals 1 times sans serif upper P left parenthesis upper X equals 1 right parenthesis plus 0 times sans serif upper P left parenthesis upper X equals 0 right parenthesisE(X) = 1 × P(X = 1) + 0 × P(X = 0)
and ﬁnally obtain sans serif upper E left parenthesis bold upper I Subscript upper A Baseline right parenthesis equals sans serif upper P left parenthesis upper A right parenthesisE(IA) = P(A). Choosing upper A equals left brace upper X element of upper B right braceA = {X ∈B} we obtain the result 
in the ﬁrst item. 
Example 4.1 Let X be a discrete rv with support StartSet 0 comma 1 comma 2 comma ellipsis EndSet{0, 1, 2, . . .} and mass function 
sans serif upper P left parenthesis upper X equals i right parenthesis equals normal e Superscript lamda Baseline StartFraction lamda Superscript i Baseline Over i factorial EndFractionP(X = i) = eλ λi
i! , with parameter lamda greater than 0λ > 0 (see Sect. 5.5). Taking the identity function 
g left parenthesis x right parenthesis equals xg(x) = x, we have5 
sans serif upper E left parenthesis upper X right parenthesis equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts i normal e Superscript negative lamda Baseline StartFraction lamda Superscript i Baseline Over i factorial EndFraction periodE(X) =
∞
⎲
i=1
ie−λ λi
i! .
Moreover, we have the following chain of equivalences: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X right parenthesis 2nd Column equals 3rd Column lamda normal e Superscript negative lamda Baseline sigma summation Underscript i equals 1 Overscript normal infinity Endscripts i StartFraction lamda Superscript i minus 1 Baseline Over i factorial EndFraction equals lamda normal e Superscript negative lamda Baseline sigma summation Underscript i equals 1 Overscript normal infinity Endscripts left bracket StartFraction normal d Over normal d lamda EndFraction StartFraction lamda Superscript i Baseline Over i factorial EndFraction right bracket 2nd Row 1st Column Blank 2nd Column equals 3rd Column lamda normal e Superscript negative lamda Baseline StartFraction normal d Over normal d lamda EndFraction left bracket sigma summation Underscript i equals 0 Overscript normal infinity Endscripts StartFraction lamda Superscript i Baseline Over i factorial EndFraction right bracket equals lamda e Superscript negative lamda Baseline StartFraction normal d Over normal d lamda EndFraction left bracket normal e Superscript lamda Baseline right bracket 3rd Row 1st Column Blank 2nd Column equals 3rd Column lamda normal e Superscript negative lamda Baseline normal e Superscript lamda Baseline equals lamda period EndLayoutE(X) = λ e−λ
∞
⎲
i=1
i λi−1
i!
= λ e−λ
∞
⎲
i=1
⎾
d
dλ
λi
i!
⏋
= λ e−λ d
dλ
⎾∞
⎲
i=0
λi
i!
⏋
= λ e−λ d
dλ
⎾
eλ⏋
= λ e−λ eλ = λ.
Remark 4.1 In the previous chain of equivalences we used facts from real analy-
sis. 
• 
The exponential function h left parenthesis lamda right parenthesis equals normal e Superscript lamdah(λ) = eλ has the Taylor series expansion6 h left parenthesis lamda right parenthesis equals sigma summation Underscript i equals 0 Overscript normal infinity Endscripts StartFraction lamda Superscript i Baseline Over i factorial EndFractionh(λ) =
∑∞
i=0
λi
i! , around lamda equals 0λ = 0.
5 Observe that sigma summation Underscript i equals 1 Overscript normal infinity Endscripts StartAbsoluteValue i normal e Superscript negative lamda Baseline StartFraction lamda Superscript i Baseline Over i factorial EndFraction EndAbsoluteValue equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts i normal e Superscript negative lamda Baseline StartFraction lamda Superscript i Baseline Over i factorial EndFraction∑∞
i=1
||ie−λ λi
i!
|| = ∑∞
i=1 ie−λ λi
i! , thus verifying sans serif upper E left parenthesis upper X right parenthesis equals lamdaE(X) = λ implies the sufﬁcient 
convergent condition in Deﬁnition 4.1 is fulﬁlled. 
6 Recall the derivative StartFraction normal d Over normal d lamda EndFraction StartFraction lamda Superscript i Baseline Over i factorial EndFraction equals i StartFraction lamda Superscript i minus 1 Baseline Over i factorial EndFraction d
dλ
λi
i! = i λi−1
i! . 
106
4
Moments and the Alike
• 
The function 
sigma summation Underscript i equals 0 Overscript normal infinity Endscripts StartFraction lamda Superscript i Baseline Over i factorial EndFraction∑∞
i=0
λi
i! is a power series converging for all 
lamda element of double struck upper R commaλ
∈
R, see 
Appendix H. 
• 
For a convergent power series we can exchange the derivative with the sum and 
differentiate term by term, StartFraction normal d Over normal d lamda EndFraction left bracket sigma summation Underscript i equals 0 Overscript normal infinity Endscripts StartFraction lamda Superscript i Baseline Over i factorial EndFraction right bracket equals sigma summation Underscript i equals 0 Overscript normal infinity Endscripts left bracket StartFraction normal d Over normal d lamda EndFraction StartFraction lamda Superscript i Baseline Over i factorial EndFraction right bracket d
dλ
⎾∑∞
i=0
λi
i!
⏋
= ∑∞
i=0
⎾
d
dλ
λi
i!
⏋
. 
For a continuous rv with density function, the following characterization is an 
intuitive extension of the discrete case. 
Deﬁnition 4.2 Let X be a continuous rv with probability density function f Subscript upper X Baseline left parenthesis x right parenthesisfX(x)
and let g colon double struck upper R right arrow double struck upper Rg : R →R be a real-valued function s.t. g left parenthesis upper X right parenthesisg(X) is a rv. The expectation of 
g left parenthesis upper X right parenthesisg(X) is 
sans serif upper E left parenthesis g left parenthesis upper X right parenthesis right parenthesis colon equals integral Subscript negative normal infinity Superscript normal infinity Baseline g left parenthesis x right parenthesis f Subscript upper X Baseline left parenthesis x right parenthesis normal d x commaE(g(X)) :=
 ⎨∞
−∞
g(x)fX(x) dx,
(4.2) 
provided that g left parenthesis upper X right parenthesis greater than or slanted equals 0g(X) ⩾0 or the integral is7 absolutely convergent, integral Subscript negative normal infinity Superscript normal infinity Baseline StartAbsoluteValue g left parenthesis x right parenthesis EndAbsoluteValue f Subscript upper X Baseline left parenthesis x right parenthesis normal d x less than normal infinity
 ⎨∞
−∞|g(x)|fX(x)
dx < ∞. 
Similarly to the discrete case, choosing g left parenthesis x right parenthesis equals xg(x) = x we also have: 
1. If a comma b element of double struck upper Ra, b ∈R then sans serif upper E left parenthesis a plus b upper X right parenthesis equals a plus b sans serif upper E left parenthesis upper X right parenthesisE(a + b X) = a + b E(X), i.e. expectation is linear, provided 
sans serif upper E left parenthesis upper X right parenthesisE(X) is well deﬁned according to Deﬁnition 4.2. 
2. If upper X left parenthesis omega right parenthesis less than or slanted equals upper Y left parenthesis omega right parenthesisX(ω) ⩽Y(ω) for every scenario then sans serif upper E left parenthesis upper X right parenthesis less than or slanted equals sans serif upper E left parenthesis upper Y right parenthesisE(X) ⩽E(Y), i.e. expectation preserves 
ordering, where Y is another continuous rv with density f Subscript upper Y Baseline left parenthesis y right parenthesisfY (y) and well-deﬁned 
sans serif upper E left parenthesis upper Y right parenthesisE(Y). 
We can as well provide a unifying treatment of expectation stating the change 
of variable formula also known as the rule (law) of the lazy (unconscious) 
statistician8 
sans serif upper E left parenthesis g left parenthesis upper X right parenthesis right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline g left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline periodE(g(X)) =
 ⎨∞
−∞
g(x) dFX.
(4.3) 
For g left parenthesis x right parenthesis equals x commag(x) = x, Deﬁnitions 4.1 and 4.2 can be deduced as follow: 
• 
.FX(x) is (absolutely) continuous and the density 
f Subscript upper X Baseline left parenthesis x right parenthesisfX(x) is continuous 
right double arrow⇒
normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis equals upper F prime Subscript upper X Baseline left parenthesis x right parenthesis normal d x equals f Subscript upper X Baseline left parenthesis x right parenthesis normal d xdFX(x) = F '
X(x)dx = fX(x)dx and sans serif upper E left parenthesis upper X right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline x f Subscript upper X Baseline left parenthesis x right parenthesis normal d xE(X) =
 ⎨∞
−∞x fX(x)dx, is a Riemann 
integral; 
• 
.FX(x) is ‘discrete’ right double arrow⇒normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis equals upper F Subscript upper X Baseline left parenthesis x Subscript i Baseline right parenthesis minus upper F Subscript upper X Baseline left parenthesis x Subscript i minus 1 Baseline right parenthesisdFX(x) = FX(xi) −FX(xi−1) and sans serif upper E left parenthesis upper X right parenthesis equals sigma summation Underscript i Endscripts x Subscript i Baseline sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesisE(X) = ∑
i xiP(X =
xi). 
The precise construction is based on measure theory, where eventually the change of 
variable formula is indeed stated as a theorem. We sketch it in several steps. Before
7 We use StartAbsoluteValue g left parenthesis x right parenthesis f Subscript upper X Baseline left parenthesis x right parenthesis EndAbsoluteValue equals|g(x)fX(x)| = StartAbsoluteValue g left parenthesis x right parenthesis EndAbsoluteValue StartAbsoluteValue f Subscript upper X Baseline left parenthesis x right parenthesis EndAbsoluteValue|g(x)||fX(x)| and StartAbsoluteValue f Subscript upper X Baseline left parenthesis x right parenthesis EndAbsoluteValue equals f Subscript upper X Baseline left parenthesis x right parenthesis|fX(x)| = fX(x), since the density if nonnegative. 
8 The integral is of the Stieltjes type. 
4.2
Expectation
107
to start, we need the following concept stated informally. A function g colon double struck upper R right arrow double struck upper Rg : R →R
is measurable9 when g Superscript negative 1 Baseline left parenthesis upper B right parenthesis colon equals StartSet x element of double struck upper R vertical bar g left parenthesis x right parenthesis element of upper B EndSetg−1(B) := {x ∈R | g(x) ∈B} is ‘suitable’.10 Thus, x element of g Superscript negative 1 Baseline left parenthesis upper B right parenthesisx ∈
g−1(B) iff g left parenthesis x right parenthesis element of upper Bg(x) ∈B. Let upper Y equals g left parenthesis upper X right parenthesisY = g(X) and take a suitable upper B overTilde subset of double struck upper R ˜B ⊂R: 
StartLayout 1st Row 1st Column left brace upper Y element of upper B overTilde right brace 2nd Column equals 3rd Column StartSet omega vertical bar g left parenthesis upper X left parenthesis omega right parenthesis right parenthesis element of upper B overTilde EndSet 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartSet omega vertical bar upper X left parenthesis omega right parenthesis element of g Superscript negative 1 Baseline left parenthesis upper B overTilde right parenthesis EndSet period EndLayout{Y ∈˜B} = {ω | g(X(ω)) ∈˜B}
= {ω | X(ω) ∈g−1( ˜B)}.
Since g is measurable and X is  a rv then upper B equals g Superscript negative 1 Baseline left parenthesis upper B overTilde right parenthesisB = g−1( ˜B) is also suitable and left brace upper X element of upper B right brace element of script upper F{X ∈B} ∈
F, thus Y is a rv. But in general sans serif upper P Subscript upper X Baseline not equals sans serif upper P Subscript upper Y Baseline equals sans serif upper P Subscript g left parenthesis upper X right parenthesisPX /= PY = Pg(X), or using CDFs upper F Subscript upper X Baseline not equals upper F Subscript g left parenthesis upper X right parenthesisFX /= Fg(X). 
What the change of variable formula says is that we do not care about the new 
distribution in computing expectations of transformed rvs. In words, the expectation 
is the integral of a measurable function g left parenthesis x right parenthesisg(x). 
1. Suppose upper X equals x 1 bold upper I Subscript left brace upper X element of upper B 1 right brace Baseline plus midline horizontal ellipsis plus x Subscript n Baseline bold upper I Subscript left brace upper X element of upper B Sub Subscript n Subscript right braceX = x1I{X∈B1} + · · · + xnI{X∈Bn} with left brace upper X element of upper B Subscript i Baseline right brace{X ∈Bi} partitioning upper OmegaΩ
and upper B Subscript iBi partitioning double struck upper RR. Thus,11 g left parenthesis upper X right parenthesis equals g left parenthesis x 1 right parenthesis bold upper I Subscript left brace upper X element of upper B 1 right brace Baseline plus midline horizontal ellipsis plus g left parenthesis x Subscript n Baseline right parenthesis bold upper I Subscript left brace upper X element of upper B Sub Subscript n Subscript right braceg(X) = g(x1)I{X∈B1} + · · · + g(xn)I{X∈Bn} has 
expectation 
integral g left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis colon equals sigma summation Underscript i equals 1 Overscript n Endscripts g left parenthesis x Subscript i Baseline right parenthesis sans serif upper P left parenthesis g left parenthesis x Subscript i Baseline right parenthesis element of upper B overTilde Subscript i Baseline right parenthesis comma where upper B Subscript i Baseline overTilde equals g left parenthesis upper B Subscript i Baseline right parenthesis period
 ⎨
g(x)dFX(x) :=
n
⎲
i=1
g(xi)P(g(xi) ∈˜Bi),
where
˜Bi = g(Bi).
2. If g left parenthesis x right parenthesis greater than or slanted equals 0g(x) ⩾0 then integral g left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis equals limit Underscript n right arrow normal infinity Endscripts integral g Subscript n Baseline left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis
 ⎨
g(x)dFX(x) = limn→∞
 ⎨
gn(x)dFX(x), where 0 less than or slanted equals g Subscript n Baseline left parenthesis x right parenthesis less than or slanted equals g Subscript n plus 1 Baseline left parenthesis x right parenthesis0 ⩽gn(x) ⩽
gn+1(x) is an increasing sequence s.t. g Subscript n Baseline left parenthesis upper X left parenthesis omega right parenthesis right parenthesisgn(X(ω)) are discrete rvs with ﬁnite 
support converging pointwise to the rv g left parenthesis upper X left parenthesis omega right parenthesis right parenthesisg(X(ω)). 
3. For a general rv 
g left parenthesis upper X right parenthesisg(X) we take 
integral g left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis equals integral g Superscript plus Baseline left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis minus integral g Superscript minus Baseline left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis
 ⎨
g(x)dFX(x)
=
 ⎨
g+(x)dFX(x) −
 ⎨
g−(x)dFX(x), where 
g Superscript plus Baseline left parenthesis x right parenthesis equals max left brace 0 comma g left parenthesis x right parenthesis right braceg+(x)
=
max{0, g(x)} is the positive part and 
g Superscript minus Baseline left parenthesis x right parenthesis equals max left brace 0 comma minus g left parenthesis x right parenthesis right braceg−(x) = max{0, −g(x)} is the negative part. Hopefully, both are ﬁnite. If 
only one is plus or minus normal infinity±∞the expectation is inﬁnite. If g Superscript plus Baseline left parenthesis x right parenthesis equals g Superscript minus Baseline left parenthesis x right parenthesis equals normal infinityg+(x) = g−(x) = ∞then the 
expectation is undeﬁned. 
Given this framework, change of variable in the discrete and continuous case is 
easily arranged. 
• 
If X has ﬁnite or countable support, then upper Y equals g left parenthesis upper X right parenthesisY = g(X) is also discrete. Thus we 
write12 
sans serif upper E left parenthesis g left parenthesis upper X right parenthesis right parenthesis equals sigma summation Underscript i Endscripts y Subscript i Baseline sans serif upper P left parenthesis upper Y equals y Subscript i Baseline right parenthesis commaE(g(X)) =
⎲
i
yiP(Y = yi),
but in fact upper X equals x Subscript iX = xi with sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesisP(X = xi), then upper Y equals g left parenthesis x Subscript i Baseline right parenthesisY = g(xi) with the same probability. 
Moreover, g left parenthesis upper X right parenthesis equals y Subscript ig(X) = yi iff g left parenthesis upper X right parenthesis element of StartSet y Subscript i Baseline EndSetg(X) ∈{yi} iff upper X element of g Superscript negative 1 Baseline left parenthesis StartSet y Subscript i Baseline EndSet right parenthesisX ∈g−1({yi}).
9 Actually Borel-measurable, see Appendix in Chap. 2. 
10 This means g Superscript negative 1 Baseline left parenthesis upper B right parenthesis element of script upper Bg−1(B) ∈B for every upper B element of script upper BB ∈B. 
11 This  is  indeed  a simple rv,  see Sect.  2.4. 
12 Observe that g Superscript negative 1 Baseline left parenthesis StartSet a EndSet right parenthesis equals StartSet x vertical bar g left parenthesis x right parenthesis equals a EndSetg−1({a}) = {x | g(x) = a}. 
108
4
Moments and the Alike
• 
If X is continuous, then sans serif upper P left parenthesis upper X equals x right parenthesis equals 0P(X = x) = 0 and we can approximate sans serif upper E left parenthesis g left parenthesis upper X right parenthesis right parenthesisE(g(X)) as 
sigma summation Underscript i Endscripts g left parenthesis x Subscript i Baseline right parenthesis f Subscript upper X Baseline left parenthesis x Subscript i Baseline right parenthesis normal d x Subscript i∑
i g(xi)fX(xi)dxi over all subintervals left parenthesis x Subscript i Baseline comma x Subscript i Baseline plus normal d x Subscript i Baseline right bracket(xi, xi + dxi], for  sans serif upper P left parenthesis x Subscript i Baseline less than upper X less than or slanted equals x Subscript i Baseline plus normal d x Subscript i Baseline right parenthesis almost equals f Subscript upper X Baseline left parenthesis x Subscript i Baseline right parenthesis normal d x Subscript iP(xi < X ⩽xi +
dxi) ≈fX(xi)dxi and in this case g left parenthesis upper X right parenthesis almost equals g left parenthesis x Subscript i Baseline right parenthesisg(X) ≈g(xi) on each subinterval. In ‘the 
limit’ we get formula (4.2). 
We can perform integration over subsets. 
• 
For probabilities: 
– Given a rv X we have sans serif upper P left parenthesis upper X element of upper B right parenthesis equals integral Underscript upper B Endscripts normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis commaP(X ∈B) =
 ⎨
B dFX(x), for every subset upper B subset of double struck upper RB ⊂R such 
as intervals, half-rays, etc. 
– In particular, sans serif upper P left parenthesis upper X element of upper B right parenthesis equals integral Underscript upper B Endscripts f Subscript upper X Baseline left parenthesis x right parenthesis normal d x commaP(X ∈B) =
 ⎨
B fX(x)dx, provided that X is continuous with 
density f Subscript upper X Baseline left parenthesis x right parenthesisfX(x). 
– Otherwise, sans serif upper P left parenthesis upper X element of upper B right parenthesis equals sigma summation Underscript x element of upper B Endscripts sans serif upper P left parenthesis upper X equals x right parenthesis commaP(X ∈B) = ∑
x∈B P(X = x), if X is discrete. 
• 
For expectations: take the truncated version upper X bold upper I Subscript upper AXIA of a rv upper X commaX, for any event upper A element of script upper FA ∈F, 
then write sans serif upper E left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesisE(XIA). Observe that upper X bold upper I Subscript upper A Baseline equals upper XXIA = X for every omega element of upper A periodω ∈A.
We give a derivation of the ﬁrst item. Recall sans serif upper E left parenthesis bold upper I Subscript upper A Baseline right parenthesis equals sans serif upper P left parenthesis upper A right parenthesisE(IA) = P(A) and apply it to upper A equals left brace upper X element of upper B right brace element of script upper FA =
{X ∈B} ∈F, for upper B subset of double struck upper RB ⊂R. Then we have: 
sans serif upper P left parenthesis upper X element of upper B right parenthesis equals sans serif upper E left parenthesis bold upper I Subscript left brace upper X element of upper B right brace Baseline right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline bold upper I Subscript upper B Baseline left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis equals integral Underscript upper B Endscripts normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis periodP(X ∈B) = E(I{X∈B}) =
 ⎨∞
−∞
IB(x)dFX(x) =
 ⎨
B
dFX(x).
Fact: bold upper I Subscript upper B Baseline left parenthesis upper X left parenthesis omega right parenthesis right parenthesis equals bold upper I Subscript left brace upper X element of upper B right braceIB(X(ω)) = I{X∈B}, for  a rv  X and suitable upper B subset of double struck upper RB ⊂R, see Exercise 2.4 in 
Chap. 2. Whenever a rv is nonnegative, upper X greater than or slanted equals 0X ⩾0,13 we compute its expectation as: 
StartEnclose box sans serif upper E left parenthesis upper X right parenthesis equals integral Subscript 0 Superscript normal infinity Baseline left bracket 1 minus upper F Subscript upper X Baseline left parenthesis x right parenthesis right bracket normal d x EndEnclose period E(X) =
 ⎨∞
0
[1 −FX(x)]dx .
(4.4) 
We could check formula (4.4) for discrete and continuous rvs, but instead we prove 
it for general nonnegative rvs: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X right parenthesis 2nd Column equals 3rd Column integral Subscript 0 Superscript normal infinity Baseline x normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript 0 Superscript normal infinity Baseline left bracket integral Subscript 0 Superscript x Baseline normal d u right bracket normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript 0 Superscript normal infinity Baseline left bracket integral Subscript u Superscript normal infinity Baseline normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis right bracket normal d u 4th Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript 0 Superscript normal infinity Baseline left bracket 1 minus upper F Subscript upper X Baseline left parenthesis u right parenthesis right bracket normal d u comma EndLayoutE(X) =
 ⎨∞
0
x dFX(x)
(4.5)
=
 ⎨∞
0
⎾ ⎨x
0
du
⏋
dFX(x)
=
 ⎨∞
0
⎾ ⎨∞
u
dFX(x)
⏋
du
=
 ⎨∞
0
[1 −FX(u)]du,
13 Observe that for any rv upper X greater than or slanted equals 0X ⩾0 we must have upper F Subscript upper X Baseline left parenthesis 0 right parenthesis equals 0FX(0) = 0. 
4.2
Expectation
109
which is formula (4.4) with x equals ux = u. This is especially useful whenever upper X greater than or slanted equals 0X ⩾0
represents the future price of a traded asset or a derivative instrument. Dropping the 
assumption upper X greater than or slanted equals 0X ⩾0, formula  (4.4) generalizes to: 
StartEnclose box sans serif upper E left parenthesis upper X right parenthesis equals integral Subscript 0 Superscript normal infinity Baseline left bracket 1 minus upper F Subscript upper X Baseline left parenthesis x right parenthesis right bracket normal d x minus integral Subscript negative normal infinity Superscript 0 Baseline upper F Subscript upper X Baseline left parenthesis x right parenthesis normal d x EndEnclose period E(X) =
 ⎨∞
0
[1 −FX(x)]dx −
 ⎨0
−∞
FX(x)dx .
(4.6) 
We give some details on formula (4.4) for nonnegative rvs. 
• 
We used x equals integral Subscript 0 Superscript x Baseline normal d ux =
 ⎨x
0 du which is u equals xu = x minus u equals 0u = 0. It is worth noting that we 
integrate an ordinary Riemann integral over the open interval left parenthesis 0 comma x right parenthesis(0, x). 
• 
The iterated integral in the second equality of (4.5) is a  double integral with 
respect to the variables u and x. The third equality is based on exchange the 
order of integration.14 
• 
The underlying double integral is given for each pair left parenthesis x comma u right parenthesis(x, u) in the region left parenthesis 0 comma normal infinity right parenthesis times left parenthesis 0 comma x right parenthesis(0, ∞)×
(0, x), i.e. we must have 0 less than u less than x0 < u < x. Thus the inner Stieltjes integral integral Subscript u Superscript normal infinity Baseline normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis
 ⎨∞
u dFX(x)
is correctly evaluated for x greater than ux > u and yields upper F Subscript upper X Baseline left parenthesis normal infinity right parenthesis minus upper F Subscript upper X Baseline left parenthesis u right parenthesis equals 1 minus upper F Subscript upper X Baseline left parenthesis u right parenthesisFX(∞) −FX(u) = 1 −FX(u). 
Formally, the double integral involved in formula (4.5) is integral Underscript left parenthesis a comma b right bracket times left parenthesis c comma d right bracket Endscripts g left parenthesis x comma u right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis normal d upper F Subscript upper Y Baseline left parenthesis u right parenthesis
 ⎨
(a,b]×(c,d] g(x, u)dFX(x)
dFY (u) which equals 
integral Subscript a Superscript b Baseline left bracket integral Subscript c Superscript d Baseline g left parenthesis x comma u right parenthesis normal d upper F Subscript upper Y Baseline left parenthesis u right parenthesis right bracket normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis equals integral Subscript c Superscript d Baseline left bracket integral Subscript a Superscript b Baseline g left parenthesis x comma u right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis right bracket normal d upper F Subscript upper Y Baseline left parenthesis u right parenthesis comma
 ⎨b
a
⎾ ⎨d
c
g(x, u)dFY (u)
⏋
dFX(x) =
 ⎨d
c
⎾ ⎨b
a
g(x, u)dFX(x)
⏋
dFY (u),
namely a double integral of the bounded function g left parenthesis x comma u right parenthesisg(x, u) whatever is the order of 
integration. We used g left parenthesis x comma u right parenthesis equals 1g(x, u) = 1 and upper F Subscript upper Y Baseline left parenthesis u right parenthesis equals uFY (u) = u. We close this section by yet 
another notation for the expectation, which is useful in symbolic manipulations: 
sans serif upper E left parenthesis upper X right parenthesis equals integral Underscript upper Omega Endscripts upper X normal d sans serif upper PE(X) =
 ⎨
Ω XdP. 
Remark 4.2 By linearity, the expectation of a mixed rv X (see Sect. 2.9) is simply  
the sum of two expectations: one for the continuous part and one for the discrete 
part. Formally, given the generalized density f Subscript upper X Baseline left parenthesis x right parenthesis equals sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline delta Subscript x Sub Subscript i Baseline left parenthesis x right parenthesis plus left parenthesis 1 minus alpha right parenthesis f Subscript c Baseline left parenthesis x right parenthesisfX(x) = ∑n
i=1 piδxi(x)+(1−α)fc(x)
we can compute 
sans serif upper E left parenthesis upper X right parenthesis equals integral f Subscript upper X Baseline left parenthesis x right parenthesis normal d x equals sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline x Subscript i Baseline left parenthesis 1 minus alpha right parenthesis integral x f Subscript c Baseline left parenthesis x right parenthesis normal d x commaE(X) =
 ⎨
fX(x)dx =
n
⎲
i=1
pixi(1 −α)
 ⎨
xfc(x)dx,
where we have used integral x delta Subscript z Baseline left parenthesis x right parenthesis normal d x equals z
 ⎨
xδz(x)dx = z to compute 
StartLayout 1st Row 1st Column integral sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline delta Subscript x Sub Subscript i Baseline left parenthesis x right parenthesis normal d x 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript n Endscripts integral p Subscript i Baseline delta Subscript x Sub Subscript i Subscript Baseline left parenthesis x right parenthesis normal d x equals sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline x Subscript i Baseline period EndLayout
 ⎨
n
⎲
i=1
piδxi(x)dx =
n
⎲
i=1
 ⎨
piδxi(x)dx =
n
⎲
i=1
pixi.
14 This is justiﬁed by the nonnegativity of the functions involved, guaranteeing an application of 
the Fubini’s theorem. 
110
4
Moments and the Alike
4.3 
Variance and Moments 
For a rv X modelling proﬁts/losses or rate of return, the spread of its values around 
its expectation can be interpreted as a risk. 
Deﬁnition 4.3 Given a rv X with ﬁnite expectation and ﬁnite sans serif upper E left parenthesis upper X squared right parenthesisE(X2), the  variance 
is 
sans serif upper V left parenthesis upper X right parenthesis colon equals sans serif upper E left parenthesis left parenthesis upper X minus sans serif upper E left parenthesis upper X right parenthesis right parenthesis squared right parenthesisV(X) := E
⎛
(X −E(X))2⎞
(4.7) 
often written sigma Subscript upper X Superscript 2σ 2
X. Denoting mu Subscript upper XμX the expectation sans serif upper E left parenthesis upper X right parenthesisE(X), as usual we distinguish 
between two cases. 
• 
Discrete rvs: sigma Subscript upper X Superscript 2 Baseline equals sigma summation Underscript i Endscripts left parenthesis x Subscript i Baseline minus mu Subscript upper X Baseline right parenthesis squared sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesisσ 2
X = ∑
i(xi −μX)2P(X = xi)
• 
Continuous rvs: sigma Subscript upper X Superscript 2 Baseline equals integral left parenthesis x minus mu Subscript upper X Baseline right parenthesis squared f Subscript upper X Baseline left parenthesis x right parenthesis normal d xσ 2
X =
 ⎨
(x −μX)2fX(x)dx, where we write integral
 ⎨
instead of integral Subscript negative normal infinity Superscript normal infinity Baseline
 ⎨∞
−∞. 
Expanding the square in formula (4.7), i.e. sans serif upper E left parenthesis upper X squared minus 2 upper X sans serif upper E left parenthesis upper X right parenthesis plus left parenthesis sans serif upper E left parenthesis upper X right parenthesis right parenthesis squared right parenthesisE
(
X2 −2XE(X) + (E(X))2)
, we  
get equivalently sigma Subscript upper X Superscript 2 Baseline equals sans serif upper E left parenthesis upper X squared right parenthesis minus left parenthesis sans serif upper E left parenthesis upper X right parenthesis right parenthesis squaredσ 2
X = E(X2) −(E(X))2. If  sans serif upper E left parenthesis upper X right parenthesisE(X) is not deﬁned or is inﬁnite, then 
sans serif upper V left parenthesis upper X right parenthesisV(X) cannot be deﬁned either. Otherwise, sans serif upper E left parenthesis upper X right parenthesisE(X) is deﬁned and ﬁnite and sans serif upper V left parenthesis upper X right parenthesisV(X) is 
also deﬁned, and is inﬁnite if and only if sans serif upper E left parenthesis upper X squared right parenthesis equals normal infinityE(X2) = ∞. Another useful indicator is 
standard deviation: sans serif upper S upper D left parenthesis upper X right parenthesis colon equals StartRoot sans serif upper V left parenthesis upper X right parenthesis EndRoot equals sigma Subscript upper XSD(X) := √V(X) = σX. Let f left parenthesis m right parenthesis colon equals sans serif upper E left parenthesis left parenthesis upper X minus m right parenthesis squared right parenthesisf (m) := E((X −m)2), for any 
m element of double struck upper Rm ∈R. Then, it is minimized by the expectation m equals mu Subscript upper Xm = μX, and the minimum is the 
variance, min Underscript m element of double struck upper R Endscripts f left parenthesis m right parenthesis equals sans serif upper V left parenthesis upper X right parenthesismin
m∈R f (m) = V(X): 
StartLayout 1st Row 1st Column f left parenthesis m right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis left parenthesis upper X minus mu Subscript upper X Baseline plus mu Subscript upper X Baseline minus m right parenthesis squared right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper E left parenthesis left parenthesis upper X minus mu Subscript upper X Baseline right parenthesis squared right parenthesis plus left parenthesis mu Subscript upper X Baseline minus m right parenthesis squared plus 2 left parenthesis mu Subscript upper X Baseline minus m right parenthesis ModifyingBelow sans serif upper E left parenthesis upper X minus mu Subscript upper X Baseline right parenthesis With bottom brace Underscript equals 0 Endscripts 3rd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper V left parenthesis upper X right parenthesis plus left parenthesis mu Subscript upper X Baseline minus m right parenthesis squared greater than or slanted equals sans serif upper V left parenthesis upper X right parenthesis EndLayoutf (m) = E((X −μX + μX −m)2)
= E((X −μX)2) + (μX −m)2 + 2(μX −m) E(X −μX)
◟
◝◜
◞
=0
= V(X) + (μX −m)2 ⩾V(X)
Then f left parenthesis m right parenthesis greater than or slanted equals sans serif upper V left parenthesis upper X right parenthesisf (m) ⩾V(X) and equality holds if and only if m equals mu Subscript upper Xm = μX. Taking powers of 
order greater than 2 in (4.7) we can generalize the variance. 
Deﬁnition 4.4 Given a rv  X with pth power upper X Superscript pXp, the  pth-moment is 
sans serif upper E left parenthesis upper X Superscript p Baseline right parenthesis comma provided expectation is finite periodE(Xp),
provided expectation is ﬁnite.
(4.8) 
• 
Discrete rvs: sans serif upper E left parenthesis upper X Superscript p Baseline right parenthesis equals sigma summation Underscript i Endscripts x Subscript i Superscript p Baseline sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesisE(Xp) = ∑
i xp
i P(X = xi)
• 
Continuous rvs: sans serif upper E left parenthesis upper X Superscript p Baseline right parenthesis equals integral x Superscript p Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d xE(Xp) =
 ⎨
xpfX(x)dx. 
For integer p equals n element of double struck upper Np = n ∈N the corresponding nth-moment sans serif upper E left parenthesis upper X Superscript n Baseline right parenthesisE(Xn) reduces to the 
expectation, for n equals 1n = 1, or the variance for n equals 2n = 2 provided that we consider bold ppth-
central moments, i.e. sans serif upper E left parenthesis left parenthesis upper X minus mu Subscript upper X Baseline right parenthesis Superscript p Baseline right parenthesisE((X −μX)p), for every p greater than 0p > 0.
4.4
Moment Generating and Characteristic Functions
111
• 
Discrete rvs: sans serif upper E left parenthesis left parenthesis upper X minus mu Subscript upper X Baseline right parenthesis Superscript p Baseline right parenthesis equals sigma summation Underscript i Endscripts left parenthesis x Subscript i Baseline minus mu Subscript upper X Baseline right parenthesis Superscript p Baseline sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesisE((X −μX)p) = ∑
i(xi −μX)pP(X = xi)
• 
Continuous rvs: sans serif upper E left parenthesis left parenthesis upper X minus mu Subscript upper X Baseline right parenthesis Superscript p Baseline right parenthesis equals integral left parenthesis x minus mu Subscript upper X Baseline right parenthesis Superscript p Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d xE((X −μX)p) =
 ⎨
(x −μX)pfX(x)dx. 
We can treat transformed rvs with ﬁnite ﬁrst moment as equally distributed, see 
Appendix in Chap. 2. 
Lemma 4.1 Let upper X comma upper YX, Y be rvs and g colon double struck upper R right arrow double struck upper Rg : R →R be a measurable function such that 
g left parenthesis upper X right parenthesis comma g left parenthesis upper Y right parenthesisg(X), g(Y) have ﬁnite expectation. We have upper X equals Overscript d Endscripts upper YX
d= Y if and only if sans serif upper E left parenthesis g left parenthesis upper X right parenthesis right parenthesis equals sans serif upper E left parenthesis g left parenthesis upper Y right parenthesis right parenthesisE(g(X)) =
E(g(Y)). 
4.4 
Moment Generating and Characteristic Functions 
Some transformation of rvs can lead to useful tools for getting moments and ﬁnding 
the distribution of sums of rvs.15 
Deﬁnition 4.5 Given a rv X and a real number u element of double struck upper Ru ∈R, the  moment generating 
function (MGF) is 
upper M Subscript upper X Baseline left parenthesis u right parenthesis colon equals sans serif upper E left parenthesis normal e Superscript u upper X Baseline right parenthesis comma for all u element of double struck upper R s period t period the expectation is finite periodMX(u) := E(euX),
for all u ∈R s.t. the expectation is ﬁnite.
(4.9) 
• 
Discrete rvs: upper M Subscript upper X Baseline left parenthesis u right parenthesis equals sigma summation Underscript i Endscripts normal e Superscript u x Super Subscript i Baseline sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesisMX(u) = ∑
i euxiP(X = xi)
• 
Continuous rvs: upper M Subscript upper X Baseline left parenthesis u right parenthesis equals integral normal e Superscript u x Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d xMX(u) =
 ⎨
euxfX(x)dx. 
Fact: assuming p element of double struck upper Np ∈N, if MGF exists and is ﬁnite in an open interval containing 
0, then the pth-moment exists too and is given by the pth-derivative w.r.t. u 
evaluated at u equals 0u = 0, i.e. 
StartEnclose box sans serif upper E left parenthesis upper X Superscript p Baseline right parenthesis equals StartFraction normal d Superscript p Baseline Over normal d u Superscript p Baseline EndFraction upper M Subscript upper X Baseline left parenthesis u right parenthesis vertical bar Subscript u equals 0 Baseline equals sans serif upper E left parenthesis StartFraction normal d Superscript p Baseline Over normal d u Superscript p Baseline EndFraction normal e Superscript u upper X Baseline vertical bar Subscript u equals 0 Baseline right parenthesis EndEnclose period E(Xp) = dp
dup MX(u)
|||
u=0 = E
⎛
dp
dup euX|||
u=0
⎞
.
Taking p equals 2p = 2 we have upper M double prime Subscript upper X Baseline left parenthesis 0 right parenthesis equals sans serif upper E left parenthesis StartFraction normal d squared Over normal d u squared EndFraction normal e Superscript u upper X Baseline vertical bar Subscript u equals 0 Baseline right parenthesis equals sans serif upper E left parenthesis upper X squared normal e Superscript u upper X Baseline vertical bar Subscript u equals 0 Baseline right parenthesis equals sans serif upper E left parenthesis upper X squared right parenthesisM''
X(0) = E
⎛
d2
du2 euX|||
u=0
⎞
= E
⎛
X2euX|||
u=0
⎞
= E(X2). 
Theorem 4.1 MGF posses the following properties. 
• 
If upper M Subscript upper X Baseline left parenthesis u right parenthesisMX(u) exists for all u in an open interval containing 0, then upper M Subscript a plus b upper X Baseline left parenthesis u right parenthesis equals normal e Superscript a u Baseline upper M Subscript upper X Baseline left parenthesis b u right parenthesisMa+bX(u) =
eauMX(b u), for all a comma ba, b. 
• 
If upper M Subscript upper X Sub Subscript i Baseline left parenthesis u right parenthesisMXi(u) all exists and upper X 1 comma ellipsis comma upper X Subscript n BaselineX1, . . . , Xn are independent rvs, then upper M Subscript sigma summation Underscript i equals 1 Overscript n Endscripts upper X Sub Subscript i Subscript Baseline left parenthesis u right parenthesis equals upper M Subscript upper X 1 Baseline left parenthesis u right parenthesis midline horizontal ellipsis upper M Subscript upper X Sub Subscript n Subscript Baseline left parenthesis u right parenthesis equals product Underscript i equals 1 Overscript n Endscripts upper M Subscript upper X Sub Subscript i Subscript Baseline left parenthesis u right parenthesisM∑n
i=1 Xi(u) =
MX1(u) · · · MXn(u) = ∏n
i=1 MXi(u). 
• 
If upper M Subscript upper X Baseline left parenthesis u right parenthesis equals upper M Subscript upper Y Baseline left parenthesis u right parenthesisMX(u) = MY (u) for all u in an open interval containing 0, then upper X equals Overscript d Endscripts upper YX d= Y.
15 They can also be used in proving theorems. 
112
4
Moments and the Alike
In fact, for independent rvs expectation of their product factorizes, see 
Lemma 4.2 in Sect. 4.8. 
Deﬁnition 4.6 Given a rv X and a real number u element of double struck upper Ru ∈R, the  characteristic function 
(CHF) is 
phi Subscript upper X Baseline left parenthesis u right parenthesis colon equals sans serif upper E left parenthesis normal e Superscript normal i u upper X Baseline right parenthesis identical to sans serif upper E left parenthesis cosine left parenthesis u upper X right parenthesis right parenthesis plus normal i sans serif upper E left parenthesis sine left parenthesis u upper X right parenthesis right parenthesis periodφX(u) := E(eiuX) ≡E(cos(uX)) + iE(sin(uX)).16 
(4.10) 
• 
Discrete rvs: phi Subscript upper X Baseline left parenthesis u right parenthesis equals sigma summation Underscript i Endscripts normal e Superscript normal i u x Super Subscript i Baseline sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesisφX(u) = ∑
i eiuxiP(X = xi)
• 
Continuous rvs: phi Subscript upper X Baseline left parenthesis u right parenthesis equals integral normal e Superscript normal i u x Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d xφX(u) =
 ⎨
eiuxfX(x)dx, also known as Fourier transform. 
Fact: CHF always exists. Recall that the set of complex numbers double struck upper CC contains z equals a plus normal i bz =
a + ib such that a comma b element of double struck upper Ra, b ∈R and normal i equals StartRoot negative 1 EndRooti =
√
−1. In fact: normal i squared equals negative 1 comma normal i cubed equals negative normal ii2 = −1, i3 = −i and normal i Superscript 4 Baseline equals 1i4 = 1. 
The absolute value is StartAbsoluteValue z EndAbsoluteValue equals StartRoot z ModifyingAbove z With quotation dash EndRoot equals StartRoot a squared plus b squared EndRoot|z| =
√
zz =
√
a2 + b2, where ModifyingAbove z With quotation dash equals a minus normal i bz = a −ib is the conjugate 
of z. Warning: the product of two complex numbers z comma w element of double struck upper Cz, w ∈C is given formally by 
left parenthesis a plus normal i b right parenthesis left parenthesis c plus normal i d right parenthesis(a + ib)(c + id). Similarly, we can deﬁne their sum. 
Theorem 4.2 CHF fulﬁlls the following properties. 
• 
.|φX(u)| ⩽φX(0) = 1, for every u element of double struck upper Ru ∈R
• 
.φa+bX(u) = eiauφX(b u), for all a comma b comma u element of double struck upper Ra, b, u ∈R
• 
If sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript n Baseline right parenthesis less than normal infinityE(|X|n) < ∞, then the nth-derivative of CHF exists and is given by 
StartFraction normal d Superscript n Baseline Over normal d u Superscript n Baseline EndFraction phi Subscript upper X Baseline left parenthesis u right parenthesis vertical bar Subscript u equals 0 Baseline equals normal i Superscript n Baseline sans serif upper E left parenthesis upper X Superscript n Baseline right parenthesis comma dn
dun φX(u)
|||
u=0 = inE(Xn),
for any integer n equals 0 comma 1 comma ellipsis comma pn = 0, 1, . . . , p. 
• 
If upper X 1 comma ellipsis comma upper X Subscript n BaselineX1, . . . , Xn are independent rvs, then phi Subscript sigma summation Underscript i equals 1 Overscript n Endscripts upper X Sub Subscript i Subscript Baseline left parenthesis u right parenthesis equals phi Subscript upper X 1 Baseline left parenthesis u right parenthesis midline horizontal ellipsis phi Subscript upper X Sub Subscript n Subscript Baseline left parenthesis u right parenthesis equals product Underscript i equals 1 Overscript n Endscripts phi Subscript upper X Sub Subscript i Subscript Baseline left parenthesis u right parenthesisφ∑n
i=1 Xi(u) = φX1(u) · · · φXn(u) =
∏n
i=1 φXi(u). 
• 
For rvs upper X comma upper YX, Y such that phi Subscript upper X Baseline left parenthesis u right parenthesis equals phi Subscript upper Y Baseline left parenthesis u right parenthesisφX(u) = φY (u), for all reals u, then upper X equals Overscript d Endscripts upper YX d= Y. 
• 
.φX(u) is a continuous function of u element of double struck upper Ru ∈R. 
We can recover the moment again by differentiation, i.e., 
StartEnclose box sans serif upper E left parenthesis upper X Superscript n Baseline right parenthesis equals StartFraction 1 Over normal i Superscript n Baseline EndFraction StartFraction normal d Superscript n Baseline Over normal d u Superscript n Baseline EndFraction phi Subscript upper X Baseline left parenthesis u right parenthesis vertical bar Subscript u equals 0 Baseline EndEnclose period E(Xn) = 1
in
dn
dun φX(u)
|||
u=0 .
Remark 4.3 Further details on CHF are worth to note. 
• 
To any pair left parenthesis a comma b right parenthesis element of double struck upper R times double struck upper R(a, b) ∈R × R we can associate uniquely a complex number z equals a plus normal i bz =
a + ib. Moreover, left parenthesis a comma b right parenthesis(a, b) corresponds 1-to-1 to a point in the xy plane. Thus, 
phi Subscript upper X Baseline left parenthesis u right parenthesisφX(u) can be viewed as a vector-valued function double struck upper R right arrow double struck upper CR →C s.t. to each real number 
u right arrow from bar left parenthesis a comma b right parenthesisu ⍿→(a, b) corresponds a point in the xy plane, where a equals sans serif upper E left parenthesis cosine left parenthesis u upper X right parenthesis right parenthesisa = E(cos(uX)) and 
b equals sans serif upper E left parenthesis sine left parenthesis u upper X right parenthesis right parenthesisb = E(sin(uX)). Hence phi left parenthesis u right parenthesisφ(u) is a complex number with modulus StartAbsoluteValue phi left parenthesis u right parenthesis EndAbsoluteValue equals StartRoot left parenthesis sans serif upper E left parenthesis cosine left parenthesis u upper X right parenthesis right parenthesis right parenthesis squared plus left parenthesis sans serif upper E left parenthesis sine left parenthesis u upper X right parenthesis right parenthesis right parenthesis squared EndRoot|φ(u)| =
16 De Moivre identity or Euler’s Formula: normal e Superscript normal i x Baseline equals cosine x plus normal i sine xeix = cos x + i sin x, for any real number x. 
4.5
Summary Statistics
113
√
(E(cos(uX)))2 + (E(sin(uX)))2, and 
phi prime Subscript upper X Baseline left parenthesis u right parenthesis equals left parenthesis StartFraction normal d Over normal d u EndFraction sans serif upper E left parenthesis cosine left parenthesis u upper X right parenthesis right parenthesis comma StartFraction normal d Over normal d u EndFraction sans serif upper E left parenthesis sine left parenthesis u upper X right parenthesis right parenthesis right parenthesis comma left bracket vector of two derivatives right bracket periodφ'
X(u) =
⎛
d
duE(cos(uX)), d
duE(sin(uX))
⎞
,
[vector of two derivatives].
We can interchange differentiation with sans serif upper E left parenthesis dot right parenthesisE( · ). 
• 
Assume X has density f Subscript upper XfX which is symmetric around zero, i.e. f Subscript upper X Baseline left parenthesis x right parenthesis equals f Subscript upper X Baseline left parenthesis negative x right parenthesisfX(x) =
fX(−x), and the density is an even function. Then we can write 
phi Subscript upper X Baseline left parenthesis u right parenthesis equals integral cosine left parenthesis u x right parenthesis f Subscript upper X Baseline left parenthesis x right parenthesis normal d x plus normal i integral sine left parenthesis u x right parenthesis f Subscript upper X Baseline left parenthesis x right parenthesis normal d x commaφX(u) =
 ⎨
cos(ux)fX(x)dx + i
 ⎨
sin(ux)fX(x)dx,
and since sine left parenthesis u x right parenthesissin(ux) is an odd function the product sine left parenthesis u x right parenthesis f Subscript upper X Baseline left parenthesis x right parenthesissin(ux)fX(x) is odd too and 
the second integral is zero. Fact: phi Subscript upper X Baseline left parenthesis u right parenthesisφX(u) reduces to a real-valued function iff X is 
symmetric around zero. 
It can be shown that for CHF we have:17 
StartAbsoluteValue phi Subscript upper X Baseline left parenthesis u right parenthesis EndAbsoluteValue less than or slanted equals sans serif upper E left parenthesis StartAbsoluteValue normal e Superscript normal i u upper X Baseline EndAbsoluteValue right parenthesis equals sans serif upper E left parenthesis cosine squared left parenthesis u upper X right parenthesis plus sine squared left parenthesis u upper X right parenthesis right parenthesis equals sans serif upper E left parenthesis 1 right parenthesis equals 1 period|φX(u)| ⩽E(|eiuX|) = E
⎛
cos2(uX) + sin2(uX)
⎞
= E(1) = 1.
When X is absolutely continuous, the Fourier Transform can be denoted German upper F left parenthesis f Subscript upper X Baseline right parenthesisF(fX), 
which is actually a map acting on the set of densities functions whose image is the 
CHF. It can be shown that this map has an inverse called inverse Fourier transform, 
f Subscript upper X Baseline left parenthesis x right parenthesis equals German upper F Superscript negative 1 Baseline left parenthesis phi Subscript upper X Baseline right parenthesis colon equals StartFraction 1 Over 2 pi EndFraction integral normal e Superscript minus normal i u x Baseline phi Subscript upper X Baseline left parenthesis u right parenthesis normal d u commafX(x) = F−1(φX) :=
1
2π
 ⎨
e−iuxφX(u)du,
which is nothing else the density. There exist commercial software (e.g. Matlab) 
which can compute the numerical inverse transform of a speciﬁed CHF to obtain 
the corresponding density. 
4.5 
Summary Statistics 
To any rv X we can associate several numerical indices measuring how its 
distribution behaves. 
Example 4.2 Let X be a degenerate rv, i.e. upper X left parenthesis omega right parenthesis equals kX(ω) = k for every scenario omega element of upper Omegaω ∈Ω, or  
sans serif upper P left parenthesis upper X equals k right parenthesis equals 1P(X = k) = 1, i.e. upper X equals Overscript a period s period Endscripts kX a.s.
= k. Thus, sans serif upper E left parenthesis upper X right parenthesis equals kE(X) = k and the new rv a plus b upper Xa + bX obtained by 
a linear transformation, i.e. scaling of the values x element of upper X left parenthesis upper Omega right parenthesisx ∈X(Ω) by a factor b not equals 0b /= 0 and 
shifting by a factor a, has a linearly transformed expectation sans serif upper E left parenthesis a plus b upper X right parenthesis equals a plus b kE(a + bX) = a + bk.
17 See Jensen’s inequality. 
114
4
Moments and the Alike
A number m element of double struck upper Rm ∈R is said to be a location parameter of upper F Subscript upper XFX if there is a high 
probability sans serif upper P left parenthesis m minus epsilon less than upper X less than m plus epsilon right parenthesisP(m −ϵ < X < m + ϵ) to ‘locate’ the values x equals upper X left parenthesis omega right parenthesisx = X(ω) near m, for  
a small  epsilon greater than 0ϵ > 0; in addition the new rv a plus b upper Xa + bX must have location a plus b ma + b m. Fact: 
expectation sans serif upper E left parenthesis upper X right parenthesis equals mu Subscript upper XE(X) = μX and median sans serif m e d left parenthesis upper X right parenthesismed(X) are location parameters. In words, 
a location parameter shifts a distribution to the right or left without changing the 
distribution’s shape or standard deviation. If sans serif upper P Subscript upper XPX is symmetric around a element of double struck upper Ra ∈R and 
sans serif upper E left parenthesis upper X right parenthesis less than normal infinityE(X) < ∞then a equals sans serif upper E left parenthesis upper X right parenthesis equals sans serif m e d left parenthesis upper X right parenthesisa = E(X) = med(X). A  dispersion parameter of upper F Subscript upper XFX is a 
number d element of double struck upper Rd ∈R measuring the error we made in predicting the X’s values by using 
its location parameter. In words, it is a measure of how X ﬂuctuates around its 
location. If X is a continuous rv, then a dispersion parameter quantiﬁes the extent to 
which the density f Subscript upper XfX is stretched or squeezed. Any dispersion parameter should be 
positive homogeneous. 
Example 4.3 Pick a comma b element of double struck upper Ra, b ∈R, such that b not equals 0b /= 0. Let  m element of double struck upper Rm ∈R a location parameter. We 
deﬁne the mean absolute deviation 
sans serif upper M upper A upper D left parenthesis upper X right parenthesis colon equals sans serif upper E left parenthesis StartAbsoluteValue upper X minus m EndAbsoluteValue right parenthesis commaMAD(X) := E(|X −m|),
which is a dispersion parameter. We can show sans serif upper M upper A upper D left parenthesis a plus b upper X right parenthesis equals StartAbsoluteValue b EndAbsoluteValue sans serif upper M upper A upper D left parenthesis upper X right parenthesisMAD(a + bX) = |b|MAD(X). 
Similarly, standard deviation is a dispersion parameter for which sans serif upper S upper D left parenthesis a plus b upper X right parenthesis equals StartAbsoluteValue b EndAbsoluteValue sans serif upper S upper D left parenthesis upper X right parenthesisSD(a + bX) =
|b|SD(X). In both cased we have positive homogeneity. 
A shape parameter of upper F Subscript upper XFX is a number s element of double struck upper Rs ∈R which is neither a location 
nor a scale parameter, similar to a dispersion parameter. Recall that a rv Y is 
symmetrically distributed around a element of double struck upper Ra ∈R if a minus upper Y equals Overscript d Endscripts upper Y minus aa −Y
d= Y −a. Hence 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis left parenthesis a minus upper Y right parenthesis Superscript n Baseline right parenthesis 2nd Column equals sans serif upper E left parenthesis left parenthesis upper Y minus a right parenthesis Superscript n Baseline right parenthesis equals sans serif upper E left parenthesis left parenthesis minus left parenthesis a minus upper Y right parenthesis right parenthesis Superscript n Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals minus sans serif upper E left parenthesis left parenthesis a minus upper Y right parenthesis Superscript n Baseline right parenthesis comma for integer n equals 1 comma 3 comma 5 comma ellipsis EndLayoutE((a −Y)n) = E((Y −a)n) = E((−(a −Y))n)
= −E((a −Y)n),
for integer n = 1, 3, 5, . . .
implying sans serif upper E left parenthesis upper Y Superscript n Baseline right parenthesis equals 0E(Y n) = 0. Now, let  a equals StartFraction mu Subscript upper X Baseline Over sigma Subscript upper X Baseline EndFractiona =
μX
σX and upper Y equals StartFraction upper X Over sigma Subscript upper X Baseline EndFractionY =
X
σX . The following shape 
parameters are the most relevant. 
• 
Skewness coefﬁcient: sans serif s k left parenthesis upper X right parenthesis colon equals StartFraction sans serif upper E left parenthesis left parenthesis upper X minus mu Subscript upper X Baseline right parenthesis cubed right parenthesis Over sigma Subscript upper X Superscript 3 Baseline EndFractionsk(X) := E((X−μX)3)
σ 3
X
, a measure of symmetry. If sans serif s k left parenthesis upper X right parenthesis greater than 0sk(X) >
0 we say X is positively skewed or right-skewed, while for sans serif s k left parenthesis upper X right parenthesis less than 0sk(X) < 0 we say 
X is negatively skewed or left-skewed. In words, sans serif s k left parenthesis upper X right parenthesis greater than 0sk(X) > 0 implies a long right 
tail. The opposite holds for negative skewness. If X has a symmetric distribution 
then sans serif s k left parenthesis upper X right parenthesis equals 0sk(X) = 0. 
• 
Kurtosis: sans serif k u r left parenthesis upper X right parenthesis colon equals StartFraction sans serif upper E left parenthesis left parenthesis upper X minus mu Subscript upper X Baseline right parenthesis Superscript 4 Baseline right parenthesis Over sigma Subscript upper X Superscript 4 Baseline EndFractionkur(X) := E((X−μX)4)
σ 4
X
. If  sans serif upper P left parenthesis StartAbsoluteValue upper X EndAbsoluteValue greater than or slanted equals a right parenthesisP(|X| ⩾a) is large, for a greater than 0a > 0, then the 
values x equals upper X left parenthesis omega right parenthesisx = X(ω) in the center and in the tails of the X’s distribution are most 
likely to be observed and the kurtosis is high. Approximately, this is true for 
the X’s values lying in intervals left parenthesis negative normal infinity comma mu Subscript x Baseline minus 2 sigma Subscript upper X Baseline right parenthesis(−∞, μx −2σX), left parenthesis mu Subscript x Baseline minus sigma Subscript upper X Baseline comma mu Subscript x Baseline plus sigma Subscript upper X Baseline right parenthesis(μx −σX, μx + σX) and 
left parenthesis mu Subscript x Baseline plus 2 sigma Subscript upper X Baseline comma normal infinity right parenthesis(μx + 2σX, ∞).
4.5
Summary Statistics
115
The skewness is the standardized third central moment. Indeed, we can write 
sans serif s k left parenthesis upper X right parenthesis equals sans serif upper E left parenthesis left parenthesis StartFraction upper X minus mu Subscript upper X Baseline Over sigma Subscript upper X Baseline EndFraction right parenthesis cubed right parenthesis commask(X) = E
⎛⎛
X−μX
σX
⎞3⎞
,
then the skewness does not depend on the location or the scale parameters (the units 
in which X is ‘measured’ do not affect sans serif s k left parenthesis upper X right parenthesissk(X)). Although sans serif s k left parenthesis upper X right parenthesis greater than 0sk(X) > 0 implies a long 
right tail compared to the left tail and sans serif s k left parenthesis upper X right parenthesis less than 0sk(X) < 0 implies a long left tail compared to 
the right tail, there exist asymmetric distributions whose odd central moments are all 
zero, and in general sans serif s k left parenthesis upper X right parenthesis equals 0sk(X) = 0 does not imply symmetry. Rvs having distributions 
with large kurtosis are more peaked in the center, have low shoulders, and heavy 
tails. Roughly, the X’s values lying on the interval left parenthesis mu Subscript x Baseline minus sigma Subscript upper X Baseline comma mu Subscript x Baseline plus sigma Subscript upper X Baseline right parenthesis(μx −σX, μx + σX) form the 
sans serif upper P Subscript upper XPX’s center; the X’s values lying on the intervals left parenthesis negative normal infinity comma mu Subscript x Baseline minus 2 sigma Subscript upper X Baseline right parenthesis(−∞, μx −2σX) and left parenthesis mu Subscript x Baseline plus 2 sigma Subscript upper X Baseline comma normal infinity right parenthesis(μx +
2σX, ∞) form the tails; the remaining values form the sans serif upper P Subscript upper XPX’s shoulders. sans serif s k left parenthesis upper X right parenthesis equals 0sk(X) = 0
and sans serif k u r left parenthesis upper X right parenthesis equals 3kur(X) = 3 are typical for upper X tilde normal upper N left parenthesis mu comma sigma squared right parenthesisX ∼N(μ, σ 2). Therefore, sans serif s k left parenthesis upper X right parenthesis not equals 0sk(X) /= 0 and high 
sans serif k u r left parenthesis upper X right parenthesis minus 3kur(X) −3 suggest a deviation from the Gaussian model (in case of continuous 
distributions). sans serif s k left parenthesis upper X right parenthesis greater than 0sk(X) > 0 implies high sans serif upper P left parenthesis upper X greater than or slanted equals mu Subscript upper X Baseline right parenthesis greater than 0P(X ⩾μX) > 0 and sans serif s k left parenthesis upper X right parenthesis less than 0sk(X) < 0 implies low 
sans serif upper P left parenthesis upper X less than or slanted equals mu Subscript upper X Baseline right parenthesis greater than 0P(X ⩽μX) > 0. For densities of transformed continuous rvs, the effect of shifting 
their density’s original location as well as modifying their variability is interesting 
in its own. Let X be continuous with density f Subscript upper XfX, and let upper Y equals g left parenthesis upper X right parenthesisY = g(X) for strictly 
increasing g left parenthesis x right parenthesisg(x). By monotonicity, g has an inverse function18 h left parenthesis y right parenthesish(y). We have:  
upper F Subscript upper Y Baseline left parenthesis y right parenthesis equals sans serif upper P left parenthesis upper Y less than or slanted equals y right parenthesis equals sans serif upper P left parenthesis g left parenthesis upper X right parenthesis less than or slanted equals y right parenthesis equals sans serif upper P left parenthesis upper X less than or slanted equals h left parenthesis y right parenthesis right parenthesis equals upper F Subscript upper X Baseline left parenthesis h left parenthesis y right parenthesis right parenthesis periodFY (y) = P(Y ⩽y) = P(g(X) ⩽y) = P(X ⩽h(y)) = FX(h(y)).
Now differentiating19 upper F Subscript upper Y Baseline left parenthesis y right parenthesis equals upper F Subscript upper X Baseline left parenthesis h left parenthesis y right parenthesis right parenthesisFY (y) = FX(h(y)) we ﬁnd 
f Subscript upper Y Baseline left parenthesis y right parenthesis equals StartFraction normal d Over normal d y EndFraction upper F Subscript upper X Baseline left parenthesis h left parenthesis y right parenthesis right parenthesis equals f Subscript upper X Baseline left parenthesis h left parenthesis y right parenthesis right parenthesis h prime left parenthesis y right parenthesis periodfY (y) = d
dy FX(h(y)) = fX(h(y))h'(y).
In general,20 for a monotone g left parenthesis x right parenthesisg(x) we have 
StartEnclose box f Subscript upper Y Baseline left parenthesis y right parenthesis equals f Subscript upper X Baseline left parenthesis h left parenthesis y right parenthesis right parenthesis StartAbsoluteValue h prime left parenthesis y right parenthesis EndAbsoluteValue EndEnclose period fY (y) = fX(h(y))|h'(y)| .
(4.11) 
Let upper Y equals a plus b upper XY = a + bX for a comma b element of double struck upper Ra, b ∈R with b not equals 0b /= 0. Then, g left parenthesis x right parenthesis equals a plus b xg(x) = a + bx has inverse 
h left parenthesis y right parenthesis equals StartFraction y minus a Over b EndFractionh(y) =
y−a
b
with h prime left parenthesis y right parenthesis equals StartFraction 1 Over b EndFractionh'(y) =
1
b. We have  f Subscript upper Y Baseline left parenthesis y right parenthesis equals StartFraction 1 Over StartAbsoluteValue b EndAbsoluteValue EndFraction f Subscript upper X Baseline left parenthesis StartFraction y minus a Over b EndFraction right parenthesisfY (y) =
1
|b|fX( y−a
b ). Deﬁning a scale
18 That is h left parenthesis g left parenthesis x right parenthesis right parenthesis equals xh(g(x)) = x, for  any  x in the domain of g and y equals g left parenthesis x right parenthesisy = g(x). Recall that if g is increasing 
(decreasing), then h is increasing (decreasing) too. 
19 Use the chain rule of differentiation. 
20 Consider g left parenthesis x right parenthesisg(x) strictly decreasing so that sans serif upper P left parenthesis upper Y less than or slanted equals y right parenthesis equals sans serif upper P left parenthesis upper X greater than or slanted equals h left parenthesis y right parenthesis right parenthesis equals 1 minus upper F Subscript upper X Baseline left parenthesis h left parenthesis y right parenthesis right parenthesisP(Y ⩽y) = P(X ⩾h(y)) = 1 −FX(h(y)), then  
differentiate. 
116
4
Moments and the Alike
parameter kappa element of double struck upper Rκ ∈R as a multiple of the standard deviation we have: 
• 
.m + X has density f Subscript upper X Baseline left parenthesis x minus m right parenthesisfX(x −m), where m element of double struck upper Rm ∈R is a location parameter; 
• 
. κX has density StartFraction 1 Over kappa EndFraction f Subscript upper X Baseline left parenthesis StartFraction x Over kappa EndFraction right parenthesis 1
κ fX( x
κ ), where kappa greater than 0κ > 0 is a scale parameter; 
• 
fully, m plus kappa upper Xm + κX has density StartFraction 1 Over kappa EndFraction f Subscript upper X Baseline left parenthesis StartFraction x minus m Over kappa EndFraction right parenthesis 1
κ fX( x−m
κ ). 
Fact: the cth-quantile upper Q Subscript upper Y Baseline left parenthesis c right parenthesisQY (c) of upper Y equals g left parenthesis upper X right parenthesisY = g(X), with strictly increasing21 g left parenthesis x right parenthesisg(x), is  
g left parenthesis upper Q Subscript upper X Baseline left parenthesis c right parenthesis right parenthesisg(QX(c)). Recall that for a composite function v left parenthesis s left parenthesis x right parenthesis right parenthesisv(s(x)), where both v comma sv, s are 
invertible, we have that the inverse is s Superscript negative 1 Baseline left parenthesis v Superscript negative 1 Baseline left parenthesis y right parenthesis right parenthesiss−1(v−1(y)). In particular, for linear functions: 
upper Q Subscript upper Y Baseline left parenthesis c right parenthesis equals a plus b upper Q Subscript upper X Baseline left parenthesis c right parenthesisQY (c) = a + b QX(c), if  b greater than 0b > 0, and upper Q Subscript upper Y Baseline left parenthesis c right parenthesis equals a plus b upper Q Subscript upper X Baseline left parenthesis 1 minus c right parenthesisQY (c) = a + b QX(1 −c), if  b less than 0b < 0. If the  
location parameter a element of double struck upper Ra ∈R is shifted by lamda element of double struck upper Rλ ∈R, i.e. a plus lamdaa + λ, then sans serif upper E left parenthesis upper X right parenthesis comma sans serif m e d left parenthesis upper X right parenthesisE(X), med(X), 
whenever they exist, are shifted too by lamdaλ. If the scale parameter is scaled, i.e. lamda bλb and 
lamda not equals 0λ /= 0, then sans serif upper V left parenthesis upper X right parenthesisV(X) is scaled by lamda squaredλ2. 
Remark 4.4 (Proper Location-Scale Density) Given a density function f Subscript bulletf• and 
a element of double struck upper R comma b greater than 0a ∈R, b > 0, then Y is a rv with density function StartFraction 1 Over b EndFraction f Subscript bullet Baseline left parenthesis StartFraction y minus a Over b EndFraction right parenthesis 1
bf•
( y−a
b
)
iff there exists 
another rv X with density f Subscript bullet Baseline left parenthesis x right parenthesisf•(x) and upper Y equals a plus b upper XY = a + bX. Indeed, if f Subscript bullet Baseline equals f Subscript upper Xf• = fX is a density 
we know that 
f Subscript upper Y Baseline left parenthesis y right parenthesis equals f Subscript upper X Baseline left parenthesis h left parenthesis y right parenthesis right parenthesis h prime left parenthesis y right parenthesis equals StartFraction 1 Over b EndFraction f Subscript upper X Baseline left parenthesis StartFraction y minus a Over b EndFraction right parenthesis commafY (y) = fX(h(y))h'(y) = 1
bfX
⎛y −a
b
⎞
,
since y equals g left parenthesis x right parenthesis equals a plus b xy = g(x) = a + bx is increasing with inverse x equals h left parenthesis y right parenthesis equals StartFraction y minus a Over b EndFractionx = h(y) = y−a
b . Conversely, 
assuming the rv Y has density f Subscript bullet Baseline left parenthesis StartFraction y minus a Over b EndFraction right parenthesisf•
( y−a
b
)
deﬁning h left parenthesis y right parenthesis equals StartFraction y minus a Over b EndFractionh(y) = y−a
b
and setting upper X equals h left parenthesis upper Y right parenthesisX = h(Y)
we can apply once again the above result on transformed rvs with densities: 
f Subscript upper X Baseline left parenthesis x right parenthesis equals f Subscript bullet Baseline left parenthesis g left parenthesis x right parenthesis right parenthesis g prime left parenthesis x right parenthesis equals StartFraction 1 Over b EndFraction f Subscript bullet Baseline left parenthesis StartFraction left parenthesis a plus b x right parenthesis minus a Over b EndFraction right parenthesis b commafX(x) = f•(g(x))g'(x) = 1
bf•
⎛
(a+bx)−a
b
⎞
b,
since h left parenthesis y right parenthesish(y) is also increasing. Moreover: 
a plus b upper X equals a plus b h left parenthesis upper Y right parenthesis equals a plus b left parenthesis StartFraction upper Y minus a Over b EndFraction right parenthesis equals upper Y perioda + bX = a + bh(Y) = a + b
( Y−a
b
)
= Y.
4.6 
Inequalities 
Proposition 4.1 (Jensen’s Inequality) Let X be a rv with ﬁnite expectation and 
g : R → R be a convex function such that E(|g(X)|) <  ∞. Then 
g left parenthesis sans serif upper E left parenthesis upper X right parenthesis right parenthesis less than or slanted equals sans serif upper E left parenthesis g left parenthesis upper X right parenthesis right parenthesis periodg(E(X)) ⩽E(g(X)).
(4.12) 
The proof of Jensen’s inequality is instructive from the geometrical point of view.
21 It sufﬁces to have g as increasing and left-continuous. 
4.6
Inequalities
117
Proof of Jensen’s Inequality Assume g(x) is convex. Then, there exists a linear 
function h(x) = ax + b such that its graph is the support line of g at the point x = 
E(X). This implies h(x) ⩽g(x) for every x ∈ R and also h(E(X)) = g(E(X)). 
Thus we have 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis g left parenthesis upper X right parenthesis right parenthesis 2nd Column greater than or slanted equals 3rd Column sans serif upper E left parenthesis h left parenthesis upper X right parenthesis right parenthesis equals sans serif upper E left parenthesis a upper X plus b right parenthesis equals a sans serif upper E left parenthesis upper X right parenthesis plus b 2nd Row 1st Column Blank 2nd Column equals 3rd Column h left parenthesis sans serif upper E left parenthesis upper X right parenthesis right parenthesis equals g left parenthesis sans serif upper E left parenthesis upper X right parenthesis right parenthesis comma EndLayoutE(g(X)) ⩾E(h(X)) = E(aX + b) = aE(X) + b
= h(E(X)) = g(E(X)),
and the proof is complete. 
█
Remark 4.5 If g is concave, then −g is convex and Jensen’s inequality becomes: 
minus g left parenthesis sans serif upper E left parenthesis upper X right parenthesis right parenthesis less than or slanted equals sans serif upper E left parenthesis minus g left parenthesis upper X right parenthesis right parenthesis long left right double arrow g left parenthesis sans serif upper E left parenthesis upper X right parenthesis right parenthesis greater than or slanted equals sans serif upper E left parenthesis g left parenthesis upper X right parenthesis right parenthesis period−g(E(X)) ⩽E(−g(X)) ⇐⇒g(E(X)) ⩾E(g(X)).
Jensen’s inequality applied to g(x) = |x|p for p >  1 yields: 
sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue right parenthesis less than or slanted equals left parenthesis sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline right parenthesis right parenthesis Superscript 1 divided by p Baseline periodE(|X|) ⩽(E(|X|p))1/p.
Here a list of useful inequalities involving expectation and other moments of 
order greater than one. 
Theorem 4.3 (Cauchy-Schwarz) Let X and Y be two rvs such that E(X2) and 
E(Y 2) are both ﬁnite. Then 
StartAbsoluteValue sans serif upper E left parenthesis upper X upper Y right parenthesis EndAbsoluteValue less than or slanted equals sans serif upper E left parenthesis StartAbsoluteValue upper X upper Y EndAbsoluteValue right parenthesis less than or slanted equals StartRoot sans serif upper E left parenthesis upper X squared right parenthesis sans serif upper E left parenthesis upper Y squared right parenthesis EndRoot period|E(XY)| ⩽E(|XY|) ⩽
√
E(X2)E(Y 2).
(4.13) 
Proof of Cauchy-Schwarz Inequalities By 
the 
Jensen’s 
inequality 
we 
have 
|E(XY)| ⩽E(|XY|). Thus, choosing p = q = 2 and applying the Hölder’s 
inequality below to E(|XY|) we have 
sans serif upper E left parenthesis StartAbsoluteValue upper X upper Y EndAbsoluteValue right parenthesis less than or slanted equals left parenthesis sans serif upper E left parenthesis upper X squared right parenthesis right parenthesis Superscript 1 divided by 2 Baseline left parenthesis sans serif upper E left parenthesis upper Y squared right parenthesis right parenthesis Superscript 1 divided by 2 Baseline commaE(|XY|) ⩽(E(X2))1/2(E(Y 2))1/2,
which together with the former inequality prove the result. 
█
Cauchy-Schwarz inequalities may be reduced to (E(XY))2 ⩽E(X2)E(Y 2), in  
fact they can be reduced to only one, considering either the left-hand side and the 
right-hand side or the innermost term and the right-hand side, each termed Cauchy-
Schwarz inequality. The following is a generalization. 
Theorem 4.4 (Hölder’s Inequality) Let p ⩾1 such that 1 
p + 1 
q = 1, and E(|X|p ) 
and E(|Y|q ) are both ﬁnite. Then 
sans serif upper E left parenthesis StartAbsoluteValue upper X upper Y EndAbsoluteValue right parenthesis less than or slanted equals RootIndex p StartRoot sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline right parenthesis EndRoot RootIndex q StartRoot sans serif upper E left parenthesis StartAbsoluteValue upper Y EndAbsoluteValue Superscript q Baseline right parenthesis EndRoot periodE(|XY|) ⩽
p√
E(|X|p) q√
E(|Y|q).
(4.14) 
If X and Y are rvs with ﬁnite expectation then E(|X+Y|) <  ∞: write the triangle 
inequality |X + Y| ⩽|X| + |Y| and take expectation of both sides. The following is 
a generalization.
118
4
Moments and the Alike
Theorem 4.5 (Minkowski’s Inequality) Let p ⩾1 and X, Y be two rvs with 
E(|X|p ) and E(|Y|p ) both ﬁnite. Then E(|X + Y|p ) <  ∞and 
RootIndex p StartRoot sans serif upper E left parenthesis StartAbsoluteValue upper X plus upper Y EndAbsoluteValue Superscript p Baseline right parenthesis EndRoot less than or slanted equals RootIndex p StartRoot sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline right parenthesis EndRoot plus RootIndex p StartRoot sans serif upper E left parenthesis StartAbsoluteValue upper Y EndAbsoluteValue Superscript p Baseline right parenthesis EndRoot period p√
E(|X + Y|p) ⩽
p√
E(|X|p) +
p√
E(|Y|p).
(4.15) 
Proposition 4.2 (Chebyshev’s Inequality) Let X be a nonnegative rv on some 
probability space. Then for all a >  0 and every p >  0 we have 
sans serif upper P left parenthesis upper X greater than or slanted equals a right parenthesis less than or slanted equals StartFraction sans serif upper E left parenthesis upper X Superscript p Baseline right parenthesis Over a Superscript p Baseline EndFraction periodP(X ⩾a) ⩽E(Xp)
ap
.
(4.16) 
Here are some special cases. 
• 
For p = 1 Proposition 4.2 gives Markov’s inequality; 
• 
For p = 2 and a general rv X: 
– Replacing X with |X − μX|, Chebyshev’s inequality yields P(|X − μX| ⩾
a) ⩽V(X) 
a2 ; 
– Taking a = λSD(X), with λ >  0, the last item gives P(|X − μX| ⩾
λSD(X)) ⩽1 
λ2 . 
The proof of Chedychev’s inequality involves indicators. 
Proof of Chebyshev’s Inequality If E(Xp ) = ∞ the inequality is trivially satisﬁed. 
Thus, let us assume22 E(Xp ) <  ∞. By truncation, we can write Xp = XpI{X<a} + 
XpI{X⩾a}. Taking expectation we have: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X Superscript p Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis upper X Superscript p Baseline bold upper I Subscript left brace upper X less than a right brace Baseline right parenthesis plus sans serif upper E left parenthesis upper X Superscript p Baseline bold upper I Subscript left brace upper X greater than or slanted equals a right brace Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column greater than or slanted equals 3rd Column sans serif upper E left parenthesis upper X Superscript p Baseline bold upper I Subscript left brace upper X greater than or slanted equals a right brace Baseline right parenthesis greater than or slanted equals sans serif upper E left parenthesis a Superscript p Baseline bold upper I Subscript left brace upper X greater than or slanted equals a right brace Baseline right parenthesis equals a Superscript p Baseline sans serif upper P left parenthesis upper X greater than or slanted equals a right parenthesis comma EndLayoutE(Xp) = E
(
XpI{X<a}
)
+ E
(
XpI{X⩾a}
)
⩾E
(
XpI{X⩾a}
)
⩾E
(
apI{X⩾a}
)
= apP(X ⩾a),
because ap ⩽Xp . 
█
Observe that X(ω) ⩾X(ω)I{X⩾a}: if  ω /∈{X ⩾a} then X(ω) ⩾0. Interesting 
enough, we can group rvs based on ﬁniteness of their moments. We write X ∈ Lp 
whenever the pth- moment exists and is ﬁnite, i.e. E(|X|p ) <  ∞. For integers 
n < m  we have Lm ⊂ Ln. E.g.: L2 ⊂ L1, and X ∈ L2 means 0 ⩽V(X) < ∞; 
X ∈ L1 means ﬁnite expectation. In words, if X has ﬁnite variance, then it has also 
a ﬁnite expectation but the converse is not true. 
Remark 4.6 All these collections are understood as equivalence classes with 
respect to the equivalence relation given by equality P-a.s. among rsv. E.g., L2 is 
that collection of X a.s.
= Y with ﬁnite second moment, see Exercise 8.7 in Chap. 8.
22 For every nonnegative rv X ⩾0 we always have  E(X) exists, maybe inﬁnite. 
4.7
Covariance and Moments of Random Vectors
119
The collection of all rvs over a ﬁxed (Ω, F, P) is denoted L0. For  rvs  X ∈L2 we 
have: 
StartEnclose box sans serif upper V left parenthesis a plus b upper X right parenthesis equals b squared sans serif upper V left parenthesis upper X right parenthesis EndEnclose comma for a element of double struck upper R and b not equals 0 period V(a + bX) = b2V(X) ,
for a ∈R and b /= 0.
In fact: a + bX ∈ L2, then we have (a + bX − E(a + bX))2 = b2(X − E(X))2 
and taking expectation of both sides we are done. Taking b = 0, the variance of a 
degenerate rv is zero. 
Remark 4.7 There is a connection between Lp classes and inequalities involving 
expectation. 
• 
For any  pair of rvs  X, Y with ﬁnite second moment, i.e. X, Y ∈ L2, their product 
XY has ﬁnite expectation: it sufﬁces to apply Hölder’s inequality with p = q = 
2. 
• 
Given X ∈ L2 we always have (E(X))2 ⩽E(X2): apply the Cauchy-Schwarz 
inequality with Y = 1. Thus E(X2) − μ2 
X ⩾0. 
• 
Any linear combination aX + bY, of two  rvs  X, Y ∈ L2, again belongs to L2: 
given x, y ∈R and for every a, b ∈R, take the quadratic (ax − by)2 ⩾0. Add 
(a2x2 +b2y2) to both sides of this inequality and consider x = X(ω), y = Y(ω) 
for every ω ∈Ω. We have:  
StartLayout 1st Row 1st Column sans serif upper E left parenthesis left parenthesis a upper X plus b upper Y right parenthesis squared right parenthesis 2nd Column less than or slanted equals 3rd Column sans serif upper E left parenthesis 2 a squared upper X squared plus 2 b squared upper Y squared right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column 2 a squared sans serif upper E left parenthesis upper X squared right parenthesis plus 2 b squared sans serif upper E left parenthesis upper Y squared right parenthesis less than normal infinity comma EndLayoutE
(
(a X + b Y)2)
⩽E
(
2 a2 X2 + 2 b2 Y 2)
= 2 a2E(X2) + 2 b2E(Y 2) < ∞,
from the assumption X, Y ∈L2. 
4.7 
Covariance and Moments of Random Vectors 
Stochastic dependence among rvs can be measured by proper numerical indices. In 
this section we summarize the most useful ones and limit ourselves to show some 
properties, postponing remaining details to Chap. 7. 
Deﬁnition 4.7 Given two rvs upper X comma upper Y element of upper L squaredX, Y ∈L2, their covariance is 
sans serif c o v left parenthesis upper X comma upper Y right parenthesis colon equals sans serif upper E left parenthesis left parenthesis upper X minus mu Subscript upper X Baseline right parenthesis left parenthesis upper Y minus mu Subscript upper Y Baseline right parenthesis right parenthesis equals sans serif upper E left parenthesis upper X upper Y right parenthesis minus sans serif upper E left parenthesis upper X right parenthesis sans serif upper E left parenthesis upper Y right parenthesis equals colon sigma Subscript upper X comma upper Y Baseline periodcov(X, Y) := E ((X −μX)(Y −μY )) = E(XY)−E(X)E(Y) =: σX,Y .
(4.17)
120
4
Moments and the Alike
For upper X comma upper Y element of upper L squaredX, Y ∈L2, the  Pearson correlation coefﬁcient is23 
rho Subscript upper X comma upper Y Baseline equals sans serif c o r r left parenthesis upper X comma upper Y right parenthesis colon equals StartFraction sans serif c o v left parenthesis upper X comma upper Y right parenthesis Over StartRoot sans serif upper V left parenthesis upper X right parenthesis sans serif upper V left parenthesis upper Y right parenthesis EndRoot EndFraction equals StartFraction sans serif c o v left parenthesis upper X comma upper Y right parenthesis Over sigma Subscript upper X Baseline sigma Subscript upper Y Baseline EndFraction periodρX,Y = corr(X, Y) :=
cov(X, Y)
√V(X)V(Y) = cov(X, Y)
σXσY
.
(4.18) 
Recall that upper X comma upper Y element of upper L squaredX, Y ∈L2 does imply upper X upper Y element of upper L Superscript 1XY ∈L1, but for independent upper X comma upper Y element of upper L Superscript 1X, Y ∈L1
then sans serif upper E left parenthesis upper X upper Y right parenthesis equals sans serif upper E left parenthesis upper X right parenthesis sans serif upper E left parenthesis upper Y right parenthesis less than normal infinityE(XY) = E(X)E(Y) < ∞, thus upper X upper Y element of upper L Superscript 1XY ∈L1. Factorization of expectation will 
be investigated later, see Theorem 4.8, Sect. 4.8. If sans serif c o v left parenthesis upper X comma upper Y right parenthesis greater than 0cov(X, Y) > 0, then X’s values 
and Y’s values are both above (below) their means, on average. 
• 
.cov(X, X) = V(X) and sans serif c o v left parenthesis upper X comma upper Y right parenthesis equals sans serif c o v left parenthesis upper Y comma upper X right parenthesiscov(X, Y) = cov(Y, X); also,  sans serif c o v left parenthesis upper X comma a right parenthesis equals 0cov(X, a) = 0, for  
a element of double struck upper Ra ∈R. 
• 
By Cauchy-Schwarz inequality, sans serif upper E left parenthesis left parenthesis upper X minus mu Subscript upper X Baseline right parenthesis left parenthesis upper Y minus mu Subscript upper Y Baseline right parenthesis right parenthesis less than or slanted equals StartRoot sans serif upper E left parenthesis left parenthesis upper X minus mu Subscript upper X Baseline right parenthesis squared right parenthesis sans serif upper E left parenthesis left parenthesis upper Y minus mu Subscript upper Y Baseline right parenthesis squared right parenthesis EndRootE ((X −μX)(Y −μY )) ⩽
√
E((X −μX)2)E((Y −μY )2), thus sans serif c o v left parenthesis upper X comma upper Y right parenthesiscov(X, Y) is ﬁnite provided24 upper X comma upper Y element of upper L squaredX, Y ∈L2. 
• 
By the last item, negative 1 less than or slanted equals sans serif c o r r left parenthesis upper X comma upper Y right parenthesis less than or slanted equals 1−1 ⩽corr(X, Y) ⩽1. 
Expectation can be deﬁned for random vectors. 
Deﬁnition 4.8 Given a random vector bold italic upper X equals left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesisX = (X1, . . . , Xn), with upper X Subscript i Baseline element of upper L Superscript 1Xi ∈L1 for i equals 1 comma ellipsis comma ni =
1, . . . , n, the ﬁrst moment or expectation is 
bold italic mu Subscript bold italic upper X Baseline equals sans serif upper E left parenthesis bold italic upper X right parenthesis colon equals left parenthesis sans serif upper E left parenthesis upper X 1 right parenthesis comma ellipsis comma sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis right parenthesis element of double struck upper R Superscript n Baseline periodμX = E(X) := (E(X1), . . . , E(Xn)) ∈Rn.
For n equals 2n = 2, assume bold italic upper XX has a bi-variate density f Subscript bold italic upper X Baseline left parenthesis x 1 comma x 2 right parenthesisfX(x1, x2). Thus, sans serif upper E left parenthesis bold italic upper X right parenthesis equals left parenthesis sans serif upper E left parenthesis upper X 1 right parenthesis comma sans serif upper E left parenthesis upper X 2 right parenthesis right parenthesisE(X) =
(E(X1), E(X2)) is the location of the f Subscript bold italic upper XfX’s graph, i.e. the set of points in double struck upper R cubedR3 with 
coordinates left parenthesis x 1 comma x 2 comma z right parenthesis(x1, x2, z), where z equals f Subscript bold italic upper X Baseline left parenthesis x 1 comma x 2 right parenthesisz = fX(x1, x2), i.e. a three-dimensional surface. 
Expectation of coordinate rvs can be deduced from the multivariate distribution. 
Example 4.4 (Univariate vs Multivariate Expectation) Let bold italic upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y) a bi-
variate random vector with joint density f Subscript bold italic upper XfX. Then 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X right parenthesis 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline x f Subscript upper X Baseline left parenthesis x right parenthesis normal d x equals integral Subscript negative normal infinity Superscript normal infinity Baseline x left bracket integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis normal d y right bracket normal d x 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline integral Subscript negative normal infinity Superscript normal infinity Baseline x f Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis normal d x normal d y period EndLayoutE(X) =
 ⎨∞
−∞
x fX(x)dx =
 ⎨∞
−∞
x
⎾ ⎨∞
−∞
fX(x, y)dy
⏋
dx
=
 ⎨∞
−∞
 ⎨∞
−∞
x fX(x, y)dxdy.
Similarly we have: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper Y right parenthesis 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline y f Subscript upper Y Baseline left parenthesis y right parenthesis normal d y equals integral Subscript negative normal infinity Superscript normal infinity Baseline y left bracket integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis normal d x right bracket normal d y 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline integral Subscript negative normal infinity Superscript normal infinity Baseline y f Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis normal d x normal d y period EndLayoutE(Y) =
 ⎨∞
−∞
y fY (y)dy =
 ⎨∞
−∞
y
⎾ ⎨∞
−∞
fX(x, y)dx
⏋
dy
=
 ⎨∞
−∞
 ⎨∞
−∞
y fX(x, y)dxdy.
23 It is a measure of linear dependence between X and Y. 
24 Recall that StartAbsoluteValue sans serif upper E left parenthesis upper Z right parenthesis EndAbsoluteValue less than or slanted equals sans serif upper E left parenthesis StartAbsoluteValue upper Z EndAbsoluteValue right parenthesis|E(Z)| ⩽E(|Z|). 
4.7
Covariance and Moments of Random Vectors
121
Having deﬁned the expectation of random vectors, we can go a step further. 
Deﬁnition 4.9 Let bold italic upper X equals left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesisX = (X1, . . . , Xn) be an n-dimensional random vector with 
upper X Subscript i Baseline element of upper L squaredXi ∈L2, for  i equals 1 comma ellipsis comma ni = 1, . . . , n. The  n times nn × n variance-covariance matrix, or simply the 
covariance matrix, bold italic upper CC of bold italic upper XX is given by taking expectation of each entry inside the 
auxiliary n times nn × n matrix 
StartLayout 1st Row Start 4 By 3 Matrix 1st Row 1st Column left brace upper X 1 minus sans serif upper E left parenthesis upper X 1 right parenthesis right brace squared 2nd Column ellipsis 3rd Column left brace upper X 1 minus sans serif upper E left parenthesis upper X 1 right parenthesis right brace left brace upper X Subscript n Baseline minus sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis right brace 2nd Row 1st Column left brace upper X 2 minus sans serif upper E left parenthesis upper X 2 right parenthesis right brace left brace upper X 1 minus sans serif upper E left parenthesis upper X 1 right parenthesis right brace 2nd Column ellipsis 3rd Column left brace upper X 2 minus sans serif upper E left parenthesis upper X 2 right parenthesis right brace left brace upper X Subscript n Baseline minus sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis right brace 3rd Row 1st Column vertical ellipsis 2nd Column down right diagonal ellipsis 3rd Column vertical ellipsis 4th Row 1st Column left brace upper X Subscript n Baseline minus sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis right brace left brace upper X 1 minus sans serif upper E left parenthesis upper X 1 right parenthesis right brace 2nd Column ellipsis 3rd Column left brace upper X Subscript n Baseline minus sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis right brace squared EndMatrix period EndLayout
⎡
⎢⎢⎢⎣
{X1 −E(X1)}2
. . . {X1 −E(X1)}{Xn −E(Xn)}
{X2 −E(X2)}{X1 −E(X1)} . . . {X2 −E(X2)}{Xn −E(Xn)}
...
...
...
{Xn −E(Xn)}{X1 −E(X1)} . . .
{Xn −E(Xn)}2
⎤
⎥⎥⎥⎦.
For example, with n equals 2n = 2 we have: 
bold italic upper C equals Start 2 By 2 Matrix 1st Row 1st Column sans serif upper V left parenthesis upper X 1 right parenthesis 2nd Column sans serif c o v left parenthesis upper X 1 comma upper X 2 right parenthesis 2nd Row 1st Column sans serif c o v left parenthesis upper X 2 comma upper X 1 right parenthesis 2nd Column sans serif upper V left parenthesis upper X 2 right parenthesis EndMatrix periodC =
⎾
V(X1)
cov(X1, X2)
cov(X2, X1)
V(X2)
⏋
.
In general, for each entry of bold italic upper CC we have c Subscript i j Baseline equals sans serif c o v left parenthesis upper X Subscript i Baseline comma upper X Subscript j Baseline right parenthesiscij = cov(Xi, Xj), for  i comma j equals 1 comma ellipsis comma ni, j = 1, . . . , n. 
Since the n-dimensional random vector bold italic upper XX can be viewed as a 1 times n1 × n row vector, the 
n times nn × n covariance matrix can be written as 
bold italic upper C equals sans serif upper E left parenthesis left parenthesis bold italic upper X minus bold italic mu Subscript bold italic upper X Baseline right parenthesis prime left parenthesis bold italic upper X minus bold italic mu Subscript bold italic upper X Baseline right parenthesis right parenthesisC = E
⎛
(X −μX)'(X −μX)
⎞
where each entry c Subscript i jcij equals the covariance sans serif c o v left parenthesis upper X Subscript i Baseline comma upper X Subscript j Baseline right parenthesiscov(Xi, Xj) for each pair upper X Subscript iXi and 
upper X Subscript jXj inside bold italic upper XX. The symbol prime' denotes matrix transposition. The matrix product 
left parenthesis bold italic upper X minus bold italic mu Subscript bold italic upper X Baseline right parenthesis prime left parenthesis bold italic upper X minus bold italic mu Subscript bold italic upper X Baseline right parenthesis(X −μX)'(X −μX) is indeed 
Start 3 By 1 Matrix 1st Row upper X 1 minus sans serif upper E left parenthesis upper X 1 right parenthesis 2nd Row vertical ellipsis 3rd Row upper X Subscript n Baseline minus sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis EndMatrix by left bracket upper X 1 minus sans serif upper E left parenthesis upper X 1 right parenthesis comma ellipsis comma upper X Subscript n Baseline minus sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis right bracket comma
⎡
⎢⎣
X1 −E(X1)
...
Xn −E(Xn)
⎤
⎥⎦by
⎾
X1 −E(X1), . . . , Xn −E(Xn)
⏋
,
yielding an n times nn × n matrix. Now we provide a generalization of moments for random 
vectors. 
Proposition 4.3 Let bold italic upper XX be a n-dimensional random (row) vector, and let bold italic upper AA be a 
m times nm×n with real valued entries a Subscript i jaij. Then, the m-dimensional random vector bold italic upper Y equals bold italic upper A bold italic upper X primeY = AX'
admits: 
1. ﬁrst moment sans serif upper E left parenthesis bold italic upper Y right parenthesis equals bold italic upper A bold italic mu Subscript bold italic upper X Superscript prime Baseline element of double struck upper R Superscript mE(Y) = Aμ'
X ∈Rm; 
2. second moment bold italic upper C Subscript bold italic upper Y Baseline equals bold italic upper A bold italic upper C Subscript bold italic upper X Baseline bold italic upper A Superscript bold prime Baseline commaCY = ACXA',
where bold italic upper C Subscript bold italic upper XCX is the n times nn × n covariance matrix of bold italic upper XX and bold italic upper C Subscript bold italic upper YCY is the m times mm × m covariance 
matrix of bold italic upper YY.
122
4
Moments and the Alike
For example, given bold italic upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y) with ﬁrst moment bold italic mu Subscript bold italic upper X Baseline equals sans serif upper E left parenthesis bold italic upper X right parenthesis equals left parenthesis mu Subscript upper X Baseline comma mu Subscript upper Y Baseline right parenthesisμX = E(X) = (μX, μY ), 
covariance matrix and deterministic matrix 
bold italic upper C Subscript bold italic upper X Baseline equals Start 2 By 2 Matrix 1st Row 1st Column sigma Subscript upper X Superscript 2 Baseline 2nd Column sigma Subscript upper X comma upper Y Baseline 2nd Row 1st Column sigma Subscript upper X comma upper Y Baseline 2nd Column sigma Subscript upper Y Superscript 2 Baseline EndMatrix comma bold italic upper A equals Start 3 By 2 Matrix 1st Row 1st Column 1 2nd Column 2 2nd Row 1st Column 3 2nd Column 1 3rd Row 1st Column 2 2nd Column 2 EndMatrix commaCX =
⎾σ 2
X σX,Y
σX,Y
σ 2
Y
⏋
,
A =
⎡
⎣
1 2
3 1
2 2
⎤
⎦,
respectively, we have 
StartLayout 1st Row 1st Column bold italic upper A bold italic upper C Subscript bold italic upper X 2nd Column equals Start 3 By 2 Matrix 1st Row 1st Column sigma Subscript upper X Superscript 2 Baseline plus 2 sigma Subscript upper X comma upper Y Baseline 2nd Column sigma Subscript upper X comma upper Y Baseline plus 2 sigma Subscript upper Y Superscript 2 Baseline 2nd Row 1st Column 3 sigma Subscript upper X Superscript 2 Baseline plus sigma Subscript upper X comma upper Y Baseline 2nd Column 3 sigma Subscript upper X comma upper Y Baseline plus sigma Subscript upper Y Superscript 2 Baseline 3rd Row 1st Column 2 sigma Subscript upper X Superscript 2 Baseline plus 2 sigma Subscript upper X comma upper Y Baseline 2nd Column 2 sigma Subscript upper X comma upper Y Baseline plus 2 sigma Subscript upper Y Superscript 2 Baseline EndMatrix comma and 2nd Row 1st Column bold italic upper A bold italic upper C Subscript bold italic upper X Baseline bold italic upper A bold prime 2nd Column equals Start 3 By 2 Matrix 1st Row 1st Column sigma Subscript upper X Superscript 2 Baseline plus 2 sigma Subscript upper X comma upper Y Baseline 2nd Column sigma Subscript upper X comma upper Y Baseline plus 2 sigma Subscript upper Y Superscript 2 Baseline 2nd Row 1st Column 3 sigma Subscript upper X Superscript 2 Baseline plus sigma Subscript upper X comma upper Y Baseline 2nd Column 3 sigma Subscript upper X comma upper Y Baseline plus sigma Subscript upper Y Superscript 2 Baseline 3rd Row 1st Column 2 sigma Subscript upper X Superscript 2 Baseline plus 2 sigma Subscript upper X comma upper Y Baseline 2nd Column 2 sigma Subscript upper X comma upper Y Baseline plus 2 sigma Subscript upper Y Superscript 2 Baseline EndMatrix Start 2 By 3 Matrix 1st Row 1st Column 1 2nd Column 3 3rd Column 2 2nd Row 1st Column 2 2nd Column 1 3rd Column 2 EndMatrix comma EndLayoutACX =
⎡
⎣
σ 2
X + 2σX,Y
σX,Y + 2σ 2
Y
3σ 2
X + σX,Y
3σX,Y + σ 2
Y
2σ 2
X + 2σX,Y 2σX,Y + 2σ 2
Y
⎤
⎦,
and
ACXA' =
⎡
⎣
σ 2
X + 2σX,Y
σX,Y + 2σ 2
Y
3σ 2
X + σX,Y
3σX,Y + σ 2
Y
2σ 2
X + 2σX,Y 2σX,Y + 2σ 2
Y
⎤
⎦
⎾1 3 2
2 1 2
⏋
,
which is a new 3 times 33 × 3 covariance matrix. 
Example 4.5 (Portfolio Return) Let bold italic upper S equals left parenthesis upper S Subscript 1 comma t Baseline comma ellipsis comma upper S Subscript n comma t Baseline right parenthesisS = (S1,t, . . . , Sn,t) be the n-dimensional 
row vector comprising stock prices upper S Subscript i comma tSi,t at the end of a ﬁxed time horizon. Assume 
upper S Subscript i comma t Baseline element of upper L squaredSi,t ∈L2, each i equals 1 comma ellipsis comma ni = 1, . . . , n. Recall that 
upper V Subscript t Baseline equals h left parenthesis upper S Subscript 1 comma t Baseline comma ellipsis comma upper S Subscript n comma t Baseline right parenthesis colon equals h 1 upper S Subscript 1 comma t Baseline plus midline horizontal ellipsis plus h Subscript n Baseline upper S Subscript n comma tVt = h(S1,t, . . . , Sn,t) := h1S1,t + · · · + hnSn,t
is the portfolio value in t with holdings h Subscript ihi. Thus, the arithmetic portfolio return in 
t plus 1t + 1 is r Subscript p comma t plus 1 Baseline equals sigma summation Underscript i equals 1 Overscript n Endscripts w 1 r Subscript i comma t plus 1rp,t+1 = ∑n
i=1 w1ri,t+1, where r Subscript i comma t plus 1ri,t+1 is the t plus 1t + 1-arithmetic return of stock 
ith, see Sect. 2.5, Chap. 2. In matrix notation: 
bold italic r equals left parenthesis r Subscript 1 comma t plus 1 Baseline comma ellipsis comma r Subscript n comma t plus 1 Baseline right parenthesis comma bold italic w equals left parenthesis w 1 comma ellipsis comma w Subscript n Baseline right parenthesisr = (r1,t+1, . . . , rn,t+1),
w = (w1, . . . , wn)
and r Subscript p Baseline equals bold italic w bold italic r Superscript prime Baseline equals sigma summation Underscript i equals 1 Overscript n Endscripts w Subscript i Baseline r Subscript i comma t plus 1rp = wr' = ∑n
i=1 wiri,t+1 yields a special application of Proposition 4.3, Item  
1, with the matrix bold italic upper AA replaced by the 1 times n1 × n matrix bold italic ww of portfolio weights and bold italic upper XX
replaced by bold italic rr: 
sans serif upper E left parenthesis r Subscript p Baseline right parenthesis equals sans serif upper E left parenthesis bold italic w dot bold italic r right parenthesis equals bold italic w dot bold italic mu Subscript bold italic r Baseline portfolio expected return periodE(rp) = E(w · r) = w · μr
portfolio expected return.
Observe that we used the ‘dot’-notation for the inner product of vectors as n-tuples 
in double struck upper R Superscript nRn. 
Example 4.6 (Portfolio Variance) Writing bold italic upper C Subscript bold italic rCr for the n times nn × n covariance matrix of 
portfolio return bold italic rr, we can deﬁne the portfolio expected risk as: 
StartLayout 1st Row 1st Column sans serif upper V left parenthesis r Subscript p Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper V left parenthesis bold italic w dot bold italic r right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column bold italic w bold italic upper C Subscript bold italic r Baseline bold italic w Superscript prime Baseline equals left parenthesis bold italic w bold italic upper C Subscript bold italic r Baseline right parenthesis dot bold italic w comma EndLayoutV(rp) = V(w · r)
= wCrw' = (wCr) · w,
4.7
Covariance and Moments of Random Vectors
123
a special case of Proposition 4.3, Item 2 with a scalar variance. 
Example 4.7 (Portfolio Optimization) Given estimates of expected stock returns 
sans serif upper E left parenthesis r Subscript i Baseline right parenthesisE(ri), variances sans serif upper V left parenthesis r Subscript i Baseline right parenthesisV(ri) and covariances sans serif c o v left parenthesis r Subscript i Baseline comma r Subscript j Baseline right parenthesiscov(ri, rj) we can solve 
min left brace bold italic w bold italic upper C Subscript bold italic r Baseline bold italic w Superscript prime Baseline equals f left parenthesis w 1 comma ellipsis comma w Subscript n Baseline right parenthesis vertical bar sigma summation Underscript i equals 1 Overscript n Endscripts w Subscript i Baseline equals 1 comma and bold italic w dot bold italic mu Subscript bold italic r Baseline equals c right brace comma min
⎧
wCrw' = f (w1, . . . , wn)
|||
n
⎲
i=1
wi = 1, and w · μr = c
⎫
,
(4.19) 
a constrained quadratic program, for a ﬁxed level c element of double struck upper Rc ∈R of portfolio expected return. 
In fact f left parenthesis w 1 comma ellipsis comma w Subscript n Baseline right parenthesisf (w1, . . . , wn) is a convex function of n element of double struck upper Nn ∈N variables, and the constrain set 
left brace w element of double struck upper R Superscript n Baseline vertical bar sigma summation Underscript i equals 1 Overscript n Endscripts w Subscript i Baseline equals 1 comma bold italic w bold italic mu Subscript bold italic r Baseline equals c right brace{w ∈Rn | ∑n
i=1 wi = 1, wμr = c} is a polyhedral set. 
Example 4.8 (Portfolio Performance) The portfolio optimization problem in 
Example 4.7 (actually minimizing the portfolio risk) can be equivalently formulated 
by replacing the objective function bold italic w bold italic upper C Subscript bold italic r Baseline bold italic w Superscript prime Baseline equals f left parenthesis w 1 comma ellipsis comma w Subscript n Baseline right parenthesiswCrw' = f (w1, . . . , wn) with its square root, 
the portfolio standard deviation, StartRoot bold italic w bold italic upper C Subscript bold italic r Baseline bold italic w EndRoot√wCrw. This is because the function f left parenthesis x right parenthesis equals StartRoot x EndRootf (x) = √x
is increasing for x greater than or slanted equals 0x ⩾0 and optimal solutions of the former optimization problem 
are the same as those of the new optimization problem. Under mild conditions, we 
can also refer to the alternative maximization: 
max left brace StartFraction bold italic w dot bold italic mu Subscript bold italic r Baseline Over StartRoot bold italic w bold italic upper C Subscript bold italic r Baseline bold italic w Superscript prime Baseline EndRoot EndFraction vertical bar sigma summation Underscript i equals 1 Overscript n Endscripts w Subscript i Baseline equals 1 right brace period max
⎧
w·μr
√wCrw'
|||
n
⎲
i=1
wi = 1
⎫
.
(4.20) 
Here StartFraction bold italic w dot bold italic mu Subscript bold italic r Baseline Over StartRoot bold italic w bold italic upper C Subscript bold italic r Baseline bold italic w prime EndRoot EndFraction
w·μr
√wCrw' represents a measure of portfolio performance (viz. risk-adjusted 
return). For a stock index with future random return upper X element of upper L squaredX ∈L2 the Sharpe Ratio is 
StartFraction sans serif upper E left parenthesis upper X right parenthesis Over sans serif upper S upper D left parenthesis upper X right parenthesis EndFraction E(X)
SD(X), although X should measures the excess return w.r.t. a benchmark index’s 
return. 
We conclude this section with a list of useful formulae. Let sigma summation Underscript i equals 1 Overscript n Endscripts a Subscript i Baseline upper X Subscript i∑n
i=1 aiXi and 
sigma summation Underscript j equals 1 Overscript m Endscripts b Subscript j Baseline upper Y Subscript j∑m
j=1 bjYj be two linear combination of n and m rvs, respectively, with a Subscript i Baseline comma b Subscript j Baseline element of double struck upper Rai, bj ∈R. 
Then: 
sans serif c o v left parenthesis sigma summation Underscript i equals 1 Overscript n Endscripts a Subscript i Baseline upper X Subscript i Baseline comma sigma summation Underscript j equals 1 Overscript m Endscripts b Subscript j Baseline upper Y Subscript j Baseline right parenthesis equals sigma summation Underscript i equals 1 Overscript n Endscripts sigma summation Underscript j equals 1 Overscript m Endscripts a Subscript i Baseline b Subscript j Baseline sans serif c o v left parenthesis upper X Subscript i Baseline comma upper Y Subscript j Baseline right parenthesis periodcov
⎛
n
⎲
i=1
aiXi,
m
⎲
j=1
bjYj
⎞
=
n
⎲
i=1
m
⎲
j=1
aibjcov(Xi, Yj).
(4.21) 
Formula (4.21) implies: 
StartLayout 1st Row 1st Column sans serif upper V left parenthesis sigma summation Underscript i equals 1 Overscript n Endscripts a Subscript i Baseline upper X Subscript i Baseline right parenthesis 2nd Column equals 3rd Column sans serif c o v left parenthesis sigma summation Underscript i equals 1 Overscript n Endscripts a Subscript i Baseline upper X Subscript i Baseline comma sigma summation Underscript j equals 1 Overscript n Endscripts a Subscript j Baseline upper X Subscript j Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript n Endscripts a Subscript i Superscript 2 Baseline sans serif upper V left parenthesis upper X Subscript i Baseline right parenthesis plus sigma summation Underscript i Endscripts sigma summation Underscript j not equals i Endscripts a Subscript i Baseline a Subscript j Baseline sans serif c o v left parenthesis upper X Subscript i Baseline comma upper X Subscript j Baseline right parenthesis period EndLayoutV
⎛
n
⎲
i=1
aiXi
⎞
= cov
⎛
n
⎲
i=1
aiXi,
n
⎲
j=1
ajXj
⎞
=
n
⎲
i=1
a2
i V(Xi) +
⎲
i
⎲
j/=i
aiajcov(Xi, Xj).
124
4
Moments and the Alike
Further, we also have the following. 
• 
.V(X + Y) = V(X) + V(Y) + 2cov(X, Y) and sans serif upper V left parenthesis upper X minus upper Y right parenthesis equals sans serif upper V left parenthesis upper X right parenthesis plus sans serif upper V left parenthesis upper Y right parenthesis minus 2 sans serif c o v left parenthesis upper X comma upper Y right parenthesisV(X −Y) = V(X) + V(Y) −
2cov(X, Y)
• 
.cov(a + bX, c + dY) = b d cov(X, Y), thus sans serif c o v left parenthesis a plus upper X comma c plus upper Y right parenthesis equals sans serif c o v left parenthesis upper X comma upper Y right parenthesiscov(a + X, c + Y) = cov(X, Y). 
• 
.corr(a + bX, c + dY) =
b d cov(X,Y)
√
b2d2V(X)V(Y) =
b d cov(X,Y)
|b d| √V(X)V(Y) =
b d cov(X,Y)
|b d| σXσY = 
StartFraction b d Over StartAbsoluteValue b d EndAbsoluteValue EndFraction sans serif c o r r left parenthesis upper X comma upper Y right parenthesis b d
|b d|corr(X, Y). 
• 
.corr(X, a + b X) =
b V(X)
√
V(X)b2 V(X) =
b V(X)
|b| √V(X)V(X) =
b
|b| = ±1. 
4.8 
Multivariate vs Univariate Expectation 
For a function g colon double struck upper R Superscript n Baseline right arrow double struck upper Rg : Rn →R of a random vector bold italic upper X equals left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesisX = (X1, . . . , Xn) s.t. g left parenthesis bold italic upper X right parenthesisg(X) is a rv 
inducing events left brace g left parenthesis bold italic upper X right parenthesis element of upper B right brace element of script upper F{g(X) ∈B} ∈F, for suitable subsets upper B subset of double struck upper RB ⊂R, we have:  
Theorem 4.6 If bold italic upper XX is absolutely continuous with joint density f Subscript bold italic upper XfX and the rv 
g left parenthesis upper X 1 comma ellipsis comma x Subscript n Baseline right parenthesis element of upper L Superscript 1g(X1, . . . , xn) ∈L1 then 
sans serif upper E left parenthesis g left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesis right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline midline horizontal ellipsis integral Subscript negative normal infinity Superscript normal infinity Baseline g left parenthesis x 1 comma ellipsis comma x Subscript x Baseline right parenthesis f Subscript bold italic upper X Baseline left parenthesis x 1 comma ellipsis comma x Subscript x Baseline right parenthesis normal d x 1 midline horizontal ellipsis normal d x Subscript n Baseline periodE(g(X1, . . . , Xn)) =
 ⎨∞
−∞
· · ·
 ⎨∞
−∞
g(x1, . . . , xx)fX(x1, . . . , xx)dx1 · · · dxn.
(4.22) 
In general25 Eq. (4.22) can be written using the CDF26 upper F Subscript bold italic upper XFX: 
StartEnclose box sans serif upper E left parenthesis g left parenthesis upper X 1 comma ellipsis comma x Subscript n Baseline right parenthesis right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline midline horizontal ellipsis integral Subscript negative normal infinity Superscript normal infinity Baseline g left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis normal d upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis EndEnclose period E(g(X1, . . . , xn)) =
 ⎨∞
−∞
· · ·
 ⎨∞
−∞
g(x1, . . . , xn)dFX(x1, . . . , xn) .
(4.23) 
In the bi-variate case the above becomes integral Subscript negative normal infinity Superscript normal infinity Baseline integral Subscript negative normal infinity Superscript normal infinity Baseline g left parenthesis x comma y right parenthesis normal d upper F Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis
 ⎨∞
−∞
 ⎨∞
−∞g(x, y)dFX(x, y) and we can 
write double integral Underscript double struck upper R squared Endscripts
 ⎨ ⎨
R2 instead of integral Subscript negative normal infinity Superscript normal infinity Baseline integral Subscript negative normal infinity Superscript normal infinity Baseline
 ⎨∞
−∞
 ⎨∞
−∞, or simply  double integral
 ⎨ ⎨
. Dropping the continuity assumption 
of components in the random vector, and performing integration via Stieltjes 
integrals entails the formula for expectation of a function of two rvs. 
Theorem 4.7 If bold italic upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y) with independent components upper X comma upper YX, Y, and g colon double struck upper R squared right arrow double struck upper Rg : R2 →R
is integrable (e.g. continuous) then 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis g left parenthesis upper X comma upper Y right parenthesis right parenthesis 2nd Column equals 3rd Column integral left bracket integral g left parenthesis x comma y right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis right bracket normal d upper F Subscript upper Y Baseline left parenthesis y right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral left bracket integral g left parenthesis x comma y right parenthesis normal d upper F Subscript upper Y Baseline left parenthesis y right parenthesis right bracket normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis period EndLayoutE(g(X, Y)) =
 ⎨⎾ ⎨
g(x, y)dFX(x)
⏋
dFY (y)
(4.24)
=
 ⎨⎾ ⎨
g(x, y)dFY (y)
⏋
dFX(x).
25 It holds also in the case of a discrete random vector. Notice that Theorem 4.6 is based on Fubini’s 
theorem yielding iterated integrals. 
26 Recall that normal d upper F Subscript bold italic upper X Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesisdFX(x1, . . . , xn) is not the CDF’s total differential. 
4.8
Multivariate vs Univariate Expectation
125
Applying Theorem 4.7 to independent rvs we get the factorization formula for 
expectation. 
Theorem 4.8 Assume upper X comma upper YX, Y are independent and h comma g colon double struck upper R right arrow double struck upper Rh, g : R →R are integrable 
functions (e.g. continuous) s.t. h left parenthesis upper X right parenthesis element of upper L Superscript 1h(X) ∈L1 and g left parenthesis upper Y right parenthesis element of upper L Superscript 1g(Y) ∈L1. Then 
sans serif upper E left parenthesis h left parenthesis upper X right parenthesis g left parenthesis upper Y right parenthesis right parenthesis equals sans serif upper E left parenthesis h left parenthesis upper X right parenthesis right parenthesis sans serif upper E left parenthesis g left parenthesis upper Y right parenthesis right parenthesis periodE(h(X)g(Y)) = E(h(X))E(g(Y)).
(4.25) 
Indeed, h left parenthesis x right parenthesis equals g left parenthesis x right parenthesis equals xh(x) = g(x) = x entails sans serif upper E left parenthesis upper X upper Y right parenthesis equals sans serif upper E left parenthesis upper X right parenthesis sans serif upper E left parenthesis upper Y right parenthesisE(XY) = E(X)E(Y) and the rvs upper X comma upper YX, Y
are called uncorrelated. In fact: sans serif c o v left parenthesis upper X comma upper Y right parenthesis equals sans serif upper E left parenthesis upper X upper Y right parenthesis minus sans serif upper E left parenthesis upper X right parenthesis sans serif upper E left parenthesis upper Y right parenthesis equals 0cov(X, Y) = E(XY) −E(X)E(Y) = 0, thus 
independent rvs are uncorrelated but the converse is not true. Here yet another 
application of Theorem 4.7 which extend the convolution formula Theorem 3.5 in 
Sect. 3.5, Chap. 3 to CDFs. Let upper X comma upper YX, Y be independent rvs. Then we have: 
upper F Subscript upper X plus upper Y Baseline left parenthesis u right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline upper F Subscript upper X Baseline left parenthesis u minus y right parenthesis normal d upper F Subscript upper Y Baseline left parenthesis y right parenthesis comma u element of double struck upper R periodFX+Y (u) =
 ⎨∞
−∞
FX(u −y)dFY (y),
u ∈R.
(4.26) 
In fact, we simply apply formula (4.23) with g left parenthesis x comma y right parenthesis equals bold upper I Subscript left brace x plus y less than u right braceg(x, y) = I{x+y<u}, where the 
indicator is 1 if the sum of values x plus yx + y is less than or slanted equals u⩽u, and get: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper X plus upper Y less than or slanted equals u right parenthesis 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket integral Subscript negative normal infinity Superscript normal infinity Baseline bold upper I Subscript left brace x plus y less than u right brace Baseline normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis right bracket normal d upper F Subscript upper Y Baseline left parenthesis y right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket integral Subscript negative normal infinity Superscript normal infinity Baseline bold upper I Subscript left brace x less than u minus y right brace Baseline normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis right bracket normal d upper F Subscript upper Y Baseline left parenthesis y right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket integral Subscript negative normal infinity Superscript u minus y Baseline normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis right bracket normal d upper F Subscript upper Y Baseline left parenthesis y right parenthesis 4th Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket upper F Subscript upper X Baseline left parenthesis u minus y right parenthesis minus upper F Subscript upper X Baseline left parenthesis negative normal infinity right parenthesis right bracket normal d upper F Subscript upper Y Baseline left parenthesis y right parenthesis period EndLayoutP(X + Y ⩽u) =
 ⎨∞
−∞
⎾ ⎨∞
−∞
I{x+y<u}dFX(x)
⏋
dFY (y)
=
 ⎨∞
−∞
⎾ ⎨∞
−∞
I{x<u−y}dFX(x)
⏋
dFY (y)
=
 ⎨∞
−∞
⎾ ⎨u−y
−∞
dFX(x)
⏋
dFY (y)
=
 ⎨∞
−∞
[FX(u −y) −FX(−∞)] dFY (y).
In Theorems 4.7 and 4.8 we assumed integrable functions g comma hg, h. Here a general 
version based on measurability. 
Lemma 4.2 Let upper X comma upper YX, Y be rvs on the same probability space. They are independent 
if and only if 
sans serif upper E left parenthesis h left parenthesis upper X right parenthesis g left parenthesis upper Y right parenthesis right parenthesis equals sans serif upper E left parenthesis h left parenthesis upper X right parenthesis right parenthesis sans serif upper E left parenthesis g left parenthesis upper Y right parenthesis right parenthesis commaE(h(X)g(Y)) = E(h(X))E(g(Y)),
for any pair of measurable functions h comma gh, g positive or bounded. 
To close this section we summarize the main facts about expectation and variance 
that can be deduced from the above results.
126
4
Moments and the Alike
• 
Let upper X 1 comma ellipsis comma upper X Subscript n BaselineX1, . . . , Xn be rvs over a common left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P). Then: 
sans serif upper E left parenthesis upper X 1 plus midline horizontal ellipsis plus upper X Subscript n Baseline right parenthesis equals sans serif upper E left parenthesis upper X 1 right parenthesis plus midline horizontal ellipsis plus sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis commaE(X1 + · · · + Xn) = E(X1) + · · · + E(Xn),
provided that sans serif upper E left parenthesis upper X Subscript i Baseline right parenthesis element of upper L Superscript 1E(Xi) ∈L1 for27 i equals 1 comma ellipsis comma ni = 1, . . . , n. 
• 
Adding independence among all upper X Subscript iXi: 
sans serif upper E left parenthesis upper X 1 midline horizontal ellipsis upper X Subscript n Baseline right parenthesis equals sans serif upper E left parenthesis upper X 1 right parenthesis midline horizontal ellipsis sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesisE(X1 · · · Xn) = E(X1) · · · E(Xn)
and 
sans serif upper V left parenthesis upper X 1 plus midline horizontal ellipsis plus upper X Subscript n Baseline right parenthesis equals sans serif upper V left parenthesis upper X 1 right parenthesis plus midline horizontal ellipsis plus sans serif upper V left parenthesis upper X Subscript n Baseline right parenthesis commaV(X1 + · · · + Xn) = V(X1) + · · · + V(Xn),
• 
Given a rv X s.t. all the moments sans serif upper E left parenthesis upper X Superscript n Baseline right parenthesisE(Xn) exists and are ﬁnite, i.e. upper X element of upper L Superscript nX ∈Ln for 
n greater than or slanted equals 2n ⩾2, then we get the central moments as: 
sans serif upper E left parenthesis left parenthesis upper X minus mu Subscript upper X Baseline right parenthesis Superscript n Baseline right parenthesis equals sigma summation Underscript i equals 0 Overscript n Endscripts StartBinomialOrMatrix n Choose i EndBinomialOrMatrix sans serif upper E left parenthesis upper X Superscript i Baseline right parenthesis left parenthesis minus mu Subscript upper X Baseline right parenthesis Superscript n minus i Baseline commaE((X −μX)n) =
n
⎲
i=0
⎛n
i
⎞
E(Xi)(−μX)n−i,
(4.27) 
just expand left parenthesis upper X minus mu Subscript upper X Baseline right parenthesis Superscript n(X −μX)n by the binomial theorem to get sigma summation Underscript i equals 0 Overscript n Endscripts StartBinomialOrMatrix n Choose k EndBinomialOrMatrix upper X Superscript i Baseline left parenthesis minus mu Subscript upper X Baseline right parenthesis Superscript n minus i∑n
i=0
(n
k
)
Xi(−μX)n−i, 
then take expectation.28 
4.9 
More on Transformation of Rvs 
Recall that double struck upper R Superscript nRn is a normed space, and in particular a vector space (see Appendix G) 
and linear functions bold italic upper T colon double struck upper R Superscript n Baseline right arrow double struck upper R Superscript nT : Rn →Rn can be given a matrix representation. Let 
StartSet bold italic e 1 comma ellipsis comma bold italic e Subscript n Baseline EndSet{e1, . . . , en} be a collection of points in double struck upper R Superscript nRn such that the jth coordinate of bold italic e Subscript jej is 
1 while the others are zero, each j equals 1 comma ellipsis comma n periodj = 1, . . . , n. This set is called the standard basis 
of double struck upper R Superscript n Baseline commaRn, and we can write (uniquely) every point bold italic x element of double struck upper R Superscript nx ∈Rn as: 
bold italic x equals x 1 bold italic e 1 plus x 2 bold italic e 2 plus midline horizontal ellipsis plus x Subscript n Baseline bold italic e Subscript n Baseline equals x 1 Start 4 By 1 Matrix 1st Row 1 2nd Row 0 3rd Row vertical ellipsis 4th Row 0 EndMatrix plus x 2 Start 4 By 1 Matrix 1st Row 0 2nd Row 1 3rd Row vertical ellipsis 4th Row 0 EndMatrix plus x Subscript n Baseline Start 4 By 1 Matrix 1st Row 0 2nd Row 0 3rd Row vertical ellipsis 4th Row 1 EndMatrix periodx = x1e1 + x2e2 + · · · + xnen = x1
⎡
⎢⎢⎢⎣
1
0
...
0
⎤
⎥⎥⎥⎦+ x2
⎡
⎢⎢⎢⎣
0
1
...
0
⎤
⎥⎥⎥⎦+ xn
⎡
⎢⎢⎢⎣
0
0
...
1
⎤
⎥⎥⎥⎦.
Note that for each element of the basis it holds double vertical bar bold italic e Subscript j Baseline double vertical bar equals 1 period‖ej‖ = 1. Then, the linear function 
maps bold italic e Subscript jej into bold italic upper T left parenthesis bold italic e Subscript j Baseline right parenthesis element of double struck upper R Superscript n Baseline commaT(ej) ∈Rn, which can be represented as sigma summation Underscript i equals 1 Overscript n Endscripts a Subscript i j Baseline e Subscript i∑n
i=1 aijei for some
27 All the expectations are admitted to be plus normal infinity+∞or negative normal infinity−∞, but not both. 
28 This can be performed term by term in the summation since all the moments exist and are ﬁnite, 
thus we cannot have terms as plus normal infinity minus normal infinity+∞−∞. 
4.9
More on Transformation of Rvs
127
constants a Subscript 1 j Baseline comma ellipsis comma a Subscript n j Baseline perioda1j, . . . , anj. We may deﬁne a n times nn × n matrix 
bold italic upper A equals Start 4 By 4 Matrix 1st Row 1st Column a 11 2nd Column a 12 3rd Column midline horizontal ellipsis 4th Column a Subscript 1 n Baseline 2nd Row 1st Column a 21 2nd Column a 22 3rd Column midline horizontal ellipsis 4th Column a Subscript 2 n Baseline 3rd Row 1st Column vertical ellipsis 2nd Column vertical ellipsis 3rd Column down right diagonal ellipsis 4th Column vertical ellipsis 4th Row 1st Column a Subscript n Baseline 1 Baseline 2nd Column a Subscript n Baseline 2 Baseline 3rd Column midline horizontal ellipsis 4th Column a Subscript n n EndMatrixA =
⎡
⎢⎢⎢⎣
a11 a12 · · · a1n
a21 a22 · · · a2n
...
...
...
...
an1 an2 · · · ann
⎤
⎥⎥⎥⎦
whose columns are just the coefﬁcients of the representation of bold italic upper T left parenthesis bold italic e Subscript j Baseline right parenthesisT(ej) for j equals 1 comma 2 comma ellipsis comma n periodj =
1, 2, . . . , n. It follows that bold italic upper T left parenthesis bold italic x right parenthesis equals bold italic upper A dot bold italic x Superscript prime Baseline commaT(x) = A · x', and we call bold italic upper AA the matrix representation 
of the linear function bold italic upper TT with respect to the standard basis. Conversely, given a n times nn× n
matrix bold italic upper A equals left bracket a Subscript i j Baseline right bracketA = [aij] we can deﬁne a linear function bold italic upper T colon double struck upper R Superscript n Baseline right arrow double struck upper R Superscript nT : Rn →Rn by the formula 
bold italic upper T left parenthesis bold italic x right parenthesis equals bold italic upper A dot bold italic x Superscript prime Baseline commaT(x) = A · x', for each bold italic x element of double struck upper R Superscript n Baseline periodx ∈Rn. The determinant of bold italic upper TT is simply det bold italic upper A perioddet A.
Remark 4.8 If upper V comma upper WV, W are vector spaces (see Appendix G), then a linear function 
upper T colon upper V right arrow upper WT : V →W is called a linear operator provided that upper T left parenthesis a x plus b y right parenthesis equals a upper T left parenthesis x right parenthesis plus b upper T left parenthesis y right parenthesisT (ax+by) = aT (x)+bT (y)
for every x comma y element of upper Vx, y ∈V and a comma b element of double struck upper R perioda, b ∈R. If upper W equals double struck upper RW = R we call T a linear functional. The  
matrix representation of a linear operator rests upon the ﬁnite-dimension of V and 
upper W commaW, as in the simple case discussed above. Since left parenthesis upper S plus upper T right parenthesis left parenthesis x right parenthesis equals upper S left parenthesis x right parenthesis plus upper T left parenthesis x right parenthesis(S + T )(x) = S(x) + T (x) and 
upper T left parenthesis a x right parenthesis equals a upper T left parenthesis x right parenthesis commaT (ax) = aT (x), the collection of all linear operators from a vector space V to 
another vector space W is a vector space itself. The subclass of all bounded linear 
operators, i.e. those upper T colon upper V right arrow upper WT : V →W with the property sup left brace double vertical bar upper T left parenthesis x right parenthesis double vertical bar colon double vertical bar x double vertical bar equals 1 right brace less than normal infinity commasup{‖T (x)‖ : ‖x‖ = 1} < ∞,
where the norms in V and W are not necessarily equivalent, is denoted by upper L left parenthesis upper V comma upper W right parenthesis periodL(V, W).
Observe that if upper T element of upper L left parenthesis upper V comma upper W right parenthesis commaT ∈L(V, W), then there exists some upper M greater than or slanted equals 0M ⩾0 such that double vertical bar upper T left parenthesis x right parenthesis double vertical bar less than or slanted equals upper M double vertical bar x double vertical bar comma‖T (x)‖ ⩽
M‖x‖, for all x element of upper V periodx ∈V. Furthermore, it can be shown that any bounded linear operator 
is continuous, that is for any sequence left parenthesis x Subscript n Baseline right parenthesis Subscript n Baseline subset of upper V(xn)n ⊂V such that limit Underscript n Endscripts x Subscript n Baseline equals xlimn xn = x we have that 
limit Underscript n Endscripts upper T left parenthesis x Subscript n Baseline right parenthesis equals upper T left parenthesis x right parenthesis periodlimn T (xn) = T (x). In fact, the two limits yields double vertical bar x Subscript n Baseline minus x double vertical bar equals 0‖xn −x‖ = 0 and double vertical bar upper T left parenthesis x Subscript n Baseline right parenthesis minus upper T left parenthesis x right parenthesis double vertical bar‖T (xn)−T (x)‖
as n right arrow normal infinity periodn →∞.
If we let upper M equals n dot max left brace StartAbsoluteValue a Subscript i j Baseline EndAbsoluteValue colon i comma j equals 1 comma ellipsis comma n right braceM = n · max{|aij| : i, j = 1, . . . , n} then double vertical bar bold italic upper T left parenthesis bold italic x right parenthesis double vertical bar equals double vertical bar bold italic upper A bold italic x Superscript prime Baseline double vertical bar less than or slanted equals upper M double vertical bar bold italic x double vertical bar‖T(x)‖ = ‖Ax'‖ ⩽M‖x‖
and we see that the matrix representation deﬁnes a continuous linear operator. 
Example 4.9 Let bold italic upper X equals left parenthesis upper X 1 left parenthesis omega right parenthesis comma upper X 2 left parenthesis omega right parenthesis right parenthesisX = (X1(ω), X2(ω)) be a two-dimensional random vector and 
bold italic upper A equals Start 2 By 2 Matrix 1st Row 1st Column 4 2nd Column 1 2nd Row 1st Column 2 2nd Column 3 EndMatrixA =
⎾4 1
2 3
⏋
be a 2 times 22 × 2 matrix with real entries. Then, bold italic upper AA represents a linear transformation bold italic upper T colon double struck upper R squared right arrow double struck upper R squaredT :
R2 →R2 which entails a composed map bold italic upper T ring bold italic upper X colon upper Omega right arrow double struck upper R squaredT ◦X : Ω →R2 deﬁned by 
bold italic upper T ring bold italic upper X left parenthesis omega right parenthesis colon equals bold italic upper Y equals bold italic upper A bold italic upper X Superscript prime Baseline equals left parenthesis 4 upper X 1 left parenthesis omega right parenthesis plus upper X 2 left parenthesis omega right parenthesis comma 2 upper X 1 left parenthesis omega right parenthesis plus 3 upper X 2 left parenthesis omega right parenthesis right parenthesis periodT ◦X(ω) := Y = AX' =
(
4X1(ω) + X2(ω), 2X1(ω) + 3X2(ω)
)
.
Thus any deterministic matrix bold italic upper AA whose dimensions are compatible with that of the 
random vector bold italic upper XX provides a new random vector bold italic upper YY as a consequence of Theorem 2.7. 
Next we aim at extending the transformation formula for densities viewed in 
Sect. 4.5, to the  n-dimensional case. Let bold italic upper XX be a random vector with joint density
128
4
Moments and the Alike
f Subscript bold italic upper X Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis commafX(x1, . . . , xn), and bold italic g colon double struck upper R Superscript n Baseline right arrow double struck upper R Superscript ng : Rn →Rn be a continuously differentiable and one-to-
one function, i.e. it is differentiable (then continuous) and all its partial derivatives 
are continuous functions from double struck upper R Superscript nRn to double struck upper R Superscript n Baseline periodRn. Such a map is called a upper C Superscript 1C1-differentiable 
function. The value of bold italic gg at a point bold italic x equals left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesisx = (x1, . . . , xn) is the vector of functions 
left parenthesis g 1 left parenthesis bold italic x right parenthesis comma ellipsis comma g Subscript n Baseline left parenthesis bold italic x right parenthesis right parenthesis comma(g1(x), . . . , gn(x)), where g Subscript i Baseline colon double struck upper R Superscript n Baseline right arrow double struck upper R periodgi : Rn →R. Recall that the derivative of bold italic gg at bold italic xx is 
represented by its Jacobian matrix, 
bold italic upper J Subscript bold italic g Baseline left parenthesis bold italic x right parenthesis equals Start 3 By 3 Matrix 1st Row 1st Column StartFraction partial differential g 1 Over partial differential x 1 EndFraction 2nd Column midline horizontal ellipsis 3rd Column StartFraction partial differential g 1 Over partial differential x Subscript n Baseline EndFraction 2nd Row 1st Column vertical ellipsis 2nd Column down right diagonal ellipsis 3rd Column vertical ellipsis 3rd Row 1st Column StartFraction partial differential g Subscript n Baseline Over partial differential x 1 EndFraction 2nd Column midline horizontal ellipsis 3rd Column StartFraction partial differential g Subscript n Baseline Over partial differential x Subscript n Baseline EndFraction EndMatrix equals Start 3 By 1 Matrix 1st Row nabla g 1 left parenthesis bold italic x right parenthesis 2nd Row vertical ellipsis 3rd Row nabla g Subscript n Baseline left parenthesis bold italic x right parenthesis EndMatrix commaJg(x) =
⎡
⎢⎢⎣
∂g1
∂x1 · · · ∂g1
∂xn
...
...
...
∂gn
∂x1 · · · ∂gn
∂xn
⎤
⎥⎥⎦=
⎡
⎢⎣
∇g1(x)
...
∇gn(x)
⎤
⎥⎦,
where nabla g Subscript i Baseline left parenthesis bold italic x right parenthesis∇gi(x) denotes the gradient of each component function g Subscript igi at bold italic x periodx. We observe 
that the determinant of the Jacobian matrix, det bold italic upper J Subscript bold italic g Baseline left parenthesis bold italic x right parenthesis commadet Jg(x), is a continuous function from 
double struck upper R Superscript nRn to double struck upper RR and is called simply the Jacobian of bold italic gg at bold italic x periodx. If we assume that det bold italic upper J Subscript bold italic g Baseline left parenthesis bold italic x right parenthesis not equals 0det Jg(x) /=
0 then the map bold italic gg is called a diffeomorphism.29 In this case bold italic gg is invertible (on a 
neighborhood of bold italic xx)30 and the Jacobian of the inverse function bold italic g Superscript negative 1g−1 at bold italic y equals bold italic g left parenthesis bold italic x right parenthesisy = g(x)
equals StartFraction 1 Over det bold italic upper J Subscript bold italic g Baseline left parenthesis bold italic x right parenthesis EndFraction period
1
det Jg(x). We have the following result: 
Proposition 4.4 Let bold italic upper XX be a n-dimensional random vector with joint density f Subscript bold italic upper X Baseline left parenthesis bold italic x right parenthesis commafX(x),
and bold italic g colon double struck upper R Superscript n Baseline right arrow double struck upper R Superscript ng : Rn →Rn be a diffeomorphism. Then bold italic upper Y equals bold italic g left parenthesis bold italic upper X right parenthesisY = g(X) is a new n-dimensional 
random vector with density 
f Subscript bold italic upper Y Baseline left parenthesis bold italic y right parenthesis equals f Subscript bold italic upper X Baseline left parenthesis bold italic g Superscript negative 1 Baseline left parenthesis bold italic y right parenthesis right parenthesis StartAbsoluteValue det bold italic upper J Subscript bold italic g Sub Superscript negative 1 Subscript Baseline left parenthesis bold italic y right parenthesis EndAbsoluteValuefY(y) = fX(g−1(y))| det Jg−1(y)|
(4.28) 
if bold italic y element of bold italic upper Y left parenthesis upper Omega right parenthesis commay ∈Y(Ω), and zero otherwise. 
Note that the Jacobian of the inverse function is taken in absolute value. 
Proposition 4.4 is based on the following theorem, which we present without proof 
(see for example [2]). 
Theorem 4.9 (Jacobi’s Transformation Formula) Let V be an open set in double struck upper R Superscript nRn
and bold italic g colon upper V right arrow double struck upper R Superscript ng : V →Rn be a diffeomorphism. Then, for a measurable function bold italic h colon bold italic g left parenthesis upper V right parenthesis right arrow double struck upper R Superscript nh :
g(V ) →Rn such that bold italic h element of script upper L Superscript 1 Baseline left parenthesis bold italic g left parenthesis upper V right parenthesis comma script upper B Superscript n Baseline comma m Superscript n Baseline right parenthesis commah ∈L1(g(V ), Bn, mn), the composed function bold italic h ring bold italic gh ◦g belongs 
to script upper L Superscript 1 Baseline left parenthesis double struck upper R Superscript n Baseline comma script upper B Superscript n Baseline comma m Superscript n Baseline right parenthesisL1(Rn, Bn, mn) and 
integral Underscript bold italic g left parenthesis upper V right parenthesis Endscripts bold italic h left parenthesis bold italic y right parenthesis normal d bold italic y equals integral Underscript upper V Endscripts bold italic h left parenthesis g left parenthesis bold italic x right parenthesis right parenthesis StartAbsoluteValue det upper J Subscript bold italic g Baseline left parenthesis bold italic x right parenthesis EndAbsoluteValue normal d bold italic x
 ⎨
g(V )
h(y)dy =
 ⎨
V
h(g(x))| det Jg(x)|dx
holds.
29 It follows that a upper C Superscript 1C1-differentiable function g with nonzero Jacobian is ever a bijection. The 
domain and range of a diffeomorphism can be restricted to open subsets upper V comma upper WV, W of double struck upper R Superscript n Baseline periodRn.
30 It is also a diffeomorphism. 
4.10
Exercises
129
Here, script upper B Superscript nBn is the n-dimensional Bore sigma hyphen algebraσ-algebra generated by the open subsets of 
double struck upper R Superscript nRn, and m Superscript nmn is the n-dimensional Lebesgue measure. In Theorem 4.9, bold italic g left parenthesis upper V right parenthesisg(V ) is the 
image of upper V commaV, i.e. StartSet bold italic y element of double struck upper R Superscript n Baseline colon bold italic y equals bold italic g left parenthesis bold italic x right parenthesis EndSet period{y ∈Rn : y = g(x)}. The assumption bold italic h element of script upper L Superscript 1 Baseline left parenthesis bold italic g left parenthesis upper V right parenthesis comma script upper B Superscript n Baseline comma m Superscript n Baseline right parenthesish ∈L1(g(V ), Bn, mn)
means that bold italic hh belongs to the space script upper L Superscript 1 Baseline left parenthesis bold italic g left parenthesis upper V right parenthesis comma script upper B Superscript n Baseline comma m Superscript n Baseline right parenthesisL1(g(V ), Bn, mn) of functions deﬁned on bold italic g left parenthesis upper V right parenthesisg(V )
and having ﬁnite n-dimensional Lebesgue integral. This implies the integral of its 
transformation bold italic h ring bold italic gh ◦g also exists, see Appendices M, N and O.31 A word of caution. 
If we deﬁne a function g colon double struck upper R Superscript n Baseline right arrow double struck upper Rg : Rn →R such that g left parenthesis bold italic x right parenthesisg(x) takes value on the range of a 
random vector bold italic upper X commaX, i.e. bold italic x equals bold italic upper X left parenthesis omega right parenthesis commax = X(ω), we return to the simple situation yet analyzed in 
the one-dimensional case. More precisely, the distribution of the rv upper Y equals g left parenthesis bold italic upper X right parenthesisY = g(X) can 
be recovered from the joint density function of bold italic upper X commaX, since we have StartSet omega element of upper Omega colon upper Y left parenthesis omega right parenthesis less than or slanted equals y EndSet equals left brace g left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesis less than or slanted equals y right brace{ω ∈Ω : Y(ω) ⩽
y} = {g(X1, . . . , Xn) ⩽y} and the set StartSet bold italic x element of double struck upper R Superscript n Baseline colon g left parenthesis bold italic x right parenthesis less than or slanted equals y EndSet{x ∈Rn : g(x) ⩽y} equals g Superscript negative 1 Baseline left parenthesis left parenthesis negative normal infinity comma y right bracket right parenthesisg−1((−∞, y])
which is contained in the range of the random vector, bold italic upper X left parenthesis upper Omega right parenthesis periodX(Ω). Hence it holds: 
upper F Subscript upper Y Baseline left parenthesis y right parenthesis equals integral Underscript g Superscript negative 1 Baseline left parenthesis left parenthesis negative normal infinity comma y right bracket right parenthesis Endscripts f Subscript bold italic upper X Baseline left parenthesis bold italic x right parenthesis normal d bold italic x periodFY (y) =
 ⎨
g−1((−∞,y])
fX(x)dx.
A special case of Proposition 4.4 is when the diffeomorphism bold italic gg is linear, represented 
by a non-singular n times nn × n matrix bold italic upper A periodA. We have bold italic upper Y equals bold italic upper A dot bold italic upper X primeY = A · X' and its density function is 
clearly 
f Subscript bold italic upper Y Baseline left parenthesis bold italic y right parenthesis equals f Subscript bold italic upper X Baseline left parenthesis bold italic upper A Superscript negative 1 Baseline dot bold italic y Superscript prime Baseline right parenthesis StartFraction 1 Over StartAbsoluteValue det bold italic upper A EndAbsoluteValue EndFraction commafY(y) = fX(A−1 · y')
1
| det A|,
where bold italic upper A Superscript negative 1 Baseline equals bold italic g Superscript negative 1A−1 = g−1 is the inverse of bold italic upper AA and its Jacobian bold italic upper J Subscript bold italic g Sub Superscript negative 1 Baseline equals det bold italic upper A Superscript negative 1Jg−1 = det A−1 is the inverse 
of the determinant of bold italic upper A periodA.
4.10 
Exercises 
4.1 Let X be a discrete rv. Prove E(a + b X)  = a + b E(X). 
4.2 Let X be a continuous rv with a density. Prove E(a + b X)  = a + b E(X). 
4.3 (First order stochastic dominance) Let X, Y be two proﬁt and loss rvs such 
that Y dominates X in the usual stochastic order, i.e. FX(x) ⩾FY (x) also written 
X ≼FSD Y. Show that E(X) ⩽E(Y), whenever the expectations are both ﬁnite.32 
4.4 (Symmetric distributions) For any kind of rv X, which is symmetrical 
distributed around a ∈ R, we have  a = med(X). Moreover, if E(X) < ∞ then 
a = E(X). Prove these.
31 The appropriate space is now script upper L Superscript 1 Baseline left parenthesis double struck upper R Superscript n Baseline comma script upper B Superscript n Baseline comma m Superscript n Baseline right parenthesis periodL1(Rn, Bn, mn).
32 In fact, we have seen that when X ≼FSD Y then either X ⩽Y for each scenario or P(X ⩽Y) = 
1. Moreover, the result holds for increasing g(x) s.t. g(X), g(Y) have ﬁnite expectations. 
130
4
Moments and the Alike
4.5 (Proper location-scale density) Given a continuous rv X with density fX(x) 
show that 1 
b fX
( x−a 
b
)
is again a density function, provided a ∈ R and b >  0. 
4.6 Let X ∈ L1, choose d ∈ R and let g(d) = E(|X − d|). Show that the median 
minimizes the MAD, i.e. mind∈R g(d) = g(m) where m is the median of FX. 
4.7 (Lp classes of rvs) Assume E(Xm ) is ﬁnite and 0 < n < m  (not necessarily 
integers) then E(Xn ) is ﬁnite too. 
4.8 Let X ∈ L2 and set g(X) = X−E(X) 
SD(X) . Show that linearity of expectation, 
E(a + bX) = a + bE(X) and quasi-linearity of standard deviation SD(a + bX) = 
|b|SD(X) are equivalent to (g(a + bX))2 = (g(X))2. 
4.9 Given two rvs X, Y ∈ L2 show that XY ∈ L1 without using Hölder’s 
inequality. 
4.10 Let g(x) = I{x⩽1} and F(x) = I{x⩾1}. Then, the former is bounded on every 
interval (a, b] while the latter is nondecreasing. Compute the Stieltjes integral of 
g(x) with respect to F(x) for a = 0 and b = 2 using the intermediate point x = 1. 
4.11 Assume 0 ⩽E(X) < ∞, for a nonnegative rv X. Show that nP(X > n) → 0 
for n →∞. 
4.12 Let X be a nonnegative rv with 0 ⩽E(X) < ∞, i.e. X ∈ L1. Show that 
P(X < ∞) = 1, i.e. X is P-a.s. ﬁnite. 
4.13 Let X, Y be any pair of rvs for which the expectation exists. Show that33 
E(X + Y) = E(X) + E(Y). 
4.14 X + Y is a simple (viz. discrete) rv if X and Y are too. Prove the claim. 
4.15 Show that E(X) ⩽E(Y), provided that X ⩽Y for every scenario and the 
expectations are both ﬁnite. 
4.16 Let X be a rv with CDF FX(x) and quantile function QX(c). Show that 
E(X) =
 ⎨1 
0 QX(c)dc 
4.17 Show that: 
1. Given a rv  X X  a.s.
= 0 implies E(X) = 0 ; 
2. For two rvs X a.s.
= Y with ﬁnite expectations implies E(X) = E(Y) ; this holds 
for bounded or continuous g : R → R s.t. g(X), g(Y) have ﬁnite expectations 
too. 
3. For a rv X ⩾0 with E(X) = 0 then X a.s.
= 0 .
33 This holds with minor modiﬁcation: E(a X + b Y)  = a E(X) + b E(Y) for constants a, b ∈ R. 
4.10
Exercises
131
4.18 Let X be a nonnegative discrete rv with countable values X(Ω) = 
{x1, x2, . . .} = X, where xi ⩾0 each i ∈ N. Show that formula 
sigma summation Underscript i equals 1 Overscript normal infinity Endscripts x Subscript i Baseline sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis comma where events left brace upper X equals x Subscript i Baseline right brace decompose upper Omega comma
∞
⎲
i=1
xiP(X = xi),
where events {X = xi} decompose Ω,
(4.29) 
a special case of (4.1) with g(x) = x, correctly deﬁnes E(X). 
4.19 Let X1, X2, . . .  be a sequence of nonnegative rvs with E(Xi) <  ∞ each i ∈ 
N. Show that 
sans serif upper E left parenthesis upper X 1 plus upper X 2 plus midline horizontal ellipsis right parenthesis equals sans serif upper E left parenthesis upper X 1 right parenthesis plus sans serif upper E left parenthesis upper X 2 right parenthesis plus midline horizontal ellipsis commaE(X1 + X2 + · · · ) = E(X1) + E(X2) + · · · ,
linearity of expectation holds for countable many rvs Xi ⩾0. 
4.20 Let X, X1, X2, . . .  be nonnegative rvs on the same probability space. Assume 
lim 
n→∞ Xn = X pointwise. Show that: (i) (Xn −X) → 0 pointwise; (ii) (X −Xn)+ ⩽
X and (Xn − X)−⩽X. Prove the same relations hold P-a.s. 
4.21 Prove Proposition 4.4. 
4.22 Let X = (X1, X2) be a random vector where Xi ∼ N(0, 1) are independent 
Gaussian variables. Compute the joint density function of the new random vector 
Y = g(X), where g : R2 → R2 is deﬁned by g(x1, x2) = (x1 + x2, x1 − x2). 
4.23 Let X be a nonnegative rv taking values xi = i = 1, 2, . . .. Compute the 
expectation. 
4.24 Let X be a rv representing a proﬁt and loss or a rate of return with ﬁnite 
expectation. Compute E(X) using the integration by parts formula (4.38) with a = 
−∞and b = ∞. 
4.25 Let X be a rv with  CDF  FX and E(|X|) <  ∞. Show that
 ⎨x 
−∞ FX(u)du = 
E
(
(x − X)+)
, where (x − X)+ := max{0, x  − X} = (x − X)I{X⩽x}. 
4.26 Let X ⩾0 be a nonnegative rv with cdf FX and E(|X|) <  ∞, representing 
a loss. A stop-loss insurance offers the payment (X − s)+ := max{0, X  −s}: the  
insurer retains a risk of monetary amount s e and let the reinsurer pays for the 
remainder (the insurer’s loss stops at s >  0). Show that E
(
(X − s)+)
=
 ⎨∞ 
s [1 − 
FX(x)]dx.
132
4
Moments and the Alike
Appendix 
The Variance Can Be Zero 
V(X) is zero if and only if X is a degenerate rv. Assume X a.s.
= c and recall that 
E(X) = c. But X2 = c2I{X=c} so V(X) = E(X2) − (E(X))2 = c2 − c2 = 0. For 
the converse, assume V(X) = 0 and apply Chebychev’s inequality to the rv |X − c| 
with p = 2 and c = μX ∈ R being the expectation of X. Then 
sans serif upper P left parenthesis StartAbsoluteValue upper X minus c EndAbsoluteValue greater than or slanted equals a right parenthesis less than or slanted equals StartFraction sans serif upper E left parenthesis left parenthesis upper X minus c right parenthesis squared right parenthesis Over a squared EndFraction equals StartFraction sans serif upper V left parenthesis upper X right parenthesis Over a squared EndFraction equals 0 commaP(|X −c| ⩾a) ⩽E
(
(X−c)2)
a2
= V(X)
a2
= 0,
and P(|X −c| ⩾a) must be zero for every a >  0. Now {|X −c| ⩾a} ⊂{|X −c| > 
0} Hence: 
1 equals 1 minus sans serif upper P left parenthesis StartAbsoluteValue upper X minus c EndAbsoluteValue greater than or slanted equals a right parenthesis less than or slanted equals 1 minus sans serif upper P left parenthesis StartAbsoluteValue upper X minus c EndAbsoluteValue greater than 0 right parenthesis1 = 1 −P
(
|X −c| ⩾a
)
⩽1 −P(|X −c| > 0)
which implies 1 = P(|X − c| = 0) = P(X = c) and we conclude that X a.s.
= c. 
Hölder and Minkowski Inequalities 
For all x comma y greater than 0x, y > 0 it holds 
x Superscript 1 divided by p Baseline y Superscript 1 divided by q Baseline less than or slanted equals StartFraction x Over p EndFraction plus StartFraction y Over q EndFraction commax1/py1/q ⩽x
p + y
q ,
(4.30) 
where p comma q element of left parenthesis 1 comma normal infinity right parenthesisp, q ∈(1, ∞) are said to be conjugate exponents, i.e. they satisfy StartFraction 1 Over p EndFraction plus StartFraction 1 Over q EndFraction equals 1 period1
p+ 1
q = 1.
Now, ln left parenthesis dot right parenthesisln( · ) is concave on upper I equals left parenthesis 0 comma normal infinity right parenthesisI = (0, ∞) and then: 
ln left parenthesis StartFraction x Over p EndFraction plus StartFraction y Over q EndFraction right parenthesis greater than or slanted equals StartFraction 1 Over p EndFraction ln x plus StartFraction 1 Over q EndFraction ln y equals ln left parenthesis x Superscript 1 divided by p Baseline y Superscript 1 divided by q Baseline right parenthesis periodln( x
p + y
q ) ⩾1
p ln x + 1
q ln y = ln
⎛
x1/py1/q⎞
.
To get (4.30) take the exponential normal e Superscript left parenthesis dot right parenthesise( · ) of both sides of the last inequality. 
Proof of Hölder’s Inequality Inequality (4.30) implies StartAbsoluteValue upper X upper Y EndAbsoluteValue less than or slanted equals StartFraction StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline Over p EndFraction plus StartFraction StartAbsoluteValue upper Y EndAbsoluteValue Superscript q Baseline Over q EndFraction comma|XY| ⩽|X|p
p
+ |Y|q
q , after 
we let x Superscript 1 divided by p Baseline equals StartAbsoluteValue upper X EndAbsoluteValuex1/p = |X| and y Superscript 1 divided by q Baseline equals StartAbsoluteValue upper Y EndAbsoluteValue periody1/q = |Y|. Assume that left parenthesis sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline right parenthesis right parenthesis Superscript 1 divided by p(E(|X|p))1/p and left parenthesis sans serif upper E left parenthesis StartAbsoluteValue upper Y EndAbsoluteValue Superscript q Baseline right parenthesis right parenthesis Superscript 1 divided by q(E(|Y|q))1/q are 
both equal to 1 so that also sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline right parenthesis equals sans serif upper E left parenthesis StartAbsoluteValue upper Y EndAbsoluteValue Superscript q Baseline right parenthesis equals 1 periodE(|X|p) = E(|Y|q) = 1. Then, taking expectation of 
both sides of the above inequality gives sans serif upper E left parenthesis StartAbsoluteValue upper X upper Y EndAbsoluteValue right parenthesis less than or slanted equals StartFraction sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline right parenthesis Over p EndFraction plus StartFraction sans serif upper E left parenthesis StartAbsoluteValue upper Y EndAbsoluteValue Superscript q Baseline right parenthesis Over q EndFraction equals StartFraction 1 Over p EndFraction plus StartFraction 1 Over q EndFraction equals 1 periodE(|XY|) ⩽E(|X|p)
p
+ E(|Y|q)
q
= 1
p + 1
q = 1.
Now, assume that neither left parenthesis sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline right parenthesis right parenthesis Superscript 1 divided by p(E(|X|p))1/p nor left parenthesis sans serif upper E left parenthesis StartAbsoluteValue upper Y EndAbsoluteValue Superscript q Baseline right parenthesis right parenthesis Superscript 1 divided by q(E(|Y|q))1/q is zero. Hence, replacing
Appendix
133
X and Y in the last inequality by StartFraction upper X Over left parenthesis sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline right parenthesis right parenthesis Superscript 1 divided by p Baseline EndFraction
X
(E(|X|p))1/p and StartFraction upper Y Over left parenthesis sans serif upper E left parenthesis StartAbsoluteValue upper Y EndAbsoluteValue Superscript q Baseline right parenthesis right parenthesis Superscript 1 divided by q Baseline EndFraction
Y
(E(|Y|q))1/q we have 
StartFraction 1 Over left parenthesis sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline right parenthesis right parenthesis Superscript 1 divided by p Baseline left parenthesis sans serif upper E left parenthesis StartAbsoluteValue upper Y EndAbsoluteValue Superscript q Baseline right parenthesis right parenthesis Superscript 1 divided by q Baseline EndFraction equals sans serif upper E left parenthesis StartAbsoluteValue upper X upper Y EndAbsoluteValue right parenthesis less than or slanted equals 1
1
(E(|X|p))1/p(E(|Y|q))1/q = E(|XY|) ⩽1
and the theorem is proved. 
█
Proof of Minkowski’s Inequality We ﬁrst prove that sans serif upper E left parenthesis StartAbsoluteValue upper X plus upper Y EndAbsoluteValue Superscript p Baseline right parenthesisE(|X + Y|p) is ﬁnite, for p greater than 1 periodp >
1. Let g left parenthesis x right parenthesis equals left parenthesis 1 plus x right parenthesis Superscript p Baseline minus 2 Superscript p minus 1 Baseline left parenthesis 1 plus x Superscript p Baseline right parenthesisg(x) = (1 + x)p −2p−1(1 + xp) and note that g left parenthesis 1 right parenthesis equals 0g(1) = 0 and max Underscript x element of double struck upper R Endscripts g left parenthesis x right parenthesis equals g left parenthesis 1 right parenthesis periodmaxx∈R g(x) =
g(1). Then, g left parenthesis x right parenthesis less than or slanted equals 0 periodg(x) ⩽0. Let x equals StartFraction StartAbsoluteValue upper Y EndAbsoluteValue Over StartAbsoluteValue upper X EndAbsoluteValue EndFractionx = |Y|
|X| and rewrite the last inequality: 
StartLayout 1st Row 1st Column StartFraction StartAbsoluteValue upper X plus upper Y EndAbsoluteValue Superscript p Baseline Over StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline EndFraction 2nd Column less than or slanted equals 3rd Column 2 Superscript p minus 1 Baseline left parenthesis StartFraction StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline plus StartAbsoluteValue upper Y EndAbsoluteValue Superscript p Baseline Over StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline EndFraction right parenthesis if and only if 2nd Row 1st Column StartAbsoluteValue upper X plus upper Y EndAbsoluteValue Superscript p 2nd Column less than or slanted equals 3rd Column 2 Superscript p minus 1 Baseline StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline plus StartAbsoluteValue upper Y EndAbsoluteValue Superscript p Baseline period EndLayout|X+Y|p
|X|p
⩽2p−1 ⎛
|X|p+|Y|p
|X|p
⎞
if and only if
|X + Y|p ⩽2p−1|X|p + |Y|p.
Taking expectation of both sides and using sans serif upper E left parenthesis StartAbsoluteValue upper X plus upper Y EndAbsoluteValue Superscript p Baseline right parenthesis less than normal infinityE(|X + Y|p) < ∞we are done. Now, 
let q equals StartFraction p Over p minus 1 EndFractionq =
p
p−1 so that StartFraction 1 Over p EndFraction plus StartFraction 1 Over q EndFraction equals 1 period 1
p + 1
q = 1. Then, apply twice the Hölder’s inequality, ﬁrst to 
X and StartAbsoluteValue upper X plus upper Y EndAbsoluteValue Superscript p minus 1|X + Y|p−1 and then to Y and to StartAbsoluteValue upper X plus upper Y EndAbsoluteValue Superscript p minus 1 Baseline comma|X + Y|p−1, we get sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue StartAbsoluteValue upper X plus upper Y EndAbsoluteValue Superscript p minus 1 Baseline right parenthesis less than or slanted equals left parenthesis sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline right parenthesis right parenthesis Superscript 1 divided by p Baseline left parenthesis sans serif upper E left parenthesis StartAbsoluteValue upper X plus upper Y EndAbsoluteValue Superscript p Baseline right parenthesis right parenthesis Superscript 1 divided by qE(|X||X + Y|p−1) ⩽
(E(|X|p))1/p(E(|X + Y|p))1/q and sans serif upper E left parenthesis StartAbsoluteValue upper Y EndAbsoluteValue StartAbsoluteValue upper X plus upper Y EndAbsoluteValue Superscript p minus 1 Baseline right parenthesis less than or slanted equals left parenthesis sans serif upper E left parenthesis StartAbsoluteValue upper Y EndAbsoluteValue Superscript p Baseline right parenthesis right parenthesis Superscript 1 divided by p Baseline left parenthesis sans serif upper E left parenthesis StartAbsoluteValue upper X plus upper Y EndAbsoluteValue Superscript p Baseline right parenthesis right parenthesis Superscript 1 divided by q Baseline periodE(|Y||X + Y|p−1) ⩽(E(|Y|p))1/p(E(|X +
Y|p))1/q. But StartAbsoluteValue upper X plus upper Y EndAbsoluteValue Superscript p Baseline equals StartAbsoluteValue upper X plus upper Y EndAbsoluteValue StartAbsoluteValue upper X plus upper Y EndAbsoluteValue Superscript p minus 1 Baseline less than or slanted equals StartAbsoluteValue upper X EndAbsoluteValue StartAbsoluteValue upper X plus upper Y EndAbsoluteValue Superscript p minus 1 Baseline plus StartAbsoluteValue upper Y EndAbsoluteValue StartAbsoluteValue upper X plus upper Y EndAbsoluteValue Superscript p minus 1 Baseline comma|X + Y|p = |X + Y||X + Y|p−1 ⩽|X||X + Y|p−1 + |Y||X + Y|p−1,
by the triangle inequality. Hence, we have 
sans serif upper E left parenthesis StartAbsoluteValue upper X plus upper Y EndAbsoluteValue Superscript p Baseline right parenthesis less than or slanted equals left parenthesis sans serif upper E left parenthesis StartAbsoluteValue upper X plus upper Y EndAbsoluteValue right parenthesis right parenthesis Superscript 1 divided by q Baseline left parenthesis left parenthesis sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline right parenthesis right parenthesis Superscript 1 divided by p Baseline left parenthesis sans serif upper E left parenthesis StartAbsoluteValue upper Y EndAbsoluteValue Superscript p Baseline right parenthesis right parenthesis Superscript 1 divided by p Baseline right parenthesisE(|X + Y|p) ⩽(E(|X + Y|))1/q(
(E(|X|p))1/p(E(|Y|p))1/p)
and dividing by left parenthesis sans serif upper E left parenthesis StartAbsoluteValue upper X plus upper Y EndAbsoluteValue right parenthesis right parenthesis Superscript 1 divided by q(E(|X + Y|))1/q inequality (4.15) is proved. 
█
The Covariance Matrix Is Semi-deﬁnite Positive 
From formula (4.22), it follows the covariance matrix is semi-deﬁnite positive: 
StartLayout 1st Row sigma summation Underscript i equals 1 Overscript n Endscripts sigma summation Underscript j equals 1 Overscript n Endscripts a Subscript i Baseline a Subscript j Baseline sans serif c o v left parenthesis upper X Subscript i Baseline comma upper X Subscript j Baseline right parenthesis equals sans serif c o v left parenthesis sigma summation Underscript i equals 1 Overscript n Endscripts a Subscript i Baseline upper X Subscript i Baseline comma sigma summation Underscript j equals 1 Overscript n Endscripts a Subscript j Baseline upper X Subscript j Baseline right parenthesis equals sans serif upper V left parenthesis sigma summation Underscript i equals 1 Overscript n Endscripts a Subscript i Baseline upper X Subscript i Baseline right parenthesis greater than or slanted equals 0 period EndLayout
n
⎲
i=1
n
⎲
j=1
aiajcov(Xi, Xj) = cov
⎛
n
⎲
i=1
aiXi,
n
⎲
j=1
ajXj
⎞
= V
⎛
n
⎲
i=1
aiXi
⎞
⩾0.
(4.31) 
In matrix notation: bold italic a bold italic upper C bold italic a Superscript bold prime Baseline greater than or slanted equals 0aCa' ⩾0, for every bold italic a element of double struck upper R Superscript na ∈Rn. Recall that every element of double struck upper R Superscript nRn is 
indeed a row vector, i.e. an 1 times n1×n matrix. Notation bold italic a primea' means transposition,34 yielding 
a column vector, i.e. a n times 1n × 1 matrix. Notation bold italic a bold italic upper CaC means matrix multiplication,
34 For a m times nm × n matrix bold italic upper AA, its transpose is the n times mn × m matrix bold italic upper A primeA'. 
134
4
Moments and the Alike
yielding a left parenthesis 1 times n right parenthesis left parenthesis n times n right parenthesis equals 1 times n(1 × n)(n × n) = 1 × n matrix (a row vector). Hence, bold italic a bold italic upper C bold italic a bold primeaCa' is a 1 times 11 × 1
matrix, i.e. a scalar whose algebraic expression is given by (4.31). 
Some Results on Measure-Theoretic Expectation 
Recall that a simple rv is of the form upper X equals sigma summation Underscript i equals 1 Overscript n Endscripts x Subscript i Baseline bold upper I Subscript left brace upper X element of upper B Sub Subscript i Subscript right braceX = ∑n
i=1 xiI{X∈Bi}, with left brace upper X element of upper B Subscript i Baseline right brace{X ∈Bi}
partitioning upper OmegaΩ, i.e. a discrete rv with ﬁnite values by setting left brace upper X element of upper B Subscript i Baseline right brace equals left brace upper X equals x Subscript i Baseline right brace{X ∈Bi} = {X = xi}
for upper B Subscript i Baseline equals StartSet x Subscript i Baseline EndSetBi = {xi}. It can be show that sums of simple rvs, products of constants by 
simple rvs are also simple rvs, see Exercise 5.11. We have:  
Lemma 4.3 (Limit of Increasing Simple Rvs) Suppose upper X greater than or slanted equals 0X ⩾0 is a nonnegative 
rv. Then, there exists an increasing sequence upper X 1 less than or slanted equals upper X 2 less than or slanted equals upper X 3 less than or slanted equals midline horizontal ellipsisX1 ⩽X2 ⩽X3 ⩽· · · of simple rvs 
which are nonnegative and converge pointwise to upper X periodX.
Remark 4.9 We can deﬁne a measurable map upper X Subscript n Baseline colon upper Omega right arrow double struck upper RXn : Ω →R for every n element of double struck upper N comman ∈N, then 
obtaining a sequence left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Xn)n∈N of rvs. For each omega element of upper Omegaω ∈Ω the set 
StartSet upper X 1 left parenthesis omega right parenthesis comma upper X 2 left parenthesis omega right parenthesis comma ellipsis EndSet equals StartSet x 1 comma x 2 comma ellipsis EndSet{X1(ω), X2(ω), . . .} = {x1, x2, . . .}
is an inﬁnite sequence of real numbers. If limit Underscript n right arrow normal infinity Endscripts x Subscript n Baseline equals xlimn→∞xn = x, then the number x 
corresponds to scenario omega element of upper Omegaω ∈Ω. It might happen that for any other scenario the 
above limit exists but in general it is not equal to the same number x. Thus, we have 
a function that to each omegaω attaches a number given by a limit. In this case the sequence 
left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Xn)n∈N is said to converge pointwise to the limit function upper X colon upper Omega right arrow double struck upper R periodX : Ω →R. Namely, 
for all omega element of upper Omega∀ω ∈Ω and for all epsilon greater than 0 comma∀ϵ > 0, there exists a positive integer N such that n greater than or slanted equals upper Nn ⩾N implies 
StartAbsoluteValue upper X Subscript n Baseline left parenthesis omega right parenthesis minus upper X left parenthesis omega right parenthesis EndAbsoluteValue less than epsilon period|Xn(ω) −X(ω)| < ϵ. It can be shown that the random function X is  also a rv.  
To prove Lemma 4.3, we provide an increasing sequences of discrete rvs for the 
pointwise convergence: 
upper X Subscript n Baseline colon equals sigma summation Underscript i equals 1 Overscript n 2 Superscript n Baseline Endscripts StartFraction i minus 1 Over 2 Superscript n Baseline EndFraction bold upper I Subscript left brace StartFraction i minus 1 Over 2 Sub Superscript n Subscript EndFraction less than upper X less than or slanted equals StartFraction i Over 2 Sub Superscript n Subscript EndFraction right brace Baseline plus n bold upper I Subscript left brace upper X greater than n right brace Baseline periodXn :=
n2n
⎲
i=1
i−1
2n I{ i−1
2n <X⩽i
2n
} + nI{X>n}.
(4.32) 
It approximates X from below. It is worth noting that we have n 2 Superscript nn2n terms in the sum 
and a left parenthesis n 2 Superscript n Baseline plus 1 right parenthesis(n2n + 1)th term outside it. To ﬁgure out the behavior of such a sequence, we 
display the ﬁrst two terms: 
StartLayout 1st Row 1st Column upper X 1 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript 2 Endscripts StartFraction i minus 1 Over 2 EndFraction bold upper I Subscript left brace StartFraction i minus 1 Over 2 EndFraction less than upper X less than or slanted equals StartFraction i Over 2 EndFraction right brace plus bold upper I Subscript left brace upper X greater than 1 right brace 2nd Row 1st Column Blank 2nd Column equals 3rd Column 0 plus one half bold upper I Subscript left brace one half less than upper X less than or slanted equals 1 right brace plus bold upper I Subscript left brace upper X greater than 1 right brace EndLayoutX1 =
2
⎲
i=1
i−1
2 I{ i−1
2 <X⩽i
2
} + I{X>1}
= 0 + 1
2I{ 1
2 <X⩽1
} + I{X>1}
Appendix
135
upper X 2 equals sigma summation Underscript i equals 1 Overscript 2 times 2 squared Endscripts StartFraction i minus 1 Over 2 squared EndFraction bold upper I Subscript left brace StartFraction i minus 1 Over 2 squared EndFraction less than upper X less than or slanted equals StartFraction i Over 2 squared EndFraction right brace Baseline plus 2 bold upper I Subscript left brace upper X greater than 2 right brace Baseline equals StartLayout Enlarged left brace 1st Row 1st Column 0 2nd Column if i equals 1 and upper X is on left parenthesis 0 comma one fourth right bracket 2nd Row 1st Column one fourth 2nd Column if i equals 2 and upper X is on left parenthesis one fourth comma one half right bracket 3rd Row 1st Column one half 2nd Column if i equals 3 and upper X is on left parenthesis one half comma three fourths right bracket 4th Row 1st Column vertical ellipsis 2nd Column vertical ellipsis 5th Row 1st Column seven fourths 2nd Column if i equals 8 and upper X is on left parenthesis seven fourths comma 2 right bracket 6th Row 1st Column 2 2nd Column at stage 2 times 2 squared plus 1 equals 9 and upper X is on left parenthesis 2 comma normal infinity right parenthesis period EndLayoutX2 =
2×22
⎲
i=1
i−1
22 I{ i−1
22 <X⩽i
22
}+2I{X>2} =
⎧
⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨
⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎩
0
if i = 1 and X is on (0, 1
4]
1
4
if i = 2 and X is on ( 1
4, 1
2]
1
2
if i = 3 and X is on ( 1
2, 3
4]
...
...
7
4
if i = 8 and X is on ( 7
4, 2]
2
at stage 2 × 22 + 1 = 9 and X is on (2, ∞).
This construction yields the following consequences. 
• 
For ﬁxed n element of double struck upper Nn ∈N the above nonnegative simple rv is based on a n 2 Superscript n plus 1n2n + 1-fold 
partition of the positive half-axe left bracket 0 comma normal infinity right parenthesis[0, ∞), into  n 2 Superscript nn2n intervals left parenthesis StartFraction i minus 1 Over 2 Superscript n Baseline EndFraction comma StartFraction i Over 2 Superscript n Baseline EndFraction right bracket( i−1
2n , i
2n ] of equal 
length StartFraction 1 Over 2 Superscript n Baseline EndFraction 1
2n , for i equals 1 comma ellipsis comma n 2 Superscript ni = 1, . . . , n2n, and a last interval left parenthesis StartFraction n 2 Superscript n Baseline Over 2 Superscript n Baseline EndFraction comma normal infinity right parenthesis( n2n
2n , ∞). 
• 
For every scenario omegaω, the upper X Subscript n Baseline left parenthesis omega right parenthesisXn(ω)’s values are StartFraction i minus 1 Over 2 Superscript n Baseline EndFraction i−1
2n for i equals 1 comma ellipsis comma n 2 Superscript n Baseline plus 1i = 1, . . . , n2n + 1 i.e. they 
are the left-hand points of left parenthesis StartFraction i minus 1 Over 2 Superscript n Baseline EndFraction comma StartFraction i Over 2 Superscript n Baseline EndFraction right bracket( i−1
2n , i
2n ] over the ﬁrst n 2 Superscript nn2n intervals, with the addition 
of the value StartFraction n 2 Superscript n Baseline Over 2 Superscript n Baseline EndFraction equals n n2n
2n = n over the last interval. 
• 
Incrementing n bisects each interval, in particular passing from n to n plus 1n + 1 yields 
left parenthesis StartFraction i minus 1 Over 2 Superscript n Baseline EndFraction comma StartFraction i Over 2 Superscript n Baseline EndFraction right bracket( i−1
2n , i
2n ] divided into two halves of length StartStartFraction StartFraction 1 Over 2 Superscript n Baseline EndFraction OverOver 2 EndEndFraction equals StartFraction 1 Over 2 Superscript n plus 1 Baseline EndFraction
1
2n
2 =
1
2n+1 . 
• 
.Xn+1(ω) = i−1
2n = Xn(ω) or upper X Subscript n plus 1 Baseline left parenthesis omega right parenthesis equals StartFraction i Over 2 Superscript n Baseline EndFraction minus StartFraction 1 Over 2 Superscript n plus 1 Baseline EndFraction equals StartFraction 2 i minus 1 Over 2 Superscript n plus 1 Baseline EndFractionXn+1(ω) =
i
2n −
1
2n+1 = 2 i−1
2n+1 , for every scenario. 
• 
Since StartFraction i minus 1 Over 2 Superscript n Baseline EndFraction equals StartFraction 2 left parenthesis i minus 1 right parenthesis Over 2 Superscript n plus 1 Baseline EndFraction i−1
2n
= 2 (i−1)
2n+1
we have upper X Subscript n Baseline left parenthesis omega right parenthesis less than or slanted equals upper X Subscript n plus 1 Baseline left parenthesis omega right parenthesisXn(ω) ⩽Xn+1(ω), for every scenario; moreover 
upper X Subscript n Baseline left parenthesis omega right parenthesis less than or slanted equals upper X left parenthesis omega right parenthesisXn(ω) ⩽X(ω) for every omegaω. 
• 
For n right arrow normal infinityn →∞each interval collapses to a single value x equals upper X left parenthesis omega right parenthesisx = X(ω). 
Thus we have proved 0 less than or slanted equals upper X 1 less than or slanted equals upper X 2 less than or slanted equals midline horizontal ellipsis less than or slanted equals upper X0 ⩽X1 ⩽X2 ⩽· · · ⩽X and limit Underscript n right arrow normal infinity Endscripts upper X Subscript n Baseline equals upper Xlimn→∞Xn = X pointwise. A 
general deﬁnition of expectation is valid for every kind of rv X and is based on the 
notion of abstract Lebesgue integral, see Appendix N. 
1. Let upper X Subscript nXn be a simple rv for any n element of double struck upper Nn ∈N. Then, we deﬁne sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis equals sigma summation Underscript i equals 1 Overscript m Endscripts x Subscript i n Baseline sans serif upper P left parenthesis upper X Subscript n Baseline element of upper B Subscript i m Baseline right parenthesisE(Xn) = ∑m
i=1 xinP(Xn ∈
Bim) and denote it integral Underscript upper Omega Endscripts upper X Subscript n Baseline normal d sans serif upper P
 ⎨
Ω XndP, for m element of double struck upper Nm ∈N. 
2. For 
upper X greater than or slanted equals 0X
⩾
0, we use Lemma 4.3 to produce a sequence left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Xn)n∈N which 
approximates X from below, then deﬁne sans serif upper E left parenthesis upper X right parenthesisE(X) as limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesislimn→∞E(Xn). 
Up to this point, we need the following result for interchanging expectation and 
limits. 
Theorem 4.10 (Monotone Convergence Theorem (MCT)) Let left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Xn)n∈N be a 
sequence of nonnegative rvs and let X be any rv such that 0 less than or slanted equals upper X 1 less than or slanted equals upper X 2 less than or slanted equals midline horizontal ellipsis less than or slanted equals upper X period0 ⩽X1 ⩽X2 ⩽· · · ⩽X.
If the sequence converges pointwise to upper X commaX, then 
limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis equals sans serif upper E left parenthesis upper X right parenthesis period lim
n→∞E(Xn) = E(X).
Comparing with Lemma 4.3, we do not necessarily use simple rvs.
136
4
Moments and the Alike
Proof Assuming pointwise convergence upper X Subscript n Baseline right arrow upper XXn →X, we have  X is a rv. Furthermore, 
sans serif upper E left parenthesis upper X 1 right parenthesis less than or slanted equals sans serif upper E left parenthesis upper X 2 right parenthesis less than or slanted equals midline horizontal ellipsis less than or slanted equals sans serif upper E left parenthesis upper X right parenthesisE(X1) ⩽E(X2) ⩽· · · ⩽E(X) by assumption. Hence, limit Underscript n Endscripts sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis less than or slanted equals sans serif upper E left parenthesis upper X right parenthesislimn E(Xn) ⩽E(X). 
It sufﬁces to show the converse inequality. The case sans serif upper E left parenthesis upper X 1 right parenthesis equals normal infinityE(X1) = ∞is trivial, then 
we assume sans serif upper E left parenthesis upper X 1 right parenthesis less than normal infinityE(X1) < ∞. By formula  (4.33) we can approximate sans serif upper E left parenthesis upper X right parenthesisE(X) by the 
expectation of a nonnegative simple rv upper Z equals sigma summation Underscript i equals 1 Overscript m Endscripts z Subscript i Baseline bold upper I Subscript upper A Sub Subscript iZ = ∑m
i=1 ziIAi such that upper Z less than or slanted equals upper XZ ⩽X. The  
latter condition means that z Subscript i Baseline less than or slanted equals upper X left parenthesis omega right parenthesiszi ⩽X(ω) for every omega element of upper A Subscript iω ∈Ai. Let us show that 
limit Underscript n Endscripts sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis greater than or slanted equals sigma summation Underscript i equals 1 Overscript m Endscripts z Subscript i Baseline sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesislimn E(Xn) ⩾∑m
i=1 ziP(Ai). Pick epsilon greater than 0 commaϵ > 0, deﬁne upper A Subscript i n Baseline equals StartSet omega element of upper A Subscript i Baseline vertical bar upper X Subscript n Baseline left parenthesis omega right parenthesis greater than z Subscript i Baseline minus epsilon EndSetAin = {ω ∈Ai | Xn(ω) > zi −ϵ}
and observe that upper A Subscript i n Baseline up arrow upper A Subscript iAin ↑Ai as n right arrow normal infinityn →∞. Furthermore, sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis greater than or slanted equals sigma summation Underscript i equals 1 Overscript m Endscripts left parenthesis z Subscript i Baseline minus epsilon right parenthesis sans serif upper P left parenthesis upper A Subscript i n Baseline right parenthesisE(Xn) ⩾∑m
i=1(zi −ϵ)P(Ain). 
By continuity from below we have 
limit Underscript n right arrow normal infinity Endscripts left parenthesis z Subscript i Baseline minus epsilon right parenthesis sans serif upper P left parenthesis upper A Subscript i n Baseline right parenthesis equals left parenthesis z Subscript i Baseline minus epsilon right parenthesis sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis comma lim
n→∞(zi −ϵ)P(Ain) = (zi −ϵ)P(Ai),
which implies limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis greater than or slanted equals sigma summation Underscript i equals 1 Overscript m Endscripts left parenthesis z Subscript i Baseline minus epsilon right parenthesis sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis equals sigma summation Underscript i equals 1 Overscript m Endscripts z Subscript i Baseline sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis minus epsilonlimn→∞E(Xn) ⩾∑m
i=1(zi −ϵ)P(Ai) = ∑m
i=1 ziP(Ai) −ϵ. Since 
epsilon greater than 0ϵ > 0 is arbitrary it follows limit Underscript n Endscripts sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis greater than or slanted equals sigma summation Underscript i equals 1 Overscript m Endscripts z Subscript i Baseline sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesislimn E(Xn) ⩾∑m
i=1 ziP(Ai) and we are done. 
█
Remark 4.10 In the proof of Theorem 4.10 we used the following fact. Let a comma b element of double struck upper Ra, b ∈
R such that a less than or slanted equals b plus epsilona ⩽b + ϵ, and epsilon greater than 0ϵ > 0, then a less than or slanted equals ba ⩽b. The proof runs by contradiction: 
assume a less than or slanted equals b plus epsilona ⩽b + ϵ and normal not sign left parenthesis a less than or slanted equals b right parenthesis equals a greater than b¬(a ⩽b) = a > b. But choosing epsilon equals StartFraction a minus b Over 2 EndFraction greater than 0ϵ = a−b
2
> 0 we arrive to 
a greater than b plus epsilona > b + ϵ, which contradicts the assumption. 
Remark 4.11 Recall that any increasing sequence of real numbers may have a 
ﬁnite supremum, which is the limit of the sequence. Thus: 
sans serif upper E left parenthesis upper X right parenthesis colon equals sup left brace sans serif upper E left parenthesis upper Z right parenthesis colon 0 less than or slanted equals upper Z less than or slanted equals upper X comma upper Z simple right brace identify upper Z identical to upper X Subscript n Baseline periodE(X) := sup
{
E(Z): 0 ⩽Z ⩽X, Z simple
}
identify Z ≡Xn.
(4.33) 
Here, the increasing sequence of real numbers is left parenthesis sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis right parenthesis Subscript n element of double struck upper N(E(Xn))n∈N and its supremum 
entails sans serif upper E left parenthesis upper X right parenthesisE(X) for upper X greater than or slanted equals 0X ⩾0. The  set  left brace sans serif upper E left parenthesis upper Z right parenthesis colon 0 less than or slanted equals upper Z less than or slanted equals upper X comma upper Z simple right brace
{
E(Z): 0 ⩽Z ⩽X, Z simple
}
is of the form 
left bracket 0 comma x right parenthesis[0, x) or left bracket 0 comma x right bracket comma[0, x], where x equals normal infinityx = ∞is allowed. 
Now, step 2 reads: 
limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis equals sans serif upper E left parenthesis limit Underscript n right arrow normal infinity Endscripts upper X Subscript n Baseline right parenthesis equals sans serif upper E left parenthesis upper X right parenthesis comma lim
n→∞E(Xn) = E
⎛
lim
n→∞Xn
⎞
= E(X),
i.e. expectation and limits can be exchanged. 
3. For a rv X not necessarily greater than or slanted equals 0 comma⩾0, we decompose upper X equals upper X Superscript plus Baseline minus upper X Superscript minusX = X+−X−and by Lemma 4.3 
we always ﬁnd two sequences of nonnegative rvs left parenthesis upper X Subscript n Superscript plus Baseline right parenthesis Subscript n element of double struck upper N(X+
n )n∈N and left parenthesis upper X Subscript n Superscript minus Baseline right parenthesis Subscript n element of double struck upper N(X−
n )n∈N s.t. 
limit Underscript n right arrow normal infinity Endscripts upper X Subscript n Superscript plus Baseline equals upper X Superscript pluslimn→∞X+
n = X+ and limit Underscript n right arrow normal infinity Endscripts upper X Subscript n Superscript minus Baseline equals upper X Superscript minuslimn→∞X−
n = X−, pointwise. If both expectations 
sans serif upper E left parenthesis upper X Superscript plus Baseline right parenthesisE(X+) and sans serif upper E left parenthesis upper X Superscript minus Baseline right parenthesisE(X−) are ﬁnite we can deﬁne: 
StartLayout 1st Row integral Underscript upper Omega Endscripts upper X normal d sans serif upper P equals sans serif upper E left parenthesis upper X right parenthesis colon equals sans serif upper E left parenthesis upper X Superscript plus Baseline right parenthesis minus sans serif upper E left parenthesis upper X Superscript minus Baseline right parenthesis equals integral Underscript upper Omega Endscripts upper X Superscript plus Baseline normal d sans serif upper P minus integral Underscript upper Omega Endscripts upper X Superscript minus Baseline normal d sans serif upper P less than normal infinity period EndLayout
 ⎨
Ω
XdP = E(X) := E(X+) −E(X−) =
 ⎨
Ω
X+dP −
 ⎨
Ω
X−dP < ∞.
(4.34) 
When the expectation of either upper X Superscript plusX+ or upper X Superscript minusX−is inﬁnite we have sans serif upper E left parenthesis upper X right parenthesis equals plus or minus normal infinity semicolonE(X) = ±∞; when 
both equal inﬁnity we no longer can deﬁne sans serif upper E left parenthesis upper X right parenthesisE(X).
Appendix
137
Remark 4.12 We have seen that formulae (4.1) and (4.2) in Sect. 4.2, for expected 
values of discrete and continuous rvs use sufﬁcient conditions of absolute con-
vergence (either sum or integral). In fact, in the current general setting we have 
StartAbsoluteValue upper X EndAbsoluteValue equals upper X Superscript plus Baseline plus upper X Superscript minus|X| = X+ + X−, then: 
• 
deﬁne sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue right parenthesis equals sans serif upper E left parenthesis upper X Superscript plus Baseline right parenthesis plus sans serif upper E left parenthesis upper X Superscript minus Baseline right parenthesisE(|X|) = E(X+) + E(X−) by formula (4.34) and assume it is ﬁnite. 
From upper X Superscript plus Baseline less than or slanted equals StartAbsoluteValue upper X EndAbsoluteValueX+ ⩽|X| and upper X Superscript minus Baseline less than or slanted equals StartAbsoluteValue upper X EndAbsoluteValueX−⩽|X| it follows both sans serif upper E left parenthesis upper X Superscript plus Baseline right parenthesis comma sans serif upper E left parenthesis upper X Superscript minus Baseline right parenthesisE(X+), E(X−) are ﬁnite so that 
sans serif upper E left parenthesis upper X right parenthesis less than normal infinityE(X) < ∞. 
• 
On the other hand, assume both sans serif upper E left parenthesis upper X Superscript plus Baseline right parenthesis comma sans serif upper E left parenthesis upper X Superscript minus Baseline right parenthesisE(X+), E(X−) are ﬁnite. Then summing and 
using linearity we get sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue right parenthesis less than normal infinityE(|X|) < ∞. 
Moral: absolute convergence sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue right parenthesis less than normal infinityE(|X|) < ∞is equivalent to existence of sans serif upper E left parenthesis upper X right parenthesis less than normal infinityE(X) < ∞. 
What we have learned is summarized below. 
• 
For ﬁxed n element of double struck upper Nn ∈N, expectation sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesisE(Xn) is the Lebesgue integral sigma summation Underscript i equals 1 Overscript n Endscripts x Subscript i Baseline sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis∑n
i=1 xi P(Ai), for  a  
simple rv upper X Subscript n Baseline equals sigma summation Underscript i equals 1 Overscript m Endscripts x Subscript i comma n Baseline bold upper I Subscript upper A Sub Subscript i Subscript nXn = ∑m
i=1 xi,nIAin where upper A Subscript i n Baseline equals left brace upper X Subscript n Baseline element of upper B Subscript i n Baseline right braceAin = {Xn ∈Bin} are events decomposing 
upper OmegaΩ. 
• 
Steps 2 and 3 yield a limiting procedure corresponding to a more reﬁned ‘version’ 
of a general rv X with more values in its support, and consequently a ‘reﬁned 
partition’ of upper OmegaΩ through an increasing number of events upper A Subscript iAi. As byproduct, an 
integration procedure is carried on upper OmegaΩ: the  abstract expectation integral Underscript upper Omega Endscripts upper X normal d sans serif upper P
 ⎨
Ω XdP is the 
Lebesgue integral of the measurable function X with respect to the measure sans serif upper PP. 
We have the extended change of variable formula 
integral Underscript upper Omega Endscripts upper X left parenthesis omega right parenthesis normal d sans serif upper P equals integral Underscript double struck upper R Endscripts x normal d sans serif upper P Subscript upper X Baseline equals integral Subscript negative normal infinity Superscript normal infinity Baseline x normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis comma
 ⎨
Ω
X(ω)dP =
 ⎨
R
xdPX =
 ⎨∞
−∞
xdFX(x),
(4.35) 
which also holds for transformation g left parenthesis upper X right parenthesisg(X). The precise statement follows.35 
Theorem 4.11 Let X be a rv with distribution sans serif upper P Subscript upper XPX and let g colon double struck upper R right arrow double struck upper Rg : R →R be a Borel-
measurable function. Then we have 
sans serif upper E left parenthesis g left parenthesis upper X right parenthesis right parenthesis equals integral Underscript double struck upper R Endscripts g left parenthesis x right parenthesis normal d sans serif upper P Subscript upper X Baseline commaE(g(X)) =
 ⎨
R
g(x)dPX,
(4.36) 
provided that both sides are well-deﬁned. 
By 1-to-1 correspondence between sans serif upper PP and CDF upper F Subscript upper XFX, via the law sans serif upper P Subscript upper XPX, for-
mula (4.36) extends formula (4.35). 
Proof First we check formula (4.36) for indicators g left parenthesis upper X right parenthesis equals bold upper I Subscript upper B Baseline left parenthesis upper X right parenthesis commag(X) = IB(X), where upper B element of script upper BB ∈B. 
We have integral Underscript upper Omega Endscripts bold upper I Subscript upper B Baseline left parenthesis upper X right parenthesis normal d sans serif upper P equals integral Underscript upper Omega Endscripts bold upper I Subscript left brace upper X element of upper B right brace Baseline normal d sans serif upper P equals sans serif upper E left parenthesis bold upper I Subscript left brace upper X element of upper B right brace Baseline right parenthesis equals sans serif upper P left parenthesis upper X element of upper B right parenthesis equals sans serif upper P Subscript upper X Baseline left parenthesis upper B right parenthesis equals integral Underscript double struck upper R Endscripts bold upper I Subscript upper B Baseline left parenthesis x right parenthesis normal d sans serif upper P Subscript upper X Baseline
 ⎨
Ω IB(X)dP =
 ⎨
Ω I{X∈B}dP = E(I{X∈B}) = P(X ∈B) = PX(B) =
 ⎨
R IB(x)dPX. By linearity, formula (4.36) holds for simple rvs g left parenthesis upper X right parenthesisg(X). If  g left parenthesis upper X right parenthesisg(X) is
35 Recall that g ring upper Xg ◦X is a rv, provided X is a rv and g is Borel-measurable. 
138
4
Moments and the Alike
any rv, then we apply MCT to both g left parenthesis upper X right parenthesis Superscript plusg(X)+ and g left parenthesis upper X right parenthesis Superscript minusg(X)−as follows: 
StartLayout 1st Row 1st Column integral Underscript upper Omega Endscripts g left parenthesis upper X right parenthesis normal d sans serif upper P 2nd Column equals 3rd Column integral Underscript upper Omega Endscripts limit Underscript n Endscripts left parenthesis g Subscript n Superscript plus Baseline left parenthesis upper X right parenthesis minus g Subscript n Superscript plus Baseline left parenthesis upper X right parenthesis right parenthesis normal d sans serif upper P 2nd Row 1st Column Blank 2nd Column equals 3rd Column limit Underscript n Endscripts integral Underscript upper Omega Endscripts g Subscript n Superscript plus Baseline left parenthesis upper X right parenthesis normal d sans serif upper P minus limit Underscript n Endscripts integral Underscript upper Omega Endscripts g Subscript n Superscript minus Baseline left parenthesis upper X right parenthesis normal d sans serif upper P 3rd Row 1st Column Blank 2nd Column equals 3rd Column limit Underscript n Endscripts integral Underscript double struck upper R Endscripts g Subscript n Superscript plus Baseline left parenthesis x right parenthesis normal d sans serif upper P Subscript upper X minus limit Underscript n Endscripts integral Underscript double struck upper R Endscripts g Subscript n Superscript minus Baseline left parenthesis x right parenthesis normal d sans serif upper P Subscript upper X 4th Row 1st Column Blank 2nd Column equals 3rd Column integral Underscript double struck upper R Endscripts limit Underscript n Endscripts left parenthesis g Subscript n Superscript plus Baseline left parenthesis x right parenthesis minus g Subscript n Superscript plus Baseline left parenthesis x right parenthesis right parenthesis normal d sans serif upper P Subscript upper X 5th Row 1st Column Blank 2nd Column equals 3rd Column integral Underscript double struck upper R Endscripts left parenthesis g Superscript plus Baseline left parenthesis x right parenthesis minus g Superscript minus Baseline left parenthesis x right parenthesis right parenthesis normal d sans serif upper P Subscript upper X Baseline equals integral Underscript double struck upper R Endscripts g left parenthesis x right parenthesis normal d sans serif upper P Subscript upper X Baseline comma EndLayout
 ⎨
Ω
g(X)dP =
 ⎨
Ω
lim
n (g+
n (X) −g+
n (X))dP
= lim
n
 ⎨
Ω
g+
n (X)dP −lim
n
 ⎨
Ω
g−
n (X)dP
= lim
n
 ⎨
R
g+
n (x)dPX −lim
n
 ⎨
R
g−
n (x)dPX
=
 ⎨
R
lim
n (g+
n (x) −g+
n (x))dPX
=
 ⎨
R
(g+(x) −g−(x))dPX =
 ⎨
R
g(x)dPX,
where g Subscript n Superscript plus Baseline left parenthesis upper X right parenthesis up arrow g Superscript plus Baseline left parenthesis upper X right parenthesis comma g Subscript n Superscript minus Baseline left parenthesis upper X right parenthesis up arrow g Superscript minus Baseline left parenthesis upper X right parenthesisg+
n (X) ↑g+(X), g−
n (X) ↑g−(X) pointwise as n right arrow normal infinityn →∞and g Subscript n Superscript plus Baseline left parenthesis upper X right parenthesis comma g Subscript n Superscript minus Baseline left parenthesis upper X right parenthesisg+
n (X), g−
n (X)
are simple rvs. 
█
There is a connection between the aforementioned approach to expectation and 
Stieltjes integration. Choosing left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Xn)n∈N in MCT as deﬁned by (4.32), we have 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis sigma summation Underscript i equals 1 Overscript n 2 Superscript n Baseline Endscripts StartFraction i minus 1 Over 2 Superscript n Baseline EndFraction bold upper I Subscript left brace StartFraction i minus 1 Over 2 Sub Superscript n Subscript EndFraction less than upper X less than or slanted equals StartFraction i Over 2 Sub Superscript n Subscript EndFraction right brace Baseline plus n bold upper I Subscript left brace upper X greater than n right brace Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript n 2 Superscript n Baseline Endscripts StartFraction i minus 1 Over 2 Superscript n Baseline EndFraction sans serif upper P left parenthesis StartFraction i minus 1 Over 2 Superscript n Baseline EndFraction less than upper X less than or slanted equals StartFraction i Over 2 Superscript n Baseline EndFraction right parenthesis plus n sans serif upper P left parenthesis upper X greater than n right parenthesis period EndLayoutE(Xn) = E
⎛
⎝
n2n
⎲
i=1
i−1
2n I{ i−1
2n <X⩽i
2n
} + nI{X>n}
⎞
⎠
=
n2n
⎲
i=1
i−1
2n P
⎛
i−1
2n < X ⩽
i
2n
⎞
+ nP(X > n).
Observe that sans serif upper P left parenthesis StartFraction i minus 1 Over 2 Superscript n Baseline EndFraction less than upper X less than or slanted equals StartFraction i Over 2 Superscript n Baseline EndFraction right parenthesis equals sans serif upper P left parenthesis upper X Subscript n Baseline equals StartFraction i minus 1 Over 2 Superscript n Baseline EndFraction right parenthesisP
⎛
i−1
2n < X ⩽
i
2n
⎞
= P
⎛
Xn = i−1
2n
⎞
, and recall it equals upper F Subscript upper X Baseline left parenthesis StartFraction i Over 2 Superscript n Baseline EndFraction right parenthesis minus upper F Subscript upper X Baseline left parenthesis StartFraction i minus 1 Over 2 Superscript n Baseline EndFraction right parenthesisFX( i
2n ) −
FX( i−1
2n ), for every i equals 1 comma ellipsis comma n 2 Superscript ni = 1, . . . , n2n and each n element of double struck upper Nn ∈N. Eventually, by MCT: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X right parenthesis 2nd Column equals 3rd Column limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis equals limit Underscript n right arrow normal infinity Endscripts sigma summation Underscript i equals 1 Overscript n 2 Superscript n Baseline Endscripts StartFraction i minus 1 Over 2 Superscript n Baseline EndFraction left bracket upper F Subscript upper X Baseline left parenthesis StartFraction i Over 2 Superscript n Baseline EndFraction right parenthesis minus upper F Subscript upper X Baseline left parenthesis StartFraction i minus 1 Over 2 Superscript n Baseline EndFraction right parenthesis right bracket 2nd Row 1st Column Blank 2nd Column plus 3rd Column limit Underscript n right arrow normal infinity Endscripts n sans serif upper P left parenthesis upper X greater than n right parenthesis period EndLayoutE(X) = lim
n→∞E(Xn) = lim
n→∞
n2n
⎲
i=1
i−1
2n
⎾
FX( i
2n ) −FX( i−1
2n )
⏋
+ lim
n→∞n P(X > n).
Now, we have 2 cases: 
• 
If sans serif upper P left parenthesis upper X equals normal infinity right parenthesis greater than 0 commaP(X = ∞) > 0, then the limit is sans serif upper E left parenthesis upper X right parenthesis equals normal infinity semicolonE(X) = ∞;
• 
If sans serif upper P left parenthesis upper X less than normal infinity right parenthesis equals 1 commaP(X < ∞) = 1, then the limit sans serif upper E left parenthesis upper X right parenthesisE(X) is ﬁnite and writes 
sans serif upper E left parenthesis upper X right parenthesis equals limit Underscript n right arrow normal infinity Endscripts sigma summation Underscript i equals 1 Overscript n 2 Superscript n Baseline Endscripts StartFraction i minus 1 Over 2 Superscript n Baseline EndFraction left bracket upper F Subscript upper X Baseline left parenthesis StartFraction i Over 2 Superscript n Baseline EndFraction right parenthesis minus upper F Subscript upper X Baseline left parenthesis StartFraction i minus 1 Over 2 Superscript n Baseline EndFraction right parenthesis right bracket colon equals integral Subscript 0 Superscript normal infinity Baseline x normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis commaE(X) = lim
n→∞
n2n
⎲
i=1
i−1
2n
⎾
FX( i
2n ) −FX( i−1
2n )
⏋
:=
 ⎨∞
0
x dFX(x),
(4.37) 
where se used limit Underscript n right arrow normal infinity Endscripts n sans serif upper P left parenthesis upper X greater than n right parenthesis equals 0limn→∞n P(X > n) = 0, see Exercise 5.10.
Appendix
139
The Stieltjes integral in (4.37) can be formally given by limit Underscript k right arrow normal infinity Endscripts integral Subscript 0 Superscript k Baseline g left parenthesis x right parenthesis normal d upper F left parenthesis x right parenthesislimk→∞
 ⎨k
0 g(x)dF(x), for  
k greater than 0k > 0. Here we recall typical properties of the integral. 
• 
(Linearity in the integrand) integral Subscript 0 Superscript normal infinity Baseline left bracket g left parenthesis x right parenthesis plus h left parenthesis x right parenthesis right bracket normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis equals integral Subscript 0 Superscript normal infinity Baseline g left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis plus integral Subscript 0 Superscript normal infinity Baseline h left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis
 ⎨∞
0 [g(x) + h(x)]dFX(x) =
 ⎨∞
0
g(x)dFX(x) +
 ⎨∞
0
h(x)dFX(x), provided that the latter integral is also ﬁnite and g comma hg, h are 
two suitable transformation of the rv X. In particular, integral Subscript 0 Superscript normal infinity Baseline k g left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis equals k integral Subscript 0 Superscript normal infinity Baseline g left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis
 ⎨∞
0
kg(x)dFX(x) =
k
 ⎨∞
0
g(x)dFX(x), for k element of double struck upper Rk ∈R. 
• 
(Linearity in the measure) For mixed CDFs upper F 1 left parenthesis x right parenthesis plus left parenthesis 1 minus alpha right parenthesis upper F 2 left parenthesis x right parenthesisF1(x)+(1−α)F2(x), with 0 less than or slanted equals alpha less than or slanted equals 10 ⩽α ⩽
1, we have  
StartLayout 1st Row 1st Column integral Subscript 0 Superscript normal infinity Baseline g left parenthesis x right parenthesis normal d left parenthesis alpha upper F Subscript upper X 1 Baseline left parenthesis x right parenthesis plus left parenthesis 1 minus alpha right parenthesis upper F Subscript upper X 2 Baseline left parenthesis x right parenthesis right parenthesis 2nd Column equals 3rd Column alpha integral Subscript 0 Superscript normal infinity Baseline g left parenthesis x right parenthesis normal d upper F Subscript upper X 1 Baseline left parenthesis x right parenthesis 2nd Row 1st Column Blank 2nd Column plus 3rd Column left parenthesis 1 minus alpha right parenthesis integral Subscript 0 Superscript normal infinity Baseline g left parenthesis x right parenthesis normal d upper F Subscript upper X 2 Baseline left parenthesis x right parenthesis comma EndLayout
 ⎨∞
0
g(x)d
(
αFX1(x) + (1 −α)FX2(x)
)
= α
 ⎨∞
0
g(x)dFX1(x)
+ (1 −α)
 ⎨∞
0
g(x)dFX2(x),
for two rvs upper X 1 comma upper X 2X1, X2. 
• 
If g left parenthesis x right parenthesis less than or slanted equals h left parenthesis x right parenthesisg(x) ⩽h(x) for every x, then integral Subscript 0 Superscript normal infinity Baseline g left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis less than or slanted equals integral Subscript 0 Superscript normal infinity Baseline h left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis
 ⎨∞
0
g(x)dFX(x) ⩽
 ⎨∞
0
h(x)dFX(x). 
• 
.
|| ⎨∞
0
g(x)dFX(x)
|| ⩽
 ⎨b
a |g(x)|dFX(x). 
• 
We can partition 
left parenthesis 0 comma normal infinity right parenthesis(0, ∞) in 
left parenthesis 0 comma y right bracket union left parenthesis y comma normal infinity right parenthesis(0, y] ∪(y, ∞) and get 
integral Subscript 0 Superscript y Baseline g left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis plus integral Subscript y Superscript normal infinity Baseline g left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis
 ⎨y
0 g(x)dFX(x) +
 ⎨∞
y
g(x)dFX(x), for 0 less than y less than normal infinity0 < y < ∞. 
All above properties can be extended to integral Subscript negative normal infinity Superscript normal infinity Baseline g left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis equals limit Underscript k right arrow normal infinity Endscripts integral Subscript negative k Superscript k Baseline g left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis
 ⎨∞
−∞g(x)dFX(x) = limk→∞
 ⎨k
−k g(x)
dFX(x). Stieltjes integration over ﬁnite intervals is indeed based on left-
open/right-closed intervals, i.e, computing integral Subscript a Superscript b Baseline g left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis
 ⎨b
a g(x)dFX(x), for real a less than ba < b, equals 
integral Underscript left parenthesis a comma b right bracket Endscripts g left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis
 ⎨
(a,b] g(x)dFX(x). In fact, upper F Subscript upper XFX is increasing right-continuous. For g left parenthesis x right parenthesis equals 1g(x) = 1, each 
x element of double struck upper Rx ∈R, we have:  
integral Underscript left parenthesis a comma b right bracket Endscripts normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis equals upper F Subscript upper X Baseline left parenthesis b right parenthesis minus upper F Subscript upper X Baseline left parenthesis a right parenthesis and integral Underscript left parenthesis a comma b right parenthesis Endscripts normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis equals upper F Subscript upper X Baseline left parenthesis b Superscript minus Baseline right parenthesis minus upper F Subscript upper X Baseline left parenthesis a right parenthesis period
 ⎨
(a,b]
dFX(x) = FX(b) −FX(a)
and
 ⎨
(a,b)
dFX(x) = FX(b−) −FX(a).
Given two CDFs upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x) and upper F Subscript upper Y Baseline left parenthesis x right parenthesisFY (x), corresponding to rvs upper X comma upper YX, Y, we have the  
following integration by parts formula: 
StartLayout 1st Row StartEnclose box upper F Subscript upper X Baseline left parenthesis b right parenthesis upper F Subscript upper Y Baseline left parenthesis b right parenthesis minus upper F Subscript upper X Baseline left parenthesis a right parenthesis upper F Subscript upper Y Baseline left parenthesis a right parenthesis equals integral Subscript a Superscript b Baseline upper F Subscript upper X Baseline left parenthesis x Superscript minus Baseline right parenthesis normal d upper F Subscript upper Y Baseline left parenthesis x right parenthesis plus integral Subscript a Superscript b Baseline upper F Subscript upper Y Baseline left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis comma EndEnclose EndLayout FX(b)FY (b) −FX(a)FY (a) =
 ⎨b
a
FX(x−)dFY (x) +
 ⎨b
a
FY (x)dFX(x),
(4.38) 
see [12, Prop 4.5]. As byproduct we also have 
upper F Subscript upper X Baseline left parenthesis x right parenthesis upper F Subscript upper Y Baseline left parenthesis x right parenthesis equals integral Subscript negative normal infinity Superscript x Baseline upper F Subscript upper X Baseline left parenthesis u Superscript minus Baseline right parenthesis normal d upper F Subscript upper Y Baseline left parenthesis u right parenthesis plus integral Subscript negative normal infinity Superscript x Baseline upper F Subscript upper Y Baseline left parenthesis u right parenthesis normal d upper F Subscript upper X Baseline left parenthesis u right parenthesis periodFX(x)FY (x) =
 ⎨x
−∞
FX(u−)dFY (u) +
 ⎨x
−∞
FY (u)dFX(u).
140
4
Moments and the Alike
For continuous CDFs, formula (4.38) reads 
integral Subscript a Superscript b Baseline upper F Subscript upper X Baseline left parenthesis x right parenthesis normal d upper F Subscript upper Y Baseline left parenthesis x right parenthesis equals upper F Subscript upper X Baseline left parenthesis b right parenthesis upper F Subscript upper Y Baseline left parenthesis b right parenthesis minus upper F Subscript upper X Baseline left parenthesis a right parenthesis upper F Subscript upper Y Baseline left parenthesis a right parenthesis minus integral Subscript a Superscript b Baseline upper F Subscript upper Y Baseline left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis period
 ⎨b
a
FX(x)dFY (x) = FX(b)FY (b) −FX(a)FY (a) −
 ⎨b
a
FY (x)dFX(x).
For upper F Subscript upper Y Baseline left parenthesis x right parenthesis equals 1FY (x) = 1, we may as well apply integration by parts formula (4.38) to get: 
upper F Subscript upper X Baseline left parenthesis b right parenthesis minus upper F Subscript upper X Baseline left parenthesis a right parenthesis equals integral Underscript left parenthesis a comma b right bracket Endscripts normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis identical to sans serif upper P left parenthesis a less than upper X less than or slanted equals b right parenthesis commaFX(b) −FX(a) =
 ⎨
(a,b]
dFX(x) ≡P(a < X ⩽b),
where normal d upper F Subscript upper Y Baseline left parenthesis x right parenthesis equals 0dFY (x) = 0. Moral: Integration by parts may serve for integrating over 
subsets. 
Proof of Lemma 4.2 
Proof (⇒) Let  g(x) = IB1(x) and h(y) = IB2(y) be two indicator functions, 
for some Borel sets B1, B2 ⊂ R. Thus, g(X) = I{X∈B1}, h(Y)  = I{Y∈B2} and 
I{X∈B1}∩{Y∈B2} = I{X∈B1}I{Y∈B2}. By assumption we have P({X ∈ B1} ∩{Y ∈ 
B2}) = P(X ∈ B1)P(Y ∈ B2) and this is equivalent to E(I{X∈B1}∩{Y∈B2}) = 
E(I{X∈B1}I{Y∈B2}) = E(I{X∈B1})E(I{Y∈B2}). We may ﬁnd increasing sequences 
gn, hn of nonnegative step (bounded) functions converging pointwise to positive 
functions g and h, respectively. The above result for indicators extend to gn(X) and 
hn(Y) by linearity, while MCT does the job: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis g left parenthesis upper X right parenthesis h left parenthesis upper Y right parenthesis right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis limit Underscript n Endscripts g Subscript n Baseline left parenthesis upper X right parenthesis h Subscript n Baseline left parenthesis upper Y right parenthesis right parenthesis equals limit Underscript n Endscripts sans serif upper E left parenthesis g Subscript n Baseline left parenthesis upper X right parenthesis h Subscript n Baseline left parenthesis upper Y right parenthesis right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column limit Underscript n Endscripts left parenthesis sans serif upper E left parenthesis g Subscript n Baseline left parenthesis upper X right parenthesis right parenthesis sans serif upper E left parenthesis h Subscript n Baseline left parenthesis upper Y right parenthesis right parenthesis right parenthesis equals sans serif upper E left parenthesis g left parenthesis upper X right parenthesis right parenthesis sans serif upper E left parenthesis h left parenthesis upper Y right parenthesis right parenthesis period EndLayoutE(g(X)h(Y)) = E(lim
n gn(X)hn(Y)) = lim
n E(gn(X)hn(Y))
= lim
n
(
E(gn(X))E(hn(Y))
)
= E(g(X))E(h(Y)).
If g, h is any pair of bounded functions, then we may always apply the above to their 
positive and negative parts. (⇐) It sufﬁces to choose g(x) = IB1(x) and h(y) = 
IB2(y). 
█
Proof of Lemma 4.1 
Proof (⇒) X  d= Y means that PX(B) = PY (B) for every Borel set B ⊂ R. If 
X = IA, Y  = IA' for A, A' ∈F, then g(X) = X and g(Y) = Y. Since {X ∈ B} =  
A, {Y ∈ B} =  A', we have that E(IA) = P(A) = PX(B) and E(IA') = P(A') = 
PX(B), hence E(g(X)) = E(g(Y)). The same argument extends to nonnegative 
simple rvs X, Y by linearity. We may apply the Monotone Convergence Theorem to 
X, Y ⩾0, or for general rvs to their positive and negative parts. (⇐) If E(g(X)) =
Appendix
141
E(g(Y)) for every Borel function g, then in particular we may choose g = IB with 
B ∈B. We have IB( · ) = I{ ·∈B} for both rvs Thus, E[I{ ·∈B}] =  P( · ∈ B), and their 
respective distributions coincide. 
█
Limit and Expectation Again 
There are two further results on interchanging limits and expectation, other than 
Theorem 4.10, which can be useful in some proofs. Before to present the results, 
be warned that Theorem 4.10 can be stated36 for an increasing sequence left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Xn)n∈N
which converges sans serif upper PP-a.s. to a limit X, i.e., given upper A equals left brace limit Underscript n right arrow normal infinity Endscripts upper X Subscript n Baseline equals upper X right braceA = { lim
n→∞Xn = X} the convergence 
fails on upper A Superscript cAc with probability sans serif upper P left parenthesis upper A Superscript c Baseline right parenthesis equals 0P(Ac) = 0. To see why, we note upper X Subscript n Baseline equals Overscript a period s period Endscripts upper X Subscript n Baseline bold upper I Subscript upper AXn
a.s.
= XnIA since 
left brace upper X Subscript n Baseline equals upper X Subscript n Baseline bold upper I Subscript upper A Baseline right brace{Xn = XnIA} is exactly the set A and the same is true for X. By Remark 3, after  
the Solution to Exercise 4.17, 3, we have  sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis equals sans serif upper E left parenthesis upper X Subscript n Baseline bold upper I Subscript upper A Baseline right parenthesisE(Xn) = E(XnIA) and sans serif upper E left parenthesis upper X right parenthesis equals sans serif upper E left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesisE(X) = E(XIA), 
since the expectation does not change by adjusting measurable functions on a sans serif upper PP-
null set. Now we have that upper X Subscript n Baseline equals Overscript a period s period Endscripts upper XXn
a.s.
= X implies upper X Subscript n Baseline bold upper I Subscript upper A Baseline right arrow upper X bold upper I Subscript upper AXnIA →XIA for every omega element of upper Aω ∈A and 
limit Underscript n Endscripts sans serif upper E left parenthesis upper X Subscript n Baseline bold upper I Subscript upper A Baseline right parenthesis equals sans serif upper E left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesislimn E(XnIA) = E(XIA) easily follows by Theorem 4.10. 
Lemma 4.4 (Fatou) Let 
left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Xn)n∈N be a sequence of nonnegative rvs. Then, 
sans serif upper E left parenthesis limit inf upper X Subscript n Baseline right parenthesis less than or slanted equals limit inf sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesisE
(
lim inf Xn
)
⩽lim inf E(Xn) where both sides may be inﬁnite. 
Proof Deﬁne the random variable upper Y Subscript k Baseline equals inf Underscript n greater than or slanted equals k Endscripts upper X Subscript nYk = infn⩾k Xn and upper Y equals limit Underscript k Endscripts upper Y Subscript k Baseline equals limit inf upper X Subscript nY = limk Yk = lim inf Xn, 
where clearly each upper Y Subscript kYk is nonnegative. For n greater than or slanted equals kn
⩾
k it holds upper X Subscript n Baseline greater than or slanted equals upper Y Subscript kXn
⩾
Yk and 
by monotonicity of expectation also sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis greater than or slanted equals sans serif upper E left parenthesis upper Y Subscript k Baseline right parenthesisE(Xn) ⩾E(Yk). This implies sans serif upper E left parenthesis upper Y Subscript k Baseline right parenthesis less than or slanted equals inf Underscript n greater than or slanted equals k Endscripts sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesisE(Yk) ⩽
infn⩾k E(Xn) But upper Y Subscript k Baseline up arrow upper YYk ↑Y and by the monotone convergence theorem it follows 
limit inf sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis greater than or slanted equals limit inf sans serif upper E left parenthesis upper Y Subscript k Baseline right parenthesis equals sans serif upper E left parenthesis upper Y right parenthesislim inf E(Xn) ⩾lim inf E(Yk) = E(Y), which proves the lemma. 
█
Again, we have the a.s.-version of Fatou’s lemma where the sequence left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Xn)n∈N
is s.t. upper X Subscript n Baseline greater than or slanted equals 0Xn ⩾0 except on a sans serif upper PP-null set upper A Superscript cAc, for all n element of double struck upper Nn ∈N. The proof runs as above with 
the only exception that we replace upper X Subscript nXn with upper X Subscript n Baseline bold upper I Subscript upper AXnIA and change all the expectations 
involved on upper A Superscript cAc, without affecting their values. 
Theorem 4.12 (Lebesgue’s Dominated Convergence) Let upper X comma upper X 1 comma upper X 2 comma ellipsisX, X1, X2, . . . be rvs 
such that upper X Subscript n Baseline right arrow upper XXn →X pointwise. If the sequence left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Xn)n∈N is dominated by a random 
variable upper Y element of upper L Superscript 1Y ∈L1, i.e., StartAbsoluteValue upper X Subscript n Baseline EndAbsoluteValue less than or slanted equals upper Y|Xn| ⩽Y for every n element of double struck upper Nn ∈N, then limit Underscript n Endscripts sans serif upper E left parenthesis StartAbsoluteValue upper X Subscript n Baseline minus upper X EndAbsoluteValue right parenthesis equals 0limn E(|Xn −X|) = 0 and in 
particular limit Underscript n Endscripts sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis equals sans serif upper E left parenthesis upper X right parenthesislimn E(Xn) = E(X). 
Proof By assumption we have upper Y plus upper X Subscript n Baseline greater than or slanted equals 0Y + Xn ⩾0 and applying the Fatou’s lemma to 
the sequence left parenthesis upper Y plus upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Y + Xn)n∈N it holds: sans serif upper E left parenthesis upper Y right parenthesis plus sans serif upper E left parenthesis upper X right parenthesis equals sans serif upper E left parenthesis upper Y plus upper X right parenthesis less than or slanted equals limit inf sans serif upper E left parenthesis upper Y plus upper X Subscript n Baseline right parenthesis equals sans serif upper E left parenthesis upper Y right parenthesis plus limit inf sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesisE(Y) + E(X) = E(Y + X) ⩽lim inf E(Y +
Xn) = E(Y) + lim inf E(Xn). Using  sans serif upper E left parenthesis upper Y right parenthesis less than normal infinityE(Y) < ∞we can rule out this expectation 
from both sides obtaining sans serif upper E left parenthesis upper X right parenthesis less than or slanted equals limit inf sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesisE(X) ⩽lim inf E(Xn). From real analysis we know that 
minus limit inf left parenthesis minus x Subscript n Baseline right parenthesis equals limit sup x Subscript n−lim inf(−xn) = lim sup xn, for any sequence left parenthesis x Subscript n Baseline right parenthesis Subscript n element of double struck upper N Baseline subset of double struck upper R(xn)n∈N ⊂R. Applying once more 
the Fatou’s lemma to the sequence left parenthesis upper Y minus upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Y −Xn)n∈N and following the same reasoning
36 This is true also for Lemma 4.3. 
142
4
Moments and the Alike
as above we have sans serif upper E left parenthesis upper X right parenthesis greater than or slanted equals limit sup sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesisE(X) ⩾lim sup E(Xn), since limit inf sans serif upper E left parenthesis minus upper X Subscript n Baseline right parenthesis equals limit sup sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesislim inf E(−Xn) = lim sup E(Xn). 
Moreover, from limit sup sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis greater than or slanted equals limit inf sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesislim sup E(Xn) ⩾lim inf E(Xn) we must have limit sup sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis equals limit inf sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis equals sans serif upper E left parenthesis upper X right parenthesislim sup E(Xn) =
lim inf E(Xn) = E(X), which is equivalent to sans serif upper E left parenthesis StartAbsoluteValue upper X Subscript n Baseline minus upper X EndAbsoluteValue right parenthesis equals 0E(|Xn −X|) = 0 and the proof is 
complete. 
█
In Theorem 4.12 we can again weaken the hypotheses by requiring that StartAbsoluteValue upper X Subscript n Baseline EndAbsoluteValue less than or slanted equals upper Y|Xn| ⩽Y
holds almost surely and sans serif upper P left parenthesis limit Underscript n right arrow normal infinity Endscripts upper X Subscript n Baseline equals upper X right parenthesis equals 1P( lim
n→∞Xn = X) = 1, i.e. limit Underscript n right arrow normal infinity Endscripts upper X Subscript n Baseline equals Overscript a period s period Endscripts upper X lim
n→∞Xn
a.s.
= X.
Chapter 5 
Special Distributions 
5.1 
Summary of Univariate Distributions 
Special models of probability distributions are available for application, especially 
in ﬁnancial modelling. A brief summary of those used in this book is showed in 
Tables 5.1 and 5.2. 
Usually, notations are correctly referred to CDFs and one can write upper X tilde upper F Subscript upper XX ∼FX, 
read ‘X is distributed as upper F Subscript upper XFX’, where upper F Subscript upper XFX is the CDF corresponding to the masses 
or densities in Tables 5.1 and 5.2. Any distribution listed above is a family of 
distributions indexed by the corresponding parameters. 
5.2 
Discrete Uniform 
From Tables 5.1 and 5.2, we see how notations for the uniform distributions are 
similar, but be careful with the discrete case where 
normal upper U left brace a comma ellipsis comma b right brace equals StartLayout Enlarged left brace 1st Row 1st Column 0 2nd Column if x Subscript i Baseline less than a 2nd Row 1st Column StartFraction x Subscript i Baseline minus a plus 1 Over b minus a EndFraction 2nd Column if a less than or slanted equals x Subscript i Baseline less than or slanted equals b 3rd Row 1st Column 1 2nd Column if x Subscript i Baseline greater than b comma EndLayoutU{a, . . . , b} =
⎧
⎨
⎩
0
if xi < a
xi−a+1
b−a
if a ⩽xi ⩽b
1
if xi > b,
denotes the CDF of the discrete uniform and 
sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis equals StartFraction bold upper I Subscript left brace a less than x Sub Subscript i Subscript less than b right brace Baseline Over b minus a plus 1 EndFractionP(X = xi) = I{a<xi<b}
b −a + 1
is the probability mass function, with a equals min upper Ca = min C and b equals max upper Cb = max C, with a less than ba < b. 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4_5
143
144
5
Special Distributions
Table 5.1 Discrete univariate distributions 
Name
Notation
Mass sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis equalsP(X = xi) =
Parameters 
Uniform 
normal upper U left brace a comma ellipsis comma b right braceU{a, . . . , b}
StartFraction 1 Over n EndFraction1
n, for x Subscript i Baseline equals i element of upper C subset of double struck upper Zxi = i ∈C ⊂Z
StartAbsoluteValue upper C EndAbsoluteValue equals n element of double struck upper N|C| = n ∈N
Bernoulli 
upper B e r left parenthesis p right parenthesisBer(p)
p, for x 1 equals 1 comma x1 = 1, or 1 minus p 1 −p for x 2 equals 0 x2 = 0
0 less than p less than 10 < p < 1
Binomial 
upper B i n left parenthesis n comma p right parenthesisBin(n, p)
StartBinomialOrMatrix n Choose i EndBinomialOrMatrix p Superscript i Baseline left parenthesis 1 minus p right parenthesis Superscript n minus i
⎛n
i
⎞
pi(1 −p)n−i, for x Subscript i Baseline equals i element of StartSet 0 comma 1 comma 2 comma ellipsis comma n EndSet xi = i ∈{0, 1, 2, . . . , n}
0 less than p less than 1 comma0 < p < 1, n element of double struck upper Nn ∈N
Poisson 
upper P o left parenthesis lamda right parenthesisPo(λ)
normal e Superscript negative lamda Baseline StartFraction lamda Superscript x Super Subscript i Superscript Baseline Over x Subscript i Baseline factorial EndFractione−λ λxi
xi! , for x Subscript i Baseline equals i element of StartSet 0 comma 1 comma 2 comma ellipsis EndSetxi = i ∈{0, 1, 2, . . .}
lamda greater than 0λ > 0
Table 5.2 Continuous univariate distributions 
Name
Notation
Density f Subscript upper X Baseline left parenthesis x right parenthesis equalsfX(x) =
Parameters 
Uniform
normal upper U left parenthesis a comma b right parenthesisU(a, b)
StartFraction 1 Over b minus a EndFraction
1
b −a for a less than or slanted equals x less than or slanted equals b commaa ⩽x ⩽b, zero otherwise
a comma b element of double struck upper R comma a less than ba, b ∈R, a < b
Gaussian or 
Normal 
normal upper N left parenthesis mu comma sigma squared right parenthesisN(μ, σ 2)
StartFraction 1 Over StartRoot 2 pi sigma squared EndRoot EndFraction normal e Superscript minus left parenthesis x minus mu right parenthesis divided by 2 sigma squared
1
√
2πσ 2 e−(x−μ)/2σ 2, for x element of double struck upper Rx ∈R
mu element of double struck upper R comma sigma greater than 0μ ∈R, σ > 0
Exponential upper E x p left parenthesis lamda right parenthesisExp(λ)
lamda normal e Superscript minus lamda xλe−λx, for x greater than or slanted equals 0 commax ⩾0, zero otherwise
lamda greater than 0λ > 0
Gamma
upper G a m m a left parenthesis alpha comma lamda right parenthesisGamma(α, λ) StartFraction lamda Superscript alpha Baseline x Superscript alpha minus 1 Baseline normal e Superscript minus lamda x Baseline Over upper Gamma left parenthesis alpha right parenthesis EndFractionλαxα−1e−λx
𝚪(α)
, for x greater than 0 commax > 0, zero otherwise alpha greater than 0 comma lamda greater than 0α > 0, λ > 0
Student-t
normal upper T left parenthesis n right parenthesisT(n)
StartStartFraction upper Gamma left parenthesis StartFraction n plus 1 Over 2 EndFraction right parenthesis OverOver StartRoot n pi EndRoot upper Gamma left parenthesis StartFraction n Over 2 EndFraction right parenthesis EndEndFraction left parenthesis 1 plus StartFraction x squared Over n EndFraction right parenthesis Superscript minus left parenthesis StartFraction n plus 1 Over 2 EndFraction right parenthesis 𝚪( n+1
2 )
√nπ𝚪( n
2 )
⎛
1 + x2
n
⎞−( n+1
2 )
, for x element of double struck upper Rx ∈R
n greater than 1n > 1, degree of freedom 
Example 5.1 Let upper C equals StartSet negative 2 comma 1 comma 0 comma 1 EndSetC = {−2, 1, 0, 1} where upper X tilde normal upper U left brace negative 2 comma ellipsis comma 1 right braceX ∼U{−2, . . . , 1} is distributed with 
equally likely probability sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis equals StartFraction 1 Over StartAbsoluteValue upper C EndAbsoluteValue EndFraction equals one fourthP(X = xi) =
1
|C| = 1
4, for  x Subscript i Baseline element of upper Cxi ∈C. Then, choosing (at 
random) x Subscript i Baseline equals 0xi = 0 we have 
sans serif upper P left parenthesis upper X equals 0 right parenthesis equals StartFraction bold upper I Subscript left brace negative 2 less than 0 less than 1 right brace Baseline Over 1 minus left parenthesis negative 2 right parenthesis plus 1 EndFraction equals one fourth periodP(X = 0) =
I{−2<0<1}
1 −(−2) + 1 = 1
4.
The law of a discrete uniform rv can be though of as a probability on left parenthesis double struck upper R comma script upper B right parenthesis(R, B), see  
Appendix in Chap. 2, using the Dirac delta measure introduced in Sect. 2.4, Chap. 2 
(see also Exercise 2.7). It sufﬁces to deﬁne probability the sans serif upper P identical to sans serif upper P Subscript upper XP ≡PX by a linear 
combination of several Dirac deltaδ measures concentrated at each point of a countable 
set1 upper C equals StartSet x 1 comma comma ellipsis comma x Subscript n Baseline EndSetC = {x1, , . . . , xn}. If we assign a weight p Subscript i Baseline greater than or slanted equals 0pi ⩾0 to each x Subscript i Baseline element of upper Cxi ∈C and require 
sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline equals 1∑n
i=1 pi = 1, then the set function sans serif upper P left parenthesis upper B right parenthesis colon equals sigma summation Underscript i equals 1 Overscript n Endscripts p Subscript i Baseline delta Subscript x Sub Subscript i Baseline left parenthesis upper B right parenthesisP(B) := ∑n
i=1 piδxi(B) is a discrete probability 
measure for every upper B element of script upper BB ∈B provided sans serif upper P left parenthesis upper C right parenthesis equals 1P(C) = 1. If  p Subscript i Baseline equals StartFraction 1 Over StartAbsoluteValue upper C EndAbsoluteValue EndFractionpi =
1
|C| we recover the masses 
above, otherwise we give raise to a discrete non-uniform rv.
1 Recall that the Borel sigma hyphen algebraσ-algebra contains all singletons StartSet x EndSet{x} with x element of double struck upper Rx ∈R. 
5.3
Bernoulli
145
5.3 
Bernoulli 
The Bernoulli distribution is used in random experiments where only two results 
are possible, and they are interpreted as ‘success’ and ‘failure’, called Bernoulli 
trial. For example, a tick movement of a daily stock price, as in Sect. 1.7, gives  
raise to such an experiment provided that the rv2 upper S 1S1 is obtained using a Bernoulli rv 
upper X tilde upper B e r left parenthesis p right parenthesisX ∼Ber(p), and then scaling it as follows: 
upper S 1 equals 0.5 bold upper I Subscript left brace upper X equals 1 right brace Baseline minus 0.5 bold upper I Subscript left brace upper X equals 0 right brace Baseline commaS1 = 0.5I{X=1} −0.5I{X=0},
where p equals sans serif upper P left parenthesis upper X equals 1 right parenthesisp = P(X = 1) is the success probability to be assigned. Alternatively, we can 
transform the Bernoulli rv using g left parenthesis x right parenthesis equals minus left parenthesis one half minus x right parenthesisg(x) = −( 1
2 −x). For  p equals one halfp = 1
2 the X’s distribution 
is symmetric with the same masses sans serif upper P equals pP = p, indeed it is a special case of the discrete 
uniform with only two values in its support. Since upper X tilde upper B e r left parenthesis p right parenthesisX ∼Ber(p) is discrete, then its 
expected value is easily computed: 
sans serif upper E left parenthesis upper X right parenthesis equals 1 times sans serif upper P left parenthesis upper X equals 1 right parenthesis plus 0 times sans serif upper P left parenthesis upper X equals 0 right parenthesis equals p periodE(X) = 1 × P(X = 1) + 0 × P(X = 0) = p.
(5.1) 
The variance is: 
StartLayout 1st Row 1st Column sans serif upper V left parenthesis upper X right parenthesis 2nd Column equals 3rd Column left parenthesis 1 minus sans serif upper E left parenthesis upper X right parenthesis right parenthesis squared times sans serif upper P left parenthesis upper X equals 1 right parenthesis plus left parenthesis 0 minus sans serif upper E left parenthesis upper X right parenthesis right parenthesis squared times sans serif upper P left parenthesis upper X equals 0 right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column left parenthesis 1 minus p right parenthesis squared p plus p squared left parenthesis 1 minus p right parenthesis equals p left parenthesis 1 minus p right parenthesis period EndLayoutV(X) = (1 −E(X))2 × P(X = 1) + (0 −E(X))2 × P(X = 0)
= (1 −p)2p + p2(1 −p) = p(1 −p).
(5.2) 
Example 5.2 The expectation of the ﬁrst day stock price is 
sans serif upper E left parenthesis upper S 1 right parenthesis equals 0.5 sans serif upper E left parenthesis bold upper I Subscript left brace upper X equals 1 right brace Baseline right parenthesis minus 0.5 sans serif upper E left parenthesis bold upper I Subscript left brace upper X equals 0 right brace Baseline right parenthesis equals 0.5 p minus 0.5 left parenthesis 1 minus p right parenthesis equals p minus one half commaE(S1) = 0.5E(I{X=1}) −0.5E(I{X=0}) = 0.5p −0.5(1 −p) = p −1
2,
or alternatively 
sans serif upper E left parenthesis upper S 1 right parenthesis equals sans serif upper E left parenthesis minus left parenthesis one half minus upper X right parenthesis right parenthesis equals negative one half plus sans serif upper E left parenthesis upper X right parenthesis commaE(S1) = E
⎛
−
⎛1
2 −X
⎞⎞
= −1
2 + E(X),
which entails the same result. The variance is: 
StartLayout 1st Row 1st Column sans serif upper V left parenthesis upper S 1 right parenthesis 2nd Column equals 3rd Column left parenthesis 0.5 minus left parenthesis p minus one half right parenthesis right parenthesis squared p plus left parenthesis negative 0.5 minus left parenthesis p minus one half right parenthesis right parenthesis squared left parenthesis 1 minus p right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column left parenthesis 1 minus p right parenthesis squared p plus p squared left parenthesis 1 minus p right parenthesis equals p left parenthesis 1 minus p right parenthesis period EndLayoutV(S1) = (0.5 −(p −1
2))2p + (−0.5 −(p −1
2))2(1 −p)
= (1 −p)2p + p2(1 −p) = p(1 −p).
It is no surprisingly that sans serif upper V left parenthesis upper S 1 right parenthesis equals sans serif upper V left parenthesis upper X right parenthesisV(S1) = V(X): the  rv  upper S 1S1 is obtained by the Bernoulli 
rv X by a linear transformation which affects only the location of upper B e r left parenthesis p right parenthesisBer(p) not its 
dispersion.
2 We conﬁne ourselves to the ﬁrst trading day. 
146
5
Special Distributions
Remark 5.1 We can use upper X tilde upper B e r left parenthesis one half right parenthesisX ∼Ber( 1
2) to create new discrete rvs with two values 
a comma b element of double struck upper Ra, b ∈R as follows: 
upper Y equals a upper X plus b left parenthesis 1 minus upper X right parenthesis periodY = aX + b(1 −X).
For example, if upper S 1S1 has values plus or minus 0.5±0.5 with equal probability, then we can use a equals one half comma b equals negative one halfa =
1
2, b = −1
2 which is the same as g left parenthesis upper X right parenthesis equals minus left parenthesis one half minus upper X right parenthesisg(X) = −( 1
2 −X). 
As we did in Sect. 5.2, considering left parenthesis double struck upper R comma script upper B right parenthesis(R, B), the  Bernoulli measure can be deﬁned 
as sans serif upper P colon equals p delta 0 plus left parenthesis 1 minus p right parenthesis delta 1P := pδ0+(1−p)δ1, where 0 less than p less than 10 < p < 1 is interpreted as the ‘success probability’ 
in one trial. This corresponds to the law sans serif upper P Subscript upper XPX of upper X tilde upper B e r left parenthesis p right parenthesisX ∼Ber(p). The Bernoulli measure 
is easily veriﬁed to be a probability. It is countably additive for any pairwise disjoint 
sequence left parenthesis upper A Subscript i Baseline right parenthesis Subscript i element of double struck upper N Baseline subset of script upper B(Ai)i∈N ⊂B: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis union Subscript i Baseline upper A Subscript i Baseline right parenthesis 2nd Column equals 3rd Column p delta 0 left parenthesis union Subscript i Baseline upper A Subscript i Baseline right parenthesis plus left parenthesis 1 minus p right parenthesis delta 1 left parenthesis union Subscript i Baseline upper A Subscript i Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column p sigma summation Underscript i Endscripts delta 0 left parenthesis upper A Subscript i Baseline right parenthesis plus left parenthesis 1 minus p right parenthesis sigma summation Underscript i Endscripts delta 1 left parenthesis upper A Subscript i Baseline right parenthesis equals sigma summation Underscript i Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis period EndLayoutP(∪iAi) = pδ0(∪iAi) + (1 −p)δ1(∪iAi)
= p
⎲
i
δ0(Ai) + (1 −p)
⎲
i
δ1(Ai) =
⎲
i
P(Ai).
Observe that sans serif upper P left parenthesis upper A right parenthesis equals p delta 0 left parenthesis upper A right parenthesis plus left parenthesis 1 minus p right parenthesis delta 1 left parenthesis upper A right parenthesisP(A) = pδ0(A) + (1 −p)δ1(A) yields p whenever 0 element of upper A0 ∈A, otherwise 
is equal to 1 minus p1 −p. Normalization is easily established: 
sans serif upper P left parenthesis double struck upper R right parenthesis equals sans serif upper P left parenthesis StartSet 0 comma 1 EndSet union double struck upper R minus StartSet 0 comma 1 EndSet right parenthesis equals 1 periodP(R) = P({0, 1} ∪R \ {0, 1}) = 1.
Remark 5.2 It is worth noting that bold upper I Subscript upper A Baseline tilde upper B e r left parenthesis p right parenthesisIA ∼Ber(p), whenever p equals sans serif upper P left parenthesis upper A right parenthesisp = P(A) for upper A element of script upper FA ∈F. 
The MGF of a Bernoulli rv is 
StartLayout 1st Row 1st Column upper M Subscript upper X Baseline left parenthesis u right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis normal e Superscript u upper X Baseline right parenthesis equals normal e Superscript u Baseline 0 Baseline left parenthesis 1 minus p right parenthesis plus normal e Superscript u Baseline p 2nd Row 1st Column Blank 2nd Column equals 3rd Column left parenthesis 1 minus p right parenthesis plus p normal e Superscript u Baseline period EndLayoutMX(u) = E(euX) = eu 0(1 −p) + eup
= (1 −p) + peu.
5.4 
Binomial 
Let upper OmegaΩ consists of n element of double struck upper Nn ∈N independent Bernoulli trials with the same success 
probability p. There are different sequences of successes and failures in n trials, 
and we can let q equals 1 minus pq
= 1 −p be the failure probability. Letting X be the rv 
representing the number of successes entails upper C equals StartSet 0 comma 1 comma 2 comma ellipsis comma n EndSetC = {0, 1, 2, . . . , n} as its support. 
To ﬁgure out possible scenarios, we also let upper A Subscript i Baseline equals left brace success at trial i right braceAi = {success at trial i} and upper B Subscript i Baseline equals left brace failure at trial i right braceBi =
{failure at trial i} be events of either a single success or failure, for i equals 1 comma 2 comma ellipsis comma ni = 1, 2, . . . , n. 
Clearly, for a ﬁxed i we have upper A Subscript iAi and upper B Subscript iBi as incompatible, while upper A Subscript i Baseline intersection upper B Subscript j Baseline equals StartSet success at trial i comma failure at trial j EndSetAi ∩Bj
=
{success at trial i, failure at trial j} are compatible for i not equals ji /= j and also independent. 
As byproduct, the probability of any speciﬁc sequence of i successes and n minus in −i
failures is simply given by p Superscript i Baseline left parenthesis 1 minus p right parenthesis Superscript n minus ipi(1 −p)n−i. For ﬁxed i, and then n minus in −i, there are 
StartFraction n factorial Over i factorial left parenthesis n minus i right parenthesis factorial EndFraction equals StartBinomialOrMatrix n Choose i EndBinomialOrMatrix
n!
i!(n−i)! =
(n
i
)
such sequences: they are the number of combinations of two objects,
5.4
Binomial
147
Fig. 5.1 Mass function of a 
upper B i n left parenthesis 6 comma 0.3 right parenthesisBin(6, 0.3)
0
1
2
3
4
5
 
0.0
0.1
0.2
0.3
0.4 
P(X = x) 
namely one success and one failure, the former repeated exactly i times and the 
latter repeated n minus in−i times. Hence, we have to sum p Superscript i Baseline left parenthesis 1 minus p right parenthesis Superscript n minus ipi(1−p)n−i across incompatible 
events each given by the union of upper A Subscript iAi and upper B Subscript iBi showing the same number i of successes 
together with n minus in −i failures, but with different position in the whole trials, using 
additivity of sans serif upper PP. For example, with n equals 4n = 4 and i equals 2i = 2 we can have upper A 1 comma upper B 2 comma upper A 3 comma upper B 4A1, B2, A3, B4 or 
upper B 1 comma upper A 2 comma upper B 3 comma upper A 4B1, A2, B3, A4 with the same number of successes and failures but different position 
in the sequence, hence upper A 1 intersection upper B 2 intersection upper A 3 intersection upper B 4A1∩B2∩A3∩B4 and upper B 1 intersection upper A 2 intersection upper B 3 intersection upper A 4B1∩A2∩B3∩A4 are incompatible. This 
yields the expression of sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesisP(X = xi) in row 3 of Table 5.1, where x Subscript i Baseline equals i element of upper Cxi = i ∈C. By  
the binomial theorem it is easily veriﬁed: sigma summation Underscript i equals 0 Overscript n Endscripts StartBinomialOrMatrix n Choose i EndBinomialOrMatrix p Superscript i Baseline left parenthesis 1 minus p right parenthesis Superscript n minus i Baseline equals 1 period∑n
i=0
⎛n
i
⎞
pi(1 −p)n−i = 1. Observe 
that sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis equals 0P(X = xi) = 0 if x Subscript i Baseline not an element of upper Cxi /∈C. For  p equals one halfp = 1
2 and even n the binomial distribution 
is symmetric around3 StartFraction n Over 2 EndFractionn
2, since upper X tilde upper B i n left parenthesis n comma p right parenthesisX ∼Bin(n, p) implies n minus upper X tilde upper B i n left parenthesis n comma q right parenthesisn −X ∼Bin(n, q), see  
Exercise 5.1, but p equals qp = q and then, letting x Subscript i Baseline equals ixi = i, 
sans serif upper P left parenthesis upper X equals i right parenthesis equals StartBinomialOrMatrix n Choose i EndBinomialOrMatrix p Superscript i Baseline q Superscript n minus i Baseline equals StartBinomialOrMatrix n Choose i EndBinomialOrMatrix q Superscript i Baseline p Superscript n minus i Baseline equals sans serif upper P left parenthesis n minus upper X equals i right parenthesis commaP(X = i) =
⎛n
i
⎞
piqn−i =
⎛n
i
⎞
qipn−i = P(n −X = i),
which entails sans serif upper P left parenthesis upper X equals i right parenthesis equals sans serif upper P left parenthesis upper X equals n minus i right parenthesisP(X = i) = P(X = n −i) so for i equals StartFraction n Over 2 EndFraction plus ji = n
2 + j we have 
sans serif upper P left parenthesis upper X equals StartFraction n Over 2 EndFraction plus j right parenthesis equals sans serif upper P left parenthesis upper X equals StartFraction n Over 2 EndFraction minus j right parenthesis comma for all j element of double struck upper N periodP
⎛
X = n
2 + j
⎞
= P
⎛
X = n
2 −j
⎞
,
for all j ∈N.
In Fig. 5.1 a typical plot of the binomial mass function is showed: when the success 
and failure probabilities are different, there is more probability weight put on smaller 
values in the support. As a result, for p less than 0.5p < 0.5 the distribution has positive skewness 
with a log right-tail. Up to this point it is worth noting that a binomial rv can be 
alternatively deﬁned as the sum of n independent Bernoulli rvs upper X Subscript i Baseline tilde upper B e r left parenthesis p right parenthesisXi ∼Ber(p), for  
i equals 1 comma ellipsis comma ni = 1, . . . , n: 
upper X equals upper X 1 plus midline horizontal ellipsis plus upper X Subscript n Baseline periodX = X1 + · · · + Xn.
(5.3)
3 For even n it holds StartFraction n Over 2 EndFraction equals m n
2 = m is also even. 
148
5
Special Distributions
Since sans serif upper E left parenthesis upper X Subscript i Baseline right parenthesis equals pE(Xi) = p we have 
sans serif upper E left parenthesis upper X right parenthesis equals sans serif upper E left parenthesis upper X 1 right parenthesis plus midline horizontal ellipsis plus sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis equals n p commaE(X) = E(X1) + · · · + E(Xn) = np,
(5.4) 
using linearity of expectation and also 
sans serif upper V left parenthesis upper X right parenthesis equals sans serif upper V left parenthesis upper X 1 right parenthesis plus midline horizontal ellipsis plus sans serif upper V left parenthesis upper X Subscript n Baseline right parenthesis equals n p left parenthesis 1 minus p right parenthesis commaV(X) = V(X1) + · · · + V(Xn) = np(1 −p),
(5.5) 
using independence and sans serif upper V left parenthesis upper X Subscript i Baseline right parenthesis equals p left parenthesis 1 minus p right parenthesisV(Xi) = p(1 −p), each i. We see that the sum of two 
independent binomial rvs with the same success probability is again binomial. Let 
upper X tilde upper B i n left parenthesis n 1 comma p right parenthesisX ∼Bin(n1, p) and upper Y tilde upper B i n left parenthesis n 2 comma p right parenthesisY ∼Bin(n2, p), then upper Z equals upper X plus upper YZ = X + Y is the sum of m equals n 1 plus n 2m = n1 + n2
IID upper X Subscript i Baseline tilde upper B e r left parenthesis p right parenthesisXi ∼Ber(p), for  i equals 1 comma ellipsis comma mi = 1, . . . , m, thus upper Z tilde upper B i n left parenthesis m comma p right parenthesisZ ∼Bin(m, p), see Exercise 5.2 for a 
different derivation. The MGF of upper X tilde upper B i n left parenthesis n comma p right parenthesisX ∼Bin(n, p) is 
StartLayout 1st Row 1st Column upper M Subscript upper X Baseline left parenthesis u right parenthesis equals sans serif upper E left parenthesis normal e Superscript u upper X Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis normal e Superscript u left parenthesis upper X 1 plus midline horizontal ellipsis plus upper X Super Subscript n Superscript right parenthesis Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper E left parenthesis normal e Superscript u upper X 1 Baseline right parenthesis midline horizontal ellipsis sans serif upper E left parenthesis normal e Superscript u upper X Super Subscript n Superscript Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column left parenthesis p normal e Superscript u Baseline plus left parenthesis 1 minus p right parenthesis right parenthesis Superscript n Baseline comma EndLayoutMX(u) = E
(
euX)
= E
(
eu(X1+···+Xn))
= E
(
euX1)
· · · E
(
euXn)
= (peu + (1 −p))n,
where the second line is due to the property of the exponential function and to the 
independence among the Bernoulli rvs, while the last line stems from 
sans serif upper E left parenthesis normal e Superscript u upper X Super Subscript i Superscript Baseline right parenthesis equals p normal e Superscript u Baseline plus left parenthesis 1 minus p right parenthesis normal e Superscript 0 Baseline periodE
(
euXi)
= peu + (1 −p)e0.
The MGF exists for all u element of double struck upper Ru ∈R, which obviously is the largest open interval 
containing zero. In R we can generate random numbers from a given distribution, 
obtain the density or mass function for given quantiles, and get the quantile for given 
probability levels. Here an example: 
Program Code 
S=20; rbinom(S,size=10,prob=0.5) 
q=seq(0:10) 
p=seq(from = 0.01,to = 0.99, length = 50) 
dbinom(q,size=10,prob=0.5) 
pbinom(q,size=10,prob=0.5) 
qbinom(p,size=10,prob=0.5) 
The ﬁrst R command sets the variable S to the number of simulation used in 
the second command, which yields twenty simulated values drawn from upper X tilde upper B i n left parenthesis 10 comma 0.5 right parenthesisX ∼
Bin(10, 0.5). The third commands creates a list of ten quantiles of X, actually the 
whole support StartSet 0 comma 1 comma 2 comma ellipsis comma 10 EndSet{0, 1, 2, . . . , 10}, while the fourth command entails a list of ﬁfty 
probability values from 0.01 to 0.99. Eventually, the ﬁfth and sixth commands 
yield the mass function and CDF, respectively. Clearly each command can be
5.4
Binomial
149
used with the ﬁrst argument, S, q and p in scalar form. We can also set apart 
parameter, e.g., rbinom(x,n,p) can be used after we specify x <- 2, n <- 5  
and p <- 1/2. We close this section with a classical application to ﬁnance. Recall 
from Example 1.2 in Sect. 1.3 the model for the daily stock price through tick 
movements plus or minus 0.5±0.5: there is a fallacy due to possible negative value for very large 
tick movements. A plausible stochastic model for the future evolution of stock 
closing prices over subsequent trading days can be built using the binomial rv. Let 
the closing price at day n element of double struck upper Nn ∈N be deﬁned by 
upper S Subscript n Baseline equals upper S 0 u Superscript upper X Baseline d Superscript n minus upper X Baseline comma upper X tilde upper B i n left parenthesis n comma p right parenthesis commaSn = S0uXdn−X,
X ∼Bin(n, p),
(5.6) 
where 0 less than d less than 1 less than u0 < d < 1 < u are interpreted as the percentages of downward and upward 
movements, respectively, starting from the initial stock price upper S 0S0. This is a special 
case of Example 2.8, item 1 in Sect. 2.5, which in the current setting becomes upper S 0 left parenthesis 1 plus r 1 right parenthesis midline horizontal ellipsis left parenthesis 1 plus r Subscript n Baseline right parenthesisS0(1+
r1) · · · (1 + rn), with arithmetic returns rvs r Subscript t plus 1 Baseline equals StartFraction upper S Subscript t plus 1 Baseline Over upper S Subscript t Baseline EndFraction minus 1rt+1 = St+1
St −1, for t equals 0 comma 1 comma ellipsis comma n minus 1t = 0, 1, . . . , n −1, 
and n source of randomness.4 The special case arises letting u equals 1 plus r Subscript t plus 1 Baselineu = 1+rt+1 for some t 
and d equals 1 plus r Subscript t plus 1 Baselined = 1+rt+1 for the remaining n minus tn−t, and considering one source of randomness 
given by the binomial rv X which counts the number of upward movements of the 
stock price. Events left brace upper S Subscript n Baseline equals u Superscript i Baseline d Superscript n minus i Baseline right brace{Sn = uidn−i} and left brace upper X equals i right brace{X = i} are the same by construction, then 
sans serif upper P left parenthesis upper S Subscript n Baseline equals u Superscript i Baseline d Superscript n minus i Baseline right parenthesis equals sans serif upper P left parenthesis upper X equals i right parenthesis comma for i equals 0 comma 1 comma 2 comma ellipsis comma n periodP(Sn = uidn−i) = P(X = i),
for i = 0, 1, 2, . . . , n.
More is true: by (5.3) the expression for the nth day stock price is: 
StartLayout 1st Row 1st Column upper S Subscript n 2nd Column equals 3rd Column upper S 0 u Superscript upper X 1 plus midline horizontal ellipsis plus upper X Super Subscript n Baseline d Superscript n minus left parenthesis upper X 1 plus midline horizontal ellipsis plus upper X Super Subscript n Superscript right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column upper S 0 u Superscript upper X 1 Baseline midline horizontal ellipsis u Superscript upper X Super Subscript n Superscript Baseline d Superscript n minus upper X 1 Baseline midline horizontal ellipsis d Superscript n minus upper X Super Subscript n Superscript Baseline 3rd Row 1st Column Blank 2nd Column equals 3rd Column upper S 0 f left parenthesis upper X 1 right parenthesis midline horizontal ellipsis f left parenthesis upper X Subscript n Baseline right parenthesis g left parenthesis upper X 1 right parenthesis midline horizontal ellipsis g left parenthesis upper X Subscript n Baseline right parenthesis period EndLayoutSn = S0uX1+···+Xndn−(X1+···+Xn)
(5.7)
= S0uX1 · · · uXndn−X1 · · · dn−Xn
= S0f (X1) · · · f (Xn)g(X1) · · · g(Xn).
For n equals 1n = 1 we have upper S 1 equals upper S 0 u Superscript upper X 1 Baseline d Superscript 1 minus upper X 1S1 = S0uX1d1−X1, so the stock price at the end of day 1 may 
take on values in StartSet upper S 0 u comma upper S 0 d EndSet{S0u, S0d}, and upper S 1S1 is independent of upper S 0S0. At the end of day 2 we 
have upper S 2 equals upper S 0 u Superscript upper X 1 plus upper X 2 Baseline d Superscript 1 minus left parenthesis upper X 1 minus upper X 2 right parenthesisS2 = S0uX1+X2d1−(X1−X2) with values in StartSet upper S 0 u squared comma upper S 0 u d comma upper S 0 d squared EndSet{S0u2, S0ud, S0d2}, and since (5.7) 
holds we compute 
StartLayout 1st Row 1st Column upper S 2 2nd Column equals 3rd Column upper S 0 u Superscript upper X 1 Baseline u Superscript upper X 2 Baseline d Superscript 1 minus upper X 1 Baseline d Superscript 1 minus upper X 2 2nd Row 1st Column Blank 2nd Column equals 3rd Column upper S 1 u Superscript upper X 2 Baseline d Superscript 1 minus upper X 2 Baseline period EndLayoutS2 = S0uX1uX2d1−X1d1−X2
= S1uX2d1−X2.
This recursive structure still holds for t equals 3 comma 4 comma ellipsis comma nt = 3, 4, . . . , n. There are some interesting 
consequences:
4 This corresponds to a vector-to-scalar transformation upper S 0 h left parenthesis r 1 comma r 2 comma ellipsis comma r Subscript n Baseline right parenthesisS0h(r1, r2, . . . , rn). 
150
5
Special Distributions
1. the stock price at day t plus 1t + 1 is dependent only on the previous stock price, 
StartEnclose box upper S Subscript t plus 1 Baseline equals upper S Subscript t Baseline u Superscript upper X Super Subscript t plus 1 Baseline d Superscript 1 minus upper X Super Subscript t plus 1 EndEnclose St+1 = StuXt+1d1−Xt+1
for all t equals 1 comma 2 comma ellipsis comma n minus 1t = 1, 2, . . . , n −1; 
2. gross returns StartFraction upper S 1 Over upper S 0 EndFraction comma StartFraction upper S 2 Over upper S 1 EndFraction comma ellipsis comma StartFraction upper S Subscript n Baseline Over upper S Subscript n minus 1 Baseline EndFraction S1
S0 , S2
S1 , . . . ,
Sn
Sn−1 are IID rvs with distribution 
StartFraction upper S Subscript t plus 1 Baseline Over upper S Subscript t Baseline EndFraction equals StartLayout Enlarged left brace 1st Row 1st Column u 2nd Column with mass p 2nd Row 1st Column d 2nd Column with mass q comma EndLayoutSt+1
St
=
⌠u with mass p
d with mass q,
(5.8) 
by the independence assumption about the Bernoulli rvs upper X 1 comma ellipsis comma upper X Subscript n BaselineX1, . . . , Xn underlying 
the model, see Theorem 3.2, Sect. 3.4; 
3. log-returns ln left parenthesis StartFraction upper S Subscript t plus 1 Baseline Over upper S Subscript t Baseline EndFraction right parenthesisln( St+1
St ) as well as arithmetic returns r Subscript t plus 1 Baseline equals StartFraction upper S Subscript t plus 1 Baseline Over upper S Subscript t Baseline EndFraction minus 1rt+1 = St+1
St −1 are IID rvs with 
the same distribution as for gross returns. 
Property 1 is a form of market efﬁciency: there is no predictive information in past 
stock prices up to day t minus 1t −1. Observe that the probability that upper S Subscript tSt take on a speciﬁc 
value depends upon uptick and downtick movements of the daily stock price given 
by gross returns i.e., it might be computed by multiplying Bernoulli probabilities of 
success p and of failure q over t consecutive trading days, for t equals 1 comma ellipsis comma nt = 1, . . . , n. On the  
other hand, the conditional probability 
StartLayout 1st Row 1st Column Blank 2nd Column sans serif upper P left parenthesis upper S Subscript t plus 1 Baseline equals u Superscript i Baseline d Superscript t plus 1 minus i Baseline vertical bar upper S Subscript t Baseline equals u Superscript i minus 1 Baseline d Superscript t minus i plus 1 Baseline right parenthesis comma for all i equals 0 comma 1 comma 2 comma ellipsis comma t plus 1 comma and 2nd Row 1st Column Blank 2nd Column t equals 1 comma ellipsis comma n minus 1 EndLayoutP(St+1 = uidt+1−i | St = ui−1dt−i+1),
for all i = 0, 1, 2, . . . , t + 1, and
t = 1, . . . , n −1
(5.9) 
is p or q. For example, sans serif upper P left parenthesis upper S 3 equals u cubed vertical bar upper S 2 equals u squared right parenthesis equals pP(S3 = u3 | S2 = u2) = p, while sans serif upper P left parenthesis upper S 3 equals u squared d vertical bar upper S 2 equals u d right parenthesis equals qP(S3 = u2d | S2 = ud) =
q. Do not confuse the parameter u element of double struck upper Ru ∈R in the deﬁnition of MGF with the uptick 
movement uu in the binomial stock price model. 
5.5 
Poisson 
A rv  X with a Poisson distribution has a countably inﬁnite support 
upper C equals StartSet 0 comma 1 comma 2 comma ellipsis EndSetC
=
{0, 1, 2, . . .}. Each mass is of the form sans serif upper P left parenthesis upper X equals i right parenthesis equals normal e Superscript negative lamda Baseline StartFraction lamda Superscript i Baseline Over i factorial EndFractionP(X = i) = e−λ λi
i! , for  x Subscript i Baseline equals i element of upper Cxi = i ∈C, see  
Appendix in Chap. 1 for a ﬁrst encounter with this distribution; see also Sect. 4.2. 
In fact, they are truly masses: 
StartLayout 1st Row 1st Column sigma summation Underscript i equals 0 Overscript normal infinity Endscripts StartFraction normal e Superscript negative lamda Baseline lamda Superscript i Baseline Over i factorial EndFraction 2nd Column equals 3rd Column normal e Superscript negative lamda Baseline sigma summation Underscript i equals 0 Overscript normal infinity Endscripts StartFraction lamda Superscript i Baseline Over i factorial EndFraction 2nd Row 1st Column Blank 2nd Column equals 3rd Column normal e Superscript negative lamda Baseline normal e Superscript lamda Baseline equals 1 comma EndLayout
∞
⎲
i=0
e−λ λi
i!
= e−λ
∞
⎲
i=0
λi
i!
= e−λ eλ = 1,
5.5
Poisson
151
Fig. 5.2 Density of a upper P o left parenthesis 6 right parenthesisPo(6)
0
1
2
3
4
5
 
0.00
0.05
0.10
0.15 
P(X = x) 
since the exponential function g left parenthesis x right parenthesis equals normal e Superscript xg(x) = ex has the Taylor series expansion g left parenthesis x right parenthesis equals sigma summation Underscript n equals 0 Overscript normal infinity Endscripts StartFraction x Superscript n Baseline Over n factorial EndFractiong(x) =
∑∞
n=0
xn
n! , each n element of double struck upper N periodn ∈N. Figure 5.2 shows a plot of the Poisson mass function, which 
has typical positive skewness. Just as we did in Sect. 5.3, the  law  sans serif upper P identical to sans serif upper P Subscript upper XP ≡PX of a 
Poisson rv X as a probability on left parenthesis double struck upper R comma script upper B right parenthesis(R, B) can be written using a countable linear 
combination of Dirac delta measures concentrated at C with weights p Subscript i Baseline equals normal e Superscript negative lamda Baseline StartFraction lamda Superscript x Super Subscript i Superscript Baseline Over x Subscript i Baseline factorial EndFractionpi = e−λ λxi
xi! , 
it sufﬁces to deﬁne sans serif upper P colon equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts p Subscript i Baseline delta Subscript iP := ∑∞
i=1 piδi. Thus, for any upper B element of script upper BB ∈B we can compute sans serif upper P left parenthesis upper B right parenthesisP(B)
as sigma summation Underscript i equals 1 Overscript normal infinity Endscripts p Subscript i Baseline delta Subscript i Baseline left parenthesis upper B right parenthesis∑∞
i=1 piδi(B). In fact, this yields a probability measure satisfying axioms PA1 
and PA2 of Deﬁnition 1.3, Sect. 1.3: normalization amounts to choose upper B equals double struck upper RB = R, and 
using the three equivalence above; countable additivity is 
StartLayout 1st Row 1st Column sigma summation Underscript n equals 1 Overscript normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript n Baseline right parenthesis 2nd Column equals 3rd Column sigma summation Underscript n equals 1 Overscript normal infinity Endscripts sigma summation Underscript i equals 1 Overscript normal infinity Endscripts StartFraction normal e Superscript negative lamda Baseline lamda Superscript i Baseline Over i factorial EndFraction delta Subscript i Baseline left parenthesis upper A Subscript n Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript normal infinity Endscripts StartFraction normal e Superscript negative lamda Baseline lamda Superscript i Baseline Over i factorial EndFraction delta Subscript i Baseline left parenthesis union Subscript n Baseline upper A Subscript n Baseline right parenthesis equals sans serif upper P left parenthesis union Subscript n Baseline upper A Subscript n Baseline right parenthesis comma EndLayout
∞
⎲
n=1
P(An) =
∞
⎲
n=1
∞
⎲
i=1
e−λ λi
i!
δi(An)
=
∞
⎲
i=1
e−λ λi
i!
δi(∪nAn) = P(∪nAn),
for a pairwise disjoint sequence left parenthesis upper A Subscript n Baseline right parenthesis Subscript n element of double struck upper N Baseline subset of script upper B(An)n∈N ⊂B. The expectation of a Poisson rv is 
computed as follows: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X right parenthesis 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript normal infinity Endscripts i normal e Superscript negative lamda Baseline StartFraction lamda Superscript i Baseline Over i factorial EndFraction equals normal e Superscript negative lamda Baseline sigma summation Underscript i equals 1 Overscript normal infinity Endscripts i StartFraction lamda Superscript i Baseline Over i factorial EndFraction 2nd Row 1st Column Blank 2nd Column equals 3rd Column lamda normal e Superscript negative lamda Baseline sigma summation Underscript i equals 1 Overscript normal infinity Endscripts StartFraction lamda Superscript i minus 1 Baseline Over left parenthesis i minus 1 right parenthesis factorial EndFraction equals lamda normal e Superscript negative lamda Baseline normal e Superscript negative lamda Baseline equals lamda comma EndLayoutE(X) =
∞
⎲
i=1
i e−λ λi
i! = e−λ
∞
⎲
i=1
i λi
i!
(5.10)
= λe−λ
∞
⎲
i=1
λi−1
(i −1)! = λe−λe−λ = λ,
where we dropped the i equals 0i = 0 term since it was 0 and used the Taylor series expansion 
for normal e Superscript lamdaeλ starting from i equals 1i = 1. Surprisingly enough, the variance is 
sans serif upper V left parenthesis upper X right parenthesis equals lamda commaV(X) = λ,
(5.11)
152
5
Special Distributions
see Exercise 5.4. The MGF of a Poisson rv is 
StartLayout 1st Row 1st Column upper M Subscript upper X Baseline left parenthesis u right parenthesis equals sans serif upper E left parenthesis normal e Superscript u upper X Baseline right parenthesis 2nd Column equals 3rd Column sigma summation Underscript i equals 0 Overscript normal infinity Endscripts normal e Superscript u i Baseline normal e Superscript negative lamda Baseline StartFraction lamda Superscript i Baseline Over i factorial EndFraction 2nd Row 1st Column Blank 2nd Column equals 3rd Column normal e Superscript negative lamda Baseline sigma summation Underscript i equals 0 Overscript normal infinity Endscripts StartFraction left parenthesis lamda normal e Superscript u Baseline right parenthesis Superscript i Baseline Over i factorial EndFraction 3rd Row 1st Column Blank 2nd Column equals 3rd Column normal e Superscript negative lamda Baseline normal e Superscript lamda normal e Super Superscript u Superscript Baseline equals exp left parenthesis lamda left parenthesis normal e Superscript u Baseline minus 1 right parenthesis right parenthesis comma EndLayoutMX(u) = E
(
euX)
=
∞
⎲
i=0
eu ie−λ λi
i!
= e−λ
∞
⎲
i=0
(λeu)i
i!
= e−λeλeu = exp(λ(eu −1)),
where we used the Taylor series expansion of exp left parenthesis lamda normal e Superscript u Baseline right parenthesisexp(λeu). The MGF exists for every 
u element of double struck upper Ru ∈R, thus also for u equals 0u = 0. The sum of two independent Poisson rvs upper X tilde upper P o left parenthesis lamda 1 right parenthesisX ∼Po(λ1)
and upper Y tilde upper P o left parenthesis lamda 2 right parenthesisY ∼Po(λ2) is just upper X plus upper Y tilde upper P o left parenthesis lamda 1 plus lamda 2 right parenthesisX + Y ∼Po(λ1 + λ2). Indeed, using the MGF and 
independence we have: 
StartLayout 1st Row 1st Column upper M Subscript upper X plus upper Y Baseline left parenthesis u right parenthesis 2nd Column equals 3rd Column upper M Subscript upper X Baseline left parenthesis u right parenthesis upper M Subscript upper Y Baseline left parenthesis u right parenthesis equals sans serif upper E left parenthesis normal e Superscript u upper X Baseline right parenthesis sans serif upper E left parenthesis normal e Superscript u upper Y Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column exp left parenthesis lamda 1 left parenthesis normal e Superscript u Baseline minus 1 right parenthesis right parenthesis exp left parenthesis lamda 2 left parenthesis normal e Superscript u Baseline minus 1 right parenthesis right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column exp left parenthesis left parenthesis lamda 1 plus lamda 2 right parenthesis left parenthesis normal e Superscript u Baseline minus 1 right parenthesis right parenthesis period EndLayoutMX+Y (u) = MX(u)MY (u) = E
(
euX)
E
(
euY )
= exp(λ1(eu −1)) exp(λ2(eu −1))
= exp((λ1 + λ2)(eu −1)).
The Poisson and the binomial distribution are related each other: if n element of double struck upper Nn ∈N is 
large enough and the success probability is very small, with np ﬁnite, bounded and 
nonzero, then we can approximate the latter distribution with the former. 
Proposition 5.1 Let upper X tilde upper B i n left parenthesis n comma p right parenthesisX ∼Bin(n, p) and send n to normal infinity∞, taking p right arrow 0p →0 s.t. lamda equals n pλ = np
remains ﬁxed. Then the X’s mass function converges to that of upper Y tilde upper P o left parenthesis lamda right parenthesisY ∼Po(λ). 
Example 5.3 Suppose an insurance company shall receive a certain number of 
claims in a ﬁxed time interval, say left parenthesis 0 comma t right bracket(0, t], for  t greater than 0t > 0. Let  X be the rv modelling 
the number of claims, with support upper C equals StartSet 0 comma 1 comma 2 comma ellipsis comma n EndSetC = {0, 1, 2, . . . , n} for a positive integer n. 
Thus, we partition left parenthesis 0 comma t right bracket(0, t] into n subinterval of equal length StartFraction t Over n EndFractiont
n, so for  n large enough 
each subinterval is small and we might assume that the company will receive only 
one claim in it. Further, we can assume that the probability for such a claim is 
proportional to the length of each subinterval left parenthesis StartFraction left parenthesis i minus 1 right parenthesis t Over n EndFraction comma StartFraction i t Over n EndFraction right bracket( (i−1)t
n
, i t
n ], for  i equals 1 comma ellipsis comma ni = 1, . . . , n. We  
set p equals StartFraction lamda t Over n EndFractionp =
λt
n , with lamda greater than 0λ > 0, the probability that a Bernoulli rv upper X Subscript iXi takes value 1 if 
there is just one claim in left parenthesis StartFraction left parenthesis i minus 1 right parenthesis t Over n EndFraction comma StartFraction i t Over n EndFraction right bracket( (i−1)t
n
, i t
n ]. We also assume that claim arrivals over each 
subinterval are independent each other. So we have upper X equals upper X 1 plus midline horizontal ellipsis plus upper X Subscript nX = X1 + · · · + Xn for IID 
Bernoulli upper X Subscript i Baseline tilde upper B e r left parenthesis p right parenthesisXi ∼Ber(p), thus we approximate the number j of claims during left parenthesis 0 comma t right bracket(0, t]
by the binomial rv upper X tilde upper B i n left parenthesis n comma StartFraction lamda t Over n EndFraction right parenthesisX ∼Bin(n, λt
n ), where StartFraction lamda t Over n EndFractionλt
n is the expected number of claims 
over each subinterval left parenthesis StartFraction left parenthesis i minus 1 right parenthesis t Over n EndFraction comma StartFraction i t Over n EndFraction right bracket( (i−1)t
n
, i t
n ], i.e., sans serif upper E left parenthesis upper X Subscript i Baseline right parenthesis equals pE(Xi) = p. By Proposition 5.1 we have 
limit Underscript n right arrow normal infinity Endscripts sans serif upper P left parenthesis upper X equals j right parenthesis equals normal e Superscript negative lamda Baseline StartFraction lamda Superscript i Baseline Over i factorial EndFraction commalimn→∞P(X = j) = e−λ λi
i! , where lamda equals StartFraction n p Over t EndFractionλ = np
t is kept ﬁxed and clearly p right arrow 0p →0. 
The following R commands are similar to those used for the binomial distribution 
in Sect. 5.3, but now without the size and success probability parameters which are 
replaced by lamdaλ.
5.6
Continuous Uniform
153
Program Code 
S=20; rpois(S,lambda=0.1) 
q=seq(0:10) 
p=seq(from=0.01,to=0.99, lenght=50) 
dpois(q,lambda=0.1) 
ppois(q,lambda=0.1) 
qunif(p,lambda=0.1) 
5.6 
Continuous Uniform 
In Example 1.25 (see Appendix in Chap. 1) we have encountered a continuous 
uniform probability law. In the current setting it is nothing else the uniform 
distribution upper X tilde normal upper U left parenthesis a comma b right parenthesisX ∼U(a, b) with a equals 0a = 0 and b equals 1b = 1. In general, a uniformly distributed 
rv X has constant density f Subscript upper X Baseline left parenthesis x right parenthesis StartFraction 1 Over b minus a EndFractionfX(x)
1
b−a for all x element of left bracket a comma b right bracketx ∈[a, b] and f Subscript upper X Baseline left parenthesis x right parenthesis equals 0fX(x) = 0 outside the 
interval. Its CDF is 
upper F Subscript upper X Baseline left parenthesis x right parenthesis equals integral Subscript negative normal infinity Superscript x Baseline StartFraction 1 Over b minus a EndFraction normal d u equals StartLayout Enlarged left brace 1st Row 1st Column 0 comma 2nd Column if x less than a 2nd Row 1st Column StartFraction x minus a Over b minus a EndFraction comma 2nd Column if a less than or slanted equals x less than or slanted equals b 3rd Row 1st Column 1 comma 2nd Column if x greater than b comma EndLayoutFX(x) =
⌠x
−∞
1
b −a du =
⎧
⎨
⎩
0,
if x < a
x−a
b−a , if a ⩽x ⩽b
1,
if x > b,
which is easily obtained from 
integral Subscript negative normal infinity Superscript x Baseline f Subscript upper X Baseline left parenthesis u right parenthesis normal d u equals ModifyingBelow integral Subscript negative normal infinity Superscript a Baseline f Subscript upper X Baseline left parenthesis u right parenthesis With bottom brace Underscript equals 0 Endscripts normal d u plus integral Subscript a Superscript x Baseline f Subscript upper X Baseline left parenthesis u right parenthesis normal d u period
⌠x
−∞
fX(u)du =
⌠a
−∞
fX(u)
◟
◝◜
◞
= 0
du +
⌠x
a
fX(u)du.
In Fig. 5.3 the plots of the CDF and the density are depicted. Observe that the CDF 
is continuous but has not derivative at the points x equals ax = a and x equals bx = b, where the 
corresponding density has two jump discontinuities.5 The importance of uniform 
distributed rvs is due to the following couple of results. 
Theorem 5.1 (Quantile Transform) 
Let upper U tilde upper U left parenthesis 0 comma 1 right parenthesisU ∼U(0, 1) be a uniform rv, and Y 
be a rv with CDF upper F Subscript upper Y Baseline left parenthesis y right parenthesisFY (y) and quantile function upper Q Subscript upper Y Baseline left parenthesis c right parenthesisQY (c), Then, upper Y equals Overscript d Endscripts upper Q Subscript upper Y Baseline left parenthesis upper U right parenthesisY
d= QY (U), i.e. 
sans serif upper P left parenthesis upper Q Subscript upper Y Baseline left parenthesis upper U right parenthesis less than or slanted equals y right parenthesis equals upper F Subscript upper Y Baseline left parenthesis y right parenthesisP(QY (U) ⩽y) = FY (y). 
Theorem 5.2 (Probability Transform) 
If a rv Y has continuous CDF, then 
upper F Subscript upper Y Baseline left parenthesis upper Y right parenthesis tilde upper U left parenthesis 0 comma 1 right parenthesis commaFY (Y) ∼U(0, 1),
i.e. upper F Subscript upper Y Baseline left parenthesis upper Y right parenthesisFY (Y) is a rv with a uniform distribution over left parenthesis 0 comma 1 right parenthesis(0, 1).
5 The plots are generated by R commands: that of f Subscript upper XfX should not display the vertical bar at abscissas 
x equals 0x = 0 and x equals 1 periodx = 1.
154
5
Special Distributions
−0.5
0.0
0.5
1.0
1.5 
0.0 
0.2 
0.4 
0.6 
0.8 
1.0 
−0.5
0.0
0.5
1.0
1.5 
0.0 
0.2 
0.4 
0.6 
0.8 
1.0 
Fig. 5.3 Left: density of a normal upper U left parenthesis 0 comma 1 right parenthesisU(0, 1). Right: CDF of a normal upper U left parenthesis 0 comma 1 right parenthesisU(0, 1)
Theorem 5.2 provides the so called inverse transform method for simulating rvs 
with a prescribed distribution. 
Example 5.4 Let X be a discrete rv with masses 
sans serif upper P left parenthesis upper X equals 3 right parenthesis equals 0.3 comma sans serif upper P left parenthesis upper X equals 4 right parenthesis equals 0.4 comma sans serif upper P left parenthesis upper X equals 5 right parenthesis equals 0.3 periodP(X = 3) = 0.3, P(X = 4) = 0.4, P(X = 5) = 0.3.
Its CDF is 
upper F left parenthesis x right parenthesis equals StartLayout Enlarged left brace 1st Row 1st Column 0 2nd Column if x less than 3 2nd Row 1st Column 0.3 2nd Column if 3 less than or slanted equals x less than 4 3rd Row 1st Column 0.7 2nd Column if 4 less than or slanted equals x less than 5 4th Row 1st Column 1 2nd Column if x greater than or slanted equals 5 comma EndLayoutF(x) =
⎧
⎪⎪⎪⎪⎨
⎪⎪⎪⎪⎩
0
if x < 3
0.3
if 3 ⩽x < 4
0.7
if 4 ⩽x < 5
1
if x ⩾5,
the quantile function is 
upper Q Subscript upper X Baseline left parenthesis u right parenthesis equals StartLayout Enlarged left brace 1st Row 1st Column 3 2nd Column if 0 less than u less than or slanted equals 0.3 2nd Row 1st Column 4 2nd Column if 0.3 less than u less than or slanted equals 0.7 3rd Row 1st Column 5 2nd Column if u greater than 0.7 period EndLayoutQX(u) =
⎧
⎪⎪⎨
⎪⎪⎩
3
if 0 < u ⩽0.3
4
if 0.3 < u ⩽0.7
5
if u > 0.7.
Hence, by Theorem 5.1 upper Q Subscript upper X Baseline left parenthesis upper U right parenthesisQX(U), with uniform normal upper U tilde normal upper U left parenthesis 0 comma 1 right parenthesisU ∼U(0, 1), yields values u equals upper U left parenthesis omega right parenthesisu =
U(ω) in the support StartSet 3 comma 4 comma 5 EndSet{3, 4, 5} of X, for every scenario omega element of upper Omegaω ∈Ω. 
Therefore, to get values from the support of a rv we can do following: 
• 
assign a rv X with prescribed CDF 
• 
randomly generate numbers u from the uniform distribution in (0,1) 
• 
obtain X’s values x after applying the X’s quantile function to u.
5.6
Continuous Uniform
155
If a rv Y is continuous we might as well plug it into its own CDF, then the resulting 
rv has normal upper U left parenthesis 0 comma 1 right parenthesisU(0, 1). 
Example 5.5 Let Y be a discrete rv with support upper C equals StartSet 0 comma 1 comma 2 comma ellipsis comma n EndSetC = {0, 1, 2, . . . , n} and mass 
function sans serif upper P left parenthesis upper Y equals i right parenthesis equals colon p Subscript iP(Y = i) =: pi, for  i element of upper Ci ∈C. Thus, divide the unit interval left parenthesis 0 comma 1 right parenthesis(0, 1) into n plus 1n + 1
open subintervals s.t. each has length equal to p Subscript ipi. Then, we can deﬁne Y taking 
value i element of upper Ci ∈C whenever a uniformly distributed rv normal upper U tilde normal upper U left parenthesis 0 comma 1 right parenthesisU ∼U(0, 1) takes value in the ith 
subinterval of length p Subscript ipi. Since the law of U is continuous uniform and 
left brace upper Y equals i right brace equals left brace upper U falls into interval of length p Subscript i Baseline right brace comma{Y = i} = {U falls into interval of length pi},
then being the law of U continuous uniform, i.e., characterized by length of 
intervals, we arrive to sans serif upper P left parenthesis upper Y equals i right parenthesisP(Y = i) is exactly p Subscript ipi, for i element of upper Ci ∈C. 
Applying a location-scale transformation to normal upper U tilde normal upper U left parenthesis 0 comma 1 right parenthesisU ∼U(0, 1) we can change the unit 
interval: upper X equals a plus left parenthesis b minus a right parenthesis normal upper U tilde normal upper U left parenthesis a comma b right parenthesisX = a + (b −a)U ∼U(a, b), for real numbers a less than ba < b. In fact, the support 
of U is the unit interval left parenthesis 0 comma 1 right parenthesis(0, 1) which has length 1, and we can pass to the support 
left parenthesis a comma b right parenthesis(a, b) by using the scaling factor b minus ab−a, i.e., left parenthesis b minus a right parenthesis normal upper U tilde normal upper U left parenthesis 0 comma b minus a right parenthesis(b−a)U ∼U(0, b−a). Thus, changing 
the left end point from 0 to a we need to shift all the support by adding just a, then 
getting the resulting distribution of X. This enable us to randomly generate numbers 
from any interval left parenthesis a comma b right parenthesis(a, b), for example using the Excel function RAND()*(b-a)+a, 
or the R command runif(n,a,b) where n is the number of simulations. Other R 
commands are: dunif(x,a,b) and punif(x,a,b) evaluating the density and 
the CDF, respectively, at x. To draw more values from the uniform over left bracket 0 comma 1 right bracket[0, 1] we 
refer to the following R commands: 
Program Code 
S=20; a <- 0; b <- 1; runif(S,a,b) 
q=seq(0:10) 
p=seq(from=0.01,to=0.99, lenght=50) 
dunif(q,a,b) 
punif(q,a,b) 
qunif(p,a,b) 
where qunif(p,a,b) yields the uniform quantile function evaluated at p. 
Observe that the ﬁrst arguments S, q and p can be vectors of values, i.e., numerical 
arrays. The expectation of a continuous uniform rv is easy to compute: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline x f left parenthesis x right parenthesis normal d x 2nd Column equals 3rd Column StartFraction 1 Over b minus a EndFraction integral Subscript a Superscript b Baseline x normal d x 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction 1 Over b minus a EndFraction left bracket StartFraction x squared Over 2 EndFraction right bracket Subscript a Superscript b Baseline equals StartFraction b squared minus a squared Over 2 left parenthesis b minus a right parenthesis EndFraction equals StartFraction b plus a Over 2 EndFraction period EndLayoutE(X) =
⌠∞
−∞
xf (x)dx =
1
b −a
⌠b
a
xdx
=
1
b −a
⎾
x2
2
⏋b
a = b2 −a2
2(b −a) = b + a
2
.
156
5
Special Distributions
To compute the variance we ﬁrst write the second moment 
sans serif upper E left parenthesis upper X squared right parenthesis equals integral Subscript a Superscript b Baseline x squared StartFraction 1 Over b minus a EndFraction normal d x equals StartFraction 1 Over b minus a EndFraction left bracket StartFraction x cubed Over 3 EndFraction right bracket Subscript a Superscript b Baseline equals StartFraction b squared plus a b plus a squared Over 3 EndFraction commaE(X2) =
⌠b
a
x2
1
b −a dx =
1
b −a
⎾x3
3
⏋b
a
= b2 + ab + a2
3
,
then we have 
sans serif upper V left parenthesis upper X right parenthesis equals sans serif upper E left parenthesis upper X squared right parenthesis minus left parenthesis sans serif upper E left parenthesis upper X right parenthesis right parenthesis squared equals StartFraction b squared plus a b plus a squared Over 3 EndFraction minus StartFraction left parenthesis b plus a right parenthesis squared Over 4 EndFraction equals StartFraction left parenthesis b minus a right parenthesis squared Over 12 EndFraction periodV(X) = E(X2) −(E(X))2 = b2 + ab + a2
3
−(b + a)2
4
= (b −a)2
12
.
The MGF of upper X tilde normal upper U left parenthesis a comma b right parenthesisX ∼U(a, b) is computed below: 
StartLayout 1st Row 1st Column upper M Subscript upper X Baseline left parenthesis u right parenthesis equals sans serif upper E left parenthesis normal e Superscript u upper X Baseline right parenthesis 2nd Column equals 3rd Column StartFraction 1 Over b minus a EndFraction integral Subscript a Superscript b Baseline normal e Superscript u x Baseline normal d x 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction normal e Superscript u b Baseline minus normal e Superscript u a Baseline Over u left parenthesis b minus a right parenthesis EndFraction period EndLayoutMX(u) = E(euX) =
1
b −a
⌠b
a
euxdx
= eub −eua
u(b −a) .
For example, choosing a equals 0 comma b equals 1a = 0, b = 1 we get upper M Subscript upper X Baseline left parenthesis u right parenthesis equals StartFraction normal e Superscript u Baseline minus 1 Over u EndFractionMX(u) = eu−1
u
as the MGF of normal upper U tilde normal upper U left parenthesis 0 comma 1 right parenthesisU ∼
U(0, 1). Therefore, the MGF exists for all u element of double struck upper Ru ∈R and this implies that the CHF can 
be obtained by replacing u with normal i uiu. 
Uniforms over the Same Interval 
Let normal upper U tilde normal upper U left parenthesis 0 comma 1 right parenthesisU ∼U(0, 1) and let upper X equals 1 minus upper UX = 1 −U. We show that upper X tilde normal upper U left parenthesis 0 comma 1 right parenthesisX ∼U(0, 1). Indeed, 
write 
StartLayout 1st Row 1st Column upper M Subscript upper X Baseline left parenthesis u right parenthesis equals sans serif upper E left parenthesis normal e Superscript u left parenthesis 1 minus upper U right parenthesis Baseline right parenthesis 2nd Column StartLayout 1st Row t equals negative u 2nd Row equals EndLayout 3rd Column sans serif upper E left parenthesis normal e Superscript u Baseline normal e Superscript t upper U Baseline right parenthesis equals normal e Superscript u Baseline ModifyingBelow sans serif upper E left parenthesis normal e Superscript t upper U Baseline right parenthesis With bottom brace Underscript equals upper M Subscript upper U Baseline left parenthesis t right parenthesis Endscripts 2nd Row 1st Column Blank 2nd Column equals 3rd Column normal e Superscript u Baseline StartFraction normal e Superscript t Baseline minus 1 Over t EndFraction equals StartFraction normal e Superscript u Baseline minus 1 Over u EndFraction comma EndLayoutMX(u) = E(eu(1−U)) t=−u
=
E(euetU) = eu E(etU)
◟◝◜◞
=MU (t)
=
eu et −1
t
= eu −1
u
,
where the term on the right-hand side of the latter equality is the MGF of 
normal upper U tilde normal upper U left parenthesis 0 comma 1 right parenthesisU ∼U(0, 1). 
Uniform rvs have also some interest to disprove a converse of the statement 
‘continuous bi-variate densities have continuous marginals’. 
Example  5.6  (Actually. . . Counterexample) Let upper X 1 tilde upper U left parenthesis 0 comma 1 right parenthesisX1 ∼U(0, 1) and deﬁne another 
rv upper X 2 left parenthesis omega right parenthesis equals upper X 1 left parenthesis omega right parenthesisX2(ω) = X1(ω) for every scenario omega element of upper Omegaω ∈Ω. Obviously, upper X 2 equals Overscript d Endscripts upper X 1X2
d= X1 so both rvs are 
absolutely continuous with uniform marginals. On the other hand, bold upper X equals left parenthesis upper X 1 comma upper X 2 right parenthesisX = (X1, X2)
5.6
Continuous Uniform
157
does not posses a bi-variate density and then it is not an absolutely continuous 
random vector. In fact we have 
StartLayout 1st Row 1st Column upper F Subscript bold upper X Baseline left parenthesis x 1 comma x 2 right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis upper X 1 less than or slanted equals x 1 comma upper X 2 less than or slanted equals x 2 right parenthesis equals sans serif upper P left parenthesis upper X 1 less than or slanted equals x 1 comma upper X 1 less than or slanted equals x 2 right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper X 1 less than or slanted equals min left brace x 1 comma x 2 right brace right parenthesis equals integral Subscript 0 Superscript min left brace x 1 comma x 2 right brace Baseline normal d x 1 3rd Row 1st Column Blank 2nd Column not equals 3rd Column integral Subscript 0 Superscript x 1 Baseline integral Subscript 0 Superscript x 2 Baseline f Subscript bold upper X Baseline left parenthesis u 1 comma u 2 right parenthesis normal d u 1 normal d u 2 comma EndLayoutFX(x1, x2) = P(X1 ⩽x1, X2 ⩽x2) = P(X1 ⩽x1, X1 ⩽x2)
= P(X1 ⩽min{x1, x2}) =
⌠min{x1,x2}
0
dx1
/=
⌠x1
0
⌠x2
0
fX(u1, u2)du1du2,
for some joint density f Subscript bold upper X Baseline left parenthesis x 1 comma x 2 right parenthesisfX(x1, x2). We used that  left brace upper X 1 less than or slanted equals x 1 right brace intersection left brace upper X 1 less than or slanted equals x 2 right brace{X1 ⩽x1} ∩{X1 ⩽x2} is reduced 
to the event left brace upper X 1 less than or slanted equals dot right brace{X1 ⩽· } evaluated at the smaller value between x 1 comma x 2x1, x2. Moreover, 
upper X 1 equals upper X 2X1 = X2 has uniform density f Subscript upper X 1 Baseline left parenthesis x right parenthesis equals bold upper I Subscript left bracket 0 comma 1 right bracket Baseline left parenthesis x right parenthesisfX1(x) = I[0,1](x). 
On the other hand, a bi-variate uniform distribution over the rectangle left bracket 0 comma 1 right bracket times left bracket 0 comma 1 right bracket[0, 1] ×
[0, 1], called the unit square, is characterized by a joint density 
f Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis equals StartLayout Enlarged left brace 1st Row 1st Column 1 2nd Column if left parenthesis x comma y right parenthesis element of left bracket 0 comma 1 right bracket times left bracket 0 comma 1 right bracket comma 2nd Row 1st Column 0 2nd Column otherwise EndLayoutfX(x, y) =
⌠
1
if (x, y) ∈[0, 1] × [0, 1],
0
otherwise
of a random vector bold italic upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y) where both coordinate rvs have a uniform 
distribution over the unit interval. In fact, for the X’s marginal we have 
f Subscript upper X Baseline left parenthesis x right parenthesis equals integral Subscript 0 Superscript 1 Baseline f Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis normal d y equals integral Subscript 0 Superscript 1 Baseline 1 normal d y equals 1 commafX(x) =
⌠1
0
fX(x, y)dy =
⌠1
0
1 dy = 1,
and similarly for f Subscript upper YfY . Moreover, for this kind of uniform bi-variate distribution upper X comma upper YX, Y
are independent: 
StartLayout 1st Row 1st Column 1 2nd Column equals 3rd Column integral Subscript 0 Superscript 1 Baseline integral Subscript 0 Superscript 1 Baseline f Subscript bold italic upper X Baseline left parenthesis x comma y right parenthesis normal d x normal d y equals integral Subscript 0 Superscript 1 Baseline integral Subscript 0 Superscript 1 Baseline 1 normal d x normal d y 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript 0 Superscript 1 Baseline 1 normal d x integral Subscript 0 Superscript 1 Baseline 1 normal d y equals 1 times 1 3rd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript 0 Superscript 1 Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x integral Subscript 0 Superscript 1 Baseline f Subscript upper Y Baseline left parenthesis y right parenthesis normal d y period EndLayout1 =
⌠1
0
⌠1
0
fX(x, y)dxdy =
⌠1
0
⌠1
0
1 dxdy
=
⌠1
0
1 dx
⌠1
0
1 dy = 1 × 1
=
⌠1
0
fX(x)dx
⌠1
0
fY (y)dy.
Thus, the joint density factors and the distribution of Y conditional on upper X equals xX = x is 
univariate uniform over the unit interval, whatever x is, see Chap. 6 for further 
details on conditional distributions.
158
5
Special Distributions
−3
−2
−1
0
1
2
3 
0.0 
0.1 
0.2 
0.3 
0.4 
−3
−2
−1
0
1
2
3 
0.0 
0.2 
0.4 
0.6 
0.8 
1.0 
Fig. 5.4 Left: density of a standard normal. Right: CDF of a standard normal 
5.7 
Gaussian 
A Gaussian rv X has the well known density with bell-shaped graph, centered at 
muμ, which is a location parameter, and whose values are dispersed around it at a 
rate sigmaσ. The Normal distribution is ubiquitous in mathematical statistics since many 
random phenomena can be modelled in such a way some aggregation procedure 
comes into play, especially through the Central Limit Theorem we will discuss 
later. Moreover, it is plausible to model stock returns over ﬁxed time periods as 
being symmetrical distributed according the Gaussian law, under normal market 
conditions.6 The Gaussian density f Subscript upper X Baseline left parenthesis x right parenthesis equals StartFraction 1 Over StartRoot 2 pi sigma squared EndRoot EndFraction normal e Superscript minus StartFraction left parenthesis x minus mu right parenthesis squared Over 2 sigma squared EndFractionfX(x) =
1
√
2πσ 2 e−(x−μ)2
2σ2
is indeed symmetric 
around muμ since f Subscript upper X Baseline left parenthesis x prime right parenthesis equals f Subscript upper X Baseline left parenthesis x right parenthesisfX(x') = fX(x), whenever x prime plus x equals 2 mu commax' + x = 2μ, i.e. when the points x 
and x primex' have the same distance from the localization parameter, and the bell-shaped 
graph of f Subscript upper XfX has a maximum at left parenthesis mu comma f Subscript upper X Baseline left parenthesis mu right parenthesis right parenthesis(μ, fX(μ)). In words, the function g left parenthesis x right parenthesis equals f Subscript upper X Baseline left parenthesis x plus mu right parenthesisg(x) = fX(x+μ)
takes value g left parenthesis x minus mu right parenthesis equals f Subscript upper X Baseline left parenthesis x right parenthesisg(x −μ) = fX(x) for m greater than 0m > 0, the same values of the density at x minus m mux −mμ
which leads to a horizontal shift of the f Subscript upper XfX’s graph on the left. If mu equals 0μ = 0 and sigma equals 1σ = 1, 
X is said to have a standard normal distribution, see Fig. 5.4. It can be shown that 
such a function f Subscript upper XfX is a truly density, see Exercise 5.9. We show that muμ and sigmaσ are the 
expectation and standard deviation of X, respectively. First, write the expectation 
with the change of variable x equals left parenthesis x minus mu right parenthesis plus mux = (x −μ) + μ: 
sans serif upper E left parenthesis upper X right parenthesis equals StartFraction 1 Over StartRoot 2 pi EndRoot sigma EndFraction integral Subscript negative normal infinity Superscript normal infinity Baseline left parenthesis x minus mu right parenthesis normal e Superscript minus StartFraction left parenthesis x minus mu right parenthesis squared Over 2 sigma squared EndFraction Baseline normal d x plus mu StartFraction 1 Over StartRoot 2 pi EndRoot sigma EndFraction integral Subscript negative normal infinity Superscript normal infinity Baseline normal e Superscript minus StartFraction left parenthesis x minus mu right parenthesis squared Over 2 sigma squared EndFraction Baseline normal d x periodE(X) =
1
√
2πσ
⌠∞
−∞
(x −μ)e−(x−μ)2
2σ2 dx + μ
1
√
2πσ
⌠∞
−∞
e−(x−μ)2
2σ2 dx.
6 Whereas this assumption is far for being true, as statistical analysis of historical returns shows, 
viz. stylized facts. 
5.7
Gaussian
159
Let y equals x minus muy = x −μ and normal d y equals normal d xdy = dx. The ﬁrst integrand on the left-hand side, say 
h left parenthesis y right parenthesis equals y normal e Superscript minus StartFraction y squared Over 2 sigma squared EndFractionh(y) = ye−y2
2σ2 , is an odd function, h left parenthesis negative y right parenthesis equals minus h left parenthesis y right parenthesish(−y) = −h(y), so its integral is zero. The 
other integral refers to the Gaussian density and then is 1, thus we have sans serif upper E left parenthesis upper X right parenthesis equals muE(X) = μ. 
Second, using again integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x equals 1
{ ∞
−∞fX(x)dx = 1 we have: 
integral Subscript negative normal infinity Superscript normal infinity Baseline normal e Superscript minus StartFraction left parenthesis x minus mu right parenthesis squared Over 2 sigma squared EndFraction Baseline normal d x equals sigma StartRoot 2 pi EndRoot period
⌠∞
−∞
e−(x−μ)2
2σ2 dx = σ
√
2π.
Hence, differentiate with respect to sigmaσ both sides we get:7 
integral Subscript negative normal infinity Superscript normal infinity Baseline StartFraction left parenthesis x minus mu right parenthesis squared Over sigma cubed EndFraction normal e Superscript minus StartFraction left parenthesis x minus mu right parenthesis squared Over 2 sigma squared EndFraction Baseline normal d x equals StartRoot 2 pi EndRoot period
⌠∞
−∞
(x −μ)2
σ 3
e−(x−μ)2
2σ2 dx =
√
2π.
Multiplying by StartFraction sigma squared Over StartRoot 2 pi EndRoot EndFraction σ 2
√
2π we get the expression 
integral Subscript negative normal infinity Superscript normal infinity Baseline left parenthesis x minus mu right parenthesis squared StartFraction 1 Over StartRoot 2 pi sigma squared EndRoot EndFraction normal e Superscript minus StartFraction left parenthesis x minus mu right parenthesis squared Over 2 sigma squared EndFraction Baseline normal d x equals sigma squared comma
⌠∞
−∞
(x −μ)2
1
√
2πσ 2 e−(x−μ)2
2σ2 dx = σ 2,
which is nothing else sans serif upper E left parenthesis left parenthesis upper X minus mu right parenthesis squared right parenthesis equals sans serif upper V left parenthesis upper X right parenthesisE((X −μ)2) = V(X). For the standard normal distribution 
we can let upper X equals mu plus sigma upper ZX = μ + σZ, where upper Z tilde normal upper N left parenthesis 0 comma 1 right parenthesisZ ∼N(0, 1) and X turn to be tilde normal upper N left parenthesis mu comma sigma squared right parenthesis∼N(μ, σ 2). In  
fact, this is a proper location-scale transform, see Sect. 4.5 in Chap. 4, and the two 
densities f Subscript upper XfX and f Subscript upper ZfZ are related by StartFraction 1 Over sigma EndFraction f Subscript upper X Baseline left parenthesis StartFraction x minus mu Over sigma EndFraction right parenthesis equals f Subscript upper Z Baseline left parenthesis x right parenthesis 1
σ fX
( x−μ
σ
)
= fZ(x) so StartFraction upper X minus mu Over sigma EndFraction tilde normal upper N left parenthesis 0 comma 1 right parenthesis X−μ
σ
∼N(0, 1). The  
Gaussian MGF is computed after that of the standard normal. Thus, let upper Z tilde normal upper N left parenthesis 0 comma 1 right parenthesisZ ∼N(0, 1)
and compute: 
StartLayout 1st Row 1st Column upper M Subscript upper Z Baseline left parenthesis u right parenthesis 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline normal e Superscript u x Baseline StartFraction 1 Over StartRoot 2 pi EndRoot EndFraction normal e Superscript minus x squared divided by 2 Baseline normal d x equals normal e Superscript t squared divided by 2 Baseline integral Subscript negative normal infinity Superscript normal infinity Baseline StartFraction 1 Over StartRoot 2 pi EndRoot EndFraction normal e Superscript minus left parenthesis x minus t right parenthesis squared divided by 2 Baseline normal d x 2nd Row 1st Column Blank 2nd Column equals 3rd Column normal e Superscript t squared divided by 2 Baseline comma EndLayoutMZ(u) =
⌠∞
−∞
eux
1
√
2π
e−x2/2dx = et2/2
⌠∞
−∞
1
√
2π
e−(x−t)2/2dx
(5.12)
= et2/2,
where the last integral refers to the density of a normal upper N left parenthesis t comma 1 right parenthesisN(t, 1) rv and then is equal to 1. The 
MGF exists for every u element of double struck upper Ru ∈R. Now, by the proper location-scale transform we obtain 
the MGF of a Gaussian upper X tilde normal upper N left parenthesis mu comma sigma squared right parenthesisX ∼N(μ, σ 2) by recalling Theorem 4.1 in Sect. 4.4: 
upper M Subscript mu plus sigma upper Z Baseline left parenthesis u right parenthesis equals normal e Superscript mu u Baseline upper M Subscript upper Z Baseline left parenthesis sigma u right parenthesis equals normal e Superscript mu u plus StartFraction sigma squared u squared Over 2 EndFraction Baseline periodMμ+σZ(u) = eμ uMZ(σ u) = eμ u+ σ2u2
2 .
7 Let h left parenthesis x comma mu comma sigma right parenthesis equals normal e Superscript minus StartFraction left parenthesis x minus mu right parenthesis squared Over 2 sigma squared EndFractionh(x, μ, σ) = e−(x−μ)2
2σ2
and use Leibniz’s formula (see Appendix L) to differentiate: 
StartFraction normal d Over normal d sigma EndFraction integral Subscript negative normal infinity Superscript normal infinity Baseline h left parenthesis x comma mu comma sigma right parenthesis normal d x d
dσ
{ ∞
−∞h(x, μ, σ)dx is equal to integral Subscript negative normal infinity Superscript normal infinity Baseline StartFraction partial differential Over partial differential sigma EndFraction h left parenthesis x comma mu comma sigma right parenthesis normal d x
{ ∞
−∞
∂
∂σ h(x, μ, σ)dx. 
160
5
Special Distributions
There is a remarkable formula for the central moments of a Gaussian distribution: 
sans serif upper E left parenthesis left parenthesis upper X minus mu right parenthesis Superscript p Baseline right parenthesis equals StartLayout Enlarged left brace 1st Row 1st Column StartFraction left parenthesis 2 p right parenthesis factorial Over 2 Superscript p Baseline p factorial EndFraction sigma Superscript 2 p Baseline 2nd Column for p equals 2 comma 4 comma 6 comma ellipsis 2nd Row 1st Column 0 2nd Column for p equals 1 comma 3 comma 5 comma ellipsis comma EndLayoutE((X −μ)p) =
⌠(2p)!
2pp! σ 2p
for p = 2, 4, 6, . . .
0
for p = 1, 3, 5, . . . ,
(5.13) 
see Exercise 5.14. Thus, for a standard normal upper Z equals StartFraction upper X minus mu Over sigma EndFractionZ = X−μ
σ
we also found that 
sans serif upper E left parenthesis left parenthesis StartFraction upper X minus mu Over sigma EndFraction right parenthesis Superscript 4 Baseline right parenthesis minus 3 equals sans serif upper E left parenthesis upper Z Superscript 4 Baseline right parenthesis minus 3 equals 3 minus 3 equals 0 commaE
⎛⎛X −μ
σ
⎞4⎞
−3 = E(Z4) −3 = 3 −3 = 0,
which conﬁrms how the excess kurtosis of a standard normal is zero. The standard 
normal distribution is symmetric around mu equals 0μ = 0 and this transfers to symmetry of 
tail areas, upper F Subscript upper Z Baseline left parenthesis x right parenthesis equals 1 minus upper F Subscript upper Z Baseline left parenthesis negative x right parenthesisFZ(x) = 1 −FZ(−x), where upper F Subscript upper ZFZ is the CDF function: 
upper F Subscript upper Z Baseline left parenthesis x right parenthesis equals integral Subscript negative normal infinity Superscript negative x Baseline f Subscript upper Z Baseline left parenthesis t right parenthesis normal d t equals integral Subscript x Superscript normal infinity Baseline f Subscript upper Z Baseline left parenthesis t right parenthesis normal d t equals 1 minus integral Subscript negative normal infinity Superscript x Baseline equals 1 minus upper F Subscript upper Z Baseline left parenthesis x right parenthesis periodFZ(x) =
⌠−x
−∞
fZ(t)dt =
⌠∞
x
fZ(t)dt = 1 −
⌠x
−∞
= 1 −FZ(x).
It follows that upper Z equals Overscript d Endscripts negative upper ZZ d= −Z: 
sans serif upper P left parenthesis negative upper Z less than or slanted equals x right parenthesis equals sans serif upper P left parenthesis upper Z greater than or slanted equals negative x right parenthesis equals 1 minus upper F Subscript upper Z Baseline left parenthesis negative x right parenthesis equals upper F Subscript upper Z Baseline left parenthesis x right parenthesis periodP(−Z ⩽x) = P(Z ⩾−x) = 1 −FZ(−x) = FZ(x).
If we take the sum of upper X tilde normal upper N left parenthesis mu 1 comma sigma 1 squared right parenthesisX ∼N(μ1, σ 2
1 ) and upper Y tilde normal upper N left parenthesis mu 2 comma sigma 2 squared right parenthesisY ∼N(μ2, σ 2
2 ), which are independent, 
then 
StartLayout 1st Row 1st Column upper M Subscript upper X plus upper Y Baseline left parenthesis u right parenthesis 2nd Column equals 3rd Column upper M Subscript upper X Baseline left parenthesis u right parenthesis upper M Subscript upper Y Baseline left parenthesis u right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column exp left parenthesis mu 1 u plus StartFraction sigma 1 squared u squared Over 2 EndFraction right parenthesis exp left parenthesis mu 2 u plus StartFraction sigma 2 squared u squared Over 2 EndFraction right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column exp left parenthesis left parenthesis mu 1 plus mu 2 right parenthesis u plus StartFraction left parenthesis sigma 1 squared plus sigma 2 squared right parenthesis u squared Over 2 EndFraction right parenthesis equals upper W comma EndLayoutMX+Y (u) = MX(u)MY (u)
= exp
⎛
μ1 u + σ 2
1 u2
2
⎞
exp
⎛
μ2 u + σ 2
2 u2
2
⎞
= exp
⎛
(μ1 + μ2)u + (σ 2
1 + σ 2
2 )u2
2
⎞
= W,
hence upper W tilde normal upper N left parenthesis mu 1 plus mu 2 comma sigma 1 squared plus sigma 2 squared right parenthesisW ∼N(μ1+μ2, σ 2
1 +σ 2
2 ). Taking instead the sum of two dependent Gaussian 
rvs, the resulting rv can be Gaussian whenever the joint density is of particular form. 
In fact, a random vector bold upper X equals left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesisX = (X1, . . . , Xn) is said to be Gaussian distributed if its 
components upper X Subscript iXi are continuous rvs with joint density 
f Subscript bold italic upper X Baseline left parenthesis bold italic x right parenthesis equals StartFraction 1 Over left parenthesis 2 pi right parenthesis Superscript n divided by 2 Baseline left parenthesis det bold italic upper Sigma right parenthesis Superscript 1 divided by 2 Baseline EndFraction exp left parenthesis minus one half left parenthesis bold italic x minus bold italic mu right parenthesis bold italic upper Sigma Superscript negative 1 Baseline left parenthesis bold x minus bold italic mu right parenthesis Superscript prime Baseline right parenthesis comma bold italic x element of double struck upper R Superscript n Baseline commafX(x) =
1
(2π)n/2(det ∑)1/2 exp
(
−1
2(x −μ) ∑−1 (x −μ)')
,
x ∈Rn,
(5.14)
5.7
Gaussian
161
where bold italic upper Sigma∑is a n times nn × n symmetric and positive semi-deﬁnite matrix,8 bold italic mu element of double struck upper R Superscript nμ ∈Rn. A prime  
prime' stands for matrix transposition9 and det bold italic upper Sigmadet ∑denotes the determinant of bold italic upper Sigma∑. We write 
bold italic upper X tilde normal upper N left parenthesis bold italic mu comma bold italic upper Sigma right parenthesisX ∼N(μ, ∑). For  n equals 2n = 2, a bi-variate Gaussian random vector has joint density 
given by (5.14), where: 
• 
the inverse of bold italic upper Sigma∑is 
bold italic upper Sigma Superscript negative 1 Baseline equals StartFraction 1 Over c 11 c Subscript 22 minus Baseline minus c 12 squared EndFraction Start 2 By 2 Matrix 1st Row 1st Column c 22 2nd Column minus c 12 2nd Row 1st Column minus c 21 2nd Column c 11 EndMatrix comma∑−1 =
1
c11c22−−c2
12
⎾c22 −c12
−c21 c11
⏋
,
for det bold italic upper Sigma equals c 11 c 22 minus c 12 squared not equals 0det ∑= c11c22 −c2
12 /= 0, with c 12 equals c 21c12 = c21; 
• 
.c11 = V(X1) = σ 2
1 and c 22 equals sans serif upper V left parenthesis upper X 2 right parenthesis equals sigma 2 squaredc22 = V(X2) = σ 2
2 ; 
• 
.c12 = cov(X1, X2); 
• 
.corr(X1, X2) =
c12
σ1σ2 = ρ, the Pearson correlation coefﬁcient. 
Indeed, let bold italic mu equals left parenthesis mu 1 comma mu 2 right parenthesisμ = (μ1, μ2) and perform the matrix multiplication left parenthesis bold italic x minus bold italic mu right parenthesis bold italic upper Sigma Superscript negative 1 Baseline left parenthesis bold italic x minus bold italic mu right parenthesis prime(x−μ) ∑−1 (x−μ)'
to get 
StartLayout 1st Row 1st Column f left parenthesis x 1 comma x 2 right parenthesis 2nd Column equals 3rd Column a 1 left parenthesis x 1 minus mu 1 right parenthesis squared minus 2 a 2 left parenthesis x 1 minus mu 1 right parenthesis left parenthesis x 2 minus mu 2 right parenthesis 2nd Row 1st Column Blank 2nd Column plus 3rd Column a 3 left parenthesis x 2 minus mu 2 right parenthesis squared greater than or slanted equals 0 comma for every left parenthesis x 1 comma x 2 right parenthesis element of double struck upper R squared comma EndLayoutf (x1, x2) = a1(x1 −μ1)2 −2a2(x1 −μ1)(x2 −μ2)
+ a3(x2 −μ2)2 ⩾0,
for every (x1, x2) ∈R2,
i.e. a quadratic form with a 1 equals StartFraction c 11 Over det bold italic upper Sigma EndFractiona1 =
c11
det ∑, a 2 equals StartFraction c 12 Over det bold italic upper Sigma EndFractiona2 =
c12
det ∑, and a 3 equals StartFraction c 22 Over det bold italic upper Sigma EndFractiona3 =
c22
det ∑. The density is: 
f Subscript bold italic upper X Baseline left parenthesis x 1 comma x 2 right parenthesis equals StartFraction 1 Over 2 pi left parenthesis c 11 c 22 minus c 12 squared right parenthesis Superscript 1 divided by 2 Baseline EndFraction normal e Superscript f left parenthesis x 1 comma x 2 right parenthesisfX(x1, x2) =
1
2π(c11c22 −c2
12)1/2 ef (x1,x2)
which we rewrite 
StartLayout 1st Row 1st Column f Subscript bold italic upper X Baseline left parenthesis x 1 comma x 2 right parenthesis 2nd Column equals 3rd Column StartFraction 1 Over 2 pi sigma 1 sigma 2 StartRoot 1 minus rho squared EndRoot EndFraction exp left parenthesis minus StartFraction 1 Over 2 left parenthesis 1 minus rho squared right parenthesis EndFraction left parenthesis StartFraction left parenthesis x 1 minus mu 1 right parenthesis squared Over sigma 1 squared EndFraction 2nd Row 1st Column Blank 2nd Column minus 3rd Column 2 rho StartFraction x 1 minus mu 1 Over sigma 1 EndFraction StartFraction x 2 minus mu 2 Over sigma 2 EndFraction plus StartFraction left parenthesis x 2 minus mu 2 right parenthesis squared Over sigma 2 squared EndFraction right parenthesis right parenthesis period EndLayoutfX(x1, x2) =
1
2πσ1σ2
√
1 −ρ2 exp
⎛
−
1
2 (1 −ρ2)
⎛(x1 −μ1)2
σ 2
1
−2ρ x1 −μ1
σ1
x2 −μ2
σ2
+ (x2 −μ2)2
σ 2
2
⎞⎞
.
Essentially, in the bi-dimensional case such a joint distribution has ﬁve parameters: 
mu 1 element of double struck upper Rμ1 ∈R, mu 2 element of double struck upper Rμ2 ∈R, sigma 1 greater than 0σ1 > 0, sigma 1 greater than 0σ1 > 0, and negative 1 less than rho less than 1 period−1 < ρ < 1. The relevant fact here is: 
Theorem 5.3 If bold italic upper X equals left parenthesis upper X 1 comma upper X 2 right parenthesis tilde normal upper N left parenthesis bold italic mu comma bold italic upper Sigma right parenthesis commaX = (X1, X2) ∼N(μ, ∑), then upper X Subscript i Baseline tilde normal upper N left parenthesis mu Subscript i Baseline comma sigma Subscript i Superscript 2 Baseline right parenthesisXi ∼N(μi, σ 2
i ) for i equals 1 comma 2 periodi = 1, 2.
For a proof of this see Exercise 5.11. There is an analogous of Theorem 5.3 
for n-dimensional Gaussian vectors. It is worth noting how for bi-variate Gaussian 
distributions rho equals 0ρ = 0 is equivalent to independence of upper X 1X1 and upper X 2X2. More generally, let
8 It is invertible. 
9 We assume that any bold italic x element of double struck upper R Superscript nx ∈Rn is represented by a row vector. 
162
5
Special Distributions
bold italic upper Sigma equals bold italic upper I∑= I, where bold italic upper II is the n times nn × n identity matrix, and bold italic muμ is the null vector, then bold italic upper I Superscript negative 1 Baseline equals bold italic upper II−1 = I
with det bold italic upper I equals 1det I = 1 and expression (5.14) reduces to 
StartLayout 1st Row 1st Column f Subscript bold italic upper X Baseline left parenthesis bold italic x right parenthesis 2nd Column equals 3rd Column StartFraction 1 Over left parenthesis 2 pi right parenthesis Superscript n divided by 2 Baseline EndFraction normal e Superscript StartFraction bold italic x bold italic x prime Over 2 EndFraction 2nd Row 1st Column Blank 2nd Column equals 3rd Column ContinuedFraction 1 Over StartRoot 2 pi EndRoot midline horizontal ellipsis StartRoot 2 pi EndRoot normal e Superscript minus x squared divided by 2 Baseline midline horizontal ellipsis normal e Superscript minus x squared divided by 2 Baseline comma EndLayoutfX(x) =
1
(2π)n/2 e
xx'
2
=
1
√
2π · · ·
√
2π
e−x2/2 · · · e−x2/2,
which means that the joint density factors and the component rvs are independent. 
If bold italic upper X equals left parenthesis upper X 1 comma upper X 2 right parenthesisX = (X1, X2) is bi-variate normal and a 1 comma a 2 element of double struck upper Ra1, a2 ∈R, then 
a 1 upper X 1 plus a 2 upper X 2 tilde normal upper N left parenthesis a 1 mu 1 plus a 2 mu 2 comma a 1 sigma 1 squared plus a 2 sigma 2 squared plus 2 a 1 a 2 rho sigma 1 sigma 2 right parenthesis perioda1X1 + a2X2 ∼N
⎛
a1μ1 + a2μ2, a1σ 2
1 + a2σ 2
2 + 2a1a2ρσ1σ2
⎞
.
In particular if upper X 1 comma upper X 2X1, X2 are independent (and then rho equals 0ρ = 0) the dispersion parameter 
simpliﬁes to a 1 sigma 1 squared plus a 2 sigma 2 squareda1σ 2
1 + a2σ 2
2 . This is a consequence of Theorem 5.3 and the use of 
MGF upper M Subscript a 1 upper X 1 plus a 2 upper X 2 Baseline left parenthesis u right parenthesisMa1X1+a2X2(u). As for bi-variate uniform distributions seen in Sect. 5.6, bi-
variate Gaussian random vectors lead to marginal distribution of one component rv 
conditional on the other, see Chap. 6. By Proposition 4.3 in Sect. 4.7, for a given 
deterministic m times nm × n matrix bold italic upper AA and a Gaussian random vector bold italic upper X tilde normal upper N left parenthesis bold italic mu comma bold italic upper Sigma right parenthesisX ∼N(μ, ∑) we have 
bold italic upper A bold italic upper X Superscript prime Baseline tilde normal upper N left parenthesis bold italic upper A bold italic mu comma bold italic upper A bold italic upper Sigma bold italic upper A Superscript prime Baseline right parenthesis periodAX' ∼N(Aμ, A∑A').
Other univariate limiting distributions might be obtained from the univariate 
Gaussian, and this will be treated in Chap. 8. We highlight a connection between the 
binomial and the Gaussian distribution which could be useful in modelling future 
stock prices and related returns. Let upper X Subscript n Baseline tilde upper B i n left parenthesis n comma p right parenthesisXn ∼Bin(n, p) and set StartFraction upper X Subscript n Baseline minus n p Over StartRoot n p left parenthesis 1 minus p right parenthesis EndRoot EndFraction
Xn−np
√np(1−p). Then, it can 
be showed that for n large enough the distribution of upper X Subscript nXn is approximately standard 
normal: the trick is to consider upper X Subscript nXn as the sum of IID upper X Subscript i Baseline tilde upper B e r left parenthesis p right parenthesisXi ∼Ber(p). Another way to 
express this is writing 
upper X Subscript n Baseline is approximately distributed as normal upper N left parenthesis n p comma n p left parenthesis 1 minus p right parenthesis right parenthesis periodXn
is approximately distributed as
N(np, np(1 −p)).
The R commands to handle a Gaussian distribution are reported below. 
Program Code 
S=20; mu <- 0; sigma <- 1 
rnorm(S,mu,sigma) 
q=seq(0:10) 
p=seq(from=0.01,to=0.99, lenght=50) 
dnorm(q,mu,sigma) 
pnorm(q,mu,sigma) 
qnorm(p,mu,sigma)
5.7
Gaussian
163
Recall 
that 
rnorm(x,mu,sigma) 
yields 
a 
realization 
x 
drawn 
from 
normal upper N left parenthesis mu comma sigma squared right parenthesisN(μ, σ 2), 
dnorm(x,mu,sigma) 
evaluates 
the 
Gaussian 
density 
at 
x, 
pnorm(x,mu,sigma) 
evaluates 
the 
Gaussian 
CDF 
up 
to 
x 
and 
qnorm(p,mu,sigma) entails the Gaussian quantile function evaluated at the 
probability level p. Obviously, when x and p are vectors, i.e, lists of values, these 
commands produce lists of output. Note that sigma is the standard deviation not 
the variance. For the bi-variate Gaussian, if we know the values of all the ﬁve 
parameters, then we can deﬁne the covariance matrix as 
Sigma=matrix(c(s12,s1*s2*rho,s22,s1*s2*rho),nrow=2,ncol=2) 
where s12 is the variance sigma 1 squaredσ 2
1 of the ﬁrst component rv of the Gaussian vector, s22 
is the variance sigma 2 squaredσ 2
2 of the second component, while s1*s2*rho is the covariance 
sans serif c o v left parenthesis upper X 1 comma upper X 2 right parenthesiscov(X1, X2) with standard deviations sigma 1 comma sigma 2σ1, σ2 and correlation coefﬁcient rhoρ. To get 
the inverse of Sigma we type solve(Sigma). Another rv whose distribution is 
related to the Gaussian is the log-normal: let upper X tilde normal upper N left parenthesis mu comma sigma squared right parenthesisX ∼N(μ, σ 2) and let upper Y equals ln upper XY = ln X, then 
we have the CDF 
StartLayout 1st Row 1st Column upper F Subscript upper Y Baseline left parenthesis y right parenthesis equals sans serif upper P left parenthesis upper Y less than or slanted equals y right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis normal e Superscript upper X Baseline less than or slanted equals y right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper X less than or slanted equals ln y right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript ln y Baseline StartFraction 1 Over StartRoot 2 pi sigma squared EndRoot EndFraction normal e Superscript minus StartFraction left parenthesis x minus mu right parenthesis squared Over 2 sigma squared EndFraction Baseline normal d x comma EndLayoutFY (y) = P(Y ⩽y) = P
⎛
eX ⩽y
⎞
= P(X ⩽ln y)
=
⌠ln y
−∞
1
√
2πσ 2 e−(x−μ)2
2σ2 dx,
(5.15) 
see Sect. 4.5 in Chap. 4. Differentiating the CDF we get 
StartLayout 1st Row 1st Column f Subscript upper Y Baseline left parenthesis y right parenthesis 2nd Column equals 3rd Column StartFraction normal d Over normal d y EndFraction h left parenthesis g left parenthesis y right parenthesis right parenthesis equals StartFraction normal d Over normal d y EndFraction upper F Subscript upper Y Baseline left parenthesis y right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column upper F prime Subscript upper Y Baseline StartFraction normal d Over normal d y EndFraction left parenthesis ln y right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction 1 Over y StartRoot 2 pi EndRoot sigma EndFraction exp left parenthesis minus StartFraction left parenthesis ln y minus mu right parenthesis squared Over 2 sigma squared EndFraction right parenthesis bold upper I Subscript left brace y greater than 0 right brace Baseline period EndLayoutfY (y) = d
dy h(g(y)) = d
dy FY (y)
= F '
Y
d
dy (ln y)
=
1
y
√
2πσ
exp
⎛
−(ln y −μ)2
2σ 2
⎞
I{y>0}.
(5.16) 
Note that we add the restriction bold upper I Subscript left brace y greater than 0 right braceI{y>0} since Y cannot assume negative values. Thus, 
Y is log-normal with parameters mu comma sigma squaredμ, σ 2 because ln left parenthesis upper Y right parenthesis tilde normal upper N left parenthesis mu comma sigma squared right parenthesisln(Y) ∼N(μ, σ 2). The log-normal 
rv is used in models of future stock prices taking advantage of its positive values. 
The expectation and variance are 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper Y right parenthesis 2nd Column equals 3rd Column normal e Superscript mu plus sigma squared divided by 2 Baseline EndLayout StartLayout 2nd Row 1st Column sans serif upper V left parenthesis upper Y right parenthesis 2nd Column equals 3rd Column normal e Superscript 2 mu plus sigma squared Baseline left parenthesis normal e Superscript sigma squared Baseline minus 1 right parenthesis comma EndLayoutE(Y) = eμ+σ 2/2Alt-text already available with first equation in this block
(5.17) 
V(Y) = e2μ+σ 2 (eσ 2 − 1),
(5.18) 
see Exercise 5.12.
164
5
Special Distributions
Remark 5.3 Let upper Y equals ln upper XY = ln X be a log-normal rv and assume upper X tilde normal upper N left parenthesis 0 comma 1 right parenthesisX ∼N(0, 1) is standard 
normal. The density function is 
f Subscript upper Y Baseline left parenthesis x right parenthesis equals StartFraction 1 Over x EndFraction StartFraction 1 Over StartRoot 2 pi EndRoot EndFraction normal e Superscript minus left parenthesis ln x right parenthesis squared divided by 2 Baseline comma x greater than 0 commafY (x) = 1
x
1
√
2π
e−(ln x)2/2,
x > 0,
so the MGF writes 
StartFraction 1 Over StartRoot 2 pi EndRoot EndFraction integral Subscript 0 Superscript normal infinity Baseline normal e Superscript u x minus left parenthesis ln x right parenthesis squared divided by 2 minus ln x Baseline normal d x period 1
√
2π
⌠∞
0
eu x−(ln x)2/2−ln xdx.
Now, for any u greater than 0u > 0 we recall from a basic calculus course that StartFraction u x Over ln x EndFraction right arrow normal infinity u x
ln x →∞as 
x right arrow normal infinityx →∞, then 
StartFraction u x minus left parenthesis ln x right parenthesis squared divided by 2 minus ln x Over u x EndFraction equals 1 minus left parenthesis ln x right parenthesis squared divided by 2 u x minus ln x divided by u x right arrow 1 comma as x right arrow normal infinity commau x −(ln x)2/2 −ln x
u x
= 1 −(ln x)2/2u x −ln x/u x →1,
as x →∞,
and the exponent in the integrand of the integral is asymptotic to u xu x, i.e., u x minus left parenthesis ln x right parenthesis squared divided by 2 minus ln x tilde u xu x −
(ln x)2/2 −ln x ∼u x as x right arrow normal infinityx →∞. This implies that sans serif upper E left parenthesis normal e Superscript u upper X Baseline right parenthesis equals normal infinityE(eu X) = ∞and actually the 
MGF does not exist. Notwithstanding, for some p element of double struck upper Np ∈N write 
sans serif upper E left parenthesis upper X Superscript p Baseline right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline normal e Superscript p t Baseline StartFraction 1 Over StartRoot 2 pi EndRoot EndFraction normal e Superscript minus t squared divided by 2 Baseline normal d t equals normal e Superscript p squared divided by 2 Baseline less than normal infinity commaE(Xp) =
⌠∞
−∞
ept
1
√
2π
e−t2/2dt = ep2/2 < ∞,
where we use the change of variable ln x equals tln x = t with normal d ln x equals StartFraction 1 Over x EndFraction equals normal d td ln x =
1
x = dt and x Superscript p Baseline equals normal e Superscript p ln x Baseline equals normal e Superscript p t Baseline periodxp =
ep ln x = ept. Hence, all the p-th moments of the log-normal distribution do exist 
and are ﬁnite. 
5.8 
Exponential 
The exponential distribution characterizes rvs with nonnegative real values. Histori-
cally, it models waiting of a success in continuous time, where the rate of successes 
for unit time is governed by a parameter lamda greater than 0λ > 0. The density function reported in 
Table 5.2 has CDF given by 
upper F Subscript upper X Baseline left parenthesis x right parenthesis equals integral Subscript negative normal infinity Superscript x Baseline lamda normal e Superscript minus lamda z Baseline bold upper I Subscript left brace z greater than or slanted equals 0 right brace Baseline normal d z equals integral Subscript 0 Superscript x Baseline lamda normal e Superscript minus lamda s Baseline normal d z equals 1 minus normal e Superscript minus lamda x Baseline commaFX(x) =
⌠x
−∞
λ e−λz I{z⩾0}dz =
⌠x
0
λ e−λsdz = 1 −e−λx,
(5.19) 
see also Fig. 5.5. 
A ﬁnancial application is when upper X tilde upper E x p left parenthesis lamda right parenthesisX ∼Exp(λ) represents the value of a callable 
bond before its drawing. Thus sans serif upper P left parenthesis upper X greater than t right parenthesis equals normal e Superscript minus lamda tP(X > t) = e−λt is the probability that the bond will 
have a life of at least t greater than 0t > 0 years. The expectation of upper X tilde upper E x p left parenthesis lamda right parenthesisX ∼Exp(λ) is sans serif upper E left parenthesis upper X right parenthesis equals StartFraction 1 Over lamda EndFractionE(X) = 1
λ and
5.8
Exponential
165
Fig. 5.5 Density of a upper E x p left parenthesis 2 right parenthesisExp(2)
0.0
0.5
1.0
1.5
2.0
2.5
3.0 
0.0 
0.5 
1.0 
1.5 
2.0 
the variance is sans serif upper V left parenthesis upper X right parenthesis equals StartFraction 1 Over lamda squared EndFractionV(X) =
1
λ2 , see Exercise 5.13. The  MGF of  upper X tilde upper E x p left parenthesis lamda right parenthesisX ∼Exp(λ) is derived 
below assuming that u less than lamdau < λ: 
StartLayout 1st Row 1st Column upper M Subscript upper X Baseline left parenthesis u right parenthesis 2nd Column equals 3rd Column integral Subscript 0 Superscript normal infinity Baseline normal e Superscript u x Baseline lamda normal e Superscript minus lamda x normal d x 2nd Row 1st Column Blank 2nd Column equals 3rd Column lamda left bracket StartFraction normal e Superscript left parenthesis u minus lamda right parenthesis x Baseline Over u minus lamda EndFraction right bracket Subscript 0 Superscript normal infinity 3rd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction lamda Over lamda minus u EndFraction period EndLayoutMX(u) =
⌠∞
0
eu xλe−λxdx
= λ
⎾
e(u−λ)x
u −λ
⏋∞
0
=
λ
λ −u.
The above constraint u less than lamdau < λ is needed since for u greater than or slanted equals lamdau ⩾λ the integral does diverge. 
Remark 5.4 From Example 2.14 in Sect. 2.9, we recognize 
upper F Subscript upper Y Baseline left parenthesis x right parenthesis equals StartLayout Enlarged left brace 1st Row 1st Column 0 comma 2nd Column if x less than 0 2nd Row 1st Column 1 minus normal e Superscript minus lamda x Baseline comma 2nd Column if 0 less than or slanted equals x less than s 3rd Row 1st Column 1 comma 2nd Column if x greater than or slanted equals s comma EndLayoutFY (x) =
⎧
⎨
⎩
0,
if x < 0
1 −e−λx, if 0 ⩽x < s
1,
if x ⩾s,
with lamda greater than 0λ > 0 and s greater than 0s > 0, a CDF similar to that of an exponential rv. Indeed, this is the 
truncated exponential CDF, a mixed rv. This is because the Y’s distribution has a 
continuous part given by the exponential density truncated at s, while the remaining 
discrete part is the point mass at normal e Superscript minus lamda se−λs. Therefore, we can compute its MGF using
166
5
Special Distributions
the change of variable formula to adapt the expectation of Y to the transform normal e Superscript u upper Yeu Y
via the original mixed distribution: 
StartLayout 1st Row 1st Column upper M Subscript upper Y Baseline left parenthesis u right parenthesis 2nd Column equals 3rd Column ModifyingBelow integral Subscript 0 Superscript s Baseline normal e Superscript u x Baseline lamda normal e Superscript minus lamda s normal d x With bottom brace Underscript sans serif upper E left parenthesis dot right parenthesis of cont period part Endscripts plus normal e Superscript u s Baseline normal e Superscript minus lamda s 2nd Row 1st Column Blank 2nd Column StartLayout 1st Row u not equals lamda 2nd Row equals EndLayout 3rd Column lamda left bracket StartFraction normal e Superscript left parenthesis u minus lamda right parenthesis x Baseline Over u minus lamda EndFraction right bracket Subscript 0 Superscript s plus normal e Superscript minus s left parenthesis lamda minus u right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction lamda Over lamda minus u EndFraction minus StartFraction u Over lamda minus u EndFraction normal e Superscript minus s left parenthesis lamda minus u right parenthesis Baseline period EndLayoutMY (u) =
⌠s
0
eu xλe−λsdx
◟
◝◜
◞
E( · ) of cont. part
+eu se−λs
u/=λ
=
λ
⎾
e(u−λ)x
u −λ
⏋s
0
+ e−s(λ−u)
=
λ
λ −u −
u
λ −ue−s(λ−u).
For u equals lamdau = λ we have upper M Subscript upper Y Baseline left parenthesis u right parenthesis equals lamda s plus 1MY (u) = λs + 1. 
An interesting property of the exponential distribution is stated as follows: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper X greater than or slanted equals x plus y vertical bar upper X greater than or slanted equals x right parenthesis 2nd Column equals 3rd Column StartFraction sans serif upper P left parenthesis upper X greater than or slanted equals x plus y right parenthesis Over sans serif upper P left parenthesis upper X greater than or slanted equals x right parenthesis EndFraction 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction normal e Superscript minus lamda left parenthesis x plus y right parenthesis Baseline Over normal e Superscript minus lamda x Baseline EndFraction equals normal e Superscript minus lamda y Baseline equals sans serif upper P left parenthesis upper X greater than or slanted equals y right parenthesis comma EndLayoutP(X ⩾x + y | X ⩾x) = P(X ⩾x + y)
P(X ⩾x)
= e−λ(x+y)
e−λx
= e−λy = P(X ⩾y),
where we used left brace upper X greater than or slanted equals x plus y right brace intersection left brace upper X greater than or slanted equals x right brace equals left brace upper X greater than or slanted equals x plus y right brace{X ⩾x + y} ∩{X ⩾x} = {X ⩾x + y}, because x plus y greater than or slanted equals xx + y ⩾x, 
in the deﬁnition of the conditional probability, while the last line follows from the 
deﬁnition of the CDF. This is called memoryless property, if  x comma yx, y are interpreted 
as waiting times. There is an interesting relationship between the exponential and 
the Poisson rvs, which can be easily derived by the deﬁnition of their probability 
distributions (viz. the CDF or density, and the mass). For upper X tilde upper E x p left parenthesis lamda right parenthesisX ∼Exp(λ) and upper P o left parenthesis lamda x right parenthesisPo(λx)
we have 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper X greater than x right parenthesis 2nd Column equals 3rd Column 1 minus upper F Subscript upper X Baseline left parenthesis x right parenthesis equals normal e Superscript minus lamda x Baseline 2nd Row 1st Column Blank 2nd Column equals 3rd Column normal e Superscript lamda x Baseline StartFraction lamda Superscript 0 Baseline Over 0 factorial EndFraction equals sans serif upper P left parenthesis upper Y equals 0 right parenthesis period EndLayoutP(X > x) = 1 −FX(x) = e−λx
= eλx λ0
0! = P(Y = 0).
From this we also deduce 
sans serif upper P left parenthesis upper X less than or slanted equals x right parenthesis equals sans serif upper P left parenthesis upper Y greater than 0 right parenthesisP(X
⩽
x)
=
P(Y
>
0). There are R com-
mands for handling the exponential distribution similar to those viewed for the 
aforementioned distributions, namely rexp(x,lambda), dexp(x,lambda), 
pexp(x,lambda) and qexp(x,lambda).
5.9
Gamma
167
5.9 
Gamma 
A rv upper X greater than 0X > 0 with gamma distribution generalizes the exponential law. The deﬁnition 
of its density requires the gamma function, which in turn generalizes the factorial 
function early deﬁned only for positive integers: 
upper Gamma left parenthesis alpha right parenthesis equals integral Subscript 0 Superscript normal infinity Baseline x Superscript alpha minus 1 Baseline normal e Superscript negative x Baseline normal d x comma alpha greater than 0 period𝚪(α) =
⌠∞
0
xα−1e−xdx,
α > 0.
(5.20) 
Note that for alpha equals 1α = 1 we have 
upper Gamma left parenthesis 1 right parenthesis equals integral Subscript 0 Superscript normal infinity Baseline normal e Superscript negative x Baseline normal d x equals 1 period𝚪(1) =
⌠∞
0
e−xdx = 1.
(5.21) 
Integrating by parts for alpha greater than 0α > 0 we also have 
StartLayout 1st Row upper Gamma left parenthesis alpha plus 1 right parenthesis equals integral Subscript 0 Superscript normal infinity Baseline x Superscript alpha Baseline normal e Superscript negative x Baseline normal d x equals ModifyingBelow left bracket minus x Superscript alpha Baseline normal e Superscript negative x Baseline right bracket Subscript 0 Superscript normal infinity Baseline With bottom brace Underscript equals 0 Endscripts plus alpha integral Subscript 0 Superscript normal infinity Baseline x Superscript alpha minus 1 Baseline normal e Superscript negative x Baseline normal d x equals alpha upper Gamma left parenthesis alpha right parenthesis period EndLayout𝚪(α + 1) =
⌠∞
0
xαe−xdx =
⎾
−xαe−x⏋∞
0
◟
◝◜
◞
=0
+α
⌠∞
0
xα−1e−xdx = α𝚪(α).
(5.22) 
Hence, by induction it holds upper Gamma left parenthesis n right parenthesis equals left parenthesis n minus 1 right parenthesis factorial𝚪(n) = (n −1)! for n element of double struck upper Nn ∈N. To get the density function 
of upper X tilde upper G a m m a left parenthesis alpha comma 1 right parenthesisX ∼Gamma(α, 1) we simply divide both sides of (5.21) by upper Gamma left parenthesis alpha right parenthesis𝚪(α), then 
1 equals integral Subscript 0 Superscript normal infinity Baseline StartFraction x Superscript alpha minus 1 Baseline normal e Superscript negative x Baseline Over upper Gamma left parenthesis alpha right parenthesis EndFraction normal d x1 =
⌠∞
0
xα−1e−x
𝚪(α)
dx
and f Subscript upper X Baseline left parenthesis x right parenthesis equals StartFraction x Superscript alpha minus 1 Baseline normal e Superscript negative x Baseline Over upper Gamma left parenthesis alpha right parenthesis EndFraction bold upper I Subscript left brace x greater than 0 right bracefX(x) = xα−1e−x
𝚪(α) I{x>0} is a truly density. With a little extra effort we obtain 
the density of upper Y equals StartFraction upper X Over lamda EndFraction tilde upper G a m m a left parenthesis alpha comma lamda right parenthesisY = X
λ ∼Gamma(α, λ) reported in Table 5.2, where lamda greater than 0λ > 0 is the 
additional parameter, see Fig. 5.6. 
Fig. 5.6 Density of a 
upper G a m m a left parenthesis 3 comma 1 right parenthesisGamma(3, 1)
0
2
4
6
8
 10
12
14
 
0.00 
0.05 
0.10 
0.15 
0.20 
0.25
168
5
Special Distributions
Remark 5.5 Any function g left parenthesis x right parenthesis equals k x Superscript alpha minus 1 Baseline normal e Superscript minus x lamda Baseline bold upper I Subscript left brace x greater than 0 right braceg(x) = k xα−1e−xλI{x>0}, for  k greater than 0k > 0, is a density and 
k equals StartFraction lamda Superscript alpha Baseline Over upper Gamma left parenthesis alpha right parenthesis EndFractionk =
λα
𝚪(α), see Exercise 5.15. On the other hand, by formula (4.11) in Sect. 4.5 
applied to the increasing transformation upper Y equals StartFraction upper X Over lamda EndFractionY = X
λ we have 
f Subscript upper Y Baseline left parenthesis y right parenthesis equals StartFraction 1 Over upper Gamma left parenthesis alpha right parenthesis EndFraction left parenthesis lamda y right parenthesis Superscript alpha Baseline normal e Superscript minus lamda y Baseline y Superscript negative 1 Baseline comma y greater than 0 commafY (y) =
1
𝚪(α)(λ y)αe−λ yy−1,
y > 0,
which is the density of upper G a m m a left parenthesis alpha comma lamda right parenthesisGamma(α, λ), see Exercise 5.16. 
It is worth noting that for alpha equals 1α = 1 the gamma distribution upper Y tilde upper G a m m a left parenthesis 1 comma lamda right parenthesisY ∼Gamma(1, λ) has 
the same density as that of the upper E x p left parenthesis lamda right parenthesisExp(λ). The expectation and variance of a gamma 
rv upper X tilde upper G a m m a left parenthesis alpha comma 1 right parenthesisX ∼Gamma(α, 1) are sans serif upper E left parenthesis upper X right parenthesis equals sans serif upper V left parenthesis upper X right parenthesis equals alphaE(X) = V(X) = α, see Exercise 5.16. We deduce that 
upper Y equals StartFraction upper X Over lamda EndFraction tilde upper G a m m a left parenthesis alpha comma lamda right parenthesisY = X
λ ∼Gamma(α, λ) has expectation 
sans serif upper E left parenthesis upper Y right parenthesis equals StartFraction 1 Over lamda EndFraction sans serif upper E left parenthesis upper X right parenthesis equals StartFraction alpha Over lamda EndFraction commaE(Y) = 1
λE(X) = α
λ ,
and variance 
sans serif upper V left parenthesis upper Y right parenthesis equals StartFraction 1 Over lamda EndFraction sans serif upper V left parenthesis upper X right parenthesis equals StartFraction alpha Over lamda squared EndFraction periodV(Y) = 1
λV(X) = α
λ2 .
The MGF of Y is easily derived: 
StartLayout 1st Row 1st Column upper M Subscript upper Y Baseline left parenthesis u right parenthesis 2nd Column equals 3rd Column integral Subscript 0 Superscript normal infinity Baseline normal e Superscript u x Baseline StartFraction lamda Superscript alpha Baseline x Superscript alpha minus 1 Baseline normal e Superscript minus lamda x Baseline Over upper Gamma left parenthesis alpha right parenthesis EndFraction normal d x 2nd Row 1st Column Blank 2nd Column equals 3rd Column left parenthesis StartFraction lamda Over lamda minus u EndFraction right parenthesis Superscript alpha Baseline integral Subscript 0 Superscript normal infinity Baseline ModifyingBelow StartFraction left parenthesis lamda minus u right parenthesis Superscript alpha Baseline x Superscript alpha minus 1 Baseline normal e Superscript minus left parenthesis lamda minus u right parenthesis x Baseline Over upper Gamma left parenthesis alpha right parenthesis EndFraction With bottom brace Underscript equals upper Gamma left parenthesis alpha comma lamda minus u right parenthesis Endscripts normal d x 3rd Row 1st Column Blank 2nd Column equals 3rd Column left parenthesis StartFraction lamda Over lamda minus u EndFraction right parenthesis Superscript alpha Baseline comma u less than lamda period EndLayoutMY (u) =
⌠∞
0
eux λαxα−1e−λx
𝚪(α)
dx
=
⎛
λ
λ −u
⎞α ⌠∞
0
(λ −u)αxα−1e−(λ−u)x
𝚪(α)
◟
◝◜
◞
=𝚪(α,λ−u)
dx
=
⎛
λ
λ −u
⎞α
,
u < λ.
The condition u less than lamdau < λ ensures that the MGF exists for u in an neighborhood of zero. 
Incidentally, we recognize that upper M Subscript upper Y Baseline left parenthesis u right parenthesisMY (u) is also equal to the MGF 
upper M Subscript upper X 1 plus midline horizontal ellipsis plus upper X Sub Subscript n Subscript Baseline left parenthesis u right parenthesis equals upper M Subscript upper X 1 Baseline midline horizontal ellipsis upper M Subscript upper X Sub Subscript n Subscript Baseline comma for IID upper X Subscript i Baseline tilde upper E x p left parenthesis lamda right parenthesis periodMX1+···+Xn(u) = MX1 · · · MXn,
for IID Xi ∼Exp(λ).
Interesting enough, there is a connection also between gamma and Gaussian 
distribution. Indeed, let upper V tilde normal upper N left parenthesis 0 comma sigma squared right parenthesisV ∼N(0, σ 2) and consider the transform upper W equals upper V squaredW = V 2. Then, 
W has a density f Subscript upper W Baseline left parenthesis x right parenthesis bold upper I Subscript left brace x greater than 0 right bracefW(x)I{x>0} which is nothing else upper Gamma left parenthesis one half comma StartFraction 1 Over 2 sigma squared EndFraction right parenthesis𝚪( 1
2,
1
2σ 2 ), see Exercise 5.18. 
Observe that this implies upper Gamma left parenthesis one half right parenthesis equals StartRoot pi EndRoot𝚪( 1
2) = √π for the gamma function.
5.11
Exercises
169
5.10 
Student-t 
To set up a rv with Student-t distribution we ﬁrst need the Chi-square distribution 
deﬁned as upper K equals sigma summation Underscript i equals 1 Overscript n Endscripts upper Z Subscript i Superscript 2K = ∑n
i=1 Z2
i , where upper Z Subscript i Baseline tilde normal upper N left parenthesis 0 comma 1 right parenthesisZi ∼N(0, 1) are IID. We write upper K tilde chi Subscript n Superscript 2K ∼χ2
n and 
call n the degree of freedom. By Exercise 5.18, we see that upper Z 1 squared tilde upper G a m m a left parenthesis one half comma one half right parenthesisZ2
1 ∼Gamma( 1
2, 1
2)
and thus chi Subscript n Superscript 2χ2
n is nothing else the upper G a m m a left parenthesis StartFraction n Over 2 EndFraction comma one half right parenthesisGamma( n
2, 1
2), the  sum of  n IID upper G a m m a left parenthesis one half comma one half right parenthesis periodGamma( 1
2, 1
2). The 
expectation and variance are obtained by knowing their counterpart in the Gamma 
distribution, or by considering the sum of IID squared standard normals: sans serif upper E left parenthesis upper K right parenthesis equals n sans serif upper E left parenthesis upper Z 1 squared right parenthesis equals nE(K) =
nE(Z2
1) = n and 
StartLayout 1st Row 1st Column sans serif upper V left parenthesis upper K right parenthesis equals n sans serif upper V left parenthesis upper Z 1 squared right parenthesis 2nd Column equals 3rd Column n left parenthesis sans serif upper E left parenthesis upper Z 1 Superscript 4 Baseline right parenthesis minus left parenthesis sans serif upper E left parenthesis upper Z 1 squared right parenthesis right parenthesis squared right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column n left parenthesis 3 minus 1 right parenthesis equals 2 n period EndLayoutV(K) = nV(Z2
1) = n
⎛
E(Z4
1) −(E(Z2
1))2⎞
= n(3 −1) = 2n.
To obtain the MGF, we simply set the parameters in upper G a m m a left parenthesis alpha comma lamda right parenthesisGamma(α, λ) equal to StartFraction n Over 2 EndFractionn
2 and 
one half1
2, thus for u less than one halfu < 1
2 we have 
upper M Subscript upper K Baseline left parenthesis u right parenthesis equals left parenthesis StartFraction 1 Over 2 minus u EndFraction right parenthesis Superscript n divided by 2 Baseline commaMK(u) =
⎛
1
2 −u
⎞n/2
,
from which the CHF can be get by replacing u with normal i uiu. Now, the Student-t rv normal upper T tilde normal upper T left parenthesis n right parenthesisT ∼
T(n) is build using a standard normal upper Z tilde normal upper N left parenthesis 0 comma 1 right parenthesisZ ∼N(0, 1) and a Chi-square upper K tilde chi Subscript n Superscript 2K ∼χ2
n
through 
upper T equals StartFraction upper Z Over StartRoot StartFraction upper K Over n EndFraction EndRoot EndFraction commaT =
Z
/
K
n
,
provided that Z is independent of K. We say that T has a Student-t distribution 
with n degree of freedom. The Student-t distribution is symmetric, i.e., normal upper T tilde normal upper T left parenthesis n right parenthesisT ∼T(n) is 
the same as negative normal upper T tilde normal upper T left parenthesis n right parenthesis−T ∼T(n), indeed negative upper T equals StartFraction negative upper Z Over StartRoot upper K divided by n EndRoot EndFraction−T =
−Z
√K/n, where negative upper Z tilde normal upper N left parenthesis 0 comma 1 right parenthesis comma−Z ∼N(0, 1), see Fig. 5.7. 
Moreover, as n right arrow normal infinityn →∞the Student-t distribution approximate the standard normal, 
see Sect. 8.2 in Chap. 8. 
5.11 
Exercises 
5.1 Let X ∼ Bin(n, p) with failure probability q = 1 −p. Show that n − X ∼ 
Bin(n, q), for  n ⩾2. 
5.2 Prove in an alternative way that X + Y ∼ Bin(n1 + n2, p), provided X ∼ 
Bin(n1, p)  and Y ∼ Bin(n2, p). 
5.3 Prove in an alternative way that E(X) = np for X ∼Bin(n, p).
170
5
Special Distributions
Fig. 5.7 Density of a 
Student-t with n equals 10n = 10 degree 
of freedom (bold) vs standard 
normal (dashed) 
−3
−2
−1
0
1
2
3 
0.0 
0.1 
0.2 
0.3 
0.4 
5.4 Derive formula (5.11) for the variance of X ∼Po(λ). 
5.5 Show that the sum of two independent Poisson rvs X ∼ Po(λ1) and Y ∼ Po(λ2) 
is again Poisson X + Y ∼ Po(λ1 + λ2), using a different method than that of MGF. 
5.6 Given two independent Poisson rvs X ∼ Po(λ1) and Y ∼ Po(λ2), show that the 
distribution of X conditioned on X + Y = n, for  n ∈ N and X + Y ∼ Po(λ1 + λ2), 
is the binomial Bin
(
n, 
λ1 
λ1+λ2
)
. 
5.7 Let Xn ∼ Bin(n, pn), for every positive integer n ⩾1, where pn = λ 
n is s.t. 
λ = npn > 0 is constant. Prove that MXn(u) → MX(u), for  n →∞, where 
X ∼ Po(λ) and u ∈R is taken from some interval containing zero. 
5.8 Let U ∼ U(a, b), and take (c, d) ⊂(a, b). Prove that conditional on U ∈(c, d) 
the distribution of U is U ∼ U(c, d). 
5.9 Let X ∼ N(μ, σ 2). Show that
{ ∞ 
−∞ fX(x)dx = 1, where fX is the density. 
5.10 Let X ∼ N(μ, σ 2) and let Y = a + bX. Prove that Y ∼ N(a + bμ, b2σ 2). 
5.11 Let X ∼ N(μ, ∑) and n = 2. Prove Theorem 5.3. 
5.12 Derive the expectation and variance of a log-normal rv. 
5.13 Derive the expressions of the expectation and variance for an exponential rv 
with parameter λ >  0. 
5.14 (Central moments of a Gaussian rv) Prove that E((X −μ)p ) = (2p)! 
2pp! σ 2p, 
for even p ∈ N, when X ∼ N(μ, σ 2). 
5.15 Assume g(x) = k xα−1e−xλI{x>0} is a density. Show that k = λα
𝚪(α). 
5.16 Using the formula fY (y) = fX(h(y))|h'(y)|, for  h(y) = λ y, show that Y =
X 
λ ∼ Gamma(α, λ) provided that X ∼ Gamma(α, 1). 
5.17 Prove that E(X) = V(X) = α for X ∼ Gamma(α, 1).
Appendix
171
5.18 Let V ∼ N(0, σ 2) and let W = g(V ) = V 2. Show that the density of W is 
supported on (0, ∞) and equal that of 𝚪( 1 
2, 1 
2σ 2 ). 
Appendix 
Binomial vs Poisson 
Proof of Proposition 5.1 Using λ = np we compute 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper X equals i right parenthesis 2nd Column equals 3rd Column StartBinomialOrMatrix n Choose i EndBinomialOrMatrix p Superscript i Baseline left parenthesis 1 minus p right parenthesis Superscript n minus i 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction n left parenthesis n minus 1 right parenthesis left parenthesis n minus 2 right parenthesis midline horizontal ellipsis left parenthesis n minus i plus 1 right parenthesis Over i factorial EndFraction left parenthesis StartFraction lamda Over n EndFraction right parenthesis Superscript i Baseline left parenthesis 1 minus StartFraction lamda Over n EndFraction right parenthesis Superscript n Baseline left parenthesis 1 minus StartFraction lamda Over n EndFraction right parenthesis Superscript negative i 3rd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction lamda Superscript i Baseline Over i factorial EndFraction StartFraction n left parenthesis n minus 1 right parenthesis left parenthesis n minus 2 right parenthesis midline horizontal ellipsis left parenthesis n minus i plus 1 right parenthesis Over n Superscript i Baseline EndFraction left parenthesis 1 minus StartFraction lamda Over n EndFraction right parenthesis Superscript n Baseline left parenthesis 1 minus StartFraction lamda Over n EndFraction right parenthesis Superscript negative i Baseline comma EndLayoutP(X = i) =
⎛n
i
⎞
pi(1 −p)n−i
= n(n −1)(n −2) · · · (n −i + 1)
i!
⎛λ
n
⎞i ⎛
1 −λ
n
⎞n ⎛
1 −λ
n
⎞−i
= λi
i!
n(n −1)(n −2) · · · (n −i + 1)
ni
⎛
1 −λ
n
⎞n ⎛
1 −λ
n
⎞−i
,
where letting n →∞, for ﬁxed i, we get n(n−1)(n−2)···(n−i+1) 
ni
→ 1,
(
1 − λ 
n
)n → eλ 
and
(
1 − λ 
n
)−i → 1, concluding the proof. 
█
Continuous Uniform and Inversion 
To prove Theorem 5.1 simply apply Proposition 2.2, item 1, with u equals c element of left parenthesis 0 comma 1 right parenthesisu = c ∈(0, 1), 
i.e. upper F Subscript upper Y Baseline left parenthesis y right parenthesis greater than or slanted equals uFY (y) ⩾u iff upper Q Subscript upper Y Baseline left parenthesis u right parenthesis less than or slanted equals yQY (u) ⩽y. Then, 
sans serif upper P left parenthesis upper Q Subscript upper Y Baseline left parenthesis upper U right parenthesis less than or slanted equals y right parenthesis equals sans serif upper P left parenthesis upper U less than or slanted equals upper F Subscript upper Y Baseline left parenthesis y right parenthesis right parenthesis equals upper F Subscript upper Y Baseline left parenthesis y right parenthesis periodP(QY (U) ⩽y) = P(U ⩽FY (y)) = FY (y).
For Theorem 5.2 we have: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper F Subscript upper Y Baseline left parenthesis upper Y right parenthesis less than or slanted equals u right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis upper Q Subscript upper Y Baseline left parenthesis upper F Subscript upper Y Baseline left parenthesis upper Y right parenthesis right parenthesis less than or slanted equals upper Q Subscript upper Y Baseline left parenthesis u right parenthesis right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper Y less than or slanted equals upper Q Subscript upper Y Baseline left parenthesis u right parenthesis right parenthesis EndLayoutP(FY (Y) ⩽u) = P(QY (FY (Y)) ⩽QY (u))
= P(Y ⩽QY (u))
where the ﬁrst equality follows because for a continuous CDF upper F Subscript upper YFY we always 
have upper Q Subscript upper YQY is strictly increasing; the second equality follows from the fact that 
upper Q Subscript upper Y Baseline left parenthesis upper F Subscript upper Y Baseline left parenthesis y right parenthesis right parenthesis less than or slanted equals yQY (FY (y)) ⩽y, but the values y where upper Q Subscript upper Y Baseline left parenthesis upper F Subscript upper Y Baseline left parenthesis y right parenthesis right parenthesis not equals yQY (FY (y)) /= y form a ﬂat of the upper F Subscript upper YFY ’s 
graph, then they have zero probability and upper Q Subscript upper Y Baseline left parenthesis upper F Subscript upper Y Baseline left parenthesis upper Y right parenthesis right parenthesis equals Overscript a period s period Endscripts upper YQY (FY (Y)) a.s.
= Y; the fourth equality 
is due to the assumption that upper F Subscript upper YFY is continuous from which it follows that the 
composition of upper F Subscript upper YFY and its quantile upper Q Subscript upper YQY is the identity map, i.e. upper F Subscript upper Y Baseline left parenthesis upper Q Subscript upper Y Baseline left parenthesis u right parenthesis right parenthesis equals uFY (QY (u)) = u, 
see Sect. 2.8, Remark 2.11, and Eq. 2.20.
Chapter 6 
Conditioning 
6.1 Conditional Distributions 
Recall that sigma left parenthesis upper X right parenthesisσ(X) is the smallest sigma hyphen algebraσ-algebra containing events left brace upper X element of upper B right brace element of script upper F comma{X ∈B} ∈F, for 
every subset upper B subset of double struck upper RB ⊂R and a ﬁxed probability space left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P). Thus, by knowing the 
numerical values upper X left parenthesis omega right parenthesisX(ω) we may identify left brace upper X element of upper B right brace{X ∈B} without knowing the scenarios 
omega element of upper Omegaω ∈Ω: the sub-sigma hyphen algebraσ-algebra sigma left parenthesis upper X right parenthesis subset of script upper Fσ(X) ⊂F represents incomplete information about the 
underlying experiment, and this is equivalent to observe bold upper I Subscript left brace upper X element of upper B right braceI{X∈B}. How can we assess 
the law sans serif upper P Subscript upper XPX taking into account other partial information, i.e. assuming a ﬁxed event 
upper A element of script upper FA ∈F occurred, provided sans serif upper P left parenthesis upper A right parenthesis greater than 0P(A) > 0? The answer is: 
sans serif upper P Subscript upper X vertical bar upper A Baseline left parenthesis upper B right parenthesis colon equals sans serif upper P left parenthesis upper X element of upper B vertical bar upper A right parenthesis equals StartFraction sans serif upper P left parenthesis left brace upper X element of upper B right brace intersection upper A right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction commaPX|A(B) := P(X ∈B | A) = P
(
{X ∈B} ∩A
)
P(A)
,
(6.1) 
which is nothing but a conditional probability given A, called the conditional 
distribution of X. Choosing upper B equals left parenthesis negative normal infinity comma x right bracketB = (−∞, x] we get the conditional cumulative 
distribution function (CCDF): 
upper F Subscript upper X vertical bar upper A Baseline left parenthesis x right parenthesis colon equals StartFraction sans serif upper P left parenthesis left brace upper X less than or slanted equals x right brace intersection upper A right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction periodFX | A(x) := P
(
{X ⩽x} ∩A
)
P(A)
.
(6.2) 
We can specify the model of conditional distribution depending on the type of rv. If 
X is discrete, the conditional masses are: 
p Subscript upper X vertical bar upper A Baseline left parenthesis x right parenthesis colon equals StartFraction sans serif upper P left parenthesis left brace upper X equals x right brace intersection upper A right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction comma x in the support script upper X periodpX | A(x) := P
(
{X = x} ∩A
)
P(A)
,
x in the support X.
(6.3) 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4_6
173
174
6
Conditioning
If upper F Subscript upper X vertical bar upper AFX | A is differentiable w.r.t. x we have the conditional density: 
f Subscript upper X vertical bar upper A Baseline left parenthesis x right parenthesis colon equals StartFraction normal d Over normal d x EndFraction upper F Subscript upper X Baseline left parenthesis x vertical bar upper A right parenthesis comma for almost all x element of double struck upper R periodfX | A(x) := d
dx FX(x | A),
for almost all x ∈R.
(6.4) 
Whenever X admits conditional density f Subscript upper X vertical bar upper A Baseline left parenthesis x right parenthesisfX | A(x) we can always set: 
upper F Subscript upper X vertical bar upper A Baseline left parenthesis x right parenthesis equals integral Subscript negative normal infinity Superscript x Baseline f Subscript upper X vertical bar upper A Baseline left parenthesis u right parenthesis normal d u periodFX | A(x) =
⎰x
−∞
fX | A(u)du.
Thus we also have 
sans serif upper P Subscript upper X vertical bar upper A Baseline left parenthesis upper B right parenthesis equals integral Underscript upper B Endscripts f Subscript upper X vertical bar upper A Baseline left parenthesis x right parenthesis normal d x commaPX | A(B) =
⎰
B
fX | A(x)dx,
as we did in the unconditional setting. 
Example 6.1 Let upper A equals left brace a less than upper X less than or slanted equals b right braceA = {a < X ⩽b} in the conditional CDF upper F Subscript upper X Baseline left parenthesis x vertical bar upper A right parenthesisFX(x | A), for reals 
a less than ba < b, s.t. its probability is positive. Now 
left brace upper X less than or slanted equals x right brace intersection left brace a less than upper X less than or slanted equals b right brace equals StartLayout Enlarged left brace 1st Row 1st Column empty set comma 2nd Column if x less than or slanted equals a 2nd Row 1st Column left brace a less than upper X less than or slanted equals x right brace comma 2nd Column if a less than x less than or slanted equals b 3rd Row 1st Column left brace a less than upper X less than or slanted equals b right brace comma 2nd Column if x greater than b period EndLayout{X ⩽x} ∩{a < X ⩽b} =
⎧
⎨
⎩
∅,
if x ⩽a
{a < X ⩽x}, if a < x ⩽b
{a < X ⩽b}, if x > b.
Applying sans serif upper P left parenthesis dot right parenthesisP( · ) to the above events and dividing by sans serif upper P left parenthesis a less than upper X less than or slanted equals b right parenthesisP(a < X ⩽b) we get: 
upper F Subscript upper X vertical bar a less than upper X less than or slanted equals b Baseline left parenthesis x right parenthesis equals StartLayout Enlarged left brace 1st Row 1st Column StartFraction sans serif upper P left parenthesis empty set right parenthesis Over sans serif upper P left parenthesis a less than upper X less than or slanted equals b right parenthesis EndFraction equals 0 comma 2nd Column if x less than or slanted equals a 2nd Row 1st Column StartFraction sans serif upper P left parenthesis a less than upper X less than or slanted equals x right parenthesis Over sans serif upper P left parenthesis a less than upper X less than or slanted equals b right parenthesis EndFraction equals StartFraction upper F Subscript upper X Baseline left parenthesis x right parenthesis minus upper F Subscript upper X Baseline left parenthesis a right parenthesis Over upper F Subscript upper X Baseline left parenthesis b right parenthesis minus upper F Subscript upper X Baseline left parenthesis a right parenthesis EndFraction comma 2nd Column if a less than x less than or slanted equals b 3rd Row 1st Column StartFraction sans serif upper P left parenthesis a less than upper X less than or slanted equals b right parenthesis Over sans serif upper P left parenthesis a less than upper X less than or slanted equals b right parenthesis EndFraction equals 1 comma 2nd Column if x greater than b period EndLayoutFX | a<X⩽b(x) =
⎧
⎪⎨
⎪⎩
P(∅)
P(a<X⩽b) = 0,
if x ⩽a
P(a<X⩽x)
P(a<X⩽b) = FX(x)−FX(a)
FX(b)−FX(a), if a < x ⩽b
P(a<X⩽b)
P(a<X⩽b) = 1,
if x > b.
Differentiating w.r.t. x we get the conditional density 
f Subscript upper X vertical bar a less than upper X less than or slanted equals b Baseline left parenthesis x right parenthesis equals StartFraction f Subscript upper X Baseline left parenthesis x right parenthesis Over integral Subscript a Superscript b Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x EndFraction comma for a less than x less than or slanted equals b commafX | a<X⩽b(x) =
fX(x)
⎰b
a fX(x)dx
,
for a < x ⩽b,
(6.5) 
whose value is zero for x less than or slanted equals ax ⩽a and x greater than bx > b. 
In Example 6.1, the conditioning event upper A equals left brace a less than upper X less than or slanted equals b right braceA = {a < X ⩽b} is reported without 
brackets inside notation upper F Subscript upper X vertical bar bullet Baseline left parenthesis x right parenthesisFX | •(x) for the CCDF. From now on, we keep this notation 
for distributions conditioned to events involving rvs. A special case arises when 
upper A equals left brace upper Y element of upper C right braceA = {Y ∈C} has positive probability, where Y is another rv deﬁned on the same 
probability space and upper C subset of double struck upper RC ⊂R is suitable. The conditional probability 
sans serif upper P left parenthesis upper X element of upper B vertical bar upper Y element of upper C right parenthesis equals StartFraction sans serif upper P left parenthesis upper X element of upper B comma upper Y element of upper C right parenthesis Over sans serif upper P left parenthesis upper Y element of upper C right parenthesis EndFractionP(X ∈B | Y ∈C) = P(X ∈B, Y ∈C)
P(Y ∈C)
(6.6)
6.1
Conditional Distributions
175
is clearly based on the joint distribution of the random vector bold upper X equals left parenthesis upper X comma upper Y right parenthesis periodX = (X, Y). For half-
rays left parenthesis negative normal infinity comma bold x right bracket equals upper B times upper C comma(−∞, x] = B × C, where upper B equals left parenthesis negative normal infinity comma x right bracketB = (−∞, x] and upper C equals left parenthesis negative normal infinity comma y right bracket commaC = (−∞, y], we can rewrite 
the CCDF as 
upper F Subscript upper X vertical bar upper Y equals y Baseline left parenthesis x right parenthesis colon equals StartLayout Enlarged left brace 1st Row 1st Column StartFraction upper F Subscript bold upper X Baseline left parenthesis x comma y right parenthesis Over upper F Subscript upper Y Baseline left parenthesis y right parenthesis EndFraction comma 2nd Column for every y element of double struck upper R s period t period upper F Subscript upper Y Baseline left parenthesis y right parenthesis not equals 0 2nd Row 1st Column 0 comma 2nd Column otherwise comma EndLayoutFX | Y=y(x) :=
⌠FX(x,y)
FY (y) , for every y ∈R s.t. FY (y) /= 0
0,
otherwise,
(6.7) 
where upper F Subscript upper Y Baseline left parenthesis y right parenthesisFY (y) is the marginal CDF of Y. A simpler notation is upper F Subscript upper X vertical bar upper Y Baseline left parenthesis x right parenthesisFX | Y (x). We can 
revert conditioning and deﬁne upper F Subscript upper Y vertical bar upper X equals x Baseline left parenthesis y right parenthesisFY | X=x(y) in a similar way. If the random vector 
has absolutely continuous joint CDF upper F Subscript bold upper XFX, with joint density f Subscript bold upper XfX, then besides the 
marginals densities f Subscript upper X Baseline left parenthesis x right parenthesis comma f Subscript upper Y Baseline left parenthesis y right parenthesisfX(x), fY (y), which we call unconditional densities, we can 
deﬁne two further univariate densities: 
f Subscript upper X vertical bar upper Y equals y Baseline left parenthesis x right parenthesis colon equals StartFraction f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis Over f Subscript upper Y Baseline left parenthesis y right parenthesis EndFraction comma for every y element of double struck upper R s period t period f Subscript upper Y Baseline left parenthesis y right parenthesis not equals 0 commafX | Y=y(x) := fX(x, y)
fY (y) ,
for every y ∈R s.t. fY (y) /= 0,
(6.8) 
f Subscript upper Y vertical bar upper X equals x Baseline left parenthesis y right parenthesis colon equals StartFraction f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis Over f Subscript upper X Baseline left parenthesis x right parenthesis EndFraction comma for every x element of double struck upper R s period t period f Subscript upper X Baseline left parenthesis x right parenthesis not equals 0 periodfY | X=x(y) := fX(x, y)
fX(x) ,
for every x ∈R s.t. fX(x) /= 0.
(6.9) 
Notation can be simpliﬁed to f Subscript upper X vertical bar upper YfX | Y and f Subscript upper Y vertical bar upper XfY | X. They are truly densities functions, 
see Exercise 6.2. We give an intuitive interpretation of f Subscript upper X vertical bar upper YfX | Y : 
• assume upper Delta xΔx,upper Delta yΔy are small changes in x comma yx, y; 
• compute f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis upper Delta x upper Delta y almost equals sans serif upper P left parenthesis x less than or slanted equals upper X less than or slanted equals x plus upper Delta x comma y less than or slanted equals upper Y less than or slanted equals y plus upper Delta y right parenthesisfX(x, y)ΔxΔy ≈P
(
x ⩽X ⩽x + Δx, y ⩽Y ⩽y + Δy
)
; 
• compute f Subscript upper Y Baseline left parenthesis y right parenthesis upper Delta y almost equals sans serif upper P left parenthesis y less than or slanted equals upper Y less than or slanted equals y plus upper Delta y right parenthesisfY (y)Δy ≈P
(
y ⩽Y ⩽y + Δy
)
and assume it positive; 
• get f Subscript upper X vertical bar upper Y equals y Baseline left parenthesis x right parenthesis upper Delta z almost equalsfX | Y=y(x)Δz ≈StartFraction sans serif upper P left parenthesis x less than or slanted equals upper X less than or slanted equals x plus upper Delta x comma y less than or slanted equals upper Y less than or slanted equals y plus upper Delta y right parenthesis Over sans serif upper P left parenthesis y less than or slanted equals upper Y less than or slanted equals y plus upper Delta y right parenthesis EndFraction almost equals sans serif upper P left parenthesis x less than or slanted equals upper X less than or slanted equalsP
(
x ⩽X ⩽x + Δx, y ⩽Y ⩽y + Δy
)
P
(
y ⩽Y ⩽y + Δy
)
≈P
(
x ⩽X ⩽
x plus upper Delta x vertical bar upper Y almost equals y right parenthesis periodx + Δx | Y ≈y
)
.
Conditional densities cannot be interpreted literally, because sans serif upper P left parenthesis upper Y equals y right parenthesis equals 0P(Y = y) = 0 for 
absolutely continuous rvs. For discrete components in bold upper XX, with supports script upper X comma script upper YX, Y, the  
corresponding conditional masses are: 
StartLayout 1st Row 1st Column p Subscript upper X vertical bar upper Y Baseline left parenthesis x right parenthesis 2nd Column colon equals 3rd Column sans serif upper P left parenthesis upper X equals x vertical bar upper Y equals y right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction sans serif upper P left parenthesis upper X equals x comma upper Y equals y right parenthesis Over sans serif upper P left parenthesis upper Y equals y right parenthesis EndFraction for every x element of script upper X comma and y element of script upper Y s period t period sans serif upper P left parenthesis upper Y equals y right parenthesis greater than 0 period EndLayoutpX | Y (x) := P(X = x | Y = y)
(6.10)
= P(X = x, Y = y)
P(Y = y)
for every x ∈X, and y ∈Y s.t. P(Y = y) > 0.
Example 6.2 (Market Efﬁciency) Let upper S Subscript t plus 1St+1 denotes one random stock price to 
be predicted by investors at time t. Assuming they are rational, to make the 
best possible forecast investors should use all available information in t. We can 
model this as another rv denoted upper Y Subscript tYt, and further assume bold upper X equals left parenthesis upper S Subscript t plus 1 Baseline comma upper Y Subscript t Baseline right parenthesisX = (St+1, Yt) has a 
joint distribution. Now, consider a third rv M representing the whole information 
available in the market where this single stock is traded; the joint distribution of bold upper XX
is considered to be known. Hence, the market is said to be informationally efﬁcient 
provided
176
6
Conditioning
sans serif upper P left parenthesis upper S Subscript t plus 1 Baseline element of upper B vertical bar upper Y Subscript t Baseline element of upper C right parenthesis equals sans serif upper P left parenthesis upper S Subscript t plus 1 Baseline element of upper B vertical bar upper M element of upper C right parenthesis comma for all suitable upper B comma upper C subset of double struck upper R commaP(St+1 ∈B | Yt ∈C) = P(St+1 ∈B | M ∈C),
for all suitable B, C ⊂R,
where sans serif upper P left parenthesis upper Y Subscript t Baseline element of upper C right parenthesis comma sans serif upper P left parenthesis upper M element of upper C right parenthesisP(Yt ∈C), P(M ∈C) are both positive. In terms of CCDF the above reads: 
upper F Subscript upper S Sub Subscript t plus 1 Subscript vertical bar upper Y Sub Subscript t Subscript equals y Baseline left parenthesis x right parenthesis equals upper F Subscript upper S Sub Subscript t plus 1 Subscript vertical bar upper M equals y Baseline left parenthesis x right parenthesis commaFSt+1 | Yt=y(x) = FSt+1 | M=y(x),
for every x element of double struck upper Rx ∈R and every y element of double struck upper Ry ∈R s.t. upper F Subscript upper Y Sub Subscript t Baseline left parenthesis y right parenthesisFYt (y) and upper F Subscript upper M Baseline left parenthesis y right parenthesisFM(y) are both positive. 
To appreciate how conditional distributions are related to conditional probability 
we further need the following classical results. 
Theorem 6.1 Let upper Omega equals union Subscript i element of upper I Baseline upper A Subscript iΩ = ∪i∈IAi be decomposed through a ﬁnite, upper I equals StartSet 1 comma ellipsis comma n EndSetI = {1, . . . , n}, or  
a countable, upper I equals double struck upper NI = N, partition of pairwise disjoint events upper A Subscript i Baseline element of script upper FAi ∈F. Then for every 
upper B element of script upper FB ∈F: 
StartLayout 1st Row 1st Column bold l a w bold o f bold t o t a l bold p r o b a b i l i t y sans serif upper P left parenthesis upper B right parenthesis 2nd Column equals sigma summation Underscript i element of upper I Endscripts sans serif upper P left parenthesis upper B vertical bar upper A Subscript i Baseline right parenthesis sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis EndLayout StartLayout 2nd Row 1st Column bold upper B a y e s prime bold f o r m u l a sans serif upper P left parenthesis upper A Subscript i Baseline vertical bar upper B right parenthesis 2nd Column equals StartFraction sans serif upper P left parenthesis upper B vertical bar upper A Subscript i Baseline right parenthesis sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis Over sigma summation Underscript i element of upper I Endscripts sans serif upper P left parenthesis upper B vertical bar upper A Subscript i Baseline right parenthesis sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis EndFraction comma for sans serif upper P left parenthesis upper B right parenthesis greater than 0 period EndLayoutlaw of total probability
P(B) =
⎲
i∈I
P(B | Ai) P(Ai)Alt-text already available with first equation in this block
(6.11) 
Bayes' formula P(Ai | B) = 
P(B | Ai)P(Ai)
∑
i∈I P(B | Ai)P(Ai) , 
for P(B) > 0. 
(6.12) 
Proof Let upper B equals upper B intersection upper Omega equals upper B intersection left parenthesis union Subscript i Baseline upper A Subscript i Baseline right parenthesis equals union Subscript i Baseline left parenthesis upper B intersection upper A Subscript i Baseline right parenthesisB = B ∩Ω = B ∩(∪iAi) = ∪i(B ∩Ai). Since left parenthesis upper A Subscript i Baseline right parenthesis Subscript i element of upper I(Ai)i∈I are pairwise 
disjoint, so are the events left parenthesis upper B intersection upper A Subscript i Baseline right parenthesis(B∩Ai). Then sans serif upper P left parenthesis upper B right parenthesis equals sans serif upper P left parenthesis union Subscript i Baseline left parenthesis upper B intersection upper A Subscript i Baseline right parenthesis right parenthesis equals sigma summation Underscript i Endscripts sans serif upper P left parenthesis upper B intersection upper A Subscript i Baseline right parenthesis equals sigma summation Underscript i Endscripts sans serif upper P left parenthesis upper B vertical bar upper A Subscript i Baseline right parenthesis sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesisP(B) = P(∪i(B∩Ai)) = ∑
i P(B∩Ai) =
∑
i P(B | Ai)P(Ai). Next, by the law of total probability we can write sans serif upper P left parenthesis upper B right parenthesis equals sigma summation Underscript i Endscripts sans serif upper P left parenthesis upper B vertical bar upper A Subscript i Baseline right parenthesis sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesisP(B) =
∑
i P(B | Ai)P(Ai). This implies StartFraction sans serif upper P left parenthesis upper B vertical bar upper A Subscript i Baseline right parenthesis sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis Over sigma summation Underscript i Endscripts sans serif upper P left parenthesis upper B vertical bar upper A Subscript i Baseline right parenthesis sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis EndFraction equals StartFraction sans serif upper P left parenthesis upper B intersection upper A Subscript i Baseline right parenthesis Over sans serif upper P left parenthesis upper B right parenthesis EndFraction equals sans serif upper P left parenthesis upper A Subscript i Baseline vertical bar upper B right parenthesis
P(B | Ai)P(Ai)
∑
i P(B | Ai)P(Ai) = P(B∩Ai)
P(B)
= P(Ai | B). 
█
With upper A Subscript i Baseline equals upper AAi = A, Bayes’ formula yields sans serif upper P left parenthesis upper B right parenthesis sans serif upper P left parenthesis upper A vertical bar upper B right parenthesis equals sans serif upper P left parenthesis upper B vertical bar upper A right parenthesis sans serif upper P left parenthesis upper A right parenthesisP(B)P(A | B) = P(B | A)P(A). 
6.2 Conditional Expectation Given an Event 
Expectation as deﬁned in Chap. 4 can be interpreted as average prediction of a 
rv’s values without additional information, called unconditional expectation. Using  
conditional distribution we may deﬁne the expected value with partially resolution 
of uncertainty. Following the route developed in Sect. 6.1, we start by deﬁning 
conditional expectation as: 
sans serif upper E left parenthesis upper X vertical bar upper A right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline x normal d upper F Subscript upper X vertical bar upper A Baseline left parenthesis x right parenthesis equals integral Underscript double struck upper R Endscripts x normal d sans serif upper P Subscript upper X vertical bar upper A Baseline comma whenever sans serif upper P left parenthesis upper A right parenthesis greater than 0 periodE(X | A) =
⎰∞
−∞
x dFX | A(x) =
⎰
R
x dPX | A,
whenever P(A) > 0.
(6.13)
6.2
Conditional Expectation Given an Event
177
Immediately, we get versions for discrete and continuous rvs, respectively: 
StartLayout 1st Row sigma summation Underscript i Endscripts x Subscript i Baseline p Subscript upper X vertical bar upper A Baseline left parenthesis x Subscript i Baseline right parenthesis comma EndLayout StartLayout 2nd Row integral Subscript negative normal infinity Superscript normal infinity Baseline x f Subscript upper X vertical bar upper A Baseline left parenthesis x right parenthesis normal d x period EndLayout
⎲
i
xi pX | A(xi), Alt-text already available with first equation in this block
(6.14)
⎰∞ 
−∞ 
x fX | A(x)dx.
(6.15) 
Example 6.3 Let upper X tilde upper N left parenthesis 0 comma sigma squared right parenthesisX ∼N(0, σ 2) a Gaussian rv and choose upper A equals left brace upper X greater than 0 right braceA = {X > 0}. Recall 
that X has density f Subscript upper X Baseline left parenthesis x right parenthesis equals StartFraction 1 Over StartRoot 2 pi EndRoot sigma EndFraction e Superscript minus StartFraction x squared Over 2 sigma squared EndFractionfX(x) =
1
√
2πσ e−x2
2σ2 . Based on (6.5) from Example 6.1 in 
Sect. 6.1, with a equals 0a = 0 and b equals normal infinityb = ∞, we compute:1 
f Subscript upper X vertical bar upper X greater than 0 Baseline left parenthesis x right parenthesis equals StartFraction f Subscript upper X Baseline left parenthesis x right parenthesis Over integral Subscript 0 Superscript normal infinity Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x EndFraction equals 2 StartFraction 1 Over StartRoot 2 pi EndRoot sigma EndFraction e Superscript minus StartFraction x squared Over 2 sigma squared EndFraction Baseline comma for 0 less than x less than or slanted equals normal infinity periodfX | X>0(x) =
fX(x)
⎰∞
0
fX(x)dx = 2
1
√
2πσ
e−x2
2σ2 ,
for 0 < x ⩽∞.
The conditional density is zero for x less than or slanted equals 0x ⩽0. As byproduct, 
sans serif upper E left parenthesis upper X vertical bar upper X greater than 0 right parenthesis equals 2 StartFraction 1 Over StartRoot 2 pi EndRoot sigma EndFraction integral Subscript 0 Superscript normal infinity Baseline x e Superscript minus StartFraction x squared Over 2 sigma squared EndFraction Baseline normal d x commaE(X | X > 0) = 2
1
√
2πσ
⎰∞
0
x e−x2
2σ2 dx,
because the conditional expectation is based on values x for which the conditional 
density is nonzero. Inside the conditional expectation sans serif upper E left parenthesis upper X vertical bar bullet right parenthesisE(X | •), the conditioning 
event is denoted again without brackets. 
Example 6.4 Let upper X tilde upper N left parenthesis mu comma sigma squared right parenthesisX ∼N(μ, σ 2) a Gaussian rv and choose upper A equals left brace upper X less than or slanted equals b right braceA = {X ⩽b}, so that 
from (6.5) with a equals negative normal infinitya = −∞we get the conditional density f Subscript upper X vertical bar upper X less than or slanted equals b Baseline left parenthesis x right parenthesis equals StartFraction f Subscript upper X Baseline left parenthesis x right parenthesis Over integral Subscript negative normal infinity Superscript b Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x EndFractionfX | X⩽b(x) =
fX(x)
⎰b
−∞fX(x)dx . 
Instead of working out the explicit expression of this density we compute the 
conditional expectation 
sans serif upper E left parenthesis upper X vertical bar upper X less than or slanted equals b right parenthesis equals integral Subscript negative normal infinity Superscript b Baseline x f Subscript upper X vertical bar upper X less than or slanted equals b Baseline left parenthesis x right parenthesis normal d x equals StartFraction integral Subscript negative normal infinity Superscript b Baseline x f Subscript upper X Baseline left parenthesis x right parenthesis normal d x Over integral Subscript negative normal infinity Superscript b Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x EndFraction periodE(X | X ⩽b) =
⎰b
−∞
x fX | X⩽b(x)dx =
⎰b
−∞x fX(x)dx
⎰b
−∞fX(x)dx
.
(6.16) 
Since it can be shown that upper X equals mu plus sigma upper ZX = μ + σZ, for a Standard Normal upper Z tilde upper N left parenthesis 0 comma 1 right parenthesisZ ∼N(0, 1) we 
rewrite: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X vertical bar upper X less than or slanted equals b right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis mu plus sigma upper Z vertical bar mu plus sigma upper Z less than or slanted equals b right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column mu plus sigma sans serif upper E left parenthesis upper Z vertical bar upper Z less than or slanted equals StartFraction b minus mu Over sigma EndFraction right parenthesis period EndLayoutE(X | X ⩽b) = E(μ + σZ | μ + σZ ⩽b)
= μ + σE
⎛
Z | Z ⩽b−μ
σ
⎞
.
1 For Gaussian density with location parameter zero, integrating over left bracket 0 comma normal infinity right parenthesis[0, ∞) yields one half1
2 by symmetry. 
178
6
Conditioning
Next we evaluate the latter conditional expectation with k equals StartFraction b minus mu Over sigma EndFractionk =
b−μ
σ , using (6.16). 
From the unconditional density f Subscript upper Z Baseline left parenthesis z right parenthesis equals StartFraction 1 Over StartRoot 2 pi EndRoot EndFraction e Superscript minus StartFraction z squared Over 2 EndFractionfZ(z) =
1
√
2π e−z2
2 we see that 
StartFraction normal d Over normal d z EndFraction f Subscript upper Z Baseline left parenthesis z right parenthesis equals minus z StartFraction 1 Over StartRoot 2 pi EndRoot EndFraction e Superscript minus StartFraction z squared Over 2 EndFraction Baseline period d
dzfZ(z) = −z
1
√
2π
e−z2
2 .
Hence by computing the integral in the numerator of (6.16) for the Standard Normal 
we get: 
StartLayout 1st Row 1st Column integral Subscript negative normal infinity Superscript k Baseline z f Subscript upper Z Baseline left parenthesis z right parenthesis normal d z 2nd Column equals 3rd Column minus integral Subscript negative normal infinity Superscript k Baseline minus z f Subscript upper Z Baseline left parenthesis z right parenthesis normal d z 2nd Row 1st Column Blank 2nd Column equals 3rd Column minus left bracket StartFraction 1 Over StartRoot 2 pi EndRoot EndFraction e Superscript minus StartFraction z squared Over 2 EndFraction Baseline right bracket Subscript negative normal infinity Superscript k Baseline equals minus f Subscript upper Z Baseline left parenthesis k right parenthesis plus limit Underscript z right arrow negative normal infinity Endscripts f Subscript upper Z Baseline left parenthesis z right parenthesis equals minus f Subscript upper Z Baseline left parenthesis k right parenthesis period EndLayout
⎰k
−∞
z fZ(z)dz = −
⎰k
−∞
−z fZ(z)dz
= −
⎾
1
√
2π
e−z2
2
⏋k
−∞
= −fZ(k) +
lim
z→−∞fZ(z) = −fZ(k).
Finally we obtain sans serif upper E left parenthesis upper Z vertical bar upper Z less than or slanted equals k right parenthesis equals StartFraction integral Subscript negative normal infinity Superscript k Baseline z f Subscript upper Z Baseline left parenthesis z right parenthesis normal d z Over integral Subscript negative normal infinity Superscript c Baseline f Subscript upper Z Baseline left parenthesis z right parenthesis normal d z EndFraction equals StartFraction minus f Subscript upper Z Baseline left parenthesis k right parenthesis Over upper F Subscript upper Z Baseline left parenthesis k right parenthesis EndFractionE(Z | Z ⩽k) =
⎰k
−∞z fZ(z)dz
⎰c
−∞fZ(z)dz = −fZ(k)
FZ(k) and thus 
sans serif upper E left parenthesis upper X vertical bar upper X less than or slanted equals b right parenthesis equals mu minus sigma StartFraction f Subscript upper Z Baseline left parenthesis k right parenthesis Over upper F Subscript upper Z Baseline left parenthesis k right parenthesis EndFraction periodE(X | X ⩽b) = μ −σ fZ(k)
FZ(k).
(6.17) 
Example 6.5 Let us identify X, from Example 6.4, with the arithmetic rate of 
return r Subscript t plus 1rt+1 of a portfolio. Then, let b equals upper Q Subscript r Sub Subscript t plus 1 Baseline left parenthesis c right parenthesisb = Qrt+1(c) be the upper F Subscript r Sub Subscript t plus 1Frt+1’s quantile, with 0 less than c less than 10 <
c < 1. Observe that for c small enough (e.g. c equals 0.01c = 0.01) the rv r Subscript t plus 1rt+1 attains negative 
values and the choice for b can be interpreted as measuring percentage losses from 
investing in the portfolio, with probability at most c. In risk management, an average 
measure for market risk associated to a negative value of returns (viz. percentage 
losses) can be deﬁned as follows: 
StartLayout 1st Row 1st Column minus sans serif upper E left parenthesis r Subscript t plus 1 Baseline vertical bar r Subscript t plus 1 Baseline less than or slanted equals upper Q Subscript r Sub Subscript t plus 1 Subscript Baseline left parenthesis c right parenthesis right parenthesis 2nd Column equals negative mu plus sigma StartFraction f Subscript upper Z Baseline left parenthesis upper Q Subscript r Sub Subscript t plus 1 Subscript Baseline left parenthesis c right parenthesis right parenthesis Over upper F Subscript upper Z Baseline left parenthesis upper Q Subscript r Sub Subscript t plus 1 Subscript Baseline left parenthesis c right parenthesis right parenthesis EndFraction 2nd Row 1st Column Blank 2nd Column equals negative mu plus sigma StartFraction f Subscript upper Z Baseline left parenthesis upper Q Subscript r Sub Subscript t plus 1 Subscript Baseline left parenthesis c right parenthesis right parenthesis Over c EndFraction period EndLayout−E(rt+1 | rt+1 ⩽Qrt+1(c)) = −μ + σ fZ(Qrt+1(c))
FZ(Qrt+1(c))
= −μ + σ fZ(Qrt+1(c))
c
.
(6.18) 
Warning: we have to let k equals StartFraction upper Q Subscript r Sub Subscript t plus 1 Subscript Baseline left parenthesis c right parenthesis minus mu Over sigma EndFractionk =
Qrt+1(c)−μ
σ
and recall that quantiles are linear for 
positive linear transformation, upper Q Subscript mu plus sigma upper Z Baseline left parenthesis c right parenthesis equals mu plus sigma upper Q Subscript upper Z Baseline left parenthesis c right parenthesisQμ+σZ(c) = μ + σQZ(c). Thus, k equals upper Q Subscript upper Z Baseline left parenthesis c right parenthesisk = QZ(c) and 
the latter expression on the right-hand side of (6.18) is due to 
integral Subscript negative normal infinity Superscript upper Q Subscript upper Z Baseline left parenthesis c right parenthesis Baseline f Subscript upper Z Baseline left parenthesis z right parenthesis normal d z equals upper F Subscript upper Z Baseline left parenthesis upper Q Subscript r Sub Subscript t plus 1 Subscript Baseline left parenthesis c right parenthesis right parenthesis equals c comma
⎰QZ(c)
−∞
fZ(z)dz = FZ(Qrt+1(c)) = c,
for absolutely continuous distributions.
6.3
Conditional Expectation Given a Rv
179
Example 6.4 suggests that sans serif upper E left parenthesis upper X vertical bar upper X less than or slanted equals b right parenthesisE(X | X ⩽b) can be generalized to any event upper A element of script upper FA ∈F
than left brace upper X less than or slanted equals b right brace{X ⩽b}. Indeed it holds: 
sans serif upper E left parenthesis upper X vertical bar upper A right parenthesis equals StartFraction sans serif upper E left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction comma if sans serif upper P left parenthesis upper A right parenthesis greater than 0 periodE(X | A) = E(XIA)
P(A) ,
if P(A) > 0.
(6.19) 
This formula can be proved directly, when X is a discrete rv with conditional masses 
given by (6.3) and with countable support. The expected value of X conditional on 
the event A having positive probability is: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X vertical bar upper A right parenthesis 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript normal infinity Endscripts x Subscript i Baseline p left parenthesis x Subscript i Baseline vertical bar upper A right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript normal infinity Endscripts x Subscript i Baseline StartFraction sans serif upper P left parenthesis left brace upper X equals x Subscript i Baseline right brace intersection upper A right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction 3rd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction 1 Over sans serif upper P left parenthesis upper A right parenthesis EndFraction sigma summation Underscript i equals 1 Overscript normal infinity Endscripts x Subscript i Baseline sans serif upper P left parenthesis left brace upper X equals x Subscript i Baseline right brace intersection upper A right parenthesis equals StartFraction sans serif upper E left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction period EndLayoutE(X | A) =
∞
⎲
i=1
xi p(xi | A)
=
∞
⎲
i=1
xi
P({X = xi} ∩A)
P(A)
=
1
P(A)
∞
⎲
i=1
xi P({X = xi} ∩A) = E(XIA)
P(A) .
The last line follows because the corresponding sum is the expectation for every 
scenario omega element of upper Aω ∈A, i.e., it is the average of values x Subscript i Baseline equals upper X left parenthesis omega right parenthesisxi = X(ω) for scenario omegaω s.t. 
probability is sans serif upper P left parenthesis left brace upper X equals x Subscript i Baseline right brace intersection upper A right parenthesisP({X = xi} ∩A). For general rvs, see Exercise 6.5. It is worth noting 
that formula (6.19) cab also be written 
StartFraction 1 Over sans serif upper P left parenthesis upper A right parenthesis EndFraction integral Underscript upper Omega Endscripts upper X bold upper I Subscript upper A Baseline normal d sans serif upper P equals StartFraction 1 Over sans serif upper P left parenthesis upper A right parenthesis EndFraction integral Underscript upper A Endscripts upper X normal d sans serif upper P comma 1
P(A)
⎰
Ω
XIAdP =
1
P(A)
⎰
A
XdP,
using the deﬁnition of Lebesgue integral involving expectation, see Appendix N, 
which emphasizes the averaging procedure restricted to a subset of upper X left parenthesis omega right parenthesisX(ω)’s values 
given by scenarios omega element of upper Aω ∈A, with additional normalization by a factor StartFraction 1 Over sans serif upper P left parenthesis upper A right parenthesis EndFraction
1
P(A). 
6.3 Conditional Expectation Given a Rv 
As we did with conditional distributions, it is sensible to extend the expectation 
conditioned on an event to conditioning on a rv. We specialize to discrete rvs. Take 
a rv upper X element of upper L Superscript 1X ∈L1 and another discrete rv Y with support script upper Y equals StartSet y 1 comma y 2 comma ellipsis EndSetY = {y1, y2, . . .}. Trying to  
forecast X conditioned on Y taking values on its support, amounts to ﬁnd which 
event left brace upper Y equals y Subscript j Baseline right brace{Y = yj} will occur. We should use formula (6.19) in Sect. 6.2 and, provided 
sans serif upper P left parenthesis upper Y equals y Subscript i Baseline right parenthesis greater than 0P(Y = yi) > 0 for all y Subscript i Baseline element of script upper Yyi ∈Y, the conditional expectation of X given Y is a second
180
6
Conditioning
discrete rv StartEnclose box upper Z equals sans serif upper E left parenthesis upper X vertical bar upper Y right parenthesis EndEnclose Z = E(X | Y) s.t. 
upper Z left parenthesis omega right parenthesis colon equals StartFraction sans serif upper E left parenthesis upper X bold upper I Subscript left brace upper Y equals y Sub Subscript i Subscript right brace Baseline right parenthesis Over sans serif upper P left parenthesis upper Y equals y Subscript i Baseline right parenthesis EndFraction comma provided upper Y left parenthesis omega right parenthesis equals y Subscript i Baseline for any i equals 1 comma 2 comma ellipsisZ(ω) := E(XI{Y=yi})
P(Y = yi) ,
provided Y(ω) = yi for any i = 1, 2, . . .
(6.20) 
A shorthand notation for Z is sans serif upper E left parenthesis upper X vertical bar upper Y equals y Subscript i Baseline right parenthesisE(X | Y = yi), whenever in formula (6.20) it is  
evaluated at those scenarios omega element of upper Omegaω ∈Ω s.t. upper Y left parenthesis omega right parenthesisY(ω) equals y Subscript i Baseline element of script upper Yyi ∈Y. In fact, f left parenthesis upper Y right parenthesis equals sans serif upper E left parenthesis upper X vertical bar upper Y right parenthesisf (Y) =
E(X | Y) is a function2 representing a ‘version’ of X obtained by averaging the 
values f left parenthesis y Subscript j Baseline right parenthesisf (yj) with weights sans serif upper P Subscript upper X vertical bar upper Y equals y Sub Subscript j SubscriptPX | Y=yj , and which takes on constant values StartFraction sans serif upper E left parenthesis upper X right parenthesis Over sans serif upper P left parenthesis upper Y equals y Subscript j Baseline right parenthesis EndFraction E(X)
P(Y=yj )
over events left brace upper Y equals y Subscript j Baseline right brace{Y = yj}. Lemma 6.1 below is a crucial ingredient in the current setting. 
Lemma 6.1 (Doob-Dynkin) 
Let Y be a rv and consider sigma left parenthesis upper Y right parenthesisσ(Y), its generated 
sigma hyphen algebraσ-algebra. Then, each rv Z which induces event left brace upper Z element of upper B right brace element of sigma left parenthesis upper Y right parenthesis{Z ∈B} ∈σ(Y) is given as 
upper Z equals f left parenthesis upper Y right parenthesisZ = f (Y), for a suitable function f colon double struck upper R right arrow double struck upper Rf : R →R and every suitable3 upper B subset of double struck upper RB ⊂R. 
It is plausible to deﬁne expectation conditioned on sub-sigma hyphen algebraσ-algebras for upper X element of upper L Superscript 1X ∈L1, 
extending deﬁnition (6.20) by declaring sans serif upper E left parenthesis upper X vertical bar upper Y right parenthesis identical to sans serif upper E left parenthesis upper X vertical bar sigma left parenthesis upper Y right parenthesis right parenthesisE(X | Y) ≡E(X | σ(Y)), i.e., sans serif upper E left parenthesis upper X vertical bar upper Y right parenthesisE(X | Y)
depends on a sigma hyphen algebraσ-algebra rather than on Y’s values.4 In fact, by Exercises 6.11 
and 6.12 we are able to deﬁne upper Z equals sans serif upper E left parenthesis upper X vertical bar upper Y right parenthesisZ = E(X | Y) also when Y is no longer discrete5 
in such a way: 
• the conditional expectation is a sigma left parenthesis upper Y right parenthesisσ(Y)-measurable rv, in words events left brace upper Z element of upper B right brace{Z ∈B}
are in here,6 and upper Z equals f left parenthesis upper Y right parenthesisZ = f (Y) for a suitable function; 
• for every event upper A element of sigma left parenthesis upper Y right parenthesisA ∈σ(Y) the unconditional expectation of upper Z bold upper I Subscript upper AZIA coincides with 
that of upper X bold upper I Subscript upper AXIA. 
It can be shown that for upper X comma upper Y element of upper L Superscript 1X, Y ∈L1 in bold upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y) with joint density, the conditional 
expectation can be computed as 
sans serif upper E left parenthesis upper X vertical bar upper Y right parenthesis equals StartFraction integral Subscript negative normal infinity Superscript normal infinity Baseline x f Subscript bold upper X Baseline left parenthesis x comma upper Y right parenthesis normal d x Over integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript bold upper X Baseline left parenthesis x comma upper Y right parenthesis normal d x EndFraction commaE(X | Y) =
⎰∞
−∞xfX(x, Y)dx
⎰∞
−∞fX(x, Y)dx ,
(6.21) 
see Exercise 6.15.
2 Actually, a Borel measurable function, i.e., the composed map upper Omega right arrow Overscript upper Y Endscripts double struck upper R right arrow Overscript f Endscripts double struck upper RΩ
Y
−−−−→R
f
−−−−→R is a rv, 
see Appendix in Chap. 2. 
3 Again, we should say Z is sigma left parenthesis upper Y right parenthesisσ(Y)-measurable and f is a Borel measurable function. 
4 Observe that sigma left parenthesis upper Y right parenthesis subset of script upper Fσ(Y) ⊂F and Z does not carries over more information than script upper FF. 
5 Do not forget the condition upper X element of upper L Superscript 1X ∈L1, which can be rephrased as X being integrable. 
6 It can be shown upper Z equals sans serif upper E left parenthesis upper X vertical bar upper Y right parenthesisZ = E(X | Y) induces events in sigma left parenthesis upper Y right parenthesisσ(Y) iff sigma left parenthesis upper Z right parenthesis subset of sigma left parenthesis upper Y right parenthesisσ(Z) ⊂σ(Y). 
6.4
Conditional Expectation Given a Sub-σ-algebra
181
6.4 Conditional Expectation Given a Sub-σ-algebra 
The framework developed in Sect. 6.3 enable us to introduce a far general deﬁnition 
of conditional expectation. 
Theorem 6.2 Let X be a rv deﬁned on a probability space left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P), assume upper X element of upper L Superscript 1X ∈
L1 and let script upper A subset of script upper FA ⊂F be a sub-sigma hyphen algebraσ-algebra. Then, there exists the conditional expectation 
of X given script upper AA which is the rv StartEnclose box upper Z equals sans serif upper E left parenthesis upper X vertical bar script upper A right parenthesis EndEnclose Z = E(X | A) satisfying: 
1. events induced by Z are in script upper AA, i.e., Z is script upper AA-measurable; 
2. Z has ﬁnite expectation, i.e. upper Z element of upper L Superscript 1Z ∈L1; 
3. for any upper A element of script upper AA ∈A it holds sans serif upper E left parenthesis upper Z bold upper I Subscript upper A Baseline right parenthesis equals sans serif upper E left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesisE(ZIA) = E(XIA). 
If conditions 1–3 are satisﬁed by another rv upper Z prime commaZ', then upper Z equals Overscript a period s period Endscripts upper Z primeZ a.s.
= Z'. 
In fact, if Z and upper Z primeZ' are two rvs inducing events in script upper AA s.t. 
sans serif upper E left parenthesis upper Z bold upper I Subscript upper A Baseline right parenthesis equals sans serif upper E left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesis equals sans serif upper E left parenthesis upper Z prime bold upper I Subscript upper A Baseline right parenthesis comma for all upper A element of script upper A subset of script upper F commaE(ZIA) = E(XIA) = E(Z'IA),
for all A ∈A ⊂F,
then sans serif upper E left parenthesis left parenthesis upper Z minus upper Z prime right parenthesis bold upper I Subscript upper A Baseline right parenthesis equals 0E((Z −Z')IA) = 0 and upper Z equals Overscript a period s period Endscripts upper Z primeZ a.s.
= Z', see Exercise 6.13. Existence asserted in 
Theorem 6.2 can be proved by invoke another classical result. Before to state it, let 
us consider the problem of changing the probability measure sans serif upper PP in the event space 
left parenthesis upper Omega comma script upper F right parenthesis(Ω, F), using another probability measure. To some extent, this can be interpreted 
as different subjective opinions about events in script upper FF. 
Deﬁnition 6.1 A probability measure sans serif upper P overTilde˜P is said to be absolutely continuous w.r.t. 
probability sans serif upper PP, written sans serif upper P overTilde much less than sans serif upper P˜P ⪡P, if sans serif upper P left parenthesis upper A right parenthesis equals 0P(A) = 0 implies ModifyingAbove sans serif upper P With tilde left parenthesis upper A right parenthesis equals 0 ˜P(A) = 0 for any event upper A element of script upper FA ∈F. 
They are equivalent probability measures, written sans serif upper P overTilde tilde sans serif upper P ˜P ∼P, whenever sans serif upper P overTilde much less than sans serif upper P ˜P ⪡P and 
sans serif upper P much less than sans serif upper P overTilde periodP ⪡˜P.
The two probabilities agree on impossible events but put different weights on 
the remaining ones. Observe that also sans serif upper P left parenthesis upper A Superscript c Baseline right parenthesis equals 1P(Ac) = 1 implies ModifyingAbove sans serif upper P With tilde left parenthesis upper A Superscript c Baseline right parenthesis equals 1 ˜P(Ac) = 1. Hence, 
impossible and certain events under sans serif upper PP are evaluated the same under sans serif upper P overTilde˜P, but the  
converse is not true. Now unconditional expectation can be computed with two 
different probabilities, and to distinguish between them we can write sans serif upper E Subscript sans serif upper PEP and sans serif upper E Subscript sans serif upper P overTildeE ˜P. 
Surprisingly enough, there is a simple way of getting sans serif upper P overTilde˜P as absolutely continuous 
w.r.t. sans serif upper PP. Take upper X greater than or slanted equals 0X ⩾0 be a nonnegative rv over left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P) and deﬁne the set function 
sans serif upper P overTilde colon script upper F right arrow left bracket 0 comma normal infinity right bracket ˜P : F →[0, ∞] by 
ModifyingAbove sans serif upper P With tilde left parenthesis upper A right parenthesis equals sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesis comma with sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X right parenthesis equals 1 period ˜P(A) = EP(XIA),
with EP(X) = 1.
(6.22) 
As a result, sans serif upper P overTilde much less than sans serif upper P ˜P ⪡P, see Exercise 6.16. 
Example 6.6 Assuming no arbitrage, the price in t equals 0t = 0 of an European call option 
with maturity in t equals upper Tt = T is 
upper C 0 equals e Superscript minus r upper T Baseline sans serif upper E Subscript sans serif upper P overTilde Baseline left parenthesis left parenthesis upper S Subscript upper T Baseline minus upper K right parenthesis Superscript plus Baseline right parenthesis commaC0 = e−r T E ˜P((ST −K)+),
182
6
Conditioning
where upper K greater than 0K > 0 is the strike price in t equals upper Tt = T and upper S Subscript upper TST is the underlying stock price; 
r is the continuously compounded risk-free rate. Under additional hypotheses, the 
ﬁnancial theory of no arbitrage ensures the existence of a new probability measure 
sans serif upper P overTilde˜P, called risk-neutral, which is equivalent to the market probability measure sans serif upper PP, in  
such a way pricing European call options reduces to compute the discounted value 
of the option random payoff e Superscript minus r upper T Baseline left parenthesis upper S Subscript upper T Baseline minus upper K right parenthesis Superscript pluse−r T (ST −K)+ using the risk-free return instead of 
the true random return of the option itself. 
Example 6.7 To appreciate how sans serif upper P overTilde much less than sans serif upper P ˜P ⪡P are related each other through for-
mula (6.22) we rewrite it using Lebesgue integration: 
ModifyingAbove sans serif upper P With tilde left parenthesis upper A right parenthesis equals ModifyingBelow integral Underscript upper Omega Endscripts upper X bold upper I Subscript upper A Baseline normal d sans serif upper P With bottom brace Underscript equals sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesis Endscripts equals StartEnclose box integral Underscript upper A Endscripts upper X normal d sans serif upper P EndEnclose equals ModifyingBelow integral Underscript upper Omega Endscripts bold upper I Subscript upper A Baseline normal d ModifyingAbove sans serif upper P With tilde With bottom brace Underscript equals sans serif upper E Subscript ModifyingAbove sans serif upper P With tilde Baseline left parenthesis bold upper I Subscript upper A Baseline right parenthesis Endscripts equals StartEnclose box integral Underscript upper A Endscripts normal d ModifyingAbove sans serif upper P With tilde EndEnclose period˜P(A) =
⎰
Ω
XIAdP
◟
◝◜
◞
= EP(XIA)
=
⎰
A
XdP =
⎰
Ω
IAd ˜P
◟
◝◜
◞
= E ˜P(IA)
=
⎰
A
d ˜P .
Comparing the second and the fourth integrals yields 
upper X normal d sans serif upper P equals normal d sans serif upper P overTilde long left right double arrow upper X equals StartFraction normal d sans serif upper P overTilde Over normal d sans serif upper P EndFraction commaXdP = d ˜P ⇐⇒X = d ˜P
dP,
where X is called the Radon-Nikodým derivative or density of sans serif upper P overTilde˜P w.r.t. sans serif upper PP. It may be 
interpreted as the rv given by limit Underscript upper A down arrow StartSet omega EndSet Endscripts StartFraction ModifyingAbove sans serif upper P With tilde left parenthesis upper A right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFractionlimA↓{ω}
˜P(A)
P(A), for ﬁner partitions of the event upper A element of script upper FA ∈F. 
Remark 6.1 For two equivalent probability measures sans serif upper P overTilde tilde sans serif upper P ˜P ∼P, we can recover the 
Radon-Nikodým derivative of sans serif upper PP w.r.t. sans serif upper P overTilde˜P simply by inverting, i.e. StartFraction normal d sans serif upper P Over normal d sans serif upper P overTilde EndFraction equals left parenthesis StartFraction normal d sans serif upper P overTilde Over normal d sans serif upper P EndFraction right parenthesis Superscript negative 1 dP
d ˜P =
⎛
d ˜P
dP
⎞−1
. 
What happen if we start from two probability measures such that sans serif upper P overTilde much less than sans serif upper P ˜P ⪡P and 
wish to ﬁnd a nonnegative rv acting as the Radon-Nikodým derivative of sans serif upper P overTilde˜P w.r.t. 
sans serif upper PP? The answer to this question is the converse of formula (6.22) which we present 
without proof. 
Theorem 6.3 (Radon-Nikodým) Let sans serif upper P overTilde˜P be a probability measure absolutely con-
tinuous with respect to sans serif upper PP over the event space left parenthesis upper Omega comma script upper F right parenthesis(Ω, F). Then, there exists a rv upper X greater than or slanted equals 0X ⩾0
such that sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X right parenthesis equals 1EP(X) = 1 and ModifyingAbove sans serif upper P With tilde left parenthesis upper A right parenthesis equals sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesis ˜P(A) = EP(XIA), for every upper A element of script upper FA ∈F. The same holds when 
the hypotheses are replaced by sans serif upper P overTilde tilde sans serif upper P ˜P ∼P and upper X greater than or slanted equals 0X ⩾0 a.s. 
To verify the existence of upper Z equals sans serif upper E left parenthesis upper X vertical bar script upper A right parenthesisZ = E(X | A) we can now use Theorem 6.3, see  
Exercise 6.17. Next, we immediately see that, similar to the special case of script upper A equals sigma left parenthesis upper Y right parenthesisA =
σ(Y), there is no additional information rather than script upper AA, i.e., sigma left parenthesis upper Z right parenthesis subset of script upper Aσ(Z) ⊂A. Observe 
that Theorem 6.2, item 3, implies sans serif upper E left parenthesis sans serif upper E left parenthesis upper X vertical bar script upper A right parenthesis right parenthesis equals sans serif upper E left parenthesis upper X right parenthesisE(E(X | A)) = E(X) provided upper A equals upper OmegaA = Ω. Moreover, 
we can condition on ‘extreme’ sub-sigma hyphen algebraσ-algebras contained in the information set script upper AA, 
namely sans serif upper E left parenthesis upper X vertical bar StartSet empty set comma upper Omega EndSet right parenthesis equals sans serif upper E left parenthesis upper X right parenthesisE(X | {∅, Ω}) = E(X) and sans serif upper E left parenthesis upper X vertical bar script upper F right parenthesis equals upper XE(X | F) = X, see Exercise 6.21. The latter 
highlights that the greater script upper AA the larger is the set of rvs inducing events in script upper AA and 
representing sans serif upper E left parenthesis upper X vertical bar script upper A right parenthesisE(X | A).
6.4
Conditional Expectation Given a Sub-σ-algebra
183
Remark 6.2 Conditional expectation 
sans serif upper E left parenthesis upper X vertical bar upper Y 1 comma ellipsis comma upper Y Subscript n Baseline right parenthesisE(X | Y1, . . . , Yn)
can be deﬁned as 
sans serif upper E left parenthesis upper X vertical bar sigma left parenthesis bold upper Y right parenthesis right parenthesisE(X | σ(Y)), for a random vector bold upper Y equals left parenthesis upper Y 1 comma ellipsis comma upper Y Subscript n Baseline right parenthesisY = (Y1, . . . , Yn) with discrete components 
upper Y Subscript iYi. Indeed, sigma left parenthesis bold upper Y right parenthesis identical to sigma left parenthesis upper Y 1 comma ellipsis comma upper Y Subscript n Baseline right parenthesisσ(Y) ≡σ(Y1, . . . , Yn) is the smallest sigma hyphen algebraσ-algebra containing events 
union Subscript j element of upper I Baseline left brace bold upper Y equals bold c Subscript j Baseline right brace∪j∈I{Y = cj} for some upper I subset of double struck upper NI ⊂N. Note that 
left brace bold upper Y equals bold c Subscript j Baseline right brace equals intersection Subscript i equals 1 Superscript n Baseline left brace upper Y Subscript i Baseline equals c Subscript i j Baseline right brace comma bold c Subscript j Baseline equals left parenthesis c Subscript 1 j Baseline comma ellipsis comma c Subscript n j Baseline right parenthesis period{Y = cj} = ∩n
i=1{Yi = cij},
cj = (c1j, . . . , cnj).
If the random vector is no longer discrete then sigma left parenthesis upper Y 1 comma ellipsis comma upper Y Subscript n Baseline right parenthesisσ(Y1, . . . , Yn) is the smallest 
sigma hyphen algebraσ-algebra containing events left brace upper Y Subscript i Baseline less than or slanted equals y Subscript i Baseline right brace{Yi ⩽yi} for all i equals 1 comma ellipsis comma ni = 1, . . . , n, i.e., intersection Subscript i Baseline left brace upper Y Subscript i Baseline less than or slanted equals y Subscript i Baseline right brace equals left brace bold upper Y less than or slanted equals bold y right brace element of sigma left parenthesis bold upper Y right parenthesis∩i{Yi ⩽yi} =
{Y ⩽y} ∈σ(Y) for some bold y element of double struck upper R Superscript ny ∈Rn. 
The general conditional expectation fulﬁlls some interesting conditions. 
Proposition 6.1 For rvs upper X comma upper Y element of upper L Superscript 1X, Y ∈L1 and sub-sigma hyphen algebraσ-algebras script upper H subset of script upper A subset of script upper FH ⊂A ⊂F the following 
properties are valid. 
1. Linearity. sans serif upper E left parenthesis alpha upper X plus beta upper Y vertical bar script upper A right parenthesis equals Overscript a period s period Endscripts alpha sans serif upper E left parenthesis upper X vertical bar script upper A right parenthesis plus beta sans serif upper E left parenthesis upper Y vertical bar script upper A right parenthesisE(αX + βY | A) a.s.
= αE(X | A) + βE(Y | A), for alpha comma beta element of double struck upper R periodα, β ∈R.
2. Positivity. If upper X greater than or slanted equals 0X ⩾0, then sans serif upper E left parenthesis upper X vertical bar script upper A right parenthesis greater than or slanted equals 0E(X | A) ⩾0 with probability 1. 
3. Law 
of 
iterated 
expectations 
or 
tower 
property. 
sans serif upper E left parenthesis sans serif upper E left parenthesis upper X vertical bar script upper A right parenthesis vertical bar script upper H right parenthesis equals Overscript a period s period Endscripts sans serif upper E left parenthesis sans serif upper E left parenthesis upper X vertical bar script upper H right parenthesis vertical bar script upper A right parenthesis equals Overscript a period s period Endscripts sans serif upper E left parenthesis upper X vertical bar script upper H right parenthesisE
(
E(X | A) | H
)
a.s.
=
E
(
E(X | H) | A
) a.s.
= E(X | H)
4. Taking out what is known. If Y induces events in script upper AA and upper X upper Y element of upper L Superscript 1XY
∈L1 then 
sans serif upper E left parenthesis upper X upper Y vertical bar script upper A right parenthesis equals Overscript a period s period Endscripts upper Y sans serif upper E left parenthesis upper X vertical bar script upper A right parenthesis periodE(XY | A) a.s.
= Y E(X | A).
5. If X and bold upper I Subscript upper AIA are independent for any upper A element of script upper AA ∈A, then sans serif upper E left parenthesis upper X vertical bar script upper A right parenthesis equals sans serif upper E left parenthesis upper X right parenthesisE(X | A) = E(X). 
Remark 6.3 Sub-sigma hyphen algebraσ-algebra script upper HH in item 3 is said to be coarser than script upper AA, which is 
said to be ﬁner than script upper HH. Thus, the ‘coarser rules out the ﬁner’: conditioning X on 
the information set script upper HH is the same as conditioning ﬁrst on script upper AA. On the other hand, 
upper Z equals sans serif upper E left parenthesis upper X vertical bar script upper H right parenthesisZ = E(X | H) induces events in script upper AA and the information in script upper AA is enough to determine 
sans serif upper E left parenthesis upper Z vertical bar script upper A right parenthesisE(Z | A), regardless a second forecast based on the ﬁner information set. Observe 
that 
sans serif upper E left parenthesis upper Z vertical bar script upper A right parenthesis equals Overscript a period s period Endscripts upper Z comma for any rv upper Z inducing events in script upper A periodE(Z | A) a.s.
= Z,
for any rv Z inducing events in A.
(6.23) 
This follows from Property 4. of Proposition 6.1 if we let upper Y equals upper ZY = Z and upper X equals 1X = 1. 
Property 4. says that for a rv Y inducing events in script upper AA, the expectation of XY 
conditional on the information script upper AA treats Y as a constant. Property 5. is equivalently 
stated by saying that the rv X and the sub-sigma hyphen algebraσ-algebra script upper AA are independent, in the sense 
that sigma left parenthesis upper X right parenthesisσ(X) and script upper AA are independent. 
We clarify the precise meaning of the statement about independence in the pre-
vious remark by stating equivalently that sigma left parenthesis upper X right parenthesisσ(X) and script upper AA are independent. Let sigma left parenthesis bold upper I Subscript upper A Sub Subscript i Subscript Baseline right parenthesisσ(IAi)
be the sigma hyphen algebraσ-algebra generated by the indicator rv bold upper I Subscript upper A Sub Subscript iIAi, for some event upper A Subscript iAi. Indicators 
bold upper I Subscript upper A 1 Baseline comma bold upper I Subscript upper A 2 Baseline comma ellipsisIA1, IA2, . . . are independent iff their generated sigma hyphen algebraσ-algebras sigma left parenthesis bold upper I Subscript upper A 1 Baseline right parenthesis comma sigma left parenthesis bold upper I Subscript upper A 2 Baseline right parenthesis comma ellipsisσ(IA1), σ(IA2), . . . are
184
6
Conditioning
independent. To see why, ﬁrst by independence we have: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper A Subscript i Baseline intersection upper A Subscript j Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis bold upper I Subscript upper A Sub Subscript i Subscript intersection upper A Sub Subscript j Subscript Baseline right parenthesis equals sans serif upper E left parenthesis bold upper I Subscript upper A Sub Subscript i Subscript Baseline right parenthesis sans serif upper E left parenthesis bold upper I Subscript upper A Sub Subscript j Subscript Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper A Subscript i Baseline right parenthesis sans serif upper P left parenthesis upper A Subscript j Baseline right parenthesis for all i not equals j period EndLayoutP(Ai ∩Aj) = E(IAi∩Aj ) = E(IAi)E(IAj )
= P(Ai)P(Aj)
for all i /= j.
Second, upper A Subscript iAi and upper A Subscript jAj are independent. Now, sigma left parenthesis bold upper I Subscript upper A Sub Subscript i Subscript Baseline right parenthesis equals sigma left parenthesis upper A Subscript i Baseline right parenthesisσ(IAi) = σ(Ai) and recall from 
Example 1.14, Sect. 1.6, that also sigma left parenthesis upper A Subscript i Baseline right parenthesis equals StartSet empty set comma upper A Subscript i Baseline comma upper A Subscript i Superscript c Baseline comma upper Omega EndSetσ(Ai) = {∅, Ai, Ac
i , Ω}, for i equals 1 comma 2 comma ellipsisi = 1, 2, . . .. We  
conclude that the families sigma left parenthesis upper A Subscript i Baseline right parenthesisσ(Ai) and sigma left parenthesis upper A Subscript j Baseline right parenthesisσ(Aj) contain mutually independent events, 
see Sect. 3.4. We can write sigma left parenthesis upper A Subscript i Baseline right parenthesis perpendicular perpendicular sigma left parenthesis upper A Subscript j Baseline right parenthesisσ(Ai) ⊥⊥σ(Aj), for all possible choice of indices 
i comma ji, j. Henceforth, independence between two rvs upper X comma upper YX, Y can be stated in one of the 
following equivalent forms: 
• 
.{X ∈B} and left brace upper Y element of upper C right brace{Y ∈C} are independent events, for any pair of suitable sets 
upper B comma upper C subset of double struck upper RB, C ⊂R. 
• 
.σ(X) and sigma left parenthesis upper Y right parenthesisσ(Y) are independent sigma hyphen algebraσ-algebras. 
• 
.I{X∈B} and bold upper I Subscript left brace upper Y element of upper C right braceI{Y∈C} are independent indicators. 
We may pass from conditional probability to a notion of stochastic probability. In 
fact, let upper X equals bold upper I Subscript upper AX = IA and deﬁne upper Z equals sans serif upper E left parenthesis bold upper I Subscript upper A Baseline vertical bar script upper A right parenthesisZ = E(IA | A), with respect to the sub-sigma hyphen algebraσ-algebra script upper A subset of script upper FA ⊂
F, as upper Z colon upper Omega right arrow left bracket 0 comma 1 right bracketZ : Ω →[0, 1]. This is a rv called regular conditional probability, denoted 
sans serif upper P left parenthesis upper A vertical bar script upper A right parenthesisP(A | A), which assigns probabilities to events upper A element of script upper AA ∈A under the hypotheses that 
other events in script upper AA occurred, i.e., what matters is the information set script upper AA. In particular, 
for every upper A comma upper B element of script upper AA, B ∈A we have sans serif upper P left parenthesis upper A intersection upper B right parenthesis equals sans serif upper E left parenthesis bold upper I Subscript upper A Baseline bold upper I Subscript upper B Baseline right parenthesis equals sans serif upper E left parenthesis sans serif upper P left parenthesis upper A vertical bar script upper A right parenthesis bold upper I Subscript upper B Baseline right parenthesisP(A ∩B) = E(IA IB) = E (P(A | A)IB), which 
is sans serif upper P left parenthesis upper A vertical bar upper B right parenthesis sans serif upper P left parenthesis upper B right parenthesisP(A | B)P(B). If upper B equals upper OmegaB = Ω then sans serif upper E left parenthesis sans serif upper P left parenthesis upper A vertical bar script upper A right parenthesis vertical bar script upper A right parenthesis equals sans serif upper E left parenthesis bold upper I Subscript upper A Baseline right parenthesis equals sans serif upper P left parenthesis upper A right parenthesisE(P(A | A) | A) = E(IA) = P(A). For a more 
detailed treatment of regular conditional probability see for example [2] and [16] 
and Appendix. Eventually, we have a further formula based on Theorem 6.2. Let  X 
be a rv independent from the sub-sigma hyphen algebraσ-algebra script upper A subset of script upper FA ⊂F, and let Y be another rv inducing 
events in script upper AA. Given the random vector bold upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y), deﬁne a function h colon double struck upper R squared right arrow double struck upper Rh : R2 →R
s.t. the rv upper Z equals h left parenthesis upper X comma upper Y right parenthesisZ = h(X, Y) has ﬁnite expectation. Then deﬁne another function psi left parenthesis x right parenthesis equals sans serif upper E left parenthesis h left parenthesis x comma upper Y right parenthesis right parenthesisψ(x) =
E(h(x, Y)) given by the expectation of the rv h left parenthesis x comma upper Y right parenthesish(x, Y), which is obtained from Z by 
keeping X as a constant. Hence: 
sans serif upper E left parenthesis h left parenthesis upper X comma upper Y right parenthesis vertical bar script upper A right parenthesis equals psi left parenthesis upper X right parenthesis periodE
(
h(X, Y) | A
)
= ψ(X).
(6.24) 
Under the assumptions above, the conditional expectation of a function of two rvs 
becomes unconditional, thus we get psi left parenthesis upper X right parenthesis equals sans serif upper E left parenthesis h left parenthesis upper X comma upper Y right parenthesis right parenthesisψ(X) = E(h(X, Y)). 
Example 6.8 Considering the same setting of Example 6.6, under no arbitrage, the 
price in t greater than 0t > 0 of an European call option with maturity in t equals upper Tt = T is the rv 
upper C Subscript t Baseline equals e Superscript minus r left parenthesis upper T minus t right parenthesis Baseline sans serif upper E Subscript sans serif upper P overTilde Baseline left parenthesis left parenthesis upper S Subscript upper T Baseline minus upper K right parenthesis Superscript plus Baseline vertical bar script upper F Subscript t Baseline right parenthesis commaCt = e−r (T −t)E ˜P((ST −K)+ | Ft),
where now we add the effect of conditioning based on information script upper F Subscript t Baseline subset of script upper FFt ⊂F, to be  
interpreted as the sub-sigma hyphen algebraσ-algebra containing all the relevant information about the 
price of any contingent claim from the perspective of risk-neutral investors.
6.5
Exercises
185
6.5 Exercises 
6.1 Verify that FX(x | A) is a CDF. 
6.2 Verify that fX | Y (x) is a density. 
6.3 Let X = IB for some event B ∈F. Compute E(X | A) with P(A) > 0. 
6.4 Let X ∈ L1 be a discrete rv with support X = {x1, x2, . . .} and masses 
P(X = xi) >  0. Write a formula to relate the unconditional expectation of X to 
its conditional expectation E(X | A) with P(A) > 0. 
6.5 Prove formula (6.19) for general rvs. 
6.6 Let X ∈ L1 be a nonnegative rv, and u >  0 s.t. Au := {X ⩾u}. Show that 
sans serif upper P left parenthesis upper A Subscript u Baseline right parenthesis less than or slanted equals StartFraction 1 Over u EndFraction sans serif upper E left parenthesis upper X bold upper I Subscript upper A Sub Subscript u Subscript Baseline right parenthesis less than or slanted equals StartFraction 1 Over u EndFraction sans serif upper E left parenthesis upper X right parenthesis periodP(Au) ⩽1
uE(XIAu) ⩽1
uE(X).
6.7 If Y = c for every scenario, show that E(X | Y) is also constant and equals 
E(X) = c. Show that for X = IA and Y = IB we have E(IA | IB) = P(A | B) for 
ω ∈ B. 
6.8 Evaluate E(X | Y) at Y = yj, when both X and Y are discrete rvs with 
countably many values. Justify a similar expression when conditioning on a discrete 
random vector. 
6.9 For discrete rvs X, Y, prove E(E(X | Y)) = E(X). 
6.10 For absolutely continuous rvs X, Y, prove E(E(X | Y)) = E(X). 
6.11 (Role of independence) Show that E(X | Y) = E(X), provided that X and Y 
are independent, by examining three cases: 
1. X and Y are both discrete; 
2. X and Y are both continuous; 
3. X is any rv and only Y is discrete. 
6.12 Assume X ∈ L1 and Y is a discrete rv. Show that: 
1. E(X | Y) induces events in σ(Y), i.e., it is σ(Y)-measurable (see also Appendix 
in Chap. 2); 
2. for every A ∈ σ(Y) it holds E(XIA) = E(E(X | Y)IA). 
6.13 Let A ⊂F be a sub-σ-algebra. Show that if X induces events in A, i.e., it is 
A-measurable, and E(XIA) = 0, for all A ∈ A, then X a.s.
= 0. Recall what the last 
sentence means: P(X = 0) = 1. 
6.14 Prove that the existence of E(X | Y) is veriﬁed up to P-null sets 
6.15 Show that E(X | Y) =
⎰∞ 
−∞ xfX(x,Y)dx
⎰∞ 
−∞ fX(x,Y)dx , for rvs X, Y ∈ L1 with joint density. 
6.16 (Expectation vs probability) Show that formula (6.22) gives a probability 
measure ˜P absolutely continuous w.r.t. P.
186
6
Conditioning
6.17 Prove existence of general conditional expectation in Theorem 6.2. 
6.18 Let X, Y ⩾0 be two rvs over a probability space (Ω, F, P), where EP(Y) = 
1, i.e. Y is a Radon-Nikodým derivative d ˜P 
dP. If  ˜P(A) = E(YIA), for any A ∈ F, 
show that:7 
sans serif upper E Subscript sans serif upper P overTilde Baseline left parenthesis upper X right parenthesis equals sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X upper Y right parenthesis periodE ˜P(X) = EP(XY).
(6.25) 
6.19 Let X ⩾0 be a rv and take  Y >  0 be another rv with EP(Y) = 1, both deﬁned 
over the same probability space. Prove that 
sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X right parenthesis equals sans serif upper E Subscript sans serif upper P overTilde Baseline left parenthesis StartFraction upper X Over upper Y EndFraction right parenthesis periodEP(X) = E ˜P( X
Y ).
(6.26) 
6.20 Let X ⩾0 a rv with EP(X) = 1. If P(A) = 0 for some event A ∈ F, show  
that ˜P(A) = 0 and then ˜P ⪡P. 
6.21 Show that E(X | A) = E(X), if A = {∅, Ω}, while it equals X for A = F. 
6.22 Prove item 3 of Theorem 6.2, i.e. Z ∈L1 for Z = E(X | A ). 
6.23 Prove tower property, i.e., item 3 of Proposition 6.1. 
Appendix 
Existence of Conditional Distribution and Joint Law 
Any conditional probability like that in (6.6) cannot be deﬁned in most cases where 
there are events with zero probability, namely sans serif upper P left parenthesis upper Y element of upper C right parenthesis equals 0P(Y ∈C) = 0. The latter is especially 
true if left brace upper Y element of upper C right brace equals left brace upper Y equals y right brace{Y ∈C} = {Y = y} and the rv Y has absolutely continuous CDF upper F Subscript upper YFY . 
To guarantee the existence of conditional probability even for sans serif upper PP-null event, the 
following theorem is of some importance. 
Theorem 6.4 Let left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P) be a probability space and bold upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y) be a random 
vector with joint law sans serif upper P Subscript bold upper X Baseline left parenthesis dot right parenthesisPX( · ) deﬁned over those subsets upper D subset of double struck upper R squaredD ⊂R2 s.t. left brace bold upper X element of upper D right brace element of script upper F{X ∈D} ∈F. 
1. There exists a conditional distribution sans serif upper P Subscript upper X vertical bar upper Y Baseline left parenthesis upper B vertical bar y right parenthesisPX | Y (B | y) which equals8 sans serif upper P left parenthesis upper X element of upper B vertical bar upper Y equals y right parenthesisP(X
∈
B | Y = y), for any upper B subset of double struck upper RB ⊂R s.t. left brace upper X element of upper B right brace element of script upper F{X ∈B} ∈F; 
2. .PX | Y (B | ·) is a univariate probability measure on double struck upper RR for every y element of double struck upper Ry ∈R; 
3. Provided sans serif upper E left parenthesis g left parenthesis upper X comma upper Y right parenthesis right parenthesis less than normal infinityE(g(X, Y)) < ∞it holds9 sans serif upper E left parenthesis g left parenthesis upper X comma upper Y right parenthesis vertical bar upper Y equals y right parenthesis equals integral Underscript double struck upper R Endscripts g left parenthesis x comma y right parenthesis normal d sans serif upper P Subscript upper X vertical bar upper Y BaselineE(g(X, Y) | Y = y) =
⎰
R g(x, y)dPX | Y , 
for a suitable function g left parenthesis x comma y right parenthesisg(x, y); 
4. .PX(D) = P(X ∈B, Y ∈C) =
⎰
C PX | Y (B | y)dPY , where upper D equals upper B times upper CD = B × C.
7 This can be extended to general rvs. 
8 This relation holds sans serif upper P Subscript upper YPY -a.s. in y element of double struck upper Ry ∈R. 
9 Again, this holds sans serif upper P Subscript upper YPY -a.s. in y element of double struck upper Ry ∈R. 
Appendix
187
The conditional distribution whose existence is postulated by Theorem 6.4 is 
the regular conditional probability introduced in Sect. 6.4. Here we give a further  
heuristic justiﬁcation: 
sans serif upper P Subscript upper X vertical bar upper Y Baseline left parenthesis upper B vertical bar y right parenthesis equals limit Underscript h down arrow 0 Endscripts StartFraction sans serif upper P left parenthesis upper X element of upper B comma upper Y element of left parenthesis y minus h comma y plus h right parenthesis right parenthesis Over sans serif upper P left parenthesis upper Y element of left parenthesis y minus h comma y plus h right parenthesis right parenthesis EndFraction comma for h greater than 0 periodPX | Y (B | y) = lim
h↓0
P(X ∈B, Y ∈(y −h, y + h))
P(Y ∈(y −h, y + h))
,
for h > 0.
(6.27) 
This can be understood as the derivative of one measure, sans serif upper Q left parenthesis upper C right parenthesis colon equals sans serif upper P left parenthesis upper X element of upper B comma upper Y element of upper C right parenthesisQ(C) := P(X ∈B, Y ∈
C), w.r.t. another, sans serif upper P Subscript upper Y Baseline left parenthesis upper C right parenthesis colon equals sans serif upper P left parenthesis upper Y element of upper C right parenthesisPY (C) := P(Y ∈C). Indeed both are probability measures on 
double struck upper RR and moreover 0 less than or slanted equals sans serif upper Q left parenthesis upper C right parenthesis less than or slanted equals sans serif upper P Subscript upper Y Baseline left parenthesis upper C right parenthesis0 ⩽Q(C) ⩽PY (C), i.e. sans serif upper Q much less than sans serif upper P Subscript upper Y BaselineQ ⪡PY and we can invoke the Radon-
Nikod`ym theorem recognizing the limit above as StartFraction normal d sans serif upper Q Over normal d sans serif upper P Subscript upper Y Baseline EndFraction equals f left parenthesis y right parenthesis dQ
dPY = f (y) and writing 
integral Underscript upper C Endscripts f left parenthesis y right parenthesis normal d sans serif upper P Subscript upper Y Baseline period
⎰
C
f (y)dPY .
Compare f left parenthesis y right parenthesisf (y) with the integrand in item (d) of Theorem 6.4.10 The limit in the 
previous discussion cannot be conceived in the usual sense since it may be sans serif upper P left parenthesis upper Y equals y right parenthesis equals 0P(Y =
y) = 0. The measure-theoretic device (Radon-Nikod`ym derivative) enable us to 
avoid imposing restrictive conditions on sans serif upper PP and left parenthesis upper X comma upper Y right parenthesis(X, Y). 
Remark 6.4 Assume bold upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y) has a joint density f Subscript bold upper X Baseline left parenthesis x comma y right parenthesisfX(x, y). Further, assume that 
there exists h greater than 0h > 0 s.t. f Subscript bold upper X Baseline left parenthesis x comma y right parenthesisfX(x, y) and the marginal f Subscript upper Y Baseline left parenthesis y right parenthesisfY (y) are both continuous in the 
second variable over left bracket y minus h comma y plus h right bracket[y −h, y + h], and also f Subscript upper Y Baseline left parenthesis y right parenthesis greater than 0fY (y) > 0. Recast the limit in (6.27) 
as 
limit Underscript h down arrow 0 Endscripts StartFraction integral Underscript upper B Endscripts integral Subscript y minus h Superscript y plus h Baseline f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis normal d x normal d y Over integral Subscript b minus h Superscript b plus h Baseline f Subscript upper Y Baseline left parenthesis y right parenthesis normal d y EndFraction periodlim
h↓0
⎰
B
⎰y+h
y−h fX(x, y)dxdy
⎰b+h
b−h fY (y)dy
.
Now, we apply the mean value theorem11 to integral Subscript y minus h Superscript y plus h Baseline f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis normal d y
⎰y+h
y−h fX(x, y)dy and integral Subscript y minus h Superscript y plus h Baseline f Subscript upper Y Baseline left parenthesis y right parenthesis normal d y
⎰y+h
y−h fY (y)dy, 
both as functions of y. This yields that the limit above can be rewritten as 
limit Underscript h down arrow 0 Endscripts StartFraction integral Underscript upper B Endscripts 2 h f Subscript bold upper X Baseline left parenthesis x comma y 1 right parenthesis normal d x Over 2 h f Subscript upper Y Baseline left parenthesis y 2 right parenthesis EndFraction commalim
h↓0
⎰
B 2h fX(x, y1)dx
2h fY (y2)
,
where y 1 comma y 2 element of left bracket y minus h comma y plus h right brackety1, y2 ∈[y −h, y + h] and in the limit they coincide with y. So, the 2h 
in the numerator and denominator cancel each other and we end with the desired 
conditional probability sans serif upper P Subscript upper X vertical bar upper Y Baseline left parenthesis upper B vertical bar y right parenthesisPX | Y (B | y).
10 Be warned: we can ﬁnd another Radon-Nikod`ym derivative s.t. ModifyingAbove f With tilde left parenthesis y right parenthesis not equals f left parenthesis y right parenthesis ˜f (y) /= f (y) for those y element of double struck upper Ry ∈R
forming a sans serif upper P Subscript upper YPY -null set. 
11 Given a continuous g left parenthesis x right parenthesisg(x) over left bracket a comma b right bracket[a, b], then there exists c element of left bracket a comma b right bracketc ∈[a, b] s.t. integral Subscript a Superscript b Baseline g left parenthesis x right parenthesis normal d x equals g left parenthesis c right parenthesis left parenthesis b minus a right parenthesis
⎰b
a g(x)dx = g(c)(b −a). 
Chapter 7 
Regression, Prediction and More 
Dependence 
7.1 
Prediction 
How is a random experiment affected by collateral random disturbances? Let  
upper X 1 comma ellipsis comma upper X Subscript n BaselineX1, . . . , Xn be rvs over left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P) and assume Y is the rv of interest. Our aim is 
to tackle the problem of predicting upper Y left parenthesis omega right parenthesisY(ω) given upper X Subscript i Baseline left parenthesis omega right parenthesisXi(ω) for every i equals 1 comma ellipsis comma ni = 1, . . . , n and 
for all scenarios omegaω in the sample space. We will see how this problem can lead to 
ﬁnd some functional dependence among Y and upper X 1 comma ellipsis comma upper X Subscript n BaselineX1, . . . , Xn. 
Deﬁnition 7.1 Let bold upper X equals left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesisX = (X1, . . . , Xn) be explanatory rvs. Then a predictor for 
Y based on bold upper XX is a suitable function f left parenthesis bold upper X right parenthesis periodf (X). The prediction error is the rv epsilon equals upper Y minus f left parenthesis bold upper X right parenthesis periodε =
Y −f (X).
To compare different predictors we use the mean-square prediction error: 
sans serif upper E left parenthesis upper Y minus f left parenthesis bold upper X right parenthesis right parenthesis squared comma upper Y comma f left parenthesis bold upper X right parenthesis element of upper L squared periodE (Y −f (X))2 ,
Y, f (X) ∈L2.
Say, a predictor f 1f1 is better than a predictor f 2f2 (in the mean-square sense) iff 
sans serif upper E left parenthesis upper Y minus f 1 left parenthesis bold upper X right parenthesis right parenthesis squared less than or slanted equals sans serif upper E left parenthesis upper Y minus f 2 left parenthesis bold upper X right parenthesis right parenthesis squared commaE (Y −f1(X))2 ⩽E (Y −f2(X))2 ,
i.e. provided that epsilonε is minimized with f 1f1. 
Example 7.1 The rv f left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesis equals sans serif upper E left parenthesis upper Y vertical bar upper X 1 comma ellipsis upper X Subscript n Baseline right parenthesisf (X1, . . . , Xn) = E(Y | X1, . . . Xn) is called the regression 
function of Y on bold upper X equals left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesis periodX = (X1, . . . , Xn). Its value at upper X Subscript i Baseline equals x Subscript i Baseline commaXi = xi, for i equals 1 comma ellipsis comma n commai = 1, . . . , n, is 
given by 
f left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis equals sans serif upper E left parenthesis upper Y vertical bar upper X 1 equals x 1 comma ellipsis comma upper X Subscript n Baseline equals x Subscript n Baseline right parenthesis periodf (x1, . . . , xn) = E(Y | X1 = x1, . . . , Xn = xn).
For n equals 1n = 1 we have f left parenthesis upper X right parenthesis equals sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesisf (X) = E(Y | X), with value f left parenthesis x right parenthesis equals sans serif upper E left parenthesis upper Y vertical bar upper X equals x right parenthesisf (x) = E(Y | X = x). 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4_7
189
190
7
Regression, Prediction and More Dependence
Example 7.2 (Linear Prediction) The function f left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesis equals a 0 plus a 1 upper X 1 plus midline horizontal ellipsis plus a Subscript n Baseline upper X Subscript n Baseline commaf (X1, . . . , Xn) = a0 + a1X1 +
· · · + anXn, where a 0 comma a 1 comma ellipsis comma a Subscript n Baselinea0, a1, . . . , an are all constants, is a linear predictor of Y based 
on bold upper X equals left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesis periodX = (X1, . . . , Xn). For n equals 1n = 1 we have f left parenthesis upper X right parenthesis equals a plus b upper Xf (X) = a + bX. 
Some properties of conditional expectation are useful in prediction, then we 
summarize them here. Observe that they can be deduced from those satisﬁed by 
general conditional expectation, see Sect. 6.4, Theorem 6.2, and Proposition 6.1. 
(all rvs are in upper L Superscript 1L1). 
1. .E(c | X) = c ∈R. 
2. .E(Y + Z | X) = E(Y | X) + E(Z | X). 
3. .E(cY | X) = cE(Y | X). 
4. .E(Y | X) = E(Y) iff X and Y are independent. 
5. .E(ZY | X) = ZE(Y | X) iff Z and X are independent. 
6. .E(h(X)Y | X) = h(X)E(Y | X), taking out what is known. 
7. .E(E(Y | X)) = E(Y), or more generally sans serif upper E left parenthesis sans serif upper E left parenthesis h left parenthesis upper Y right parenthesis vertical bar upper X right parenthesis right parenthesis equals sans serif upper E left parenthesis h left parenthesis upper Y right parenthesis right parenthesisE(E(h(Y) | X)) = E(h(Y)) for a 
suitable function h. 
8. .E(f (X) | X) = h(X), for a suitable function h. 
9. .E (E(Y | X, Z) | X) = E(Y | X). 
In item 4 we have no information from X, and sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesisE(Y | X) becomes unconditional; in 
item 7 we have complete information from X, which we understood as complete 
dependence. Recall that sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesisE(Y | X) is a rv that equals sans serif upper E left parenthesis upper Y vertical bar upper X equals x right parenthesisE(Y | X = x) whenever upper X equals xX = x. 
In item (8) we used sans serif upper E left parenthesis dot vertical bar upper X comma upper Z right parenthesis equals sans serif upper E left parenthesis dot vertical bar sigma left parenthesis upper X comma upper Z right parenthesis right parenthesisE( · | X, Z) = E( · | σ(X, Z)) and sans serif upper E left parenthesis dot vertical bar upper X right parenthesis equals sans serif upper E left parenthesis dot vertical bar sigma left parenthesis upper X right parenthesis right parenthesisE( · | X) = E( · | σ(X)), and 
since sigma left parenthesis upper X right parenthesis subset of sigma left parenthesis upper X comma upper Z right parenthesisσ(X) ⊂σ(X, Z) the tower property of general conditional expectation does 
the job, see Proposition 6.1 in Sect. 6.4. It is worth noting how sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesisE(Y | X) is based 
on reverse conditioning w.r.t. that treated in Sect. 6.3, which is now expressed as 
dependence between Y and X, i.e., upper Y equals f left parenthesis upper X right parenthesisY = f (X), see also Lemma 6.1. 
Remark 7.1 (Projection) For any suitable1 function h left parenthesis dot right parenthesish( · ) we have upper Y minus sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesisY −E(Y | X)
is uncorrelated with h left parenthesis upper X right parenthesish(X). Indeed, in sans serif c o v left parenthesis upper Y minus sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesis comma h left parenthesis upper X right parenthesis right parenthesiscov(Y −E(Y | X), h(X)) let upper Z equals sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesisZ = E(Y | X)
then: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis left parenthesis upper Y minus upper Z right parenthesis h left parenthesis upper X right parenthesis right parenthesis minus ModifyingBelow sans serif upper E left parenthesis upper Y minus upper Z right parenthesis With bottom brace Underscript equals 0 by left parenthesis 2 right parenthesis comma left parenthesis 3 right parenthesis and left parenthesis 7 right parenthesis Endscripts sans serif upper E left parenthesis h left parenthesis upper X right parenthesis right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis upper Y h left parenthesis upper X right parenthesis right parenthesis minus sans serif upper E left parenthesis h left parenthesis upper X right parenthesis upper Z right parenthesis 2nd Row 1st Column Blank 2nd Column StartLayout 1st Row by left parenthesis 6 right parenthesis 2nd Row equals EndLayout 3rd Column sans serif upper E left parenthesis upper Y h left parenthesis upper X right parenthesis right parenthesis minus ModifyingBelow sans serif upper E left parenthesis sans serif upper E left parenthesis h left parenthesis upper X right parenthesis upper Y vertical bar upper X right parenthesis right parenthesis With bottom brace Underscript equals sans serif upper E left parenthesis upper Y h left parenthesis upper X right parenthesis right parenthesis Endscripts 3rd Row 1st Column Blank 2nd Column equals 3rd Column 0 EndLayoutE((Y −Z)h(X)) −
E(Y −Z)
◟
◝◜
◞
=0 by (2), (3) and (7)
E(h(X))
=
E(Yh(X)) −E(h(X)Z)
by (6)
=
E(Yh(X)) −E(E(h(X)Y | X))
◟
◝◜
◞
=E(Yh(X))
=
0
Up to this point, it is useful to have a conditional version of the variance.
1 Recall: this means Borel measurable. 
7.1
Prediction
191
Deﬁnition 7.2 Given two rvs upper X comma upper Y element of upper L squaredX, Y ∈L2, the conditional variance of Y based on X 
is the rv 
sans serif upper V left parenthesis upper Y vertical bar upper X right parenthesis colon equals sans serif upper E left parenthesis left brace upper Y minus sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesis right brace squared vertical bar upper X right parenthesis commaV(Y | X) := E
⎛
{Y −E(Y | X)}2 | X
⎞
,
(7.1) 
i.e., the variance of Y given X. A speciﬁc value is given by: 
sans serif upper V left parenthesis upper Y vertical bar upper X equals x right parenthesis comma x element of double struck upper R periodV(Y | X = x),
x ∈R.
The conditional variance can be written: 
sans serif upper V left parenthesis upper Y vertical bar upper X right parenthesis equals sans serif upper E left parenthesis upper Y squared vertical bar upper X right parenthesis minus left parenthesis sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesis right parenthesis squared periodV(Y | X) = E(Y 2 | X) −(E(Y | X))2 .
(7.2) 
sans serif upper V left parenthesis upper Y vertical bar upper X right parenthesisV(Y | X) is also a function of X, i.e. it is a rv. 
Proposition 7.1 (Law of Total Variance) 
For upper Y element of upper L squaredY ∈L2 we have 
sans serif upper V left parenthesis upper Y right parenthesis equals sans serif upper V left parenthesis sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesis right parenthesis plus sans serif upper E left parenthesis sans serif upper V left parenthesis upper Y vertical bar upper X right parenthesis right parenthesis periodV(Y) = V(E(Y | X)) + E(V(Y | X)).
(7.3) 
sans serif upper V left parenthesis upper Y right parenthesisV(Y) decomposes into the sum of: 
• 
.V(E(Y | X)) which explains the variability of Y in term of its average dependence 
on X (explained variation); 
• 
.E(V(Y | X)) accounts for other sources of variability (unexplained variation). 
If upper Y equals f left parenthesis upper X right parenthesisY = f (X) for a suitable function f , then 
sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesis equals sans serif upper E left parenthesis f left parenthesis upper X right parenthesis vertical bar upper X right parenthesis equals f left parenthesis upper X right parenthesis equals upper YE(Y | X) = E(f (X) | X) = f (X) = Y
thus 
sans serif upper V left parenthesis upper Y vertical bar upper X right parenthesis equals sans serif upper E left parenthesis left parenthesis upper Y minus upper Y right parenthesis squared vertical bar upper X right parenthesis equals 0 periodV(Y | X) = E
⎛
(Y −Y)2 | X
⎞
= 0.
Hence, in case of strong dependence the variance of sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesisE(Y | X) is the same as sans serif upper V left parenthesis upper Y right parenthesis commaV(Y),
and X is a good predictor of upper Y periodY. In case of independence, sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesis equals sans serif upper E left parenthesis upper Y right parenthesisE(Y | X) = E(Y) and 
the conditional variance equals sans serif upper V left parenthesis sans serif upper E left parenthesis upper Y right parenthesis right parenthesis equals 0V(E(Y)) = 0. Observing that, from upper L squared subset of upper L Superscript 1L2 ⊂L1, 
Theorem 6.2 in Sect. 6.4 can be stated for square integrable rvs, and we have that the 
expectation of one rv Y conditioned on another rv X (recall to choose script upper A equals sigma left parenthesis upper X right parenthesisA = σ(X)) 
represents a form of functional dependence which is the best in the mean-square 
sense. 
Theorem 7.1 (Least-Square Estimate) 
For a rv upper Y element of upper L squaredY ∈L2 it holds 
sans serif upper E left parenthesis left brace upper Y minus sans serif upper E left parenthesis upper Y vertical bar script upper A right parenthesis right brace squared right parenthesis less than or slanted equals sans serif upper E left parenthesis left parenthesis upper Y minus upper Z right parenthesis squared right parenthesis commaE
⎛
{Y −E(Y | A)}2⎞
⩽E
⎛
(Y −Z)2⎞
,
(7.4) 
for any rv upper Z element of upper L squaredZ ∈L2 which induces events in script upper A subset of script upper FA ⊂F, i.e., which is script upper AA-measurable.
192
7
Regression, Prediction and More Dependence
Thanks to the Law of Total Variance (Proposition 7.1) we can write: 
StartLayout 1st Row 1st Column sans serif upper V left parenthesis upper Y right parenthesis 2nd Column StartLayout 1st Row Def period of sigma Subscript upper Y Superscript 2 Baseline 2nd Row equals EndLayout 3rd Column sans serif upper E left parenthesis left brace upper Y minus sans serif upper E left parenthesis upper Y right parenthesis right brace squared right parenthesis 2nd Row 1st Column Blank 2nd Column StartLayout 1st Row Def period left parenthesis question mark question mark question mark right parenthesis 2nd Row equals EndLayout 3rd Column sans serif upper E left parenthesis left brace sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesis minus sans serif upper E left parenthesis upper Y right parenthesis right brace squared right parenthesis plus sans serif upper E left parenthesis sans serif upper V left parenthesis upper Y vertical bar upper X right parenthesis right parenthesis 3rd Row 1st Column Blank 2nd Column greater than or slanted equals 3rd Column sans serif upper E left parenthesis sans serif upper V left parenthesis upper Y vertical bar upper X right parenthesis right parenthesis period EndLayoutV(Y) Def. of σ 2
Y
=
E({Y −E(Y)}2)
Def. (7.1) 
= 
E
⎛
{E(Y | X) −E(Y)}2⎞
+ E (V(Y | X))
⩾
E(V(Y | X)). 
The above rewrites: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis left brace upper Y minus h left parenthesis upper X right parenthesis right brace squared right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis left brace f left parenthesis upper X right parenthesis minus h left parenthesis upper X right parenthesis right brace squared right parenthesis plus sans serif upper E left parenthesis sans serif upper V left parenthesis upper Y vertical bar upper X right parenthesis right parenthesis 2nd Row 1st Column Blank 2nd Column greater than or slanted equals 3rd Column sans serif upper E left parenthesis sans serif upper V left parenthesis upper Y vertical bar upper X right parenthesis right parenthesis comma EndLayoutE({Y −h(X)}2) = E
⎛
{f (X) −h(X)}2⎞
+ E (V(Y | X))
⩾E(V(Y | X)),
with h left parenthesis upper X right parenthesis equals sans serif upper E left parenthesis upper Y right parenthesish(X) = E(Y) being another predictor2 of Y and f left parenthesis upper X right parenthesis equals sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesisf (X) = E(Y | X) the 
regression function of Y on upper X periodX. When h left parenthesis upper X right parenthesis equals Overscript a period s period Endscripts f left parenthesis upper X right parenthesis commah(X) a.s.
= f (X), we have equality above and 
minimal expected quadratic prediction error: f left parenthesis upper X right parenthesis equals sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesisf (X) = E(Y | X) is the best predictor 
of Y based on upper X commaX, for rvs upper Y element of upper L squared periodY ∈L2.
7.2 
Linear Prediction and Dependence 
Although f left parenthesis upper X right parenthesis equals sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesisf (X) = E(Y | X) is the best predictor of upper Y element of upper L squaredY ∈L2 in the mean square 
sense, computing the conditional expectation requires the joint distribution of 
left parenthesis upper X comma upper Y right parenthesis(X, Y). When knowledge of the regression function can be difﬁcult, we turn to the 
best linear predictor: f left parenthesis upper X right parenthesis equals a plus b upper Xf (X) = a + bX for some b element of double struck upper Rb ∈R and a not equals 0a /= 0. 
Proposition 7.2 Let two rvs upper X comma upper Y element of upper L squaredX, Y ∈L2 be given, with sans serif upper E left parenthesis upper X right parenthesis equals mu Subscript upper X Baseline comma sans serif upper V left parenthesis upper X right parenthesis equals sigma Subscript upper X Superscript 2E(X) = μX, V(X) = σ 2
X
and sans serif upper E left parenthesis upper Y right parenthesis equals mu Subscript upper Y Baseline comma sigma Subscript upper Y Superscript 2 Baseline equals sans serif upper V left parenthesis upper Y right parenthesisE(Y) = μY , σ 2
Y
= V(Y), and with Pearson correlation coefﬁcient rho equals StartFraction sans serif c o v left parenthesis upper X comma upper Y right parenthesis Over sigma Subscript upper X Baseline sigma Subscript upper Y Baseline EndFraction equals StartFraction sigma Subscript upper X comma upper Y Baseline Over sigma Subscript upper X Baseline sigma Subscript upper Y Baseline EndFractionρ =
cov(X,Y)
σXσY
=
σX,Y
σXσY . Then, the best linear predictor f left parenthesis upper X right parenthesis equals a plus b upper Xf (X) = a + bX of Y is that 
minimizing sans serif upper E left parenthesis left brace upper Y minus f left parenthesis upper X right parenthesis right brace squared right parenthesisE
(
{Y −f (X)}2)
, where parameters a comma b element of double struck upper Ra, b ∈R are s.t. 
f left parenthesis upper X right parenthesis equals mu Subscript upper Y Baseline plus rho StartFraction sigma Subscript upper Y Baseline Over sigma Subscript upper X Baseline EndFraction left parenthesis upper X minus mu Subscript upper X Baseline right parenthesis periodf (X) = μY + ρ σY
σX
(X −μX).
(7.5) 
In words, if Y depends linearly on X then Y is closely approximated by the 
straight line upper Y equals f left parenthesis upper X right parenthesis equals a plus b upper XY = f (X) = a + bX with (minimizing) parameters a equals mu Subscript upper Y Baseline minus rho StartFraction sigma Subscript upper Y Baseline Over sigma Subscript upper X Baseline EndFraction mu Subscript upper Xa = μY −ρ σY
σX μX
and b equals rho StartFraction sigma Subscript upper Y Baseline Over sigma Subscript upper X Baseline EndFractionb = ρ σY
σX . Moreover, computing the variance of Y we get: 
sans serif upper V left parenthesis a plus b right parenthesis equals rho squared StartFraction sigma Subscript upper Y Superscript 2 Baseline Over sigma Subscript upper X Superscript 2 Baseline EndFraction sans serif upper V left parenthesis upper X right parenthesis equals rho squared sigma Subscript upper Y Superscript 2 Baseline periodV(a + b) = ρ2 σ 2
Y
σ 2
X
V(X) = ρ2σ 2
Y .
2 It is the constant function h left parenthesis upper X right parenthesish(X) whose value is the unconditional expectation of X. 
7.2
Linear Prediction and Dependence
193
Since rho element of left bracket negative 1 comma 1 right bracketρ ∈[−1, 1] we have sans serif upper V left parenthesis a plus b upper X right parenthesis less than or slanted equals sans serif upper V left parenthesis upper Y right parenthesisV(a + bX) ⩽V(Y) and StartFraction sans serif upper V left parenthesis a plus b upper X right parenthesis Over sans serif upper V left parenthesis upper Y right parenthesis EndFraction equals rho squared V(a+bX)
V(Y)
= ρ2, called 
coefﬁcient of determination, which measures the variation of Y explained by a 
linear relationship with X. A perfect linear dependence is when rho equals 1ρ = 1. Here, 
y equals mu Subscript upper Y Baseline plus rho StartFraction sigma Subscript upper Y Baseline Over sigma Subscript upper X Baseline EndFraction left parenthesis x minus mu Subscript upper X Baseline right parenthesisy = μY +ρ σY
σX (x−μX) is the regression line, and rho StartFraction sigma Subscript upper Y Baseline Over sigma Subscript upper X Baseline EndFractionρ σY
σX is the regression coefﬁcient, 
for every scenario omegaω s.t. upper Y left parenthesis omega right parenthesis equals yY(ω) = y and upper X left parenthesis omega right parenthesis equals xX(ω) = x. The quantity sigma Subscript upper Y Superscript 2 Baseline left parenthesis 1 minus rho squared right parenthesisσ 2
Y (1 −ρ2), the  
minimum attained by sans serif upper E left parenthesis left brace upper Y minus f left parenthesis upper X right parenthesis right brace squared right parenthesisE({Y −f (X)}2), is called residual variance, see Exercise 7.3 
and its solution. Prediction of X based on Y, via the best linear predictor (in the 
mean-square sense) gives the regression line: 
x equals mu Subscript upper X Baseline plus rho StartFraction sigma Subscript upper X Baseline Over sigma Subscript upper Y Baseline EndFraction left parenthesis y minus mu Subscript upper Y Baseline right parenthesis periodx = μX + ρ σX
σY
(y −μY ).
This rewrites: 
y equals mu Subscript upper Y Baseline plus StartFraction 1 Over rho EndFraction StartFraction sigma Subscript upper Y Baseline Over sigma Subscript upper X Baseline EndFraction left parenthesis x minus mu Subscript upper X Baseline right parenthesis comma rho not equals 0 periody = μY + 1
ρ
σY
σX
(x −μX),
ρ /= 0.
The two regression lines coincides when the slope is the same: 
rho StartFraction sigma Subscript upper Y Baseline Over sigma Subscript upper X Baseline EndFraction equals StartFraction 1 Over rho EndFraction StartFraction sigma Subscript upper Y Baseline Over sigma Subscript upper X Baseline EndFraction iff StartAbsoluteValue rho EndAbsoluteValue equals 1 periodρ σY
σX
= 1
ρ
σY
σX
iff
|ρ| = 1.
Remark 7.2 From the perspective of conditional expectation, the best linear 
prediction is when f left parenthesis upper X right parenthesis equals sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesis equals a plus b upper Xf (X) = E(Y | X) = a + bX. This is equivalent to have 
upper Y equals a plus b upper X plus epsilonY = a + bX + ϵ, where epsilonϵ is the prediction error s.t. sans serif upper E left parenthesis epsilon vertical bar upper X right parenthesis equals 0E(ϵ | X) = 0. In fact by 
linearity: 
sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesis equals sans serif upper E left parenthesis a vertical bar upper X right parenthesis plus sans serif upper E left parenthesis b upper X vertical bar upper X right parenthesis plus sans serif upper E left parenthesis epsilon vertical bar upper X right parenthesis equals a plus b upper X periodE(Y | X) = E(a | X) + E(bX | X) + E(ϵ | X) = a + bX.
Conversely, suppose sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesis equals a plus b upper XE(Y | X) = a + bX and let epsilon equals upper Y minus left parenthesis a plus b upper X right parenthesisϵ = Y −(a + bX). Then, upper Y equals a plus b upper X plus epsilonY =
a + bX + ϵ and 
sans serif upper E left parenthesis epsilon vertical bar upper X right parenthesis equals sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesis minus sans serif upper E left parenthesis a plus b upper X vertical bar upper X right parenthesis equals sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesis minus left parenthesis a plus b upper X right parenthesis equals 0 periodE(ϵ | X) = E(Y | X) −E(a + bX | X) = E(Y | X) −(a + bX) = 0.
Note sans serif upper E left parenthesis epsilon right parenthesis equals sans serif upper E left parenthesis sans serif upper E left parenthesis epsilon vertical bar upper X right parenthesis right parenthesis equals sans serif upper E left parenthesis 0 right parenthesis equals 0E(ϵ) = E(E(ϵ | X)) = E(0) = 0. Also that sans serif upper E left parenthesis epsilon upper X right parenthesisE(ϵX) equals 
sans serif upper E left parenthesis sans serif upper E left parenthesis epsilon upper X vertical bar upper X right parenthesis right parenthesis equals sans serif upper E left parenthesis upper X sans serif upper E left parenthesis epsilon vertical bar upper X right parenthesis right parenthesis equals sans serif upper E left parenthesis 0 right parenthesis equals 0 commaE(E(ϵX | X)) = E(XE(ϵ | X)) = E(0) = 0,
i.e. the explanatory variable X and the error 
epsilonϵ are uncorrelated. Taking the 
covariance of both sides in upper Y equals a plus b upper X plus epsilonY = a+bX+ϵ with X we get a equals sans serif upper E left parenthesis upper Y right parenthesis minus StartFraction sans serif c o v left parenthesis upper X comma upper Y right parenthesis Over sans serif upper V left parenthesis upper X right parenthesis EndFraction sans serif upper E left parenthesis upper X right parenthesisa = E(Y)−cov(X,Y)
V(X)
E(X)
and b equals StartFraction sans serif c o v left parenthesis upper X comma upper Y right parenthesis Over sans serif upper V left parenthesis upper X right parenthesis EndFractionb =
cov(X,Y)
V(X)
. Observe that in all the above calculations we used properties 
(1),(2) and (8) of conditional expectation. 
Example 7.3 
.X∗= E(Xt | Fs) is the best predictor of a future price upper X Subscript tXt for any 
date t greater than s greater than or slanted equals 0t > s ⩾0. The information script upper F Subscript sFs available at a past date if fully reﬂected in the
194
7
Regression, Prediction and More Dependence
price upper X Subscript t Baseline commaXt, i.e. is embodied optimally (in the mean square sense). This is a form of 
market efﬁciency given in term of rational expectations. sans serif upper E left parenthesis upper X Subscript t Baseline vertical bar script upper F Subscript s Baseline right parenthesisE(Xt | Fs) is a prediction 
of the price upper X Subscript tXt at time t commat, given all the available information up to time s less than t periods < t. Used 
as a forecast, sans serif upper E left parenthesis upper X Subscript t Baseline vertical bar script upper F Subscript s Baseline right parenthesisE(Xt | Fs) is the best predictor in the mean square sense, i.e. 
sans serif upper E left parenthesis left brace upper X Subscript t Baseline minus upper X Superscript asterisk Baseline right brace squared right parenthesisE
⎛
{Xt −X∗}2⎞
is minimal for upper X Superscript asterisk Baseline equals sans serif upper E left parenthesis upper X Subscript t Baseline vertical bar script upper F Subscript s Baseline right parenthesis commaX∗= E(Xt | Fs), provided that upper X Subscript t Baseline element of upper L squaredXt ∈L2 for all t periodt.
7.3 
Nonlinear Dependence 
The Pearson correlation coefﬁcient is a scalar measure of linear dependence between 
two rvs, corresponding to the case upper Y equals a plus b upper XY = a + bX or upper Y equals Overscript a period s period Endscripts a plus bY a.s.
= a + b, for  a element of double struck upper Ra ∈R, b not equals 0b /= 0
and upper X comma upper Y element of upper L squaredX, Y ∈L2. 
Remark 7.3 Two uncorrelated rvs upper X comma upper Y element of upper L squaredX, Y ∈L2 are note necessarily independent. 
E.g., take upper X tilde normal upper N left parenthesis 0 comma 1 right parenthesisX ∼N(0, 1) and let upper Y equals g left parenthesis upper X right parenthesis equals upper X squaredY = g(X) = X2. Now  sans serif upper E left parenthesis upper X upper Y right parenthesis equals sans serif upper E left parenthesis upper X cubed right parenthesis equals 0E(XY) = E(X3) =
0 because the Normal X is symmetric (the odd moments are all zero), then 
sans serif c o v left parenthesis upper X comma upper Y right parenthesis equals sans serif upper E left parenthesis upper X cubed right parenthesis minus sans serif upper E left parenthesis upper X right parenthesis sans serif upper E left parenthesis upper Y right parenthesis equals 0cov(X, Y) = E(X3) −E(X)E(Y) = 0, since sans serif upper E left parenthesis upper X right parenthesis equals 0E(X) = 0, and they are uncorrelated 
although strongly dependent: the X’s values yield perfect prediction of the Y’s 
values. For rvs upper X comma upper Y element of upper L squaredX, Y ∈L2 to be uncorrelated it sufﬁces to have at least sans serif upper E left parenthesis upper X upper Y right parenthesis equals 0E(XY) = 0
and sans serif upper E left parenthesis upper X right parenthesis equals 0E(X) = 0, or sans serif upper E left parenthesis upper X upper Y right parenthesis equals 0E(XY) = 0 and sans serif upper E left parenthesis upper Y right parenthesis equals 0E(Y) = 0. 
Example 7.4 Let upper OmegaΩ be a ﬁnite sample space with StartAbsoluteValue upper Omega EndAbsoluteValue equals 7|Ω| = 7 and assume the discrete 
uniform distribution with sans serif upper P left parenthesis StartSet omega EndSet right parenthesis equals one seventh commaP({ω}) = 1
7, for omega element of upper Omegaω ∈Ω. Deﬁne two rvs upper X equals sigma summation Underscript i equals 1 Overscript 7 Endscripts left parenthesis one half plus StartFraction left parenthesis negative 1 right parenthesis Superscript i Baseline Over 2 EndFraction right parenthesis bold upper I Subscript upper A Sub Subscript iX = ∑7
i=1( 1
2 +
(−1)i
2
)IAi and upper Y equals bold upper I Subscript left brace upper X equals 0 right brace Baseline minus sigma summation Underscript i even Endscripts left parenthesis negative 1 right parenthesis Superscript i plus 1 Baseline bold upper I Subscript upper A Sub Subscript iY = I{X=0} −∑
i even(−1)i+1IAi, where upper A Subscript i Baseline equals StartSet omega EndSetAi = {ω}, each omega element of upper Omegaω ∈Ω, is a  
partition of upper OmegaΩ. We have  upper X upper Y equals 0XY = 0 and sans serif upper E left parenthesis upper Y right parenthesis equals 0E(Y) = 0 so sans serif c o v left parenthesis upper X comma upper Y right parenthesis equals 0cov(X, Y) = 0 but left brace upper X equals 1 right brace intersection left brace upper Y equals 1 right brace equals empty set{X = 1} ∩
{Y = 1} = ∅, then sans serif upper P left parenthesis upper X equals 1 comma upper Y equals 1 right parenthesis equals 0P(X = 1, Y = 1) = 0 while sans serif upper P left parenthesis upper X equals 1 right parenthesis sans serif upper P left parenthesis upper Y equals 1 right parenthesis equals three sevenths dot two sevenths not equals 0P(X = 1)P(Y = 1) = 3
7 · 2
7 /= 0. 
Thus, X and Y are not independent. Observe that bold upper I Subscript left brace upper X equals 0 right brace Baseline equals sigma summation Underscript i even Endscripts bold upper I Subscript upper A Sub Subscript i Subscript Baseline periodI{X=0} = ∑
i even IAi.
Perfect linear dependence is when StartAbsoluteValue sans serif c o r r left parenthesis upper X comma upper Y right parenthesis EndAbsoluteValue equals 1|corr(X, Y)| = 1, similar to the concepts of 
antimonotone and comonotone rvs. Indeed, taking an increasing linear function g colon double struck upper R right arrow double struck upper Rg :
R →R and considering sans serif c o r r left parenthesis g left parenthesis upper X right parenthesis comma g left parenthesis upper Y right parenthesis right parenthesiscorr(g(X), g(Y)), then correlation is unchanged. But for 
nonlinear increasing transformations this does not apply. Moreover, correlation is 
not suitable when marginal distributions are heavy-tailed which means that possibly 
variances are not ﬁnite, i.e. upper X comma upper Y not an element of upper L squaredX, Y /∈L2.
7.3
Nonlinear Dependence
195
Just to Remind 
We summarize the framework of linear dependence. 
• 
Pearson correlation is invariant only under linear increasing transform, i.e. 
a plus b upper Xa + b X and c plus d upper Yc + d Y with positive b comma db, d. In fact we showed 
sans serif c o r r left parenthesis a plus b upper X comma c plus d upper Y right parenthesis equals sign left parenthesis b d right parenthesis sans serif c o r r left parenthesis upper X comma upper Y right parenthesiscorr(a + b X, c + d Y) = sign(bd)corr(X, Y)
which equals sans serif c o r r left parenthesis upper X comma upper Y right parenthesiscorr(X, Y) iff sign left parenthesis b d right parenthesis equals 1sign(bd) = 1. 
• 
Consider the linear relationship upper Y equals Overscript a period s period Endscripts a plus b upper XY a.s.
= a + b X and take a equals 0a = 0 and b equals plus or minus 1b = ±1. 
Observe upper Y equals Overscript a period s period Endscripts sign left parenthesis b right parenthesis upper XY a.s.
= sign(b)X implies upper Y equals Overscript d Endscripts sign left parenthesis b right parenthesis upper XY
d= sign(b)X. Thus 
sans serif c o v left parenthesis upper X comma upper Y right parenthesis equals sans serif c o v left parenthesis upper X comma sign left parenthesis b right parenthesis upper X right parenthesis equals sign left parenthesis b right parenthesis sans serif upper V left parenthesis upper X right parenthesis long right double arrow sans serif c o r r left parenthesis upper X comma upper Y right parenthesis equals sign left parenthesis b right parenthesis commacov(X, Y) = cov(X, sign(b)X) = sign(b)V(X) =⇒corr(X, Y) = sign(b),
so we have upper Y equals Overscript a period s period Endscripts upper XY
a.s.
= X corresponds to maximal linear dependence with 
upper X comma upper YX, Y being comonotone, provided sign left parenthesis b right parenthesis equals 1sign(b) = 1, and upper Y equals Overscript a period s period Endscripts negative upper XY a.s.
= −X corresponds 
to minimal linear dependence with upper X comma upper YX, Y being antimonotone, provided 
sign left parenthesis b right parenthesis equals negative 1sign(b) = −1. 
It is not always possible to build a bi-variate CDF upper F Subscript bold upper XFX for the random vector bold upper X equals left parenthesis upper X comma upper Y right parenthesisX =
(X, Y) with margins upper F Subscript upper X Baseline comma upper F Subscript upper Y BaselineFX, FY and assigned correlation, unless bold upper XX is, e.g., a Gaussian 
random vector. In fact, linear and nonlinear dependence are related by Theorem 7.2 
below. 
Theorem 7.2 Assume bold upper X equals left parenthesis upper X 1 comma upper X 2 right parenthesisX = (X1, X2) has joint CDF upper F Subscript bold upper XFX and marginal CDFs 
upper F Subscript upper X 1 Baseline comma upper F Subscript upper X 2 BaselineFX1, FX2 with ﬁnite variances sans serif upper V left parenthesis upper X 1 right parenthesis comma sans serif upper V left parenthesis upper X 2 right parenthesis less than normal infinityV(X1), V(X2) < ∞. 
(a) If upper X 1 comma upper X 2X1, X2 are comonotone, then sans serif c o r r left parenthesis upper X 1 comma upper X 2 right parenthesis greater than 0corr(X1, X2) > 0. If they are antimonotone, 
then sans serif c o r r left parenthesis upper X 1 comma upper X 2 right parenthesis less than 0corr(X1, X2) < 0. 
(b) The correlation sans serif c o r r left parenthesis upper X 1 comma upper X 2 right parenthesiscorr(X1, X2) is maximal if upper X 1 comma upper X 2X1, X2 are comonotone, in particu-
lar upper X 1 equals Overscript d Endscripts upper X 2X1
d= X2 yields sans serif c o r r left parenthesis upper X 1 comma upper X 2 right parenthesis equals 1corr(X1, X2) = 1. The correlation sans serif c o r r left parenthesis upper X 1 comma upper X 2 right parenthesiscorr(X1, X2) is minimal 
if upper X 1 comma upper X 2X1, X2 are antimonotone, in particular upper X 1 equals Overscript d Endscripts minus upper X 2X1
d= −X2 yields sans serif c o r r left parenthesis upper X 1 comma upper X 2 right parenthesis equals negative 1corr(X1, X2) =
−1. 
The proof of Theorem 7.2, see Appendix, is partly based on the following well 
known formula for covariances. 
Lemma 7.1 (Hoeffding) 
If bold upper X equals left parenthesis upper X 1 comma upper X 2 right parenthesisX = (X1, X2) has joint CDF upper F Subscript bold upper XFX and marginal CDFs 
upper F Subscript upper X 1 Baseline comma upper F Subscript upper X 2 BaselineFX1, FX2, then 
sans serif c o v left parenthesis upper X 1 comma upper X 2 right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket upper F Subscript bold upper X Baseline left parenthesis x 1 comma x 2 right parenthesis minus upper F Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis upper F Subscript upper X 2 Baseline left parenthesis x 2 right parenthesis right bracket normal d x 1 normal d x 2 periodcov(X1, X2) =
⎰∞
−∞
⎰∞
−∞
⎾
FX(x1, x2) −FX1(x1)FX2(x2)
⏋
dx1dx2.
(7.6)
196
7
Regression, Prediction and More Dependence
The proof of Hoeffding’s lemma is in Appendix. More concept and results on 
nonlinear dependence, than those presented in Sect. 7.4, are needed for the proof of 
Theorem 7.2. 
Remark 7.4 Assume that upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x) is the CDF of a degenerate rv with a point mass 
at x equals ax = a, and upper F Subscript upper Y Baseline left parenthesis y right parenthesisFY (y) is another CDF corresponding to a different not necessarily 
degenerate rv. Then we have: 
min left brace upper F Subscript upper X Baseline left parenthesis x right parenthesis comma upper F Subscript upper Y Baseline left parenthesis y right parenthesis right brace equals upper F Subscript upper X Baseline left parenthesis x right parenthesis upper F Subscript upper Y Baseline left parenthesis y right parenthesis period min{FX(x), FY (y)} = FX(x)FY (y).
(7.7) 
In fact, for x less than ax < a we have upper F Subscript upper X Baseline left parenthesis x right parenthesis equals 0FX(x) = 0, for  x greater than or slanted equals ax ⩾a we have upper F Subscript upper X Baseline left parenthesis x right parenthesis equals 1FX(x) = 1 while 
for every y element of double struck upper Ry ∈R we have 0 less than or slanted equals upper F Subscript upper Y Baseline left parenthesis y right parenthesis less than or slanted equals 10 ⩽FY (y) ⩽1, and the product of CDFs equals their 
pointwise minimum. If at least one of the rvs corresponding to the marginal CDFs 
is not degenerate we also have 
upper F Subscript upper X Baseline left parenthesis x right parenthesis upper F Subscript upper Y Baseline left parenthesis y right parenthesis less than min left brace upper F Subscript upper X Baseline left parenthesis x right parenthesis comma upper F Subscript upper Y Baseline left parenthesis y right parenthesis right braceFX(x)FY (y) < min{FX(x), FY (y)}
(7.8) 
for every pair left parenthesis x comma y right parenthesis element of double struck upper R squared(x, y) ∈R2. 
7.4 
Stochastic Dependence...Again 
Assume bold upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y) is a random vector with components interpreted as risk factors. 
For example, upper X comma upper YX, Y can be thought as future stock prices, proﬁts and losses, rates of 
return, contracts held by an insurance company. Thus the joint distribution of bold upper XX
provides probabilistic information on the dependence between X and Y, especially 
if they form a portfolio whose possible changes (viz. the loss incurred by the 
portfolio) are affected by their joint movements. Based on the analysis developed 
in Sect. 3.4, the two risk factors are dependent whenever their joint probability or 
CDF does not factor and assumes value within the interval3 left bracket a comma b right bracket[a, b] where a comma ba, b are 
values attained by 
StartLayout 1st Row 1st Column upper G left parenthesis x comma y right parenthesis 2nd Column equals 3rd Column max left brace 0 comma upper F Subscript upper X Baseline left parenthesis x right parenthesis plus upper F Subscript upper Y Baseline left parenthesis y right parenthesis minus 1 right brace EndLayout StartLayout 2nd Row 1st Column upper H left parenthesis x comma y right parenthesis 2nd Column equals 3rd Column min left brace upper F Subscript upper X Baseline left parenthesis x right parenthesis comma upper F Subscript upper Y Baseline left parenthesis y right parenthesis right brace comma EndLayoutG(x, y) = max{0, FX(x) + FY (y) −1}Alt-text already available with first equation in this block
(7.9) 
H(x, y) = min{FX(x), FY (y)},
(7.10) 
respectively for left parenthesis x comma y right parenthesis element of double struck upper R squared(x, y) ∈R2, which are proved to be CDFs, see Exercise 7.10. 
upper F Subscript bold upper X Baseline left parenthesis x comma y right parenthesisFX(x, y) is bounded above by the joint CDF upper H left parenthesis x comma y right parenthesisH(x, y) describing positive depen-
dence between the marginals upper F Subscript upper X Baseline left parenthesis x right parenthesis comma upper F Subscript upper Y Baseline left parenthesis y right parenthesisFX(x), FY (y), and it is bounded below by the joint 
CDF upper G left parenthesis x comma y right parenthesisG(x, y) describing negative dependence. These are called Fréchet bounds. 
Now, we apply Theorem 5.1 to the risk factors getting the new random vectors
3 Recall to set upper A equals left brace upper X less than or slanted equals x right braceA = {X ⩽x} and upper B equals left brace upper Y less than or slanted equals y right braceB = {Y ⩽y} in Eq. (3.9). 
7.4
Stochastic Dependence...Again
197
bold upper X Superscript c Baseline equals left parenthesis upper Q Subscript upper X Baseline left parenthesis upper U right parenthesis comma upper Q Subscript upper Y Baseline left parenthesis upper U right parenthesis right parenthesis and bold upper X Subscript c Baseline equals left parenthesis upper Q Subscript upper X Baseline left parenthesis upper U right parenthesis comma upper Q Subscript upper Y Baseline left parenthesis 1 minus upper U right parenthesis right parenthesis comma upper U tilde upper U left parenthesis 0 comma 1 right parenthesis periodXc = (QX(U), QY (U)) and Xc = (QX(U), QY (1 −U)),
U ∼U(0, 1).
The former is called comonotonic the latter antimonotonic. 
Theorem 7.3 Let bold upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y) be two risk factors. Then: 
1. The upper Fréchet bound upper H left parenthesis x comma y right parenthesisH(x, y) is the joint CDF of bold upper X Superscript cXc. Equivalently, there 
exists a rv Z and two nondecreasing functions f 1 comma f 2f1, f2 s.t. bold upper XX has the same 
joint distribution as the random vector left parenthesis f 1 left parenthesis upper Z right parenthesis comma f 2 left parenthesis upper Z right parenthesis right parenthesis(f1(Z), f2(Z)). Moreover X and Y are 
comonotone, i.e. upper F Subscript bold upper X Baseline equals upper HFX = H. 
2. The lower Fréchet bound upper G left parenthesis x comma y right parenthesisG(x, y) is the joint CDF of bold upper X Subscript cXc. Equivalently, there 
exists a rv Z, a nondecreasing function f 1f1 and a nonincreasing function f 2f2
(or vice versa) s.t. bold upper XX has the same joint distribution as the random vector 
left parenthesis f 1 left parenthesis upper Z right parenthesis comma f 2 left parenthesis upper Z right parenthesis right parenthesis(f1(Z), f2(Z)). Moreover X and Y are antimonotone, i.e. upper F Subscript bold upper X Baseline equals upper GFX = G. 
It is worth noting that upper Q Subscript upper X Baseline left parenthesis upper U right parenthesis equals Overscript d Endscripts upper XQX(U)
d= X and also upper Q Subscript upper Y Baseline left parenthesis upper U right parenthesis equals Overscript d Endscripts upper Q Subscript upper Y Baseline left parenthesis 1 minus upper U right parenthesis equals Overscript d Endscripts upper YQY (U)
d= QY (1 −U)
d= Y
but equality in distribution does not mean equality among the components of bold upper XX
and the components of bold upper X Superscript c Baseline comma bold upper X Subscript c BaselineXc, Xc. Theorem 7.3, Item 1, is still valid for n greater than 2n > 2 and 
corresponding CDFs in double struck upper R Superscript nRn, but Item 2 no longer holds for n greater than 2n > 2. The general 
version of the upper Fréchet bound is 
upper H left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis equals min left brace upper F Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis comma ellipsis comma upper F Subscript upper X Sub Subscript n Subscript Baseline left parenthesis x Subscript n Baseline right parenthesis right brace comma bold upper X equals left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesis commaH(x1, . . . , xn) = min{FX1(x1), . . . , FXn(xn)},
X = (X1, . . . , Xn),
(7.11) 
while the right form of the lower Fréchet bound is 
upper G left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis equals max left brace 0 comma sigma summation Underscript i equals 1 Overscript n Endscripts upper F Subscript upper X Sub Subscript i Subscript Baseline left parenthesis x Subscript i Baseline right parenthesis plus 1 minus n right brace periodG(x1, . . . , xn) = max
⌠
0,
n
⎲
i=1
FXi(xi) + 1 −n
⎫
.
(7.12) 
Remark 7.5 For comonotonic rvs upper X comma upper YX, Y there is a single source Z determining their 
riskiness as component of bold upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y): they are perfect positively dependent being 
both increasing functions of Z. Applying the same reasoning as above, two risk 
factors in bold upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y) are perfect negatively dependent in the antimonotonic case. 
Remark 7.6 Observe that for a uniform rv normal upper U tilde normal upper U left parenthesis 0 comma 1 right parenthesisU ∼U(0, 1) we have upper F Subscript upper U Baseline left parenthesis x right parenthesis equals sans serif upper P left parenthesis upper U less than or slanted equals x right parenthesis equals xFU(x) = P(U ⩽
x) = x, which is obvious from the truly deﬁnition of its CDF: essentially, it is the 
identity function restricted to the unit interval. 
For more details on dependence concepts as applied to risk management, see 
[11, Sec 7.2] and [13, Chps 1,2]. In risk management or credit risk, the probability 
distribution of portfolio losses upper L equals upper V Subscript t Baseline minus upper V 0L = Vt −V0 is crucial. Recall that upper V Subscript t Baseline equals sigma summation Underscript i equals 1 Overscript n Endscripts h Subscript i Baseline upper S Subscript i comma tVt = ∑n
i=1 hiSi,t
is a vector-to-scalar transformation, thus the upper V Subscript tVt’s distribution hardly depends on the 
joint distribution of bold upper S equals left parenthesis upper S Subscript 1 comma t Baseline comma ellipsis comma upper S Subscript n comma t Baseline right parenthesisS = (S1,t, . . . , Sn,t), i.e., future asset prices, given the vector of 
portfolio holdings h equals left parenthesis h 1 comma ellipsis comma h Subscript n Baseline right parenthesish = (h1, . . . , hn) s.t. the initial endowment is upper V 0 equals sigma summation Underscript i equals 1 Overscript n Endscripts h Subscript i Baseline upper S Subscript i comma 0V0 = ∑n
i=1 hiSi,0, 
which is assumed to be constant. The components in bold upper SS are risk factors, since 
securities are exposed to ﬂuctuations in the market. However, if r Subscript p comma t Baseline equals sigma summation Underscript i equals 1 Overscript n Endscripts w Subscript i Baseline r Subscript i comma trp,t = ∑n
i=1 wiri,t
198
7
Regression, Prediction and More Dependence
is the portfolio return with weights4 w Subscript i Baseline equals StartFraction h Subscript i Baseline upper S Subscript i comma 0 Baseline Over upper V Subscript t Baseline EndFractionwi = hiSi,0
Vt , where r Subscript i comma t Baseline equals StartFraction upper S Subscript i comma t Baseline minus upper S Subscript i comma 0 Baseline Over upper S Subscript i comma 0 Baseline EndFractionri,t = Si,t−Si,0
Si,0
, then it is 
equivalent to say that the random vector of risk factors is bold r equals left parenthesis r Subscript i comma t Baseline comma ellipsis comma r Subscript n comma t Baseline right parenthesisr = (ri,t, . . . , rn,t), since 
upper V Subscript t Baseline equals upper V 0 left parenthesis 1 plus r Subscript p comma t Baseline right parenthesisVt = V0(1 + rp,t). Therefore, what really matters for L is the joint distribution 
upper F Subscript bold r Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesisFr(x1, . . . , xn), which contains relevant information about individual risk factors as 
well as their dependence structure. We know that only for independent marginals 
upper F Subscript r Sub Subscript i comma tFri,t one may set up the joint CDF by multiplication. Assuming returns have 
symmetric distributions given by upper F Subscript r Sub Subscript i comma tFri,t , with no fat-tails, and assuming further 
linear dependence then multivariate Gaussian modelling of bold rr comes in hand.5 But 
empirical evidence shows different patterns of returns. Fortunately enough, there is 
a way to get the joint distribution of risk factors starting from the marginals and 
this take advantage of being easier to estimate univariate CDFs from time series of 
returns than to postulate a particular form of the dependence among risk factors. 
Deﬁnition 7.3 A function upper C colon left bracket 0 comma 1 right bracket times left bracket 0 comma 1 right bracket right arrow left bracket 0 comma 1 right bracketC : [0, 1] × [0, 1] →[0, 1] is a bi-variate copula if the 
following properties hold: 
(1) 
.C(u1, u2) = 0, if u 1 equals u 2 equals 0u1 = u2 = 0; 
(2) 
.C(1, u2) = u2, and upper C left parenthesis u 1 comma 1 right parenthesis equals u 1C(u1, 1) = u1; 
(3) 
.C(b1, b2) −C(a1, b2) −C(b1, a2) + C(a1, a2) ⩾0, for any 0 less than or slanted equals a 1 less than b 1 less than or slanted equals 10 ⩽a1 < b1 ⩽1
and 0 less than or slanted equals a 2 less than b 2 less than or slanted equals 10 ⩽a2 < b2 ⩽1. 
It is worth noting that upper C left parenthesis u 1 comma u 2 right parenthesisC(u1, u2) is non-decreasing in each components. Moral: 
upper C left parenthesis u 1 comma u 2 right parenthesis equals sans serif upper P left parenthesis upper U 1 less than or slanted equals u 1 comma upper U 2 less than or slanted equals u 2 right parenthesisC(u1, u2) = P(U1 ⩽u1, U2 ⩽u2) is a CDF having uniform normal upper U Subscript i Baseline tilde normal upper U left parenthesis 0 comma 1 right parenthesisUi ∼U(0, 1)
marginals, for i equals 1 comma 2i = 1, 2, which assigns a nonnegative probability to rectangles inside 
the unit cube left bracket 0 comma 1 right bracket times left bracket 0 comma 1 right bracket[0, 1] × [0, 1], i.e., sans serif upper P left parenthesis a 1 less than or slanted equals upper U 1 less than or slanted equals b 1 comma a 2 less than or slanted equals upper U 2 less than or slanted equals b 2 right parenthesis greater than or slanted equals 0P(a1 ⩽U1 ⩽b1, a2 ⩽U2 ⩽b2) ⩾0. Copula 
functions, marginal CDFs and joint CDF are related each other, as stated in: 
Theorem 7.4 (Sklar) 
Assume the bi-variate vector bold upper X equals left parenthesis upper X 1 comma upper X 2 right parenthesisX = (X1, X2) has joint CDF 
upper F Subscript bold upper X Baseline commaFX, with marginals upper F Subscript upper X 1FX1 and upper F Subscript upper X 2FX2. Then, there exists a copula function upper C colon left bracket 0 comma 1 right bracket times left bracket 0 comma 1 right bracket right arrow left bracket 0 comma 1 right bracketC : [0, 1] ×
[0, 1] →[0, 1] s.t. for every left parenthesis x 1 comma x 2 right parenthesis element of double struck upper R squared(x1, x2) ∈R2 we have 
upper F Subscript bold upper X Baseline left parenthesis x 1 comma x 2 right parenthesis equals upper C left parenthesis upper F Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis comma upper F Subscript upper X 2 Baseline left parenthesis x 2 right parenthesis right parenthesis periodFX(x1, x2) = C(FX1(x1), FX2(x2)).
(7.13) 
If upper F Subscript bold upper XFX has continuous marginals, then the copula C is unique. Conversely, if C is a 
copula and upper F Subscript upper X 1 Baseline comma upper F Subscript upper X 2 BaselineFX1, FX2 are univariate CDFs, then the function of two variable given 
in (7.13) yields a joint CDF with marginals upper F Subscript upper X 1 Baseline comma upper F Subscript upper X 2 BaselineFX1, FX2.
4 No-leverage is implicitly assumed: sigma summation Underscript i equals 1 Overscript n Endscripts w Subscript i Baseline equals 1∑n
i=1 wi = 1
5 Recall that in the multivariate Gaussian setting, each component rv is also Gaussian. 
7.4
Stochastic Dependence...Again
199
See Appendix for the n-dimensional version of copula and Sklar’s theorem. 
Under the continuity hypotheses we have upper F Subscript upper X 1 Baseline left parenthesis upper X 1 right parenthesis equals upper U 1 tilde upper U left parenthesis 0 comma 1 right parenthesisFX1(X1) = U1 ∼U(0, 1) and upper F Subscript upper X 2 Baseline left parenthesis upper X 2 right parenthesis equals upper U 2 tilde upper U left parenthesis 0 comma 1 right parenthesis commaFX2(X2) =
U2 ∼U(0, 1), thus assuming C as the joint CDF of left parenthesis upper U 1 comma upper U 2 right parenthesis(U1, U2) we have 
StartLayout 1st Row 1st Column upper C left parenthesis u 1 comma u 2 right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis upper F Subscript upper X 1 Baseline left parenthesis upper X 1 right parenthesis less than or slanted equals u 1 comma upper F Subscript upper X 2 Baseline left parenthesis upper X 2 right parenthesis less than or slanted equals u 2 right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper X 1 less than or slanted equals upper Q Subscript upper X 1 Baseline left parenthesis u 1 right parenthesis comma upper X 2 less than or slanted equals upper Q Subscript upper X 2 Baseline left parenthesis u 2 right parenthesis right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column upper F Subscript bold upper X Baseline left parenthesis upper Q Subscript upper X 1 Baseline left parenthesis u 1 right parenthesis comma upper Q Subscript upper X 2 Baseline left parenthesis u 2 right parenthesis right parenthesis comma EndLayoutC(u1, u2) = P(FX1(X1) ⩽u1, FX2(X2) ⩽u2)
= P(X1 ⩽QX1(u1), X2 ⩽QX2(u2))
= FX(QX1(u1), QX2(u2)),
which is nothing else the only-if part of Sklar’s theorem proof. Coming back to 
risk management, portfolio value upper V Subscript tVt with two weights bold w equals left parenthesis w Subscript i Baseline comma w 2 right parenthesisw = (wi, w2) gives raise 
to random loss upper L equals upper V 0 r Subscript p comma tL = V0rp,t where random return r Subscript p comma t Baseline equals bold w dot bold rrp,t = w · r is based on the 
random vector bold r equals left parenthesis r Subscript 1 comma t Baseline comma r Subscript 2 comma t Baseline right parenthesisr = (r1,t, r2,t) of two risk factors. If marginal CDFs upper F Subscript r Sub Subscript 1 comma t Subscript Baseline comma upper F Subscript r Sub Subscript 2 comma t Subscript BaselineFr1,t , Fr2,t and 
their dependence structure given by copula upper C left parenthesis u 1 comma u 2 right parenthesisC(u1, u2) are available, then by Sklar’s 
theorem the latter is the bi-variate CDF C of left parenthesis upper F Subscript r Sub Subscript 1 comma t Subscript Baseline left parenthesis r Subscript 1 comma t Baseline right parenthesis comma upper F Subscript r Sub Subscript 2 comma t Subscript Baseline left parenthesis r Subscript 2 comma t Baseline right parenthesis right parenthesis(Fr1,t (r1,t), Fr2,t (r2,t)), and we can 
say that C is the copula of upper F Subscript bold rFr or bold rr. Perfect positive/negative dependence6 can be 
reproduced by copula functions since we always have: 
upper G left parenthesis u 1 comma u 2 right parenthesis less than or slanted equals upper C left parenthesis u 1 comma u 2 right parenthesis less than or slanted equals upper H left parenthesis u 1 comma u 2 right parenthesis comma for all left parenthesis u 1 comma u 2 right parenthesis element of left bracket 0 comma 1 right bracket times left bracket 0 comma 1 right bracket commaG(u1, u2) ⩽C(u1, u2) ⩽H(u1, u2),
for all (u1, u2) ∈[0, 1] × [0, 1],
where upper G comma upper HG, H are the bi-variate Fréchet bounds in (7.9) and (7.10), respectively. 
Hence, H is the copula of bold upper U equals left parenthesis upper U 1 comma upper U 2 right parenthesisU = (U1, U2) with upper U 1 equals upper U 2U1 = U2, while G for upper U 2 equals 1 minus upper U 1U2 =
1 −U1. They can be used when the corresponding random vector bold upper X equals left parenthesis upper X 1 comma upper X 2 right parenthesisX = (X1, X2)
has marginals upper F Subscript upper X 1 Baseline comma upper F Subscript upper X 2 BaselineFX1, FX2 for which we want to reproduce either a perfect positive 
dependence or a perfect negative dependence structure. 
Proposition 7.3 Let bold upper X equals left parenthesis upper X 1 comma upper X 2 right parenthesisX = (X1, X2) be a random vector with continuous marginals 
upper F Subscript upper X 1 Baseline comma upper F Subscript upper X 2 BaselineFX1, FX2, copula function upper C left parenthesis u 1 comma u 2 right parenthesisC(u1, u2), and let f Subscript i Baseline colon double struck upper R right arrow double struck upper Rfi : R →R be two strictly increasing 
functions, for i equals 1 comma 2i = 1, 2. Then the random vector left parenthesis f 1 left parenthesis upper X 1 right parenthesis comma f 2 left parenthesis upper X 2 right parenthesis right parenthesis(f1(X1), f2(X2)) also has copula 
functions upper C left parenthesis u 1 comma u 2 right parenthesisC(u1, u2). 
Proposition 7.3 is analogous to Proposition 2.3 in Sect. 2.8, indeed copula 
functions represent stochastic dependence on a quantile scale. 
Example 7.5 Assuming continuity of the CDFs, letting upper X 1 equals f 1 left parenthesis upper X 1 right parenthesisX1 = f1(X1) and upper X 2 equals Overscript a period s period Endscripts f 2 left parenthesis upper X 1 right parenthesisX2
a.s.
=
f2(X1) and applying Proposition 7.3 we have that copulas of bold upper X equals left parenthesis upper X 1 comma upper X 1 right parenthesisX = (X1, X1) and 
bold upper U equals left parenthesis upper U 1 comma upper U 1 right parenthesisU = (U1, U1) are the same, and since the copula of the former random vector is the 
CDF of the latter (with upper U Subscript i Baseline equals upper F Subscript upper X 1 Baseline left parenthesis upper X 1 right parenthesisUi = FX1(X1), for i equals 1 comma 2i = 1, 2), we get the copula H. 
Example 7.6 (Independence Copula) For a vector of two random returns bold r equals left parenthesis r Subscript 1 comma t Baseline comma r Subscript 2 comma t Baseline right parenthesisr =
(r1,t, r2,t) which can be assumed to be independent, their copula function is 
upper C left parenthesis u 1 comma u 2 right parenthesis equals u 1 u 2 periodC(u1, u2) = u1u2.
(7.14)
6 In risk management, comonotonicity entails undiversiﬁable risks and must be handled with care 
in capital requirements based on risk. 
200
7
Regression, Prediction and More Dependence
In fact, by assumption upper F Subscript bold r Baseline left parenthesis x 1 comma x 2 right parenthesis equals upper F Subscript r Sub Subscript 1 comma t Baseline left parenthesis x 1 right parenthesis upper F Subscript r Sub Subscript 2 comma t Baseline left parenthesis x 2 right parenthesisFr(x1, x2) = Fr1,t (x1)Fr2,t (x2), and by Sklar’s theorem the 
joint CDF of returns must be equal to upper C left parenthesis upper F Subscript r Sub Subscript 1 comma t Subscript Baseline left parenthesis x 1 right parenthesis comma upper F Subscript r Sub Subscript 2 comma t Subscript Baseline left parenthesis x 2 right parenthesis right parenthesisC(Fr1,t (x1), Fr2,t (x2)) which in turn is (7.14). 
Example 7.7 (Gaussian Copula) 
Consider two random returns bold r equals left parenthesis r Subscript 1 comma t Baseline comma r Subscript 2 comma t Baseline right parenthesisr = (r1,t, r2,t)
with bi-variate Gaussian distribution bold r tilde normal upper N left parenthesis bold italic mu comma bold upper C Subscript bold r Baseline right parenthesisr ∼N(μ, Cr), where bold italic mu equals left parenthesis mu 1 comma mu 2 right parenthesisμ = (μ1, μ2), and the 
covariance matrix is 
bold upper C Subscript bold r Baseline equals Start 2 By 2 Matrix 1st Row 1st Column sigma 1 squared 2nd Column sigma Subscript 1 comma 2 Baseline 2nd Row 1st Column sigma Subscript 1 comma 2 Baseline 2nd Column sigma 2 squared EndMatrix commaCr =
⎾σ 2
1 σ1,2
σ1,2 σ 2
2
⏋
,
with covariance 
sigma Subscript 1 comma 2 Baseline equals sans serif c o v left parenthesis r Subscript 1 comma t Baseline comma r Subscript 2 comma t Baseline right parenthesisσ1,2
=
cov(r1,t, r2,t). By Sklar’s theorem, 
bold rr’s copula is 
upper C left parenthesis upper F Subscript r Sub Subscript 1 comma t Subscript Baseline left parenthesis x 1 right parenthesis comma upper F Subscript r Sub Subscript 2 comma t Subscript Baseline left parenthesis x 2 right parenthesis right parenthesisC(Fr1,t (x1), Fr2,t (x2)) and equals upper F Subscript bold r Baseline left parenthesis x 1 comma x 2 right parenthesisFr(x1, x2). On the other hand, standardizing 
returns, upper X Subscript i Baseline equals f Subscript i Baseline left parenthesis r Subscript i comma t Baseline right parenthesis equals StartFraction r Subscript i comma t Baseline minus mu Subscript i Baseline Over sigma Subscript i Baseline EndFractionXi = fi(ri,t) =
ri,t−μi
σi
for i equals 1 comma 2i = 1, 2, we also have the random vector 
bold upper X equals left parenthesis upper X 1 comma upper X 2 right parenthesisX = (X1, X2) distributed as normal upper N left parenthesis bold 0 comma bold upper C Subscript bold upper X Baseline right parenthesisN(0, CX), where bold 0 equals left parenthesis 0 comma 0 right parenthesis0 = (0, 0) and 
bold upper C Subscript bold upper X Baseline equals Start 2 By 2 Matrix 1st Row 1st Column 1 2nd Column rho 2nd Row 1st Column rho 2nd Column 1 EndMatrix commaCX =
⎾1 ρ
ρ 1
⏋
,
with Pearson correlation coefﬁcient rho equals sans serif c o r r left parenthesis r Subscript 1 comma t Baseline comma r Subscript 2 comma t Baseline right parenthesisρ = corr(r1,t, r2,t). Hence, we have the Gaus-
sian copula upper C Superscript Ga Baseline left parenthesis upper F Subscript upper X Sub Subscript i Subscript Baseline left parenthesis x 1 right parenthesis comma upper F Subscript upper X 2 Baseline left parenthesis x 2 right parenthesis right parenthesisCGa(FXi(x1), FX2(x2)) as the CDF upper F Subscript bold upper X Baseline left parenthesis x 1 comma x 2 right parenthesisFX(x1, x2), and by Proposition 7.3 
it holds upper C equals upper C Superscript GaC = CGa since f Subscript ifi is strictly increasing for i equals 1 comma 2i = 1, 2. We can do more, by 
writing the explicit expression of the Gaussian copula as follows: 
StartLayout 1st Row 1st Column upper C Superscript Ga Baseline left parenthesis u 1 comma u 2 right parenthesis 2nd Column equals upper F Subscript bold upper X Baseline left parenthesis upper Q Subscript upper X 1 Baseline left parenthesis u 1 right parenthesis comma upper Q Subscript upper X 1 Baseline left parenthesis u 2 right parenthesis right parenthesis 2nd Row 1st Column Blank 2nd Column equals integral Subscript negative normal infinity Superscript upper Q Subscript upper X 1 Baseline left parenthesis u 1 right parenthesis Baseline integral Subscript negative normal infinity Superscript upper Q Subscript upper X 2 Baseline left parenthesis u 2 right parenthesis Baseline StartFraction 1 Over 2 pi StartRoot left parenthesis 1 minus rho squared right parenthesis EndRoot EndFraction 3rd Row 1st Column Blank 2nd Column times exp left parenthesis StartFraction minus left parenthesis y 1 squared minus 2 rho y 1 y 2 plus y 2 squared right parenthesis Over 2 left parenthesis 1 minus rho squared right parenthesis EndFraction right parenthesis normal d y 1 normal d y 2 period EndLayoutCGa(u1, u2) = FX(QX1(u1), QX1(u2))
=
⎰QX1(u1)
−∞
⎰QX2(u2)
−∞
1
2π
√
(1 −ρ2)
× exp
⎛
−(y2
1 −2ρy1y2 + y2
2)
2(1 −ρ2)
⎞
dy1dy2.
(7.15) 
Example 7.7 suggests that under the continuity assumption we can ﬁnd the 
density of C. Indeed, assuming upper F Subscript bold upper XFX is an absolutely continuous bi-variate CDF with 
strictly increasing, continuous marginals upper F Subscript upper X 1 Baseline comma upper F Subscript upper X 2 BaselineFX1, FX2, we can differentiate the copula 
function upper C left parenthesis u 1 comma u 2 right parenthesis equals upper F Subscript bold upper X Baseline left parenthesis upper Q Subscript upper X 1 Baseline left parenthesis u 1 right parenthesis comma upper Q Subscript upper X 2 Baseline left parenthesis u 2 right parenthesis right parenthesisC(u1, u2) = FX(QX1(u1), QX2(u2)) to get 
c left parenthesis u 1 comma u 2 right parenthesis equals StartFraction partial differential upper C left parenthesis u 1 comma u 2 right parenthesis Over partial differential u 1 partial differential u 2 EndFraction periodc(u1, u2) = ∂C(u1, u2)
∂u1∂u2
.
Observing that upper Q Subscript upper X Sub Subscript i Baseline identical to upper F Subscript upper X Sub Subscript i Superscript negative 1QXi ≡F −1
Xi , i.e., quantiles are now inverse functions of CDFs, we 
can relate the copula density to the bi-variate density of bold upper XX as 
StartLayout 1st Row 1st Column c left parenthesis upper F Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis comma upper F Subscript upper X 2 Baseline left parenthesis x 2 right parenthesis right parenthesis 2nd Column equals StartFraction f Subscript bold upper X Baseline left parenthesis x 1 comma x 2 right parenthesis Over f Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis f Subscript x 2 Baseline left parenthesis x 2 right parenthesis EndFraction long left right double arrow f Subscript bold upper X Baseline left parenthesis x 1 comma x 2 right parenthesis 2nd Row 1st Column Blank 2nd Column equals c left parenthesis upper F Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis comma upper F Subscript upper X 2 Baseline left parenthesis x 2 right parenthesis right parenthesis f Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis f Subscript x 2 Baseline left parenthesis x 2 right parenthesis comma EndLayoutc(FX1(x1), FX2(x2)) =
fX(x1, x2)
fX1(x1)fx2(x2) ⇐⇒fX(x1, x2)
= c(FX1(x1), FX2(x2))fX1(x1)fx2(x2),
(7.16)
7.5
Exercises
201
see [11, Ch 7].  Using  R or Matlab or Excel we can: 
• 
simulate a random vector bold upper XX according to a speciﬁed parametric bi-variate 
distribution upper F Subscript bold upper XFX, i.e. we get pseudo random numbers x 1 comma x 2x1, x2; 
• 
we let u Subscript i Baseline equals upper F Subscript upper X Sub Subscript i Baseline left parenthesis x Subscript i Baseline right parenthesisui = FXi(xi) for i equals 1 comma 2i = 1, 2 and get the vector bold u equals left parenthesis u 1 comma u 2 right parenthesisu = (u1, u2), where u Subscript iui are 
drawn from uniform marginal normal upper U tilde normal upper U left parenthesis 0 comma 1 right parenthesisU ∼U(0, 1) and thanks to Sklar’s theorem we 
have the dependence structure given by copula upper C left parenthesis u 1 comma u 2 right parenthesisC(u1, u2); 
• 
we let x Subscript i Baseline equals upper Q Subscript upper X Sub Subscript i Baseline left parenthesis u Subscript i Baseline right parenthesisxi = QXi(ui) and get the vector bold x equals left parenthesis x 1 comma x 2 right parenthesisx = (x1, x2), where now x Subscript ixi are drawn 
from the marginal CDFs upper F Subscript upper X Sub Subscript iFXi and we get the required dependence structure given 
by the bi-variate CDF upper F Subscript bold upper XFX. 
For in depth analysis of copula and dependence see [11, Ch 7] and [13, Ch 1]. See 
also Appendix. 
7.5 
Exercises 
7.1 Prove formula (7.3) in Proposition 7.1. 
7.2 Prove Theorem 7.1. 
7.3 Prove Proposition 7.2. 
7.4 Prove |corr(X, Y)| ⩽1 and corr(a + bX, c + dY) = corr(X, Y), provided 
b, d > 0. 
7.5 Prove V(a + bX) = b2V(X) by: 
(i) ﬁrst showing that the degenerate rv Y = a and the rv Z = bX are independent; 
(ii) then showing that for two independent rvs Y, Z it holds V(Y + Z) = V(Y) + 
V(Z). 
7.6 Let Y = a + bX. Compute the covariance and the Pearson correlation of the 
pair X, Y. 
7.7 Given two independent random vectors s.t. (X1, X2) = X 
d= Y = ( ˜X1, ˜X2) 
show that 2 cov(X1, X2) = E
⎾
(X1 − ˜X1)(X2 − ˜X2)
⏋
. 
7.8 Let Y a.s.
= X and show this implies Y d= X so that it can be generalized to 
Y a.s.
= g(X) implying Y d= g(X) for a suitable function g(x). 
7.9 Let Y a.s.
= X and show this implies corr(X, Y) = 1. 
7.10 Show that G(x, y) = max{0, FX(x) + FY (y) − 1} and H(x, y) = 
min{FX(x), FY (y)} are joint CDFs.
202
7
Regression, Prediction and More Dependence
Appendix 
Proof of Hoeffding’s Lemma 
Proof Let X = (X1, X2) and take another block independent random vector Y = 
( ˜X1, ˜X2) and assume they have the same distribution, X 
d= Y. Now, consider the 
formula 
StartLayout 1st Row 1st Column integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket bold upper I Subscript left brace b less than or slanted equals x right brace Baseline minus bold upper I Subscript left brace a less than or slanted equals x right brace Baseline right bracket normal d x 2nd Column equals 3rd Column integral Subscript b Superscript x Baseline normal d x minus integral Subscript a Superscript x Baseline normal d x equals a minus b period EndLayout
⎰∞
−∞
⎾
I{b⩽x} −I{a⩽x}
⏋
dx =
⎰x
b
dx −
⎰x
a
dx = a −b.
Use this formula twice for the pairs X1, ˜X1 and X2, ˜X2 then multiply and get 
StartLayout 1st Row 1st Column left parenthesis upper X 1 minus upper X overTilde Subscript 1 Baseline right parenthesis left parenthesis upper X 2 minus upper X overTilde Subscript 2 Baseline right parenthesis 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket bold upper I Subscript left brace upper X overTilde Sub Subscript 1 Subscript less than or slanted equals x 1 right brace Baseline minus bold upper I Subscript left brace upper X 1 less than or slanted equals x 1 right brace Baseline right bracket normal d x 1 2nd Row 1st Column Blank 2nd Column times 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket bold upper I Subscript left brace upper X overTilde Sub Subscript 2 Subscript less than or slanted equals x 2 right brace Baseline minus bold upper I Subscript left brace upper X 2 less than or slanted equals x 2 right brace Baseline right bracket normal d x 2 period EndLayout(X1 −˜X1)(X2 −˜X2) =
⎰∞
−∞
⎾
I{ ˜X1⩽x1} −I{X1⩽x1}
⏋
dx1
×
⎰∞
−∞
⎾
I{ ˜X2⩽x2} −I{X2⩽x2}
⏋
dx2.
The above product is actually a double integral w.r.t. the Lebesgue product measure 
in R2, thus we can rewrite it as: 
integral Subscript negative normal infinity Superscript normal infinity Baseline integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket bold upper I Subscript left brace upper X overTilde Sub Subscript 1 Subscript less than or slanted equals x 1 right brace Baseline minus bold upper I Subscript left brace upper X 1 less than or slanted equals x 1 right brace Baseline right bracket left bracket bold upper I Subscript left brace upper X overTilde Sub Subscript 2 Subscript less than or slanted equals x 2 right brace Baseline minus bold upper I Subscript left brace upper X 2 less than or slanted equals x 2 right brace Baseline right bracket normal d x 1 normal d x 2 period
⎰∞
−∞
⎰∞
−∞
⎾
I{ ˜X1⩽x1} −I{X1⩽x1}
⏋⎾
I{ ˜X2⩽x2} −I{X2⩽x2}
⏋
dx1dx2.
Recall that 2 cov(X1, X2) equals the expectation of (X1 − ˜X1)(X2 − ˜X2), so taking 
expectation of the iterated integral above we get:7 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis integral Subscript negative normal infinity Superscript normal infinity Baseline integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket bold upper I Subscript left brace upper X overTilde Sub Subscript 1 Subscript less than or slanted equals x 1 right brace Baseline minus bold upper I Subscript left brace upper X 1 less than or slanted equals x 1 right brace Baseline right bracket left bracket bold upper I Subscript left brace upper X overTilde Sub Subscript 2 Subscript less than or slanted equals x 2 right brace Baseline minus bold upper I Subscript left brace upper X 2 less than or slanted equals x 2 right brace Baseline right bracket normal d x 1 normal d x 2 right parenthesis 2nd Column equals 3rd Column Blank 2nd Row 1st Column integral Subscript negative normal infinity Superscript normal infinity Baseline integral Subscript negative normal infinity Superscript normal infinity Baseline sans serif upper E left bracket bold upper I Subscript left brace upper X overTilde Sub Subscript 1 Subscript less than or slanted equals x 1 right brace Baseline minus bold upper I Subscript left brace upper X 1 less than or slanted equals x 1 right brace Baseline right bracket left bracket bold upper I Subscript left brace upper X overTilde Sub Subscript 2 Subscript less than or slanted equals x 2 right brace Baseline minus bold upper I Subscript left brace upper X 2 less than or slanted equals x 2 right brace Baseline right bracket normal d x 1 normal d x 2 period EndLayoutE
⎛⎰∞
−∞
⎰∞
−∞
⎾
I{ ˜X1⩽x1} −I{X1⩽x1}
⏋⎾
I{ ˜X2⩽x2} −I{X2⩽x2}
⏋
dx1dx2
⎞
=
⎰∞
−∞
⎰∞
−∞
E
⎾
I{ ˜X1⩽x1} −I{X1⩽x1}
⏋⎾
I{ ˜X2⩽x2} −I{X2⩽x2}
⏋
dx1dx2.
Now performing the product between brackets inside the expectation yields: 
bold upper I Subscript left brace upper X overTilde Sub Subscript 1 Subscript less than or slanted equals x 1 right brace intersection left brace upper X overTilde Sub Subscript 2 Subscript less than or slanted equals x 2 right brace Baseline minus bold upper I Subscript left brace upper X overTilde Sub Subscript 1 Subscript less than or slanted equals x 1 right brace intersection left brace upper X 2 less than or slanted equals x 2 right brace Baseline minus bold upper I Subscript left brace upper X 1 less than or slanted equals x 1 right brace intersection left brace upper X overTilde Sub Subscript 2 Subscript less than or slanted equals x 2 right brace Baseline plus bold upper I Subscript left brace upper X 1 less than or slanted equals x 1 right brace intersection left brace upper X 2 less than or slanted equals x 2 right brace Baseline periodI{ ˜X1⩽x1}∩{ ˜X2⩽x2} −I{ ˜X1⩽x1}∩{X2⩽x2} −I{X1⩽x1}∩{ ˜X2⩽x2} + I{X1⩽x1}∩{X2⩽x2}.
7 This results in a new double integral w.r.t. to P × (m × m). By Fubini’s theorem we get three 
iterated integrals
⎰
Ω
⎰
R
⎰
R that can be interchanged. 
Appendix
203
Taking expectation we get: 
1. P( ˜X1 ⩽x1, ˜X2 ⩽x2) which is the same distribution as P(X1 ⩽x1, X2 ⩽x2), 
and these two CDFs do not factor; 
2. P( ˜X1 ⩽x1, X2 ⩽x2) factors by independence, and the same is true for the other 
cross product of indicators; 
3. P(Xi ⩽xi) = P( ˜Xi ⩽xi) for i = 1, 2, by block independence. 
As byproduct we ﬁnally have the desired formula (7.6). 
█
Proof of Theorem 7.2 
Proof To prove item (a) we apply Hoeffding’s Lemma 7.1 and Theorem 7.3. 
First, if X1, X2 are comonotone then their joint CDF is FX(x1, x2) 
= 
min{FX1(x1), FX2(x2)} and by formula (7.6) we get: 
sans serif c o v left parenthesis upper X 1 comma upper X 2 right parenthesis equals double integral left bracket min left brace upper F Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis comma upper F Subscript upper X 2 Baseline left parenthesis x 2 right parenthesis right brace minus upper F Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis upper F Subscript upper X 2 Baseline left parenthesis x 2 right parenthesis right bracket normal d x 1 normal d x 2 periodcov(X1, X2) =
⎰⎰⎾
min{FX1(x1), FX2(x2)} −FX1(x1)FX2(x2)
⏋
dx1dx2.
This is positive if at least one of the rvs is not degenerate, but this is the case since we 
assumed both V(X1), V(X2) are strictly positive. The statement for antimonotone 
rvs follows by FX(x1, x2) = max{0, FX1(x1)+FX2(x2)−1} and replacing X2 with 
−X2. To prove item (b) we note that 
StartLayout 1st Row 1st Column sans serif c o v left parenthesis upper X 1 comma upper X 2 right parenthesis 2nd Column equals 3rd Column double integral left bracket upper F Subscript bold upper X Baseline left parenthesis x 1 comma x 2 right parenthesis minus upper F Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis upper F Subscript upper X 2 Baseline left parenthesis x 2 right parenthesis right bracket normal d x 1 normal d x 2 2nd Row 1st Column Blank 2nd Column less than or slanted equals 3rd Column double integral left bracket min left brace upper F Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis comma upper F Subscript upper X 2 Baseline left parenthesis x 2 right parenthesis right brace minus upper F Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis upper F Subscript upper X 2 Baseline left parenthesis x 2 right parenthesis right bracket normal d x 1 normal d x 2 comma EndLayoutcov(X1, X2) =
⎰⎰⎾
FX(x1, x2) −FX1(x1)FX2(x2)
⏋
dx1dx2
⩽
⎰⎰⎾
min{FX1(x1), FX2(x2)} −FX1(x1)FX2(x2)
⏋
dx1dx2,
while the covariance is ⩾of
⎰⎰⎾
max{0, FX1(x1)+FX2(x2)−1}−FX1(x1)FX2(x2)
⏋
dx1dx2. 
█
In the proof of the antimonotone case we used the following fact. The function 
g left parenthesis x 1 comma x 2 right parenthesis equals max left brace 0 comma upper F Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis plus upper F Subscript upper X 2 Baseline left parenthesis x 2 right parenthesis minus 1 right brace minus upper F Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis upper F Subscript upper X 2 Baseline left parenthesis x 2 right parenthesisg(x1, x2) = max{0, FX1(x1) + FX2(x2) −1} −FX1(x1)FX2(x2)
is negative if the maximum is zero. Then, assume the latter is positive and observe 
that 
StartLayout 1st Row 1st Column upper F Subscript upper X 1 Baseline plus upper F Subscript upper X 2 minus 1 minus upper F Subscript upper X 1 Baseline upper F Subscript upper X 2 2nd Column equals 3rd Column upper F Subscript upper X 1 Baseline left parenthesis 1 minus upper F Subscript upper X 2 Baseline right parenthesis minus left parenthesis 1 minus upper F Subscript upper X 2 Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column left parenthesis 1 minus upper F Subscript upper X 2 Baseline right parenthesis left parenthesis upper F Subscript upper X 1 Baseline minus 1 right parenthesis equals minus left parenthesis 1 minus upper F Subscript upper X 2 Baseline right parenthesis left parenthesis 1 minus upper F Subscript upper X 1 Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column minus upper F overbar Subscript upper X 2 Baseline upper F overbar Subscript upper X 1 Baseline less than 0 comma EndLayoutFX1 + FX2 −1 −FX1FX2 = FX1(1 −FX2) −(1 −FX2)
= (1 −FX2)(FX1 −1) = −(1 −FX2)(1 −FX1)
= −¯FX2 ¯FX1 < 0,
where ¯FXi (xi) = 1 − FXi (xi) is the survival function.
204
7
Regression, Prediction and More Dependence
More on Copula Functions 
The n-dimensional version of Sklar’s theorem 7.4 requires only minor changes. 
Before to state it, we need to extend Deﬁnition 7.3. 
Deﬁnition 7.4 An n-dimensional copula function upper C colon left bracket 0 comma 1 right bracket Superscript n Baseline right arrow left bracket 0 comma 1 right bracketC : [0, 1]n →[0, 1] is a map 
from the unit hypercube left bracket 0 comma 1 right bracket Superscript n Baseline colon equals left bracket 0 comma 1 right bracket times midline horizontal ellipsis times left bracket 0 comma 1 right bracket[0, 1]n := [0, 1] × · · · × [0, 1] to the unit interval, fulﬁlling 
the following properties: 
1. .C(u1, . . . , un) = 0 whenever u Subscript i Baseline equals 0ui = 0, each i; 
2. C evaluated at bold 1 Subscript i1i, the vector of ones except the ith coordinate which is u Subscript iui, yields 
upper C left parenthesis bold 1 Subscript i Baseline right parenthesis equals u Subscript iC(1i) = ui for i equals 1 comma ellipsis comma ni = 1, . . . , n; 
3. for every pair of vectors bold a comma bold b element of left bracket 0 comma 1 right bracket Superscript na, b ∈[0, 1]n forming a rectangle left parenthesis bold a comma bold b right bracket(a, b] we have C as 
n-increasing, 
upper Delta Subscript a 1 comma b 1 Baseline midline horizontal ellipsis upper Delta Subscript a Sub Subscript n Subscript comma b Sub Subscript n Subscript Baseline upper C left parenthesis u 1 comma ellipsis comma u Subscript n Baseline right parenthesis greater than or slanted equals 0 commaΔa1,b1 · · · Δan,bnC(u1, . . . , un) ⩾0,
for all rectangle, see Appendix in Chap. 3. 
Hence, C is the joint CDF of a random vector left parenthesis upper U 1 comma ellipsis comma upper U Subscript n Baseline right parenthesis(U1, . . . , Un) with uniform 
marginals, i.e. normal upper U Subscript i Baseline tilde normal upper U left parenthesis 0 comma 1 right parenthesisUi ∼U(0, 1) for i equals 1 comma ellipsis comma ni = 1, . . . , n. As usual, Item 3 entails sans serif upper P left parenthesis a 1 less than or slanted equals upper U 1 less than or slanted equals b 1 comma ellipsis comma a Subscript n Baseline less than or slanted equals upper U Subscript n Baseline less than or slanted equals b Subscript n Baseline right parenthesis greater than or slanted equals 0P(a1 ⩽
U1 ⩽b1, . . . , an ⩽Un ⩽bn) ⩾0. 
Theorem 7.5 (Sklar) 
Assume the random vector bold upper X equals left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesisX = (X1, . . . , Xn) has multi-
variate CDF upper F Subscript bold upper X Baseline commaFX, with marginals upper F Subscript upper X 1 Baseline comma ellipsis comma upper F Subscript upper X 2 BaselineFX1, . . . , FX2. Then, there exists a copula function 
upper C colon left bracket 0 comma 1 right bracket Superscript n Baseline right arrow left bracket 0 comma 1 right bracketC : [0, 1]n →[0, 1] s.t. for every bold x equals left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis element of double struck upper R Superscript nx = (x1, . . . , xn) ∈Rn we have 
upper F Subscript bold upper X Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis equals upper C left parenthesis upper F Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis comma ellipsis comma upper F Subscript upper X Sub Subscript n Subscript Baseline left parenthesis x Subscript n Baseline right parenthesis right parenthesis periodFX(x1, . . . , xn) = C(FX1(x1), . . . , FXn(xn)).
(7.17) 
If upper F Subscript bold upper XFX has continuous marginals, then the copula C is unique. Conversely, if C is a 
copula and upper F Subscript upper X 1 Baseline comma ellipsis comma upper F Subscript upper X Sub Subscript n Subscript BaselineFX1, . . . , FXn are univariate CDFs, then the mapping given in (7.17) 
yields a multivariate CDF with those marginals. 
The proof of Theorem 7.5 is simpliﬁed in the ‘if part’ by assuming continuous 
marginals, while the ‘only if part’ is a simple extension to n-dimensions of the 
corresponding proof given for the bi-variate case, see the paragraph immediately 
after the statement of Theorem 7.4. 
Proof (long right double arrow=⇒) Assume bold upper XX has CDF upper F Subscript bold upper XFX with continuous marginals upper F Subscript upper X 1 Baseline comma ellipsis comma upper F Subscript upper X Sub Subscript n Subscript BaselineFX1, . . . , FXn. 
Thus, let upper U Subscript i Baseline equals upper F Subscript upper X Sub Subscript i Baseline left parenthesis upper X Subscript i Baseline right parenthesisUi = FXi(Xi), for  i equals 1 comma ellipsis comma ni = 1, . . . , n so by Theorem 5.2 and Remark 2.11, 
Sect. 2.8 we have: 
upper Q Subscript upper X Sub Subscript i Subscript Baseline left parenthesis upper U Subscript i Baseline right parenthesis equals upper Q Subscript upper X Sub Subscript i Subscript Baseline left parenthesis upper F Subscript upper X Sub Subscript i Subscript Baseline left parenthesis upper X Subscript i Baseline right parenthesis right parenthesis equals Overscript a period s period Endscripts upper X Subscript i Baseline comma for all i element of StartSet 1 comma ellipsis comma n EndSet periodQXi(Ui) = QXi(FXi(Xi)) a.s.
= Xi,
for all i ∈{1, . . . , n}.
Appendix
205
Thus, if C is the CDF of the uniform random vector bold upper U equals left parenthesis upper U 1 comma ellipsis comma upper U Subscript n Baseline right parenthesisU = (U1, . . . , Un), then by 
Deﬁnition 7.4 and Property 3, Proposition 2.2, for every bold x element of double struck upper R Superscript nx ∈Rn we compute 
StartLayout 1st Row 1st Column upper F Subscript bold upper X Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis upper X 1 less than or slanted equals x 1 comma ellipsis comma upper X Subscript n Baseline less than or slanted equals x Subscript n Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper Q Subscript upper X 1 Baseline left parenthesis upper U 1 right parenthesis comma ellipsis comma upper Q Subscript upper X Sub Subscript n Subscript Baseline left parenthesis upper U Subscript n Baseline right parenthesis right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper U 1 less than or slanted equals upper F Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis comma ellipsis comma upper U Subscript n Baseline less than or slanted equals upper F Subscript upper X Sub Subscript n Subscript Baseline left parenthesis x Subscript n Baseline right parenthesis right parenthesis 4th Row 1st Column Blank 2nd Column equals 3rd Column upper C left parenthesis upper F Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis comma ellipsis comma upper F Subscript upper X Sub Subscript n Subscript Baseline left parenthesis x Subscript n Baseline right parenthesis right parenthesis comma EndLayoutFX(x1, . . . , xn) = P(X1 ⩽x1, . . . , Xn ⩽xn)
= P(QX1(U1), . . . , QXn(Un))
= P(U1 ⩽FX1(x1), . . . , Un ⩽FXn(xn))
= C(FX1(x1), . . . , FXn(xn)),
therefore C exists. Using again Remark 2.11, for  x Subscript i Baseline equals upper Q Subscript upper X Sub Subscript i Baseline left parenthesis u Subscript i Baseline right parenthesisxi = QXi(ui), each i, we get 
upper F Subscript upper X Sub Subscript i Baseline left parenthesis x Subscript i Baseline right parenthesis equals upper Q Subscript upper X Sub Subscript i Baseline left parenthesis u Subscript i Baseline right parenthesis equals u Subscript iFXi(xi) = QXi(ui) = ui and 
upper F Subscript bold upper X Baseline left parenthesis upper Q Subscript upper X 1 Baseline left parenthesis u 1 right parenthesis comma ellipsis comma upper Q Subscript upper X Sub Subscript n Subscript Baseline left parenthesis u Subscript n Baseline right parenthesis right parenthesis equals upper C left parenthesis u 1 comma ellipsis comma u Subscript n Baseline right parenthesis periodFX(QX1(u1), . . . , QXn(un)) = C(u1, . . . , un).
We conclude that the copula C is given in terms of the multivariate CDF and its 
marginal quantiles, which entails uniqueness. 
█
Eventually, we provide the following: 
Proof of Proposition 7.3 The pair bold upper Y equals left parenthesis f 1 left parenthesis upper X 1 right parenthesis comma f 2 left parenthesis upper X 2 right parenthesis right parenthesisY = (f1(X1), f2(X2)) is a new random vector, 
and since f Subscript ifi are strictly increasing,8 each i, the coordinate f Subscript i Baseline left parenthesis upper X Subscript i Baseline right parenthesisfi(Xi) are rvs which 
implies bold upper YY is indeed a random vector. From the last paragraph in the (‘only if part’) 
proof of Theorem 7.5, we can rewrite the expression of C by observing that left brace upper X Subscript i Baseline less than or slanted equals x Subscript i Baseline right brace equals left brace f Subscript i Baseline left parenthesis upper X Subscript i Baseline right parenthesis less than or slanted equals f Subscript i Baseline left parenthesis x Subscript i Baseline right parenthesis right brace{Xi ⩽
xi} = {fi(Xi) ⩽fi(xi)}: 
StartLayout 1st Row 1st Column upper C left parenthesis u 1 comma ellipsis comma u Subscript n Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis upper X 1 less than or slanted equals upper Q Subscript upper X 1 Baseline left parenthesis u 1 right parenthesis comma ellipsis comma upper X Subscript n Baseline less than or slanted equals upper Q Subscript upper X Sub Subscript n Subscript Baseline left parenthesis u Subscript n Baseline right parenthesis right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis f 1 left parenthesis upper X 1 right parenthesis less than or slanted equals f 1 left parenthesis upper Q Subscript upper X 1 Baseline left parenthesis u 1 right parenthesis right parenthesis comma ellipsis comma f Subscript n Baseline left parenthesis upper X Subscript n Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column Blank 3rd Column less than or slanted equals f Subscript n Baseline left parenthesis upper Q Subscript upper X Sub Subscript n Subscript Baseline left parenthesis u Subscript n Baseline right parenthesis right parenthesis right parenthesis 4th Row 1st Column Blank 2nd Column StartLayout 1st Row Proposition question mark question mark question mark 2nd Row equals EndLayout 3rd Column sans serif upper P left parenthesis f 1 left parenthesis upper X 1 right parenthesis less than or slanted equals upper Q Subscript f 1 left parenthesis upper X 1 right parenthesis Baseline left parenthesis u 1 right parenthesis comma ellipsis comma f Subscript n Baseline left parenthesis upper X Subscript n Baseline right parenthesis 5th Row 1st Column Blank 2nd Column Blank 3rd Column less than or slanted equals upper Q Subscript f Sub Subscript n Subscript left parenthesis upper X Sub Subscript n Subscript right parenthesis Baseline left parenthesis u Subscript n Baseline right parenthesis right parenthesis period EndLayoutC(u1, . . . , un)
=
P(X1 ⩽QX1(u1), . . . , Xn ⩽QXn(un))
=
P(f1(X1) ⩽f1(QX1(u1)), . . . , fn(Xn)
⩽fn(QXn(un)))
Proposition 2.3
=
P
(
f1(X1) ⩽Qf1(X1)(u1), . . . , fn(Xn)
⩽Qfn(Xn)(un)
)
. 
This shows that C as given above is the unique copula of bold upper YY, and we are done.
█
8 They are Borel-measurable. 
Chapter 8 
Convergence Concepts 
8.1 
Type of Convergence 
Sequences of rvs are important in probability since they reveal interesting behavior 
essential for mathematical statistics, especially the theory of large sample.1 The 
reason is that sequences of rvs or their partial sums enable us to connect patterns 
of real world data with named distributions. Suppose that upper X 1 comma ellipsis comma upper X Subscript n BaselineX1, . . . , Xn are IID rvs 
representing possible values of a population rv X with the same distribution. If we 
want to infer information on the X’s law, then we might use realizations from each 
upper X Subscript iXi, whose collection is termed a random sample. Suppose, we try to model the 
unknown distribution of a 1 day stock return X using n greater than 2n > 2 historical daily returns 
x 1 comma ellipsis comma x Subscript n Baselinex1, . . . , xn collected within a past time horizon, say left bracket t Subscript m minus 1 Baseline comma t Subscript m Baseline right bracket[tm−1, tm] for m element of double struck upper Nm ∈N. Anytime 
we change the time horizon switching to another not overlapping time interval, say 
left bracket t Subscript m minus 3 Baseline comma t Subscript m minus 2 Baseline right bracket[tm−3, tm−2], s.t. we keep collecting n greater than 2n > 2 historical returns y 1 comma ellipsis comma y Subscript n Baseliney1, . . . , yn different 
from the previous ones, then we thought of x Subscript i Baseline comma y Subscript i Baselinexi, yi as two different realizations of 
rvs upper X Subscript iXi, for i equals 1 comma ellipsis comma ni = 1, . . . , n. In words, the ith rv upper X Subscript iXi represents all possible historical 
returns x Subscript i Baseline comma y Subscript i Baseline comma ellipsisxi, yi, . . ., not necessarily with the same value, for ﬁxed i. Moreover, we 
need to known what happen when the number n, called sample size, will increase 
and we gather more information about X via its copies upper X Subscript iXi. In situation like this, we 
are interested in study the limiting behavior of upper X 1 comma ellipsis comma upper X Subscript n BaselineX1, . . . , Xn for n right arrow normal infinityn →∞, excluding 
the trivial pointwise convergence discussed in Appendix to Chap. 4. 
Example 8.1 Let upper X 1 comma ellipsis comma upper X Subscript n BaselineX1, . . . , Xn a random sample of n IID daily observations drawn 
from the price upper S Subscript tSt of the S&P500, say t equals 1t = 1 day, acting as the population rv. We 
should believe that some model of rv with a speciﬁc parametric distribution well 
describe upper S Subscript tSt, but we decide to handle the Gaussian the normal upper N left parenthesis mu comma sigma squared right parenthesisN(μ, σ 2), under normal 
market conditions, by considering the log-normal return upper Y equals ln left parenthesis StartFraction upper S Subscript t Baseline Over upper S 0 EndFraction right parenthesisY = ln( St
S0 ), where upper S 0S0
1 Synonymous for this are asymptotic theory or stochastic limit theory. 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4_8
207
208
8
Convergence Concepts
is the initial known quote of the S&P500, i.e., upper Y tilde normal upper N left parenthesis mu comma sigma squared right parenthesisY ∼N(μ, σ 2) iff upper S Subscript t Baseline equals upper S 0 e Superscript upper YSt = S0eY
has the log-normal distribution with the same parameters. Doing this, we aim at 
recover the upper S Subscript tSt’s unknown distribution via the inverse transform exp left parenthesis ln left parenthesis StartFraction upper S Subscript t Baseline Over upper S 0 EndFraction right parenthesis right parenthesisexp(ln( St
S0 )). We  
gather actual data x 1 comma ellipsis comma x Subscript n Baselinex1, . . . , xn for a ﬁxed time horizon, and obtain the corresponding 
time series of log-returns ln left parenthesis StartFraction x 2 Over x 1 EndFraction right parenthesis comma ln left parenthesis StartFraction x 3 Over x 2 EndFraction right parenthesis comma ellipsis comma ln left parenthesis StartFraction x Subscript n Baseline Over x Subscript n minus 1 Baseline EndFraction right parenthesisln( x2
x1 ), ln( x3
x2 ), . . . , ln( xn
xn−1 ) whose population counterpart 
is the random sample upper Y 1 comma ellipsis comma upper Y Subscript n BaselineY1, . . . , Yn. To infer values of muμ and sigma squaredσ 2 we can consider the 
sample mean upper Y overbar Subscript n Baseline equals StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts upper Y Subscript i ¯Yn = 1
n
∑n
i=1 Yi and the sample variance upper V overbar Subscript n Baseline equals StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts left parenthesis upper Y Subscript i Baseline minus upper Y overbar Subscript n Baseline right parenthesis squared ¯Vn = 1
n
∑n
i=1(Yi −¯Yn)2. 
They are statistics, meaning that a function upper T left parenthesis upper Y 1 comma ellipsis comma upper Y Subscript n Baseline right parenthesisT (Y1, . . . , Yn) has been deﬁned and 
a possible value is obtained by evaluating upper T left parenthesis y 1 comma ellipsis comma y Subscript n Baseline right parenthesisT (y1, . . . , yn), called estimate, at a  
particular sample of historical log-returns. Clearly, we wish increasing n in such a 
way estimates of the sample mean and variance become more accurate and approach 
the true (unknown) values of muμ and sigma squaredσ 2. 
The question of approximating unknown statistics2 requires deﬁning some 
convergence concepts for rvs. 
Example 8.2 Consider the sample mean upper Z overbar equals StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts StartFraction upper Y Subscript i Baseline minus mu Over sigma EndFraction ¯Z
=
1
n
∑n
i=1
Yi−μ
σ
and variance 
StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts left parenthesis StartFraction upper Y Subscript i Baseline minus mu Over sigma EndFraction minus upper Z overbar right parenthesis squared 1
n
∑n
i=1( Yi−μ
σ
−¯Z)2 obtained from those in Example 8.1 by standardizing (recall 
that we treat random samples, i.e., IID rvs having the same distribution and then 
the same population’s parameters). Note that we average over IID rvs which are 
standard normal distributed. In R we have simulated two samples z1 of length n1 
and z2 of length n2, from a standard normal distribution; we have calculated their 
sample mean m1, m2 and variance v1,v2, see the program code below. Visualizing 
their respective values via the last four commands, we have that the sample mean 
decreases from negative 0.08834072−0.08834072 to negative 0.007981814−0.007981814 and approaches mu equals 0μ = 0, besides the 
sample variance also decreases from 1.1714431.171443 to 0.99277580.9927758 approaching sigma squared equals 1σ 2 = 1. 
A 8-line  code
 of  s tandar d n or mal d
ist ri but ion, s am pl
e m ea n and variance. It h as fo rmula for z1 and m1
.
Convergence of rvs can happen in different ways, in contrast to convergence of real-
valued sequences. 
Example 8.3 Given a sequence upper X 1 comma upper X 2 comma ellipsisX1, X2, . . . of IID rvs, where each upper X Subscript n Baseline tilde normal upper N left parenthesis mu comma StartFraction sigma squared Over i EndFraction right parenthesisXn ∼N(μ, σ 2
i )
for n equals 1 comma 2 comma ellipsisn = 1, 2, . . .. Statements like ‘upper X Subscript n Baseline right arrow 0Xn →0 as n right arrow normal infinityn →∞’ requires a careful
2 Other forms of the function T can be considered. 
8.1
Type of Convergence
209
examination of the limiting behavior, since for continuous rvs sans serif upper P left parenthesis upper X Subscript n Baseline equals 0 right parenthesis equals 0P(Xn = 0) = 0
and we are likely to rule out that increasing the sample size n will lead to have any 
upper X Subscript nXn more concentrated around zero, almost in the probabilistic sense. 
Let upper X 1 comma upper X 2 comma ellipsisX1, X2, . . . be a sequence of rvs and let X be another rv, whose CDFs are 
upper F Subscript upper X Sub Subscript nFXn for n equals 1 comma 2 comma ellipsisn = 1, 2, . . . and upper F Subscript upper XFX, respectively. We deﬁne the following: 
1. Convergence in distribution: limit Underscript n right arrow normal infinity Endscripts upper F Subscript upper X Sub Subscript n Baseline left parenthesis x right parenthesis equals upper F Subscript upper X Baseline left parenthesis x right parenthesis lim
n→∞FXn(x) = FX(x), at every  x at which the 
limiting CDF upper F Subscript upper XFX is continuous,3 written upper X Subscript n Baseline right arrow Overscript d Endscripts upper XXn
d−→X. 
2. Convergence in probability: limit Underscript n right arrow normal infinity Endscripts sans serif upper P left parenthesis StartAbsoluteValue upper X Subscript n Baseline minus upper X EndAbsoluteValue greater than epsilon right parenthesis equals 0 lim
n→∞P(|Xn −X| > ϵ) = 0, for every epsilon greater than 0ϵ > 0, 
written upper X Subscript n Baseline right arrow Overscript sans serif upper P Endscripts upper XXn
P
−→X. 
3. Convergence almost sure (a.s.): sans serif upper P left parenthesis limit Underscript n right arrow normal infinity Endscripts upper X Subscript n Baseline equals upper X right parenthesis equals 1P( lim
n→∞Xn = X) = 1, written upper X Subscript n Baseline right arrow Overscript a period s period Endscripts upper XXn
a.s.
−−→X. 
4. Convergence in mean square: limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis left parenthesis upper X Subscript n Baseline minus upper X right parenthesis squared right parenthesis equals 0 lim
n→∞E((Xn −X)2) = 0, written upper X Subscript n Baseline right arrow Overscript ms Endscripts upper XXn
ms
−−→X. 
Convergence a.s. is the strongest one and convergence in probability is stronger than 
convergence in distribution. In a sequence converging in distribution, each upper X Subscript nXn can 
be deﬁned over a different probability space than X. Convergence in probability 
and a.s. make sense only if all the rvs involved are deﬁned over the same probability 
space. In is worth noting that convergence in probability can be restated as:
•
. lim
n→∞P(|Xn −X| ⩽ϵ) = 1, for every epsilon greater than 0ϵ > 0;
•
.|Xn −X|
P
−→0.
•
.P(|Xn −X| > ϵ) < δ, for all n greater than or slanted equals mn ⩾m, any epsilon greater than 0ϵ > 0 and delta greater than 0δ > 0 with integer 
m colon equals m left parenthesis delta right parenthesism := m(δ) depending on deltaδ. 
Convergence in mean square can be generalized to convergence in pth 
moment limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis StartAbsoluteValue upper X Subscript n Baseline minus upper X EndAbsoluteValue Superscript p Baseline right parenthesis equals 0 lim
n→∞E(|Xn −X|p) = 0, written upper X Subscript n Baseline right arrow Overscript upper L Superscript p Baseline Endscripts upper XXn
Lp
−−→
X. A special case is 
limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis StartAbsoluteValue upper X Subscript n Baseline minus upper X EndAbsoluteValue right parenthesis equals 0 lim
n→∞E(|Xn −X|) = 0, written upper X Subscript n Baseline right arrow Overscript upper L Superscript 1 Baseline Endscripts upper XXn
L1
−−→X and called bold italic upper L Superscript bold 1L1 convergence. Observe 
that upper L Superscript pLp convergence needs left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N Baseline subset of upper L Superscript p(Xn)n∈N ⊂Lp and upper X element of upper L Superscript pX ∈Lp. Further, we note that 
StartLayout 1st Row 1st Column StartAbsoluteValue sans serif upper E left parenthesis upper X Subscript n Baseline minus upper X right parenthesis EndAbsoluteValue Superscript p Baseline less than or slanted equals sans serif upper E left parenthesis StartAbsoluteValue upper X Subscript n Baseline minus upper X EndAbsoluteValue Superscript p Baseline right parenthesis 2nd Column Blank 3rd Column by Jensen right single quotation mark s inequality 2nd Row 1st Column Blank 2nd Column Blank 3rd Column since f left parenthesis x right parenthesis equals StartAbsoluteValue x EndAbsoluteValue Superscript p Baseline is convex and 3rd Row 1st Column StartAbsoluteValue sans serif upper E left parenthesis StartAbsoluteValue upper X Subscript n Baseline EndAbsoluteValue minus sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue right parenthesis right parenthesis EndAbsoluteValue Superscript p Baseline less than or slanted equals sans serif upper E left parenthesis StartAbsoluteValue upper X Subscript n Baseline minus upper X EndAbsoluteValue Superscript p Baseline right parenthesis 2nd Column Blank 3rd Column since StartAbsoluteValue EndAbsoluteValue x Subscript n Baseline StartAbsoluteValue minus EndAbsoluteValue x StartAbsoluteValue EndAbsoluteValue less than or slanted equals StartAbsoluteValue x Subscript n Baseline minus x EndAbsoluteValue comma EndLayout|E(Xn −X)|p ⩽E(|Xn −X|p) by Jensen’s inequality
since f (x) = |x|p is convex and
|E(|Xn| −E(|X|))|p ⩽E(|Xn −X|p) since ||xn| −|x|| ⩽|xn −x|,
whence upper L Superscript pLp convergence does imply convergence of moments, limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis equals sans serif upper E left parenthesis upper X right parenthesis lim
n→∞E(Xn) = E(X), 
and absolute moments, limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis StartAbsoluteValue upper X Subscript n Baseline EndAbsoluteValue right parenthesis equals sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue right parenthesis lim
n→∞E(|Xn|) = E(|X|), which can be of some importance 
when handling upper L Superscript pLp spaces of rvs. In all types of convergence, a special case 
arises when the limiting rv is degenerate, upper X equals cX = c, with a point mass at c and
3 These are called continuity points. The set containing continuity points is dense in double struck upper RR. 
210
8
Convergence Concepts
sans serif upper P left parenthesis upper X equals c right parenthesis equals 1P(X = c) = 1. Convergence in distribution is also called weak convergence, and 
it can be rephrased as sans serif upper P Subscript upper X Sub Subscript n Baseline left parenthesis upper B right parenthesis right arrow sans serif upper P Subscript upper X Baseline left parenthesis upper B right parenthesisPXn(B) →PX(B), as n right arrow normal infinityn →∞, for every suitable (Borel) set 
whose boundary4 partial differential upper B∂B is s.t. sans serif upper P Subscript upper X Baseline left parenthesis partial differential upper B right parenthesis equals 0PX(∂B) = 0. 
Example 8.4 Proposition 5.1 in Sect. 5.5 asserts that the sequence left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Xn)n∈N with 
upper X Subscript n Baseline tilde upper B i n left parenthesis n comma StartFraction lamda Over n EndFraction right parenthesisXn ∼Bin(n, λ
n) converges in distribution to the upper P o left parenthesis lamda right parenthesisPo(λ), i.e., using that both the 
distribution of each upper X Subscript nXn and the limiting distribution of X are discrete, we have 
sans serif upper P left parenthesis upper X Subscript n Baseline equals x right parenthesis right arrow sans serif upper P left parenthesis upper X equals x right parenthesisP(Xn = x) →P(X = x) for every point x element of StartSet 0 comma 1 comma 2 comma ellipsis EndSetx ∈{0, 1, 2, . . .} where both laws have 
atoms. 
Convergence in probability means that events left brace StartAbsoluteValue upper X Subscript n Baseline minus upper X EndAbsoluteValue greater than epsilon right brace{|Xn −X| > ϵ} describing the 
‘error’ made by approximating X with elements upper X Subscript nXn in the sequence, exceeding 
a ﬁxed threshold epsilonϵ, have smaller probability as n increases. Here, the asserted 
convergence pertains to sequence of real numbers sans serif upper P left parenthesis StartAbsoluteValue upper X 1 minus upper X EndAbsoluteValue greater than epsilon right parenthesis comma sans serif upper P left parenthesis StartAbsoluteValue upper X 2 minus upper X EndAbsoluteValue greater than epsilon right parenthesis comma ellipsisP(|X1 −X| > ϵ), P(|X2 −X| >
ϵ), . . .. 
Example 8.5 Let left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Xn)n∈N be a sequence of rvs converging in distribution to the 
point mass distribution upper F Subscript upper X Baseline left parenthesis x right parenthesis equals bold upper I Subscript left brace x greater than or slanted equals c right braceFX(x) = I{x⩾c}. The event left brace StartAbsoluteValue upper X Subscript n Baseline minus c EndAbsoluteValue greater than epsilon right brace{|Xn −c| > ϵ} is equal to the 
disjoint union left brace upper X Subscript n Baseline less than c minus epsilon right brace union left brace upper X Subscript n Baseline greater than c plus epsilon right brace{Xn < c −ϵ} ∪{Xn > c + ϵ}, and left brace upper X Subscript n Baseline less than c minus epsilon right brace subset of left brace upper X Subscript n Baseline less than or slanted equals c minus epsilon right brace{Xn < c −ϵ} ⊂{Xn ⩽c −ϵ}. 
Then, we have: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis StartAbsoluteValue upper X Subscript n Baseline minus c EndAbsoluteValue greater than epsilon right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis upper X Subscript n Baseline less than c minus epsilon right parenthesis plus sans serif upper P left parenthesis upper X Subscript n Baseline greater than c plus epsilon right parenthesis 2nd Row 1st Column Blank 2nd Column less than or slanted equals 3rd Column sans serif upper P left parenthesis upper X Subscript n Baseline less than or slanted equals c minus epsilon right parenthesis plus sans serif upper P left parenthesis upper X Subscript n Baseline greater than c plus epsilon right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column upper F Subscript upper X Sub Subscript n Baseline left parenthesis c minus epsilon right parenthesis plus 1 minus upper F Subscript upper X Sub Subscript n Baseline left parenthesis c plus epsilon right parenthesis 4th Row 1st Column Blank 2nd Column StartLayout 1st Row n right arrow normal infinity 2nd Row right arrow EndLayout 3rd Column upper F Subscript upper X Baseline left parenthesis c minus epsilon right parenthesis plus 1 minus upper F Subscript upper X Baseline left parenthesis c plus epsilon right parenthesis 5th Row 1st Column Blank 2nd Column equals 3rd Column 0 plus 1 minus 1 equals 0 period EndLayoutP(|Xn −c| > ϵ)
=
P(Xn < c −ϵ) + P(Xn > c + ϵ)
⩽
P(Xn ⩽c −ϵ) + P(Xn > c + ϵ)
=
FXn(c −ϵ) + 1 −FXn(c + ϵ)
n→∞
→
FX(c −ϵ) + 1 −FX(c + ϵ)
=
0 + 1 −1 = 0.
This shows that upper X Subscript n Baseline right arrow Overscript d Endscripts cXn
d−→c, where sans serif upper P left parenthesis upper X equals c right parenthesis equals 1P(X = c) = 1, does imply upper X Subscript n Baseline right arrow Overscript sans serif upper P Endscripts upper XXn
P
−→X. 
Typically, convergence types are related each other via the ‘right’ implication. 
Theorem 8.1 Let left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Xn)n∈N be a sequence of rvs and let X be a rv. Then 
(i) . Xn
a.s.
−−→X long right double arrow=⇒upper X Subscript n Baseline right arrow Overscript sans serif upper P Endscripts upper XXn
P
−→X; 
(ii) . Xn
P
−→X long right double arrow=⇒upper X Subscript n Baseline right arrow Overscript d Endscripts upper XXn
d−→X; 
(iii) . Xn
ms
−−→X long right double arrow=⇒upper X Subscript n Baseline right arrow Overscript sans serif upper P Endscripts upper XXn
P
−→X; 
(iv) . Xn
ms
−−→X long right double arrow=⇒upper X Subscript n Baseline right arrow Overscript upper L Superscript 1 Baseline Endscripts upper XXn
L1
−−→X; 
(v) . Xn
L1
−−→X long right double arrow=⇒upper X Subscript n Baseline right arrow Overscript sans serif upper P Endscripts upper XXn
P
−→X. 
Exercise 8.5 shows that the reverse implication of item (ii) holds for a degenerate 
rv upper X equals cX = c. Convergence types can be generalized to sequences of random vectors
4 The boundary of any upper B subset of double struck upper RB ⊂R is the set difference upper B overbar minus ModifyingAbove upper B With ring above ¯B \ ˚
B between the closure and the interior of 
B. Equivalently (in double struck upper RR and more general metric spaces), it contains limit points of sequence in upper B Superscript cBc. 
8.1
Type of Convergence
211
left parenthesis bold upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Xn)n∈N. Convergence in distribution is for multivariate CDFs and the continuity 
points bold xx of the limiting multivariate CDF. For convergence in probability, the 
absolute value StartAbsoluteValue upper X Subscript n Baseline minus upper X EndAbsoluteValue|Xn −X| is replaced by the Euclidean distance d left parenthesis bold upper X Subscript n Baseline comma bold upper X right parenthesis equals double vertical bar bold upper X Subscript n Baseline comma bold upper X double vertical bard(Xn, X) = ‖Xn, X‖. 
For convergence in mean square expectation is understood as the vector of scalar 
expectations. Be careful that for bold upper X Subscript n Baseline equals left parenthesis upper X Subscript 1 n Baseline comma ellipsis comma upper X Subscript n n Baseline right parenthesisXn = (X1n, . . . , Xnn) convergence in probability, 
in mean square and in upper L Superscript 1L1 is equivalent to convergence of components left parenthesis upper X Subscript i n Baseline right parenthesis Subscript n element of double struck upper N(Xin)n∈N in 
the same sense, for i equals 1 comma ellipsis comma ni = 1, . . . , n. 
Remark 8.1 For random vectors bold upper X Subscript n Baseline equals left parenthesis upper X Subscript 1 n Baseline comma ellipsis comma upper X Subscript n n Baseline right parenthesisXn = (X1n, . . . , Xnn) convergence bold upper X Subscript n Baseline right arrow Overscript d Endscripts bold upper XXn
d−→X is 
not equivalent to convergence upper X Subscript i n Baseline right arrow Overscript d Endscripts upper X Subscript iXin
d−→Xi of components upper X Subscript i nXin,upper X Subscript iXi in bold upper X Subscript n Baseline comma bold upper XXn, X, respec-
tively. Indeed, marginal CDFs upper F Subscript upper X Sub Subscript i n Subscript Baseline comma upper F Subscript upper X Sub Subscript i Subscript BaselineFXin, FXi do not determine joint CDFs upper F Subscript bold upper X Sub Subscript n Subscript Baseline comma upper F Subscript bold upper X BaselineFXn, FX due 
to possible stochastic dependence, see Sect. 3.4. What is true is that convergence in 
distribution bold upper X Subscript n Baseline right arrow Overscript d Endscripts bold upper XXn
d−→X implies convergence of the components upper X Subscript i n Baseline right arrow Overscript d Endscripts upper X Subscript iXin
d−→Xi, but the  
converse is not necessarily true, see Appendix to Chap. 8 for a partial converse. 
There are two partial converse of Theorem 8.1: the ﬁrst to items (i) and the second 
to items (iii),(v) in the general version upper X Subscript n Baseline right arrow Overscript upper L Superscript p Baseline Endscripts upper XXn
Lp
−−→X, whose special cases are for 
p equals 1 comma 2p = 1, 2, respectively.5 
Theorem 8.2 Assume upper X Subscript n Baseline right arrow Overscript sans serif upper P Endscripts upper XXn
P
−→X and suppose StartAbsoluteValue upper X Subscript n Baseline EndAbsoluteValue less than or slanted equals upper Y|Xn| ⩽Y, for a rv upper Y element of upper L Superscript pY ∈Lp. Then: 
(a) there exists a subsequence left parenthesis upper X Subscript n Sub Subscript k Subscript Baseline right parenthesis Subscript k element of double struck upper N(Xnk)k∈N of rvs s.t. upper X Subscript n Sub Subscript k Baseline right arrow Overscript a period s period Endscripts upper XXnk
a.s.
−−→X, for k right arrow normal infinityk →∞; 
(b) .|X| ∈Lp and upper X Subscript n Baseline right arrow Overscript upper L Superscript p Baseline Endscripts upper XXn
Lp
−−→X. 
Convergences in distribution, probability and a.s. are preserved under continuous 
transformations. 
Theorem 8.3 (Continuous Mapping) 
Let g colon double struck upper R right arrow double struck upper Rg : R →R be a function which is 
continuous within a suitable upper B subset of double struck upper RB ⊂R s.t. sans serif upper P left parenthesis upper X element of upper B right parenthesis equals 1P(X ∈B) = 1. Then we have: 
1. If upper X Subscript n Baseline right arrow Overscript d Endscripts upper XXn
d−→X, long right double arrow=⇒g left parenthesis upper X Subscript n Baseline right parenthesis right arrow Overscript d Endscripts g left parenthesis upper X right parenthesisg(Xn)
d−→g(X). 
2. If upper X Subscript n Baseline right arrow Overscript sans serif upper P Endscripts upper XXn
P
−→X, long right double arrow=⇒g left parenthesis upper X Subscript n Baseline right parenthesis right arrow Overscript sans serif upper P Endscripts g left parenthesis upper X right parenthesisg(Xn)
P
−→g(X). 
3. If upper X Subscript n Baseline right arrow Overscript a period s period Endscripts upper XXn
a.s.
−−→X, long right double arrow=⇒g left parenthesis upper X Subscript n Baseline right parenthesis right arrow Overscript a period s period Endscripts g left parenthesis upper X right parenthesisg(Xn)
a.s.
−−→g(X). 
Some convergence are preserved under arithmetic operations. 
Theorem 8.4 Let upper X Subscript n Baseline comma upper XXn, X upper Y Subscript n Baseline comma upper YYn, Y be rvs and c element of double struck upper Rc ∈R. Then we have: 
(a) If upper X Subscript n Baseline right arrow Overscript sans serif upper P Endscripts upper XXn
P
−→X and upper Y Subscript n Baseline right arrow Overscript sans serif upper P Endscripts upper YYn
P
−→Y, long right double arrow=⇒upper X Subscript n Baseline plus upper Y Subscript n Baseline right arrow Overscript sans serif upper P Endscripts upper X plus upper YXn + Yn
P
−→X + Y and upper X Subscript n Baseline upper Y Subscript n Baseline right arrow Overscript sans serif upper P Endscripts upper X upper YXnYn
P
−→XY; 
(b) If upper X Subscript n Baseline right arrow Overscript d Endscripts upper XXn
d−→X and upper Y Subscript n Baseline right arrow Overscript d Endscripts cYn
d−→c, long right double arrow=⇒upper X Subscript n Baseline plus upper Y Subscript n Baseline right arrow Overscript d Endscripts upper X plus cXn + Yn
d−→X + c and upper X Subscript n Baseline upper Y Subscript n Baseline right arrow Overscript d Endscripts upper X cXnYn
d−→Xc; 
(c) If upper X Subscript n Baseline right arrow Overscript upper L Superscript p Baseline Endscripts upper XXn
Lp
−−→X and upper Y Subscript n Baseline right arrow Overscript upper L Superscript p Baseline Endscripts upper YYn
Lp
−−→Y, long right double arrow=⇒upper X Subscript n Baseline plus upper Y Subscript n Baseline right arrow Overscript upper L Superscript p Baseline Endscripts upper X plus upper YXn + Yn
Lp
−−→X + Y, for p equals 1 comma 2p = 1, 2; 
(d) If upper X Subscript n Baseline right arrow Overscript ms Endscripts upper XXn
ms
−−→X and upper Y Subscript n Baseline right arrow Overscript upper L Superscript p Baseline Endscripts upper YYn
Lp
−−→Y, long right double arrow=⇒upper X Subscript n Baseline upper Y Subscript n Baseline right arrow Overscript upper L Superscript 1 Baseline Endscripts upper X upper YXnYn
L1
−−→XY, for p equals 1 comma 2p = 1, 2.
5 For a proof see [8, Th. 17.3, 17.4]. 
212
8
Convergence Concepts
Part (b) is known6 as Slutsky’s lemma, and provided c not equals 0c /= 0 we also have StartFraction upper X Subscript n Baseline Over upper Y Subscript n Baseline EndFraction right arrow Overscript d Endscripts StartFraction upper X Over c EndFractionXn
Yn
d−→
X
c . 
Remark 8.2 Recall that upper L squared subset of upper L Superscript 1L2 ⊂L1 and upper X Subscript n Baseline upper Y Subscript nXnYn need not belong to upper L squaredL2 even if upper X Subscript n Baseline comma upper Y Subscript n BaselineXn, Yn
do, for every n element of double struck upper Nn ∈N. On the other hand, if upper X Subscript n Baseline upper Y Subscript n element of upper L squaredXnYn ∈L2, then the product does belong 
to upper L Superscript 1L1 so upper X Subscript n Baseline right arrow Overscript upper L Superscript 1 Baseline Endscripts upper XXn
L1
−−→X and upper Y Subscript n Baseline right arrow Overscript upper L Superscript 1 Baseline Endscripts upper YYn
L1
−−→Y is implied by upper L squaredL2 convergence of factors. 
Convergence in distribution can be checked using CHF phi Subscript bullet Baseline left parenthesis u right parenthesis equals sans serif upper E left parenthesis normal e Superscript normal i u bullet Baseline right parenthesisφ•(u) = E(eiu•). 
Theorem 8.5 (Levy’s Continuity Theorem) 
Let upper X Subscript n Baseline comma upper XXn, X be rvs with CHFs 
phi Subscript upper X Sub Subscript n Subscript Baseline left parenthesis u right parenthesis comma phi Subscript upper X Baseline left parenthesis u right parenthesisφXn(u), φX(u). Then upper X Subscript n Baseline right arrow Overscript d Endscripts upper XXn
d−→X iff limit Underscript n right arrow normal infinity Endscripts phi Subscript upper X Sub Subscript n Baseline left parenthesis u right parenthesis equals phi Subscript upper X Baseline left parenthesis u right parenthesis lim
n→∞φXn(u) = φX(u) for all u element of double struck upper Ru ∈R. If  
limit Underscript n right arrow normal infinity Endscripts phi Subscript upper X Sub Subscript n Baseline left parenthesis u right parenthesis equals f left parenthesis u right parenthesis lim
n→∞φXn(u) = f (u) for every u element of double struck upper Ru ∈R, where f left parenthesis u right parenthesisf (u) is continuous at zero, then 
f left parenthesis u right parenthesisf (u) is the CHF phi Subscript upper X Baseline left parenthesis u right parenthesisφX(u) of a rv X for which upper X Subscript n Baseline right arrow Overscript d Endscripts upper XXn
d−→X. 
In the second part of Levy’s continuity theorem, it sufﬁces to have a sequence 
of CHFs converging pointwise to a function that it is the CHF of some rv, to which 
the sequence of rvs underlying the CHFs will converge in distribution. Note that all 
functions u right arrow from bar phi Subscript bullet Baseline left parenthesis u right parenthesisu ⍿→φ•(u) are continuous and bounded. Theorem 8.5 is the reason why 
the ﬁfth item of Theorem 4.2 in Sect. 4.4 asserts that the distribution of rvs depends 
upon their CHFs. More generally, convergence in distribution can be equivalently 
stated as 
limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis g left parenthesis upper X Subscript n Baseline right parenthesis right parenthesis equals sans serif upper E left parenthesis g left parenthesis upper X right parenthesis right parenthesis comma lim
n→∞E(g(Xn)) = E(g(X)),
for every bounded continuous function g colon double struck upper R right arrow double struck upper Rg : R →R, and as 
limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis g left parenthesis bold upper X Subscript n Baseline right parenthesis right parenthesis equals sans serif upper E left parenthesis g left parenthesis bold upper X right parenthesis right parenthesis comma lim
n→∞E(g(Xn)) = E(g(X)),
for every bounded continuous function g colon double struck upper R Superscript n Baseline right arrow double struck upper Rg : Rn →R, see Appendix to Chap. 8. 
8.2 
The Law of Large Numbers and the Central Limit 
Theorem 
The celebrated law of large number (LLN) is based on theorems stating conditions 
under which sample moments converge to their population counterparts. Here a 
version with weaker hypotheses.
6 The version for random vector requires bold c element of double struck upper R Superscript nc ∈Rn. 
8.2
The Law of Large Numbers and the Central Limit Theorem
213
Theorem 8.6 (Weak Law of Large Numbers (WLLN)) 
Let upper Y 1 comma upper Y 2 comma ellipsisY1, Y2, . . . be a 
sequence of IID rvs, each upper X Subscript i Baseline element of upper L squaredXi ∈L2, with sans serif upper E left parenthesis upper Y 1 right parenthesis equals muE(Y1) = μ and sans serif upper V left parenthesis upper Y 1 right parenthesis equals sigma squaredV(Y1) = σ 2. Then 
limit Underscript n right arrow normal infinity Endscripts sans serif upper P left parenthesis StartAbsoluteValue StartFraction 1 Over n EndFraction left parenthesis upper Y 1 plus midline horizontal ellipsis plus upper Y Subscript n Baseline right parenthesis minus mu EndAbsoluteValue greater than or slanted equals epsilon right parenthesis equals 0 comma lim
n→∞P
⎛|||1
n(Y1 + · · · + Yn) −μ
||| ⩾ϵ
⎞
= 0,
for every epsilon greater than 0ϵ > 0. 
Thus, WLLN asserts that upper Y overbar Subscript n Baseline equals StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts upper Y Subscript i Baseline right arrow Overscript sans serif upper P Endscripts mu ¯Yn =
1
n
∑n
i=1 Yi
P
−→μ, i.e., the sample mean 
converges in probability to the population expectation muμ. 
Proof For the sample mean we have sans serif upper E left parenthesis upper Y overbar Subscript n Baseline right parenthesis equals n muE( ¯Yn) = nμ and, by independence, sans serif upper V left parenthesis upper Y overbar Subscript n Baseline right parenthesis equals StartFraction sigma squared Over n EndFractionV( ¯Yn) =
σ 2
n . Then, by Chebyshev’s inequality we have 
sans serif upper P left parenthesis StartAbsoluteValue upper Y overbar Subscript n Baseline minus mu EndAbsoluteValue greater than epsilon right parenthesis less than or slanted equals StartFraction sigma squared Over epsilon squared n EndFraction commaP
⎛|| ¯Yn −μ
|| > ϵ
⎞
⩽σ 2
ϵ2 n,
and letting n right arrow normal infinityn →∞the proof is complete. 
█
Remark 8.3 Observe that sans serif upper E left parenthesis left parenthesis upper Y overbar Subscript n Baseline minus mu right parenthesis squared right parenthesis equals sans serif upper E left parenthesis left parenthesis upper Y overbar Subscript n Baseline right parenthesis squared right parenthesis minus 2 mu sans serif upper E left parenthesis upper Y overbar Subscript n Baseline right parenthesis plus mu squaredE(( ¯Yn −μ)2) = E(( ¯Yn)2) −2μE( ¯Yn) + μ2, and since 
mu equals sans serif upper E left parenthesis upper Y overbar Subscript n Baseline right parenthesisμ = E( ¯Yn) we recover the variance sans serif upper V left parenthesis upper Y overbar Subscript n Baseline right parenthesisV( ¯Yn) of the sample mean. 
Another version is: 
Theorem 8.7 (Strong Law of Large Numbers (SLLN)) 
Let upper Y 1 comma upper Y 2 comma ellipsisY1, Y2, . . . be a 
sequence of IID rvs, each upper X Subscript i Baseline element of upper L Superscript 1Xi ∈L1, with sans serif upper E left parenthesis upper Y 1 right parenthesis equals muE(Y1) = μ. Then upper Y overbar Subscript n Baseline right arrow Overscript a period s period Endscripts mu ¯Yn
a.s.
−−→μ. 
Theorem 8.7 does not require ﬁnite second moments and the involved conver-
gence is a.s. For a proof see [10, Th 7.7], and for yet other versions see [2]. 
Example 8.6 Let upper K Subscript n Baseline equals sigma summation Underscript i equals 1 Overscript n Endscripts upper Z Subscript i Superscript 2Kn = ∑n
i=1 Z2
i for IID upper Z Subscript i Superscript 2 Baseline tilde normal upper N left parenthesis 0 comma 1 right parenthesisZ2
i
∼N(0, 1), thus by the SLLN 
upper K Subscript n Baseline divided by n right arrow Overscript a period s period Endscripts sans serif upper E left parenthesis upper Z 1 squared right parenthesis equals 1Kn/n
a.s.
−−→E(Z2
1) = 1. Thus, let upper Z tilde normal upper N left parenthesis 0 comma 1 right parenthesisZ ∼N(0, 1) be independent of all upper Z Subscript iZi and 
let upper T Subscript n Baseline equals StartFraction upper Z Over StartRoot upper Z Subscript n Baseline divided by n EndRoot EndFractionTn =
Z
√Zn/n, for every n element of double struck upper Nn ∈N. By construction, upper T Subscript n Baseline tilde upper T left parenthesis n right parenthesisTn ∼T (n) and since the 
denominator goes to 1 for n large enough upper T Subscript n Baseline right arrow Overscript d Endscripts upper ZTn
d−→Z. 
The LLN suggests how the sample mean approximates the population counter-
part for n large enough, but probability statements about upper Y overbar Subscript n¯Yn need another important 
result. 
Theorem 8.8 (Central Limit Theorem (CLT)) 
Let upper Y 1 comma upper Y 2 comma ellipsisY1, Y2, . . . be a sequence of 
IID rvs, each upper X Subscript i Baseline element of upper L squaredXi ∈L2, with sans serif upper E left parenthesis upper Y 1 right parenthesis equals muE(Y1) = μ and sans serif upper V left parenthesis upper Y 1 right parenthesis equals sigma squaredV(Y1) = σ 2. Then 
limit Underscript n right arrow normal infinity Endscripts sans serif upper P left parenthesis StartFraction upper Y 1 plus midline horizontal ellipsis plus upper Y Subscript n Baseline minus n mu Over StartRoot n EndRoot sigma EndFraction less than or slanted equals x right parenthesis equals normal upper N left parenthesis 0 comma 1 right parenthesis period lim
n→∞P
⎛Y1 + · · · + Yn −nμ
√nσ
⩽x
⎞
= N(0, 1).
(8.1)
214
8
Convergence Concepts
It is worth noting that sigma summation Underscript i equals 1 Overscript n Endscripts upper Y Subscript i Baseline equals n upper Y overbar Subscript n∑n
i=1 Yi = n ¯Yn, then: 
StartLayout 1st Row 1st Column StartFraction sigma summation Underscript i equals 1 Overscript n Endscripts upper Y Subscript i Baseline minus sans serif upper E left parenthesis sigma summation Underscript i equals 1 Overscript n Endscripts upper Y Subscript i Baseline right parenthesis Over StartRoot sans serif upper V left parenthesis sigma summation Underscript i equals 1 Overscript n Endscripts upper Y Subscript i Baseline right parenthesis EndRoot EndFraction 2nd Column equals 3rd Column StartFraction n upper Y overbar Subscript n Baseline minus n mu Over StartRoot n squared sans serif upper V left parenthesis upper Y overbar Subscript n Baseline right parenthesis EndRoot EndFraction equals StartFraction n upper Y overbar Subscript n Baseline minus n mu Over StartRoot n EndRoot sigma EndFraction 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction StartRoot n EndRoot left parenthesis upper Y overbar Subscript n Baseline minus mu right parenthesis Over sigma EndFraction period EndLayout
∑n
i=1 Yi −E(∑n
i=1 Yi)
/
V(∑n
i=1 Yi)
= n ¯Yn −nμ
√
n2V( ¯Yn)
= n ¯Yn −nμ
√nσ
=
√n( ¯Yn −μ)
σ
.
Hence, the CLT asserts that the standardized sample mean converges in distribution 
to a standard normal,7 namely StartFraction StartRoot n EndRoot left parenthesis upper Y overbar Subscript n Baseline minus mu right parenthesis Over sigma EndFraction right arrow Overscript d Endscripts normal upper N left parenthesis 0 comma 1 right parenthesis
√n( ¯Yn−μ)
σ
d−→N(0, 1). By the property of the 
Gaussian distribution, we deduce the following approximation which are equivalent 
to statement of Theorem 8.8 (viz. the necessary part) for n large enough: StartRoot n EndRoot left parenthesis upper Y overbar Subscript n Baseline minus mu right parenthesis almost equals normal upper N left parenthesis 0 comma sigma squared right parenthesis√n( ¯Yn −
μ) ≈N(0, σ 2), or upper Y overbar Subscript n Baseline minus mu almost equals normal upper N left parenthesis 0 comma StartFraction sigma squared Over n EndFraction right parenthesis ¯Yn −μ ≈N(0, σ 2
n ), or also upper Y overbar Subscript n Baseline almost equals normal upper N left parenthesis mu comma StartFraction sigma squared Over n EndFraction right parenthesis ¯Yn ≈N(μ, σ 2
n ). For stronger version 
of the CLT see [8, 10, Sec 7.3] or [2]. We can prove Theorem 8.8 using the CHF as a 
device, see Appendix in Chap. 8. Whenever the CLT holds, we might be interested 
in proving convergence in distribution for some transforms. The following result 
helps us in such a situation. 
Theorem 8.9 (Delta Method) With the same notation as in Theorem 8.8, assume 
that StartFraction StartRoot n EndRoot left parenthesis upper Y overbar Subscript n Baseline minus mu right parenthesis Over sigma EndFraction right arrow Overscript d Endscripts normal upper N left parenthesis 0 comma 1 right parenthesis period
√n( ¯Yn −μ)
σ
d−→N(0, 1). Let f colon double struck upper R right arrow double struck upper Rf : R →R be a differentiable function s.t. 
StartFraction normal d Over normal d x EndFraction f left parenthesis x right parenthesis vertical bar Subscript x equals mu Baseline equals colon f prime left parenthesis mu right parenthesis not equals 0 d
dx f (x)
||
x=μ =: f '(μ) /= 0. Then: 
StartFraction StartRoot n EndRoot left parenthesis f left parenthesis upper Y overbar Subscript n Baseline right parenthesis minus f left parenthesis mu right parenthesis right parenthesis Over StartAbsoluteValue f prime left parenthesis mu right parenthesis EndAbsoluteValue sigma EndFraction right arrow Overscript d Endscripts normal upper N left parenthesis 0 comma 1 right parenthesis period
√n(f ( ¯Yn) −f (μ))
|f '(μ)|σ
d−→N(0, 1).
For the multivariate extension see [15, Ch 3].  
Example 8.7 Let upper R 1 comma ellipsis comma upper R Subscript n BaselineR1, . . . , Rn be IID daily log-returns over n trading days, with 
upper R Subscript t Baseline element of upper L squaredRt ∈L2, for t equals 1 comma ellipsis comma nt = 1, . . . , n, and sans serif upper E left parenthesis upper R Subscript t Baseline right parenthesis equals muE(Rt) = μ, sans serif upper V left parenthesis upper R Subscript t Baseline right parenthesis equals sigma squaredV(Rt) = σ 2. We have StartFraction StartRoot n EndRoot left parenthesis upper S overbar Subscript n Baseline minus mu right parenthesis Over sigma EndFraction right arrow Overscript d Endscripts normal upper N left parenthesis 0 comma 1 right parenthesis
√n( ¯Sn−μ)
σ
d−→
N(0, 1), where upper S overbar Subscript n Baseline equals StartFraction 1 Over n EndFraction sigma summation Underscript t equals 1 Overscript n Endscripts upper S Subscript t ¯Sn = 1
n
∑n
t=1 St is the sample mean return. If we pass to f left parenthesis upper S overbar Subscript n Baseline right parenthesis equals e Superscript upper S overbar Super Subscript nf ( ¯Sn) =
e ¯Sn, i.e. to the accumulation factor over the horizon left bracket 0 comma n right bracket[0, n], with average log-return 
per day, then upper S overbar Subscript n Baseline almost equals normal upper N left parenthesis mu comma StartFraction sigma squared Over n EndFraction right parenthesis ¯Sn ≈N(μ, σ 2
n ) and as a consequence f left parenthesis upper S overbar Subscript n Baseline right parenthesis almost equals normal upper N left parenthesis f left parenthesis mu right parenthesis comma left parenthesis f prime left parenthesis mu right parenthesis right parenthesis squared StartFraction sigma squared Over n EndFraction right parenthesisf ( ¯Sn) ≈N(f (μ), (f '(μ))2 σ 2
n ). 
The latter give almost equals normal upper N left parenthesis e Superscript mu Baseline comma e Superscript 2 mu Baseline StartFraction sigma squared Over n EndFraction right parenthesis≈N(eμ, e2μ σ 2
n ). 
There is a multivariate version of the CLT, for a proof see [2]. 
Theorem 8.10 (Multivariate CLT) 
Let bold upper Y 1 comma bold upper Y 2 comma ellipsisY1, Y2, . . . be a sequence of IID random 
vectors, with sans serif upper E left parenthesis bold upper Y Subscript i Baseline right parenthesis equals left parenthesis sans serif upper E left parenthesis upper Y Subscript i Baseline 1 Baseline right parenthesis comma ellipsis comma sans serif upper E left parenthesis upper Y Subscript i n Baseline right parenthesis right parenthesis equals bold italic mu equals left parenthesis mu 1 comma ellipsis comma mu Subscript n Baseline right parenthesisE(Yi) = (E(Yi1), . . . , E(Yin)) = μ = (μ1, . . . , μn), each i, and n times nn×n
covariance matrix bold italic upper Sigma equals left bracket c Subscript i comma j Baseline right bracket∑= [ci,j], where c Subscript i i Baseline equals sans serif upper V left parenthesis upper Y Subscript i k Baseline right parenthesis equals sigma Subscript i Superscript 2cii = V(Yik) = σ 2
i and c Subscript i j Baseline equals sans serif c o v left parenthesis upper Y Subscript i k Baseline comma upper Y Subscript j k Baseline right parenthesis equals sigma Subscript i jcij = cov(Yik, Yjk) =
7 Be warned that probability statements about the sample mean can be approximated by the 
standard normal CDF. This by no means implies that the rv upper Y overbar Subscript n¯Yn can be approximated by upper Z tilde normal upper N left parenthesis 0 comma 1 right parenthesisZ ∼
N(0, 1). 
8.3
Application 1: Point and CDF Estimation
215
σij, for every k equals 1 comma ellipsis comma nk = 1, . . . , n and each pair i comma ji, j. Let bold upper Y overbar Subscript m Baseline equals left parenthesis upper Y overbar Subscript 1 Baseline comma ellipsis comma upper Y overbar Subscript m Baseline right parenthesis ¯Ym = ( ¯Y1, . . . , ¯Ym), where each 
component is upper Y overbar Subscript j Baseline equals StartFraction 1 Over m EndFraction sigma summation Underscript j equals 1 Overscript m Endscripts upper Y Subscript j i ¯Yj = 1
m
∑m
j=1 Yji. Then: 
limit Underscript m right arrow normal infinity Endscripts sans serif upper P left parenthesis StartRoot m EndRoot left parenthesis bold upper Y overbar Subscript m Baseline minus bold italic mu right parenthesis less than or slanted equals x right parenthesis equals normal upper N left parenthesis bold 0 comma bold italic upper Sigma right parenthesis period lim
m→∞P
⎛√m( ¯Ym −μ) ⩽x
⎞
= N(0, ∑).
(8.2) 
8.3 
Application 1: Point and CDF Estimation 
Suppose we drawn a random sample upper R 1 comma ellipsis comma upper R Subscript n BaselineR1, . . . , Rn of daily log-returns from a 
population’s law sans serif upper P Subscript upper XPX, i.e., upper R Subscript iRi are IID and each is a copy of X (viz. same distribution). 
If we further assume upper X tilde normal upper N left parenthesis mu comma sigma squared right parenthesisX ∼N(μ, σ 2), then the sample mean upper R overbar Subscript n Baseline equals StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts upper R Subscript i ¯Rn = 1
n
∑n
i=1 Ri and the 
sample variance upper V overbar Subscript n Baseline equals StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts left parenthesis upper R Subscript i Baseline minus upper R overbar Subscript n Baseline right parenthesis squared ¯Vn = 1
n
∑n
i=1(Ri −¯Rn)2 could be considered as approximation of 
muμ and sigma squaredσ 2, respectively. How good is this approximation? It is worth noting that the 
question remains unchanged if we drop the hypotheses of a parametric population 
law. In any case, we know that a statistics upper T left parenthesis upper R 1 comma ellipsis comma upper R Subscript n Baseline right parenthesisT (R1, . . . , Rn) as a function of the random 
sample can be used to infer the true values of mu comma sigma squaredμ, σ 2, by specifying its functional 
form. The sample mean and variance are two such speciﬁcation of upper T left parenthesis dot right parenthesisT ( · ). We can 
collect n historical daily log-returns c 1 comma ellipsis comma c Subscript n Baselinec1, . . . , cn and evaluate upper T left parenthesis dot right parenthesisT ( · ) at the n-tuple 
left parenthesis c 1 comma ellipsis comma c Subscript n Baseline right parenthesis(c1, . . . , cn) getting an estimated value of upper R overbar Subscript n Baseline comma upper V overbar Subscript n Baseline ¯Rn, ¯Vn or whatever the statistics is. We 
call upper T Subscript n Baseline colon equals upper T left parenthesis upper R 1 comma ellipsis comma upper R Subscript n Baseline right parenthesisTn := T (R1, . . . , Rn) a point estimator of some parameter, say thetaθ concerning 
a ﬁxed parametric distribution, and this is the assumption we made together with 
upper T Subscript n Baseline element of upper L squaredTn ∈L2. Observe that any random sample has its own parametric probability law 
sans serif upper P Subscript bold upper RPR, where bold upper R equals left parenthesis upper R 1 comma ellipsis comma upper R Subscript n Baseline right parenthesisR = (R1, . . . , Rn). Turning to the CDF we write upper F Subscript bold upper R Baseline left parenthesis bold x comma theta right parenthesisFR(x, θ) to emphasize 
the parametric dependence. Since the daily log-returns are IID, we have that the 
CDF is equivalently given by upper F Subscript upper R 1 Baseline left parenthesis x 1 comma theta right parenthesis midline horizontal ellipsis upper F Subscript upper R Sub Subscript n Subscript Baseline left parenthesis x Subscript n Baseline comma theta right parenthesisFR1(x1, θ) · · · FRn(xn, θ). 
Example 8.8 The function upper T left parenthesis upper R 1 comma ellipsis comma upper R Subscript n Baseline right parenthesis equals product Underscript i equals 1 Overscript n Endscripts f left parenthesis upper R Subscript i Baseline comma theta right parenthesisT (R1, . . . , Rn) = ∏n
i=1 f (Ri, θ) expresses the prob-
ability of observing upper R Subscript iRi when the true value of the parameter if just thetaθ, for  
IID upper R Subscript iRi each with continuous density function f left parenthesis x Subscript i Baseline comma theta right parenthesisf (xi, θ). It is an estimator called 
likelihood function. The maximum likelihood estimator is the value thetaθ maximizing 
product Underscript i equals 1 Overscript n Endscripts f left parenthesis upper R Subscript i Baseline comma theta right parenthesis∏n
i=1 f (Ri, θ), written 
theta Subscript n Baseline equals arg max Underscript theta element of double struck upper R Endscripts product Underscript i equals 1 Overscript n Endscripts f left parenthesis upper R Subscript i Baseline comma theta right parenthesisθn = arg max
θ∈R
n
∏
i=1
f (Ri, θ)
which is again an estimator as a function of upper R 1 comma ellipsis comma upper R Subscript n BaselineR1, . . . , Rn. Usually, under mild 
assumptions, it is consistent, theta Subscript n Baseline right arrow Overscript sans serif upper P Endscripts thetaθn
P
−→θ. There is a related version, ln theta Subscript nln θn, called 
log-likelihood function which is maximized at the same value8 of thetaθ. This is used
8 If a function attains a global maximum at a point, then any monotone transformation attains a 
maximum at the same point. 
216
8
Convergence Concepts
because, depending on the particular form of the densities involved, calculations 
with ln theta Subscript nln θn can be easier. 
We say that an estimator is unbiased if sans serif upper E left parenthesis upper T Subscript n Baseline right parenthesis equals thetaE(Tn) = θ, and we can let9 sans serif b i a s left parenthesis upper T Subscript n Baseline right parenthesis colon equals sans serif upper E left parenthesis upper T Subscript n Baseline right parenthesis minus thetabias(Tn) :=
E(Tn) −θ be the bias of the estimator. A point estimator upper T Subscript nTn is consistent at 
thetaθ if upper T Subscript n Baseline right arrow Overscript sans serif upper P Endscripts thetaTn
P
−→θ. Also the estimator has its own probability law called sampling 
distribution. The standard deviation StartRoot sans serif upper V left parenthesis upper T Subscript n Baseline right parenthesis EndRoot√V(Tn) is often used as measure of the error 
made in approximating thetaθ with upper T Subscript nTn, called standard error. 
Example 8.9 Assume upper X Subscript i Baseline tilde upper B e r left parenthesis p right parenthesisXi ∼Ber(p) are IID, for i equals 1 comma 2 comma ellipsisi = 1, 2, . . .. For an n-dimensional 
random sample we set upper T Subscript n Baseline colon equals upper T left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesis equals upper X overbar Subscript nTn := T (X1, . . . , Xn) = ¯Xn, the sample mean. Then we have 
sans serif upper E left parenthesis upper X overbar Subscript n Baseline right parenthesis equals StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts sans serif upper E left parenthesis upper X Subscript i Baseline right parenthesis equals p equals thetaE( ¯Xn) = 1
n
∑n
i=1 E(Xi) = p = θ, then upper T Subscript nTn is an unbiased estimator of the success 
probability, i.e. bias left parenthesis upper T Subscript n Baseline right parenthesis equals 0bias(Tn) = 0. The standard error is StartRoot sans serif upper V left parenthesis upper T Subscript n Baseline right parenthesis EndRoot equals StartRoot StartFraction p left parenthesis 1 minus p right parenthesis Over n EndFraction EndRoot√V(Tn) =
/
p(1−p)
n
. Switching 
to IID upper X Subscript i Baseline tilde normal upper N left parenthesis mu comma sigma squared right parenthesisXi ∼N(μ, σ 2) we instead have sans serif upper E left parenthesis upper X overbar Subscript n Baseline right parenthesis equals mu equals theta 1E( ¯Xn) = μ = θ1, and the sample mean of a 
Gaussian sample is unbiased, besides the sample variance upper V overbar Subscript n Baseline equals StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts left parenthesis upper X Subscript i Baseline minus mu right parenthesis squared¯Vn = 1
n
∑n
i=1(Xi −μ)2
has expectation sans serif upper E left parenthesis upper V overbar Subscript n Baseline right parenthesis equals n Superscript negative 1 Baseline sigma summation Underscript i equals 1 Overscript n Endscripts sans serif upper E left parenthesis left parenthesis upper X Subscript i Baseline minus mu right parenthesis right parenthesis squared equals sigma squared equals theta 2E( ¯Vn) = n−1 ∑n
i=1 E((Xi −μ))2 = σ 2 = θ2 and then it is unbiased 
too. The variance of the sample mean is sans serif upper V left parenthesis upper X overbar Subscript n Baseline right parenthesis equals StartFraction sigma squared Over n EndFractionV( ¯Xn) = σ 2
n . Observe that in this case we 
have a bi-variate parameter bold italic theta equals left parenthesis theta 1 comma theta 2 right parenthesisθ = (θ1, θ2). 
Deﬁning sans serif upper M upper S upper E colon equals sans serif upper E left parenthesis left parenthesis upper T Subscript n Baseline minus theta right parenthesis squared right parenthesisMSE := E((Tn −θ)2) as the mean squared error, we have a further 
measure of the quality of an estimator. 
Lemma 8.1 
.MSE = (bias(Tn))2 −V(Tn). Moreover, if bias left parenthesis upper T Subscript n Baseline right parenthesis right arrow 0bias(Tn) →0 and 
StartRoot sans serif upper V left parenthesis upper T Subscript n Baseline right parenthesis EndRoot right arrow 0√V(Tn) →0, as n right arrow normal infinityn →∞, then upper T Subscript n Baseline right arrow Overscript sans serif upper P Endscripts thetaTn
P
−→θ. 
Hence, the less a point estimator upper T Subscript nTn is biased and the less the standard error 
is, the more upper T Subscript nTn is a good approximation of the unknown parameter thetaθ, i.e., it is a 
consistent estimator. If we drop the assumption of a parametric population law, then 
the inference is said nonparametric. Thus, without assuming the population daily 
log-return X follows some parametric distribution, we can use row estimates of its 
unknown expectation and variance given by c overbar equals StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts c Subscript i¯c = 1
n
∑n
i=1 ci and v overbar equals StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts left parenthesis c Subscript i Baseline minus c overbar right parenthesis squared¯v = 1
n
∑n
i=1(ci −
¯c)2. The interesting thing now is that we can consider the whole unknown CDF as a 
‘parameter’. We deﬁne 
double struck upper F Subscript n Baseline left parenthesis omega comma x right parenthesis equals StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts bold upper I Subscript left brace upper R Sub Subscript i Subscript less than or slanted equals x right brace Baseline left parenthesis omega right parenthesis commaFn(ω, x) = 1
n
n
⎲
i=1
I{Ri⩽x}(ω),
(8.3) 
to be the empirical distribution function, where we emphasize its dependence on 
both scenarios omegaω and rvs upper R Subscript iRi. By varying the sample size n, the empirical distribution 
function will depend on n too, indeed it can be considered an indexed family of 
rvs known as empirical process.10 Since upper R Subscript iRi are IID, the indicators bold upper I Subscript left brace upper R Sub Subscript i Subscript less than or slanted equals x right braceI{Ri⩽x} are
9 Expectation is taken with respect to the law sans serif upper P Subscript upper XPX, or equivalently the CDF upper F Subscript upper XFX. Clearly, in the 
discrete and continuous case we turn to the corresponding mass function or density. 
10 It ﬁts the deﬁnition of a stochastic process, see Sect. 9.1. 
8.3
Application 1: Point and CDF Estimation
217
IID upper B e r left parenthesis upper F Subscript upper X Baseline left parenthesis x right parenthesis right parenthesisBer(FX(x)), for every x element of double struck upper Rx ∈R. This is obvious by deﬁnition: if left brace upper R Subscript i Baseline less than or slanted equals x right brace{Ri ⩽x}
occurs, with probability sans serif upper P left parenthesis upper R Subscript i Baseline less than or slanted equals x right parenthesis equals upper F Subscript upper X Baseline left parenthesis x right parenthesisP(Ri ⩽x) = FX(x), then the indicator takes value 1, 
otherwise is zero. Thus, double struck upper F Subscript n Baseline left parenthesis omega comma x right parenthesisFn(ω, x) can be used to estimate the true CDF upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x) when 
it is unknown. If we collect a sample of historical daily log-returns c 1 comma ellipsis comma c Subscript n Baselinec1, . . . , cn, the  
empirical distribution function as a nonparametric estimator can be evaluated at the 
sample as double struck upper F overbar Subscript n Baseline equals StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts bold upper I Subscript left brace c Sub Subscript i Subscript less than or slanted equals x right brace¯Fn = 1
n
∑n
i=1 I{ci⩽x} corresponding to a particular scenario omegaω. This is  
nothing else a sample mean, thus collecting more and more data the sample size n 
grows and by the WLLN we have double struck upper F Subscript n Baseline left parenthesis omega comma x right parenthesis right arrow Overscript sans serif upper P Endscripts upper F Subscript upper X Baseline left parenthesis x right parenthesisFn(ω, x)
P
−→FX(x). Clearly we have: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis double struck upper F Subscript n Baseline left parenthesis omega comma x right parenthesis right parenthesis 2nd Column equals 3rd Column upper F Subscript upper X Baseline left parenthesis x right parenthesis comma 2nd Row 1st Column sans serif upper V left parenthesis double struck upper F Subscript n Baseline left parenthesis omega comma x right parenthesis right parenthesis 2nd Column equals 3rd Column sans serif upper V left parenthesis StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts bold upper I Subscript left brace upper R Sub Subscript i Subscript less than or slanted equals x right brace Baseline left parenthesis omega right parenthesis right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction 1 Over n squared EndFraction n sans serif upper V left parenthesis bold upper I Subscript left brace upper R Sub Subscript i Subscript less than or slanted equals x right brace Baseline left parenthesis omega right parenthesis right parenthesis equals StartFraction upper F Subscript upper X Baseline left parenthesis x right parenthesis left parenthesis 1 minus upper F Subscript upper X Baseline left parenthesis x right parenthesis right parenthesis Over n EndFraction period EndLayoutE(Fn(ω, x)) = FX(x),
V(Fn(ω, x)) = V
⎛
1
n
n
⎲
i=1
I{Ri⩽x}(ω)
⎞
= 1
n2 nV(I{Ri⩽x}(ω)) = FX(x)(1 −FX(x))
n
.
Hence, the empirical distribution function is unbiased, sans serif upper E left parenthesis double struck upper F Subscript n Baseline left parenthesis omega comma x right parenthesis minus upper F Subscript upper X Baseline left parenthesis x right parenthesis right parenthesis equals 0E(Fn(ω, x) −FX(x)) = 0, 
and by Lemma 8.1 its sans serif upper M upper S upper EMSE equals sans serif upper V left parenthesis double struck upper F Subscript n Baseline left parenthesis omega comma x right parenthesis right parenthesisV(Fn(ω, x)). 
Theorem 8.11 (Glivenko-Cantelli) 
Let upper R 1 comma upper R 2 comma ellipsisR1, R2, . . . be IID with common CDF upper F Subscript upper XFX. 
Then sup Underscript x Endscripts StartAbsoluteValue double struck upper F Subscript n Baseline minus upper F Subscript upper X Baseline EndAbsoluteValue right arrow Overscript a period s period Endscripts 0 commasup
x
|Fn −FX|
a.s.
−−→0, as n right arrow normal infinityn →∞. 
The Glivenko-Cantelli theorem says that for larger and larger samples the empir-
ical distribution function converges to the true unknown CDF, and the convergence 
is uniform (does not depend on x). By Theorem 8.1, part (i), the convergence is 
also in probability. There is a relation between convergence in distribution and 
related quantiles of the distributions involved. It can be shown that upper R Subscript n Baseline right arrow Overscript d Endscripts upper XRn
d−→X
is equivalent to have limit Underscript n right arrow normal infinity Endscripts upper Q Subscript upper R Sub Subscript n Baseline left parenthesis c right parenthesis equals upper Q Subscript upper X Baseline left parenthesis c right parenthesis lim
n→∞QRn(c) = QX(c) at every point c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1) at which 
upper Q Subscript upper X Baseline left parenthesis c right parenthesisQX(c) is continuous, see [15, Lemma 21.2]. There is an alternative deﬁnition to 
that of a statistics: a statistical functional upper T left parenthesis upper F Subscript upper X Baseline right parenthesisT (FX) is a function acting on the set 
of CDFs.11 Its role is analogous to upper T left parenthesis upper R 1 comma ellipsis comma upper R Subscript n Baseline right parenthesisT (R1, . . . , Rn), but now we refer directly to 
the unknown CDF. Two examples are the expectation mu equals upper T left parenthesis upper F Subscript upper X Baseline right parenthesis equals integral x normal d upper F Subscript upper X Baseline left parenthesis x right parenthesisμ = T (FX) =
⎨
xdFX(x)
and variance integral left parenthesis x minus mu right parenthesis squared normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis
⎨
(x −μ)2dFX(x). Thus, we can recover some unknown parameter 
as theta equals upper T left parenthesis upper F Subscript upper X Baseline right parenthesisθ = T (FX). The plug-in estimator of thetaθ is obtained by literally ‘plugging in’ 
the empirical distribution function, upper T left parenthesis double struck upper F Subscript n Baseline right parenthesisT (Fn). We drop the argument in double struck upper F Subscript n Baseline left parenthesis omega comma x right parenthesisFn(ω, x). It  
is possible to build a statistical functional by specifying the functional form of T . 
When we choose the integral against normal d upper F Subscript upper X Baseline left parenthesis x right parenthesisdFX(x) we say that upper T left parenthesis upper F Subscript upper X Baseline right parenthesis equals integral g left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesisT (FX) =
⎨
g(x)dFX(x) is 
a linear functional.12 Interpreting double struck upper F Subscript nFn as the CDF that puts equal probability masses 
StartFraction 1 Over n EndFraction1
n at each data point upper R Subscript iRi we can consider the plug-in estimator of a linear statistical
11 This set must include the empirical distribution functions and every point mass distribution. 
12 The term stems from functional analysis, studying vector spaces such as the set of all CDFs. In 
fact, upper T left parenthesis alpha upper F Subscript upper X Baseline plus beta upper F Subscript upper Y Baseline right parenthesis equals alpha upper T left parenthesis upper F Subscript upper X Baseline right parenthesis plus beta upper T left parenthesis upper F Subscript upper Y Baseline right parenthesisT (αFX + βFY ) = αT (FX) + βT (FY ), whenever upper T left parenthesis dot right parenthesisT ( · ) is speciﬁed by an integral.  
218
8
Convergence Concepts
functional upper T left parenthesis upper F Subscript upper X Baseline right parenthesisT (FX) as 
upper T left parenthesis double struck upper F Subscript n Baseline right parenthesis equals integral g left parenthesis x right parenthesis normal d double struck upper F Subscript n Baseline equals StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts g left parenthesis upper R Subscript i Baseline right parenthesis periodT (Fn) =
⎨
g(x)dFn = 1
n
n
⎲
i=1
g(Ri).
Further examples of statistical functional can be found in chapters 5, 12, 20 and 22 
of [15]. For any sample of log-returns, and in particular for IID rvs, we deﬁne 
StartLayout 1st Row 1st Column upper R Subscript left parenthesis 1 right parenthesis 2nd Column equals 3rd Column min left brace upper R 1 comma ellipsis comma upper R Subscript n Baseline right brace comma 2nd Row 1st Column upper R Subscript left parenthesis 2 right parenthesis 2nd Column equals 3rd Column second smallest of upper R 1 comma ellipsis comma upper R Subscript n Baseline comma 3rd Row 1st Column Blank 2nd Column vertical ellipsis 3rd Column Blank 4th Row 1st Column upper R Subscript left parenthesis n minus 1 right parenthesis 2nd Column equals 3rd Column second largest of upper R 1 comma ellipsis comma upper R Subscript n Baseline comma 5th Row 1st Column upper R Subscript left parenthesis n right parenthesis 2nd Column equals 3rd Column max left brace upper R 1 comma ellipsis comma upper R Subscript n Baseline right brace period EndLayoutR(1) = min{R1, . . . , Rn},
R(2) = second smallest of R1, . . . , Rn,
...
R(n−1) = second largest of R1, . . . , Rn,
R(n) = max{R1, . . . , Rn}.
We call upper R Subscript left parenthesis i right parenthesisR(i) the ith order statistics, since it is a function of the sample. Note that by 
construction upper R Subscript left parenthesis 1 right parenthesis Baseline less than or slanted equals midline horizontal ellipsis comma less than or slanted equals upper R Subscript left parenthesis n right parenthesis BaselineR(1) ⩽· · · , ⩽R(n). Using this we can deﬁne the empirical quantile 
function double struck upper F Subscript n Superscript negative 1 Baseline left parenthesis c right parenthesis equals upper R Subscript left parenthesis i right parenthesisF−1
n (c) = R(i) for c element of left parenthesis StartFraction i minus 1 Over n EndFraction comma StartFraction i Over n EndFraction right bracketc ∈( i−1
n , i
n]. In the IID case, it is easy to see that 
StartLayout 1st Row 1st Column upper F Subscript upper R Sub Subscript left parenthesis n right parenthesis Baseline left parenthesis x right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis max left brace upper R 1 comma ellipsis comma upper R Subscript n Baseline right brace less than or slanted equals x right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper R 1 less than or slanted equals x comma ellipsis comma upper R Subscript n Baseline less than or slanted equals x right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper R 1 less than or slanted equals x right parenthesis midline horizontal ellipsis sans serif upper P left parenthesis upper R Subscript n Baseline less than or slanted equals x right parenthesis equals upper F Subscript upper X Baseline left parenthesis x right parenthesis comma EndLayoutFR(n)(x) = P(max{R1, . . . , Rn} ⩽x)
= P(R1 ⩽x, . . . , Rn ⩽x)
= P(R1 ⩽x) · · · P(Rn ⩽x) = FX(x),
where again upper F Subscript upper XFX is the unknown CDF s.t. upper R 1 comma ellipsis comma upper R Subscript n Baseline tilde upper F Subscript upper X BaselineR1, . . . , Rn ∼FX. The ﬁrst equality holds 
because the event left brace max left brace upper R 1 comma ellipsis comma upper R Subscript n Baseline right brace less than or slanted equals x right brace{max{R1, . . . , Rn} ⩽x} equals intersection Subscript i equals 1 Superscript n Baseline left brace upper R Subscript i Baseline less than or slanted equals x right brace∩n
i=1{Ri ⩽x} and the others are 
due to independence. Similarly we get: 
StartLayout 1st Row 1st Column upper F Subscript upper R Sub Subscript left parenthesis 1 right parenthesis Baseline left parenthesis x right parenthesis 2nd Column equals 3rd Column 1 minus sans serif upper P left parenthesis min left brace upper R 1 comma ellipsis comma upper R Subscript n Baseline right brace greater than x right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column 1 minus sans serif upper P left parenthesis upper R 1 greater than x comma ellipsis comma upper R Subscript n Baseline greater than x right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column 1 minus left parenthesis 1 minus upper F Subscript upper X Baseline left parenthesis x right parenthesis right parenthesis Superscript n Baseline period EndLayoutFR(1)(x) = 1 −P(min{R1, . . . , Rn} > x)
= 1 −P(R1 > x, . . . , Rn > x)
= 1 −(1 −FX(x))n.
Then it can be shown that 
sans serif upper P left parenthesis upper R Subscript left parenthesis i right parenthesis Baseline less than or slanted equals x right parenthesis equals sigma summation Underscript j equals i Overscript n Endscripts StartBinomialOrMatrix n Choose j EndBinomialOrMatrix upper F Subscript upper X Baseline left parenthesis x right parenthesis Superscript j Baseline left parenthesis 1 minus upper F Subscript upper X Baseline left parenthesis x right parenthesis right parenthesis Superscript n minus j Baseline periodP(R(i) ⩽x) =
n
⎲
j=i
⎛n
j
⎞
FX(x)j(1 −FX(x))n−j.
A similar approach can be used for approximating an unknown density function. 
Let upper X 1 comma upper X 2 comma ellipsisX1, X2, . . . IID distributed according to upper F Subscript upper XFX, which admits the density f Subscript upper XfX. Fix  
an interval left bracket a comma b right bracket[a, b] with ﬁnite endpoints and split it into subintervals upper I 1 comma ellipsis comma upper I Subscript m BaselineI1, . . . , Im, then
8.3
Application 1: Point and CDF Estimation
219
sigma summation Underscript i equals 1 Overscript n Endscripts bold upper I Subscript left brace upper X Sub Subscript i Subscript element of upper I Sub Subscript j Subscript right brace∑n
i=1 I{Xi∈Ij } counts how many observations lie in upper I Subscript jIj among the ﬁrst n elements 
upper X 1 comma ellipsis comma upper X Subscript n BaselineX1, . . . , Xn of the sample, for j equals 1 comma ellipsis comma mj = 1, . . . , m, and the rv 
upper Y Subscript n Superscript j Baseline colon equals StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts bold upper I Subscript left brace upper X Sub Subscript i Subscript element of upper I Sub Subscript j Subscript right brace Baseline commaY j
n := 1
n
n
⎲
i=1
I{Xi∈Ij },
expresses this in percentage. Assuming all subintervals have equal length, an 
histogram is a plot of m bar charts each having height proportional to the upper Y Subscript n Superscript jY j
n
insisting on upper I Subscript jIj. By the SLLN, as n right arrow normal infinityn →∞we have 
upper Y Subscript n Superscript j Baseline right arrow Overscript a period s period Endscripts sans serif upper E left parenthesis bold upper I Subscript left brace upper X Sub Subscript i Subscript element of upper I Sub Subscript j Subscript right brace Baseline right parenthesis equals sans serif upper P left parenthesis upper X Subscript i Baseline element of upper I Subscript j Baseline right parenthesis equals integral Underscript upper I Subscript j Baseline Endscripts f Subscript upper X Baseline left parenthesis x right parenthesis normal d x commaY j
n
a.s.
−−→E(I{Xi∈Ij }) = P(Xi ∈Ij) =
⎨
Ij
fX(x)dx,
which explains why we use histograms to approximate unknown density: for n large 
enough, each subinterval upper I Subscript jIj shrinks and the corresponding bar approximating the 
value of f Subscript upper X Baseline left parenthesis x right parenthesisfX(x) at x element of upper I Subscript jx ∈Ij. Another similar application refers to the quantile plot. 
Given IID upper X 1 comma ellipsis comma upper X Subscript n Baseline tilde upper F Subscript upper X BaselineX1, . . . , Xn ∼FX and for upper B Subscript x Baseline equals left parenthesis negative normal infinity comma x right bracketBx = (−∞, x], with sans serif upper E left parenthesis bold upper I Subscript upper B Sub Subscript x Subscript Baseline left parenthesis upper X 1 right parenthesis right parenthesis equals upper F Subscript upper X Baseline left parenthesis x right parenthesisE(IBx(X1)) = FX(x), 
we can see that 
StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts bold upper I Subscript upper B Sub Subscript x Subscript Baseline left parenthesis upper X Subscript i Baseline right parenthesis right arrow Overscript a period s period Endscripts sans serif upper E left parenthesis bold upper I Subscript upper B Sub Subscript x Subscript Baseline left parenthesis upper X 1 right parenthesis right parenthesis comma1
n
n
⎲
i=1
IBx(Xi)
a.s.
−−→E(IBx(X1)),
by the SLLN. Considering the ordered statistics upper X Subscript left parenthesis 1 right parenthesis Baseline less than or slanted equals midline horizontal ellipsis less than or slanted equals upper X Subscript left parenthesis n right parenthesisX(1) ⩽· · · ⩽X(n) and the 
empirical distribution function double struck upper F Subscript nFn it is clear that 
double struck upper F Subscript n Baseline left parenthesis omega comma x right parenthesis equals StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts bold upper I Subscript upper B Sub Subscript x Subscript Baseline left parenthesis upper X Subscript i Baseline right parenthesis commaFn(ω, x) = 1
n
n
⎲
i=1
IBx(Xi),
and double struck upper F Subscript n Baseline left parenthesis omega comma x right parenthesis equals 0Fn(ω, x) = 0 if x less than upper X Subscript left parenthesis 1 right parenthesisx < X(1), it is double struck upper F Subscript n Baseline left parenthesis omega comma x right parenthesis equals 1Fn(ω, x) = 1 if upper X Subscript left parenthesis n right parenthesis Baseline less than or slanted equals xX(n) ⩽x and it is in between 
double struck upper F Subscript n Baseline left parenthesis omega comma x right parenthesis equals StartFraction i Over n EndFraction comma if x element of left bracket upper X Subscript left parenthesis i right parenthesis Baseline comma upper X Subscript left parenthesis i plus 1 right parenthesis Baseline right parenthesis comma i equals 1 comma ellipsis comma n minus 1 periodFn(ω, x) = i
n,
if x ∈[X(i), X(i+1)), i = 1, . . . , n −1.
Thus, if we collect data upper X Subscript comma Baseline ellipsis comma upper X Subscript n BaselineX, . . . , Xn and ask ourselves if they are generated by, say, 
upper Z tilde normal upper N left parenthesis 0 comma 1 right parenthesisZ ∼N(0, 1), since double struck upper F Subscript n Baseline equals StartFraction i Over n EndFractionFn = i
n at upper X Subscript left parenthesis i right parenthesisX(i) then the true StartFraction i Over n EndFractioni
n and the theoretical counterpart 
upper F Subscript upper Z Baseline left parenthesis upper X Subscript left parenthesis i right parenthesis Baseline right parenthesisFZ(X(i)) are near each other. Thus, starting from the quantile transform we have 
upper Q Subscript upper Z Baseline left parenthesis StartFraction i Over n EndFraction right parenthesisQZ( i
n) and upper X Subscript left parenthesis i right parenthesisX(i) tied together, and drawing a straight line with a (unit) slope of StartFraction pi Over 4 EndFractionπ
4
the pairs left parenthesis upper Q Subscript upper Z Baseline left parenthesis StartFraction i Over n EndFraction right parenthesis comma upper X Subscript left parenthesis i right parenthesis Baseline right parenthesis(QZ( i
n), X(i)) lie ‘along’ the line. The resulting graphic is known as the 
q-q plot. Roughly speaking, given n historical returns r 1 comma ellipsis comma r Subscript n Baseliner1, . . . , rn we can standardize 
them, x Subscript i Baseline equals StartFraction r Subscript i Baseline minus r overbar Over s overbar EndFractionxi = ri−¯r
¯s
for i equals 1 comma ellipsis comma n commai = 1, . . . , n, where r overbar equals n Superscript negative 1 Baseline sigma summation Underscript i equals 1 Overscript n Endscripts r Subscript i¯r = n−1 ∑n
i=1 ri is the sample mean 
and s overbar equals StartRoot n Superscript negative 1 Baseline sigma summation Underscript i equals 1 Overscript n Endscripts left parenthesis r Subscript i Baseline minus r overbar right parenthesis squared EndRoot¯s =
/
n−1 ∑n
i=1(ri −¯r)2 is the sample standard deviation, then we arrange 
in increasing order x Subscript left parenthesis 1 right parenthesis Baseline less than x Subscript left parenthesis 2 right parenthesis Baseline less than midline horizontal ellipsis x Subscript left parenthesis n right parenthesis Baselinex(1) < x(2) < · · · x(n) and get the sample counterpart of the 
ordered statistics upper X Subscript left parenthesis 1 right parenthesis Baseline comma ellipsis comma upper X Subscript left parenthesis n right parenthesis BaselineX(1), . . . , X(n). Thus, we divide the x-axis into n bins expecting
220
8
Convergence Concepts
one value x Subscript left parenthesis i right parenthesisx(i) in the ith bin provided that it is closest to the quantile upper Q Subscript upper Z Baseline left parenthesis StartFraction i Over n EndFraction right parenthesisQZ( i
n) of 
a standard normal. As byproduct, the smallest standardized return x Subscript left parenthesis 1 right parenthesisx(1) should be 
closed to upper Q Subscript upper Z Baseline left parenthesis StartFraction 1 Over n EndFraction right parenthesis commaQZ( 1
n), the second smallest x Subscript left parenthesis 2 right parenthesisx(2) should be closed to upper Q Subscript upper Z Baseline left parenthesis StartFraction 2 Over n EndFraction right parenthesis commaQZ( 2
n), and so on. 
For large sample size n comman, if the q-q plot13 displays points lying approximately on a 
straight line of unit slope, then we can assume that historical returns are drawn from 
upper Z tilde normal upper N left parenthesis 0 comma 1 right parenthesisZ ∼N(0, 1). The  matlab command qqplot(x) can be used to produce a q-q 
plot of input data contained in the vector x. 
8.4 
Application 2: Monte Carlo Simulation 
Let upper S 1 comma ellipsis comma upper S Subscript n BaselineS1, . . . , Sn be daily stock prices and set theta equals h left parenthesis upper S 1 comma ellipsis comma upper S Subscript n Baseline right parenthesis equals n Superscript negative 1 Baseline sigma summation Underscript t equals 1 Overscript n Endscripts upper S Subscript tθ = h(S1, . . . , Sn) = n−1 ∑n
t=1 St, 
nothing else the sample mean of the rvs, s.t. h left parenthesis upper S 1 comma ellipsis comma upper S Subscript n Baseline right parenthesis element of upper L Superscript 1h(S1, . . . , Sn) ∈L1. We can estimate thetaθ
by the following algorithm: 
A 8-line c ode for 
a conditional calculation of the European call price. If S T above or = k, a formula for C subscript 0. i
This kind of algorithm is at the heart of the so called Monte Carlo methods. It is  
worth noting that given the random vector bold upper S Subscript iSi of n simulated daily stock prices we 
have h left parenthesis i right parenthesis equals h left parenthesis bold upper S Subscript i Baseline right parenthesish(i) = h(Si) by the fourth step in the above code, then the latter step provides 
us with 
theta Subscript n Baseline colon equals StartFraction h left parenthesis 1 right parenthesis plus midline horizontal ellipsis plus h left parenthesis m right parenthesis Over m EndFraction commaθn := h(1) + · · · + h(m)
m
,
actually an average of averages. We can use theta Subscript nθn as an estimator of thetaθ, and indeed it is 
unbiased 
sans serif upper E left parenthesis theta Subscript n Baseline right parenthesis equals StartFraction sans serif upper E left parenthesis sigma summation Underscript i equals 1 Overscript m Endscripts h left parenthesis bold upper S Subscript i Baseline right parenthesis right parenthesis Over m EndFraction equals StartFraction m theta Over m EndFraction equals theta commaE(θn) = E
(∑m
i=1 h(Si)
)
m
= mθ
m = θ,
and by SLLN it is also consistent, theta Subscript n Baseline right arrow Overscript a period s period Endscripts thetaθn
a.s.
−−→θ as n right arrow normal infinityn →∞. If we specialize to the 
case of a random sample of stock prices, i.e., the IID hypotheses is considered, then 
Monte Carlo simulation can be used to estimate the unknown population mean using
13 We plot ordered historical returns on the y-axis against the population standard normal quantiles 
on the x-axis. 
8.4
Application 2: Monte Carlo Simulation
221
the sample average, 
mu equals sans serif upper E left parenthesis upper X right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline x normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis almost equals StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts c Subscript i Baseline commaμ = E(X) =
⎨∞
−∞
x dFX(x) ≈1
n
n
⎲
i=1
ci,
where c 1 comma ellipsis comma c Subscript n Baselinec1, . . . , cn is a realization of the sample and we have assumed14 that 
upper S 1 comma ellipsis comma upper S Subscript n Baseline tilde upper F Subscript upper X BaselineS1, . . . , Sn ∼FX. We can invoke Theorem 5.1, Sect. 5.6 for upper X equals upper Q Subscript upper X Baseline left parenthesis upper U right parenthesisX = QX(U) with 
normal upper U tilde normal upper U left parenthesis 0 comma 1 right parenthesisU ∼U(0, 1), so that the sample mean can be approximated by n Superscript negative 1 Baseline sigma summation Underscript t equals 1 Overscript n Endscripts upper Q Subscript upper X Baseline left parenthesis u Subscript i Baseline right parenthesisn−1 ∑n
t=1 QX(ui), 
where upper Q Subscript upper X Baseline left parenthesis u Subscript i Baseline right parenthesis equals c Subscript iQX(ui) = ci and u 1 comma ellipsis comma u Subscript n Baselineu1, . . . , un are uniform random number on left bracket 0 comma 1 right bracket[0, 1]. This is  
possible because of: 
Lemma 8.2 Let h colon left bracket 0 comma 1 right bracket right arrow double struck upper Rh : [0, 1] →R be continuous15 s.t. integral Subscript 0 Superscript 1 Baseline StartAbsoluteValue h left parenthesis x right parenthesis EndAbsoluteValue normal d x less than normal infinity
⎨1
0 |h(x)|dx < ∞, and 
consider IID uniform normal upper U Subscript i Baseline tilde normal upper U left parenthesis 0 comma 1 right parenthesisUi ∼U(0, 1), for i equals 1 comma 2 comma ellipsisi = 1, 2, . . .. Then n Superscript negative 1 Baseline sigma summation Underscript i equals 1 Overscript n Endscripts h left parenthesis upper U Subscript i Baseline right parenthesis right arrow Overscript a period s period Endscripts integral Subscript 0 Superscript 1 Baseline h left parenthesis x right parenthesis normal d xn−1 ∑n
i=1 h(Ui)
a.s.
−−→
⎨1
0 h(x)dx. 
In fact, we have sans serif upper E left parenthesis h left parenthesis upper U 1 right parenthesis right parenthesis equals integral Subscript 0 Superscript 1 Baseline h left parenthesis x right parenthesis normal d xE(h(U1)) =
⎨1
0 h(x)dx and considering upper Y Subscript i Baseline equals h left parenthesis upper U Subscript i Baseline right parenthesisYi = h(Ui) with 
sans serif upper E left parenthesis StartAbsoluteValue upper Y Subscript i Baseline EndAbsoluteValue right parenthesis equals integral Subscript 0 Superscript 1 Baseline StartAbsoluteValue h left parenthesis x right parenthesis EndAbsoluteValue normal d xE(|Yi|) =
⎨1
0 |h(x)|dx we apply SLLN, Theorem 8.7, to IID upper Y Subscript iYi. 
Example 8.10 (Option Pricing) Continuous time arbitrage theory provide us with 
the following formula for the price of a European call option: 
upper C 0 equals e Superscript minus r upper T Baseline sans serif upper E left parenthesis max left brace upper S 0 e Superscript left parenthesis r minus sigma squared divided by 2 right parenthesis upper T plus sigma StartRoot upper T EndRoot upper Z Baseline minus upper K comma 0 right brace right parenthesis commaC0 = e−rT E
⎛
max
{
S0e(r−σ 2/2)T +σ
√
T Z −K, 0
}⎞
,
where upper S 0S0 is the initial stock price of one share paying no dividend over the horizon 
left bracket 0 comma upper T right bracket[0, T ], K is the strike price, upper S 0 e Superscript left parenthesis r minus sigma squared divided by 2 right parenthesis upper T plus sigma StartRoot upper T EndRoot upper ZS0e(r−σ 2/2)T +σ
√
T Z is the T -price of the stock, and 
r is the known continuously compounded return of a risk-free asset, see Sect. 2.5 
in Chap. 2. Here, upper Z tilde normal upper N left parenthesis 0 comma 1 right parenthesisZ ∼N(0, 1). Estimate of sigma squaredσ 2 might be the sample variance ModifyingAbove sigma With caret squaredˆσ 2 of 
historical daily log-returns, then knowing the value upper S 0S0 and the strike price K, we can 
approximate T with the number of trading days in left bracket 0 comma upper T right bracket[0, T ] expressed in annual terms 
and run the simulation of n uniform random numbers normal upper U Subscript i Baseline tilde normal upper U left parenthesis 0 comma 1 right parenthesisUi ∼U(0, 1) to compute 
upper Z equals upper Q Subscript upper Z Baseline left parenthesis upper U Subscript i Baseline right parenthesisZ = QZ(Ui) and then the Monte Carlo estimate of upper C 0C0 will be: 
StartFraction 1 Over n EndFraction e Superscript minus r upper T Baseline sigma summation Underscript i equals 1 Overscript n Endscripts sans serif upper E left parenthesis max left brace upper S 0 e Superscript left parenthesis r minus ModifyingAbove sigma With caret squared divided by 2 right parenthesis upper T plus ModifyingAbove sigma With caret StartRoot upper T EndRoot upper Q Super Subscript upper Z Superscript left parenthesis u Super Subscript i Superscript right parenthesis Baseline minus upper K comma 0 right brace right parenthesis comma1
ne−rT
n
⎲
i=1
E
⎛
max
{
S0e(r−ˆσ 2/2)T +ˆσ
√
T QZ(ui) −K, 0
}⎞
,
where u 1 comma ellipsis comma u Subscript n Baselineu1, . . . , un are the actual realizations of the uniform random sample.
14 We also assume upper X element of upper L Superscript 1X ∈L1. 
15 This can be weakened by requiring h left parenthesis x right parenthesish(x) being Borel measurable. 
222
8
Convergence Concepts
An algor ithm 
of Monte Carlo si
mulation  with i nput int eger m an d for loop i = 1 to m. I
t simulates a  vector S subscrip
t i  o f n  s tock pr i ces.
The code above is written in Matlab: command rand(’state’,0) ini-
tializes the uniform random number generator; the number of simulation of 
upper Z tilde normal upper N left parenthesis 0 comma 1 right parenthesisZ ∼N(0, 1), the horizon, parameters mu comma sigmaμ, σ and the strike price are set in the 
second line;
U=rand(1,n) generates 1000 uniform random numbers and 
Z=norminv(U,0,1) yields an array (row vector) of 1000 standard normal 
values. The function ones(1,n) yields an array (row vector) or 1000 ones. The 
fourth line sets the formula for the log-normal distributed stock price,16 and the rest 
of the code provides a conditional calculation of the European call price. 
8.5 
Application to Log-Normal Stock Price Model 
Assume you are interested in a single stock traded in the market. You are requested 
to build a sensible model of the upper S Subscript upper TST ’s probability distribution over the time horizon 
left bracket 0 comma upper T right bracket[0, T ]. For each trading day, log-returns are good approximation of arithmetic 
returns, see Sect. 2.5. In fact, taking the Taylor series expansion17 of ln left parenthesis 1 plus x right parenthesisln(1 + x)
around x equals 0x = 0 we have 
ln left parenthesis 1 plus x right parenthesis equals x minus one half x squared plus StartFraction 2 Over 3 factorial EndFraction x cubed minus midline horizontal ellipsis equals sigma summation Underscript n equals 1 Overscript normal infinity Endscripts left parenthesis negative 1 right parenthesis Superscript n plus 1 Baseline StartFraction x Superscript n Baseline Over n EndFraction commaln(1 + x) = x −1
2x2 + 2
3!x3 −· · · =
∞
⎲
n=1
(−1)n+1 xn
n ,
16 The horizon upper T equals 0.5T = 0.5 is corresponds to 6 months, and the parameters mu comma sigmaμ, σ are expressed in 
annual terms. 
17 Equivalently, we can consider the Taylor series expansion of normal e Superscript xex near x equals 0x = 0 up to the ﬁrst-order 
term 
normal e Superscript x Baseline equals x plus 1 plus o left parenthesis x right parenthesis commaex = x + 1 + o(x),
where o left parenthesis x right parenthesis right arrow 0o(x) →0 as x right arrow 0x →0 faster than x.
8.5
Application to Log-Normal Stock Price Model
223
and observe that when x almost equals 0x ≈0, then powers StartFraction x Superscript n Baseline Over n EndFractionxn
n vanishes rapidly for n greater than 1n > 1, which is 
the case for historical daily returns x. Recalling that r Subscript upper T Baseline equals StartFraction upper S Subscript upper T Baseline minus upper S 0 Over upper S 0 EndFractionrT = ST −S0
S0
, we have:  
ln left parenthesis 1 plus r Subscript upper T Baseline right parenthesis equals ln left parenthesis StartFraction upper S Subscript upper T Baseline Over upper S 0 EndFraction right parenthesis almost equals r Subscript upper T Baseline periodln(1 + rT ) = ln
⎛ST
S0
⎞
≈rT .
We are interested in improving this approximation for high-frequency returns, when 
the following question arises: Fix a time-horizon left bracket 0 comma upper T right bracket[0, T ] and suppose you might 
invest a monetary amount in t equals 0t = 0 and hold the investment until t equals upper Tt = T . Is this a  
good strategy? An answer to this question requires probability statements about upper S Subscript upper TST , 
i.e., we need to recover the distribution of the ﬁnal stock price. Our strategy based 
on taking higher frequency returns than daily ones, starts ﬁrstly by decomposing 
left bracket 0 comma upper T right bracket[0, T ] into n element of double struck upper Nn ∈N subintervals of equal length upper Delta equals StartFraction upper T Over n EndFractionΔ = T
n and then consider: 
StartLayout 1st Row 1st Column g Subscript upper T Baseline equals StartFraction upper S Subscript upper T Baseline Over upper S 0 EndFraction 2nd Column equals 3rd Column StartFraction upper S Subscript t Sub Subscript n Subscript Baseline Over upper S Subscript t Sub Subscript n minus 1 Subscript Baseline EndFraction StartFraction upper S Subscript t Sub Subscript n minus 1 Subscript Baseline Over upper S Subscript t Sub Subscript n minus 2 Subscript Baseline EndFraction midline horizontal ellipsis StartFraction upper S Subscript t 1 Baseline Over upper S Subscript t 0 Baseline EndFraction 2nd Row 1st Column Blank 2nd Column equals 3rd Column g Subscript t Sub Subscript n Subscript Baseline g Subscript t Sub Subscript n minus 1 Subscript Baseline midline horizontal ellipsis g Subscript t 1 Baseline comma EndLayoutgT = ST
S0
=
Stn
Stn−1
Stn−1
Stn−2
· · · St1
St0
= gtngtn−1 · · · gt1,
where t Subscript i Baseline equals i upper Deltati = iΔ for i equals 0 comma 1 comma 2 comma ellipsis comma n commai = 0, 1, 2, . . . , n, t 0 equals 0t0 = 0 and t Subscript n Baseline equals upper Ttn = T . Next, we write 
StartLayout 1st Row 1st Column ln left parenthesis g Subscript upper T Baseline right parenthesis 2nd Column equals 3rd Column ln left parenthesis g Subscript t Sub Subscript n Subscript Baseline g Subscript t Sub Subscript n minus 1 Subscript Baseline midline horizontal ellipsis g Subscript t 1 Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column ln left parenthesis g Subscript t Sub Subscript n Subscript Baseline right parenthesis plus ln left parenthesis g Subscript t Sub Subscript n minus 1 Subscript Baseline right parenthesis plus midline horizontal ellipsis plus ln left parenthesis g Subscript t 1 Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column ln left parenthesis StartFraction upper S Subscript upper T Baseline Over upper S 0 EndFraction right parenthesis almost equals r Subscript upper T EndLayoutln(gT ) = ln
(
gtngtn−1 · · · gt1
)
= ln(gtn) + ln(gtn−1) + · · · + ln(gt1)
= ln
⎛ST
S0
⎞
≈rT
which implies upper S Subscript upper T Baseline equals upper S 0 normal e Superscript upper R Super Subscript upper T Baseline almost equals upper S 0 left parenthesis 1 plus r Subscript upper T Baseline right parenthesisST = S0eRT ≈S0(1 + rT ), where upper R Subscript upper T Baseline equals ln left parenthesis StartFraction upper S Subscript upper T Baseline Over upper S 0 EndFraction right parenthesisRT = ln
⎛
ST
S0
⎞
is the log-return at 
T . Now, sending n to normal infinity∞implies upper Delta right arrow 0Δ →0 since 
limit Underscript n right arrow normal infinity Endscripts upper Delta equals limit Underscript n right arrow normal infinity Endscripts StartFraction upper T Over n EndFraction equals 0 comma upper T fixed period lim
n→∞Δ = lim
n→∞
T
n = 0,
T ﬁxed.
But upper T equals n upper DeltaT = nΔ, then if both n right arrow normal infinityn →∞and upper Delta right arrow 0Δ →0 we have that n and StartFraction 1 Over upper Delta EndFraction1
Δ are of the same 
order. Moreover, assume sans serif upper E left parenthesis ln left parenthesis g Subscript t Sub Subscript i Subscript Baseline right parenthesis right parenthesis equals mu upper DeltaE(ln(gti)) = μΔ and sans serif upper V left parenthesis ln left parenthesis g Subscript t Sub Subscript i Subscript Baseline right parenthesis right parenthesis equals sigma squared upper DeltaV(ln(gti)) = σ 2Δ, where mu element of double struck upper Rμ ∈R and 
sigma greater than 0σ > 0. These represent the continuously compound expected return and volatility 
of a log-return as proxies for r Subscript t Sub Subscript i Subscript Baseline commarti, each i equals 1 comma ellipsis comma ni = 1, . . . , n. From stylized facts about daily 
log-returns, the latter assumptions are meant as proportional rules for instantaneous 
returns over each subintervals. The expected return and volatility over the whole
224
8
Convergence Concepts
time horizon are given respectively by: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis ln left parenthesis g Subscript upper T Baseline right parenthesis right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis sigma summation Underscript i equals 1 Overscript n Endscripts ln left parenthesis g Subscript t Sub Subscript i Subscript Baseline right parenthesis right parenthesis sigma summation Underscript i equals 1 Overscript n Endscripts sans serif upper E left parenthesis ln left parenthesis g Subscript t Sub Subscript i Subscript Baseline right parenthesis right parenthesis EndLayoutE(ln(gT )) = E
⎛n
⎲
i=1
ln(gti)
⎞
n
⎲
i=1
E(ln(gti))
StartLayout 1st Row 1st Column sans serif upper V left parenthesis ln left parenthesis g Subscript upper T Baseline right parenthesis right parenthesis 2nd Column equals 3rd Column sans serif upper V left parenthesis sigma summation Underscript i equals 1 Overscript n Endscripts ln left parenthesis g Subscript t Sub Subscript i Subscript Baseline right parenthesis right parenthesis sigma summation Underscript i equals 1 Overscript n Endscripts sans serif upper V left parenthesis ln left parenthesis g Subscript t Sub Subscript i Subscript Baseline right parenthesis right parenthesis period EndLayoutV(ln(gT )) = V
⎛n
⎲
i=1
ln(gti)
⎞
n
⎲
i=1
V(ln(gti)).
The latter equation is based on the additional assumption that periodic log-
returns are IID rvs, again based on stylized facts suggesting little auto-correlation 
among historical daily log-returns as a proxy of independence and their frequency 
histograms: they are almost similar through successive time windows. By standard-
ization 
StartFraction ln left parenthesis g Subscript upper T Baseline right parenthesis minus sans serif upper E left parenthesis ln left parenthesis g Subscript upper T Baseline right parenthesis right parenthesis Over StartRoot sans serif upper V left parenthesis ln left parenthesis g Subscript upper T Baseline right parenthesis right parenthesis EndRoot EndFraction equals StartFraction sigma summation Underscript i equals 1 Overscript n Endscripts ln left parenthesis g Subscript t Sub Subscript i Subscript Baseline right parenthesis minus mu upper T Over sigma StartRoot upper T EndRoot EndFraction commaln(gT ) −E(ln(gT ))
√
V(ln(gT ))
=
∑n
i=1 ln(gti) −μT
σ
√
T
,
as n right arrow normal infinityn →∞log-returns are much more frequently observed within left bracket 0 comma upper T right bracket[0, T ] and by CLT 
the sample mean log-return g overbar Subscript n Baseline equals n Superscript negative 1 Baseline sigma summation Underscript i equals 1 Overscript n Endscripts ln left parenthesis g Subscript t Sub Subscript i Subscript Baseline right parenthesis ¯gn = n−1 ∑n
i=1 ln(gti) is s.t. StartRoot upper T EndRoot g overbar Subscript n Baseline almost equals normal upper N left parenthesis mu upper T comma sigma StartRoot upper T EndRoot right parenthesis
√
T ¯gn ≈N(μT, σ
√
T ), 
thus its CDF can be approximated by that of a Gaussian mu upper T plus sigma StartRoot upper T EndRoot upper Z tilde normal upper N left parenthesis mu upper T comma sigma squared upper T right parenthesisμT + σ
√
T Z
∼
N(μT, σ 2T ) with standard normal upper Z tilde normal upper N left parenthesis 0 comma 1 right parenthesisZ ∼N(0, 1). As byproduct, a reasonable model 
for the stock price at the horizon is: 
StartLayout 1st Row 1st Column ln left parenthesis g Subscript upper T Baseline right parenthesis 2nd Column equals 3rd Column ln left parenthesis StartFraction upper S Subscript upper T Baseline Over upper S 0 EndFraction right parenthesis equals mu upper T plus sigma StartRoot upper T EndRoot upper Z 2nd Row 1st Column Blank 2nd Column long left right double arrow 3rd Column Blank 3rd Row 1st Column upper S Subscript upper T 2nd Column equals 3rd Column upper S 0 normal e Superscript mu upper T plus sigma StartRoot upper T EndRoot upper Z Baseline comma EndLayoutln(gT )
=
ln
⎛ST
S0
⎞
= μT + σ
√
T Z
⇐⇒
ST
=
S0eμT +σ
√
T Z,
then upper S Subscript upper TST is a log-normal rv. If further assumptions are made, in particular the market 
is arbitrage-free, we can18 take mu equals r minus StartFraction sigma squared Over 2 EndFractionμ = r −σ 2
2 , where r is a risk-free rate. 
8.6 
Exercises 
8.1 Prove (i) of Theorem 8.1. 
8.2 Prove (iii) of Theorem 8.1. 
8.3 Prove (iv) of Theorem 8.1.
18 After a proper change of the probability measure sans serif upper PP, replaced by the so called equivalent 
martingale measure. 
Appendix
225
8.4 Prove (v) of Theorem 8.1. 
8.5 Write the likelihood function of a Gaussian sample X1, . . . , Xn ∼ N(μ, σ 2), 
and verify that it is maximized at the sample mean ¯Rn and the sample standard 
deviation
√¯Vn. 
8.6 Prove Lemma 8.1. 
8.7 For 1 ⩽p <  ∞, prove that in Lp the relation XR Y deﬁned as X a.s.
= Y, for  
every X, Y ∈Lp, is indeed an equivalence relation, with quotient space Lp. 
Appendix 
Details on Theorem 8.1 
Proof of Theorem 8.1, (ii) Let g : R → R be bounded and continuous, so that 
g(Xn) 
P
−→ g(X) by the continuous mapping Theorem 8.3. By Theorem 8.2, part 
(b), we also have E(g(Xn)) 
L1 
−−→ E(g(X)) which in turn implies convergence of 
expectations, and this together with Portmanteau lemma 8.3 (see below), entails the 
desired result. 
█
Portmanteau Lemma 
We present a useful result on convergence in distribution without proof. 
Lemma 8.3 (Portmanteau (Partial)) 
Let upper X Subscript n Baseline comma upper XXn, X be rvs. The following are equiv-
alent. 
(a) . lim
n→∞FXn(x) = FX(x) at every continuity point x element of double struck upper Rx ∈R; 
(b) . lim
n→∞E(g(Xn)) = E(g(X)), for every bounded continuous functions g; 
(c) . lim
n→∞P(Xn ∈B) = P(X ∈B), for every Borel set upper B subset of double struck upper RB ⊂R s.t. sans serif upper P left parenthesis upper X element of partial differential upper B right parenthesis equals 0P(X ∈∂B) = 0, 
with partial differential upper B∂B being the boundary of B. 
This formulation of the lemma is incomplete, since we must add four equivalent 
provisos which are omitted here see [15, Th 2.2], items (iii)–(vi). For equivalence 
(a)left right double arrow⇔(b) see also [10, Th 5.8].
226
8
Convergence Concepts
Convergence in Distribution: Special Cases 
Convergence in distribution can be specialized to cases when all rvs upper X Subscript n Baseline comma upper XXn, X are 
either continuous with densities f Subscript upper X Sub Subscript n Subscript Baseline left parenthesis x right parenthesis comma f Subscript upper X Baseline left parenthesis x right parenthesisfXn(x), fX(x) or discrete with masses sans serif upper P left parenthesis upper X Subscript n Baseline equals x right parenthesis comma sans serif upper P left parenthesis upper X equals x right parenthesisP(Xn =
x), P(X = x). In the ﬁrst case: 
StartLayout 1st Row 1st Column limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis g left parenthesis upper X Subscript n Baseline right parenthesis right parenthesis 2nd Column equals 3rd Column limit Underscript n right arrow normal infinity Endscripts integral g left parenthesis x right parenthesis f Subscript upper X Sub Subscript n Baseline left parenthesis x right parenthesis normal d x 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral g left parenthesis x right parenthesis limit Underscript n right arrow normal infinity Endscripts f Subscript upper X Sub Subscript n Baseline left parenthesis x right parenthesis normal d x 3rd Row 1st Column Blank 2nd Column equals 3rd Column integral g left parenthesis x right parenthesis f left parenthesis x right parenthesis normal d x equals sans serif upper E left parenthesis g left parenthesis upper X right parenthesis right parenthesis comma EndLayout lim
n→∞E(g(Xn)) = lim
n→∞
⎨
g(x)fXn(x)dx
=
⎨
g(x) lim
n→∞fXn(x)dx
=
⎨
g(x)f (x)dx = E(g(X)),
where for the second equality to hold we must assume f Subscript upper X Sub Subscript n Baseline left parenthesis x right parenthesis less than or slanted equals g left parenthesis x right parenthesisfXn(x)
⩽
g(x), 
each n element of double struck upper Nn
∈
N and bounded continuous g left parenthesis x right parenthesisg(x), together with integral g left parenthesis x right parenthesis normal d x less than normal infinity
⎨
g(x)dx
<
∞
and limit Underscript n right arrow normal infinity Endscripts f Subscript upper X Sub Subscript n Baseline left parenthesis x right parenthesis equals f Subscript upper X Baseline left parenthesis x right parenthesis lim
n→∞fXn(x) = fX(x) pointwise,19 so we can apply a version of the 
Lebesgue’s dominated convergence Theorem 4.12 for real-valued measurable 
functions, see Appendix to Chap. 4. But this is nothing else convergence in 
distribution upper X Subscript n Baseline right arrow Overscript d Endscripts upper XXn
d−→
X, see Portmanteau lemma 8.3, equivalence (a)left right double arrow⇔(b). 
In fact, this result can be extended to random vectors bold upper X Subscript n Baseline comma bold upper XXn, X having joint 
densities f Subscript bold upper X Sub Subscript n Subscript Baseline left parenthesis bold x right parenthesis comma f Subscript bold upper X Baseline left parenthesis bold x right parenthesisfXn(x), fX(x), s.t. limit Underscript n right arrow normal infinity Endscripts f Subscript bold upper X Sub Subscript n Baseline left parenthesis bold x right parenthesis equals f Subscript bold upper X Baseline left parenthesis bold x right parenthesis lim
n→∞fXn(x) = fX(x) pointwise:20 this again implies 
convergence in distribution bold upper X Subscript n Baseline right arrow Overscript d Endscripts bold upper XXn
d−→X of the joint CDFs. In the second case, one can 
prove limit Underscript n right arrow normal infinity Endscripts sans serif upper P left parenthesis upper X Subscript n Baseline equals x right parenthesis equals sans serif upper P left parenthesis upper X equals x right parenthesis lim
n→∞P(Xn = x) = P(X = x) is equivalent to upper X Subscript n Baseline right arrow Overscript d Endscripts upper XXn
d−→X, for every x in the 
supports of each upper X Subscript nXn and of X, see [8, Th 18.9] for a proof. Finally we present a 
partial converse of the implication 
bold upper X Subscript n Baseline right arrow Overscript d Endscripts bold upper X long right double arrow upper X Subscript i n Baseline right arrow Overscript d Endscripts upper X Subscript i Baseline comma for i equals 1 comma ellipsis comma nXn
d−→X =⇒Xin
d−→Xi,
for i = 1, . . . , n
for random vectors bold upper X Subscript n Baseline equals left parenthesis upper X Subscript 1 n Baseline comma ellipsis comma upper X Subscript n n Baseline right parenthesisXn
= (X1n, . . . , Xnn) and bold upper X equals left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesisX
= (X1, . . . , Xn) In fact, 
convergence in distribution for random vectors is equivalent to 
sigma summation Underscript i equals 1 Overscript n Endscripts a Subscript i Baseline upper X Subscript i n Baseline right arrow Overscript d Endscripts sigma summation Underscript i equals 1 Overscript n Endscripts a Subscript i Baseline upper X Subscript i Baseline comma
n
⎲
i=1
aiXin
d−→
n
⎲
i=1
aiXi,
19 This can be weakened to f Subscript upper X Sub Subscript n Baseline left parenthesis x right parenthesis right arrow f Subscript upper X Baseline left parenthesis x right parenthesisfXn(x) →fX(x), excepts on a set of x of Lebesgue measure zero. 
20 This can also be weakened by requiring convergence on a set of bold xx with n-dimensional Lebesgue 
measure zero. 
Appendix
227
for every choice of bold a equals left parenthesis a 1 comma ellipsis comma a Subscript n Baseline right parenthesisa = (a1, . . . , an), since deﬁning the linear function 
h left parenthesis bold x right parenthesis equals g left parenthesis bold a dot bold x right parenthesis equals g left parenthesis sigma summation Underscript i equals 1 Overscript n Endscripts a Subscript i Baseline x Subscript i Baseline right parenthesish(x) = g(a · x) = g
⎛n
⎲
i=1
aixi
⎞
we clearly have 
limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis h left parenthesis bold upper X Subscript n Baseline right parenthesis right parenthesis equals sans serif upper E left parenthesis h left parenthesis bold upper X right parenthesis right parenthesis comma lim
n→∞E(h(Xn)) = E(h(X)),
which is convergence in distribution due to h left parenthesis dot right parenthesish( · ) being bounded and continuous on 
double struck upper R Superscript nRn. For the converse see below Complements on CHF. 
Further Details on Convergence in Distribution 
Convergence in probability does not imply convergence of expectations, but there 
is one exception which requires an additional property. We say that a sequence 
left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N Baseline subset of upper L Superscript 1(Xn)n∈N ⊂L1 is uniformly integrable if 
limit Underscript upper M right arrow normal infinity Endscripts sup sans serif upper E left parenthesis StartAbsoluteValue upper X Subscript n Baseline EndAbsoluteValue bold upper I Subscript left brace StartAbsoluteValue upper X Sub Subscript n Subscript EndAbsoluteValue greater than upper M right brace Baseline right parenthesis equals 0 period lim
M→∞sup E
(
|Xn|I{|Xn|>M}
)
= 0.
(8.4) 
By Lebesgue’s dominated convergence theorem 4.12 (see Appendix in Chap. 4) it  
is true21 
limit Underscript upper M right arrow normal infinity Endscripts sans serif upper E left parenthesis StartAbsoluteValue upper X Subscript n Baseline EndAbsoluteValue bold upper I Subscript left brace StartAbsoluteValue upper X Sub Subscript n Subscript EndAbsoluteValue greater than upper M right brace Baseline right parenthesis equals 0 period lim
M→∞E(|Xn|I{|Xn|>M}) = 0.
Condition sans serif upper E left parenthesis StartAbsoluteValue upper X Subscript n Baseline EndAbsoluteValue bold upper I Subscript left brace StartAbsoluteValue upper X Sub Subscript n Subscript EndAbsoluteValue greater than upper M right brace Baseline right parenthesis less than deltaE(|Xn|I{|Xn|>M}) < δ holds for all delta greater than 0δ > 0 and some constant M, thus, 
in (8.4) we further require it holds for the same22 M for all upper X Subscript nXn. It can be shown 
that uniform integrability is equivalent to the condition sup Underscript n Endscripts sans serif upper E left parenthesis StartAbsoluteValue upper X Subscript n Baseline EndAbsoluteValue right parenthesis less than normal infinitysupn E(|Xn|) < ∞, see [10, 
Th 5.16], part i). Now, if upper X Subscript n Baseline right arrow Overscript sans serif upper P Endscripts cXn
P
−→c and left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N Baseline subset of upper L Superscript 1(Xn)n∈N ⊂L1 is uniformly integrable then 
limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis equals c lim
n→∞E(Xn) = c, for a constant c element of double struck upper Rc ∈R, see [10, Theorem 5.17] in the degenerate 
case upper X equals cX = c. A similar situation occurs for convergence in distribution. Intuitively, 
sans serif upper P left parenthesis StartAbsoluteValue upper X Subscript n Baseline EndAbsoluteValue greater than upper M right parenthesis less than epsilonP(|Xn| > M) < ϵ holds for all epsilon greater than 0ϵ > 0 and some constant M and rvs upper X Subscript nXn are called 
tight. In condition (8.4) we impose choosing the same M for every n element of double struck upper Nn ∈N, and the 
sequence is said uniformly tight.23 On the other hand, convergence in distribution
21 Every truncated rv StartAbsoluteValue upper X Subscript n Baseline EndAbsoluteValue bold upper I Subscript left brace StartAbsoluteValue upper X Sub Subscript n Subscript EndAbsoluteValue greater than upper M vertical bar right brace|Xn|I{|Xn|>M|} is dominated by upper X Subscript nXn, each n, and converge to zero. 
22 Recall that a sequence of functions left parenthesis f Subscript n Baseline left parenthesis x right parenthesis right parenthesis Subscript n element of double struck upper N(fn(x))n∈N, deﬁned over the same domain, say D, converges  
uniformly to a limit function f left parenthesis x right parenthesisf (x) iff sup Underscript x element of upper D Endscripts StartAbsoluteValue f Subscript n Baseline left parenthesis x right parenthesis minus f left parenthesis x right parenthesis EndAbsoluteValue right arrow 0supx∈D |fn(x)−f (x)| →0 as n right arrow normal infinityn →∞, i.e., sup Underscript x element of upper D Endscripts StartAbsoluteValue f Subscript n Baseline left parenthesis x right parenthesis minus f left parenthesis x right parenthesis EndAbsoluteValue less than deltasupx∈D |fn(x)−
f (x)| < δ for all delta greater than 0δ > 0 and some upper N element of double struck upper NN ∈N s.t. n greater than upper Nn > N. 
23 Note that the complimentary event left brace StartAbsoluteValue upper X Subscript n Baseline EndAbsoluteValue less than or slanted equals epsilon right brace{|Xn| ⩽ϵ} is deﬁned over a compact subset left bracket negative epsilon comma epsilon right bracket[−ϵ, ϵ]. 
228
8
Convergence Concepts
upper X Subscript n Baseline right arrow Overscript d Endscripts upper XXn
d−→X does imply left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Xn)n∈N is uniformly tight.24 In fact, a pathological behavior 
happens when upper X Subscript n Baseline right arrow Overscript d Endscripts upper XXn
d−→X, and all upper X Subscript nXn are continuous rvs but X is not. More generally, 
it could be the case that a sequence of CDFs upper F Subscript upper X Sub Subscript n Baseline left parenthesis x right parenthesisFXn(x) converges pointwise to a 
limit upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x) which is not a properly CDF: it is nondecreasing, right-continuous but 
upper F Subscript upper X Baseline left parenthesis normal infinity right parenthesis less than 1FX(∞) < 1 and upper F Subscript upper X Baseline left parenthesis negative normal infinity right parenthesis greater than 0FX(−∞) > 0. This is called a defective CDF, and can be right 
discontinuous at some points x where upper F Subscript upper X Baseline left parenthesis x right parenthesis minus upper F Subscript upper X Baseline left parenthesis negative x right parenthesis greater than 0FX(x)−FX(−x) > 0. In the latter case, these 
form sets of isolated points StartSet x EndSet{x} which have to be excluded from the convergence 
since sans serif upper P left parenthesis upper X element of partial differential StartSet x EndSet right parenthesis greater than 0P(X ∈∂{x}) > 0, where we considered partial differential StartSet x EndSet equals StartSet x EndSet∂{x} = {x}. The following lemma 
ﬁxes this, see [15, Lemma 2.5] or [10, Th 6.32]. 
Lemma 8.4 (Helly) 
Let left parenthesis upper F Subscript upper X Sub Subscript n Subscript Baseline left parenthesis x right parenthesis right parenthesis Subscript n element of double struck upper N(FXn(x))n∈N be a sequence of CDFs. Then there is a 
subsequence s.t. limit Underscript k right arrow normal infinity Endscripts upper F Subscript upper X Sub Subscript n Sub Sub Subscript k Baseline left parenthesis x right parenthesis equals upper F Subscript upper X Baseline left parenthesis x right parenthesis lim
k→∞FXnk (x) = FX(x), at each continuity point x of a possibly 
defective CDF upper F Subscript upper XFX. 
When the limit rv X has a continuous CDF upper F Subscript upper XFX then convergence in distribution is 
at every x element of double struck upper Rx ∈R, and then it is uniform convergence of CDFs upper F Subscript upper X Sub Subscript nFXn, i.e., sup Underscript x Endscripts StartAbsoluteValue upper F Subscript upper X Sub Subscript n Subscript Baseline left parenthesis x right parenthesis minus upper F Subscript upper X Baseline left parenthesis x right parenthesis EndAbsoluteValue right arrow 0supx |FXn(x)−
FX(x)| →0 as n right arrow normal infinityn →∞, see [15, Lemma 2.11]. There is a more general version 
of Lemma 8.4, referred as Helly’s selection principle, see for example [8, Th 18.6]. 
More complete accounts of convergence concepts are [1] and [6]. 
Further Convergence Relationships 
Theorem 8.12 Let Xn, X  and Yn, Y  be rvs. Then: 
(i) if Xn 
d−→ X and |Xn − Yn| 
P
−→ 0, then Yn 
d−→ X; 
(ii) if Xn 
d−→ X and Yn 
P
−→ c, then (Xn, Yn) 
d−→(X, c), where c ∈ R; 
(iii) if Xn 
P
−→ X and Yn 
P
−→ Y, then (Xn, Yn) 
P
−→ (X, Y). 
Proof We only prove (ii) and (iii). For a proof of (i) see [15, Th 2.7]. To check 
(ii), ﬁrst we recall that convergence in probability for random vectors in Rn needs 
replacing absolute value in the condition |Xn − X| 
P
−→ 0 for univariate rvs, 
with the Euclidean distance d((Xn, Yn), (Xn, c))  =
√
(Xn − Xn)2 + (Yn − c)2, 
written for bi-variate random vectors (Xn, Yn), each n, and (Yn, c). Thus, 
d((Xn, Yn), (Xn, c))  = |Yn − c| which converges to zero in probability. According 
to (i) the proof amounts to show (Xn, c)  
d−→ (X, c). In fact, for every bounded 
continuous function g(x, y), the mapping x
⍿→ g(x, c) is also continuous 
and bounded. Then, provided Xn 
d−→ X we get g(Xn, c)  
d−→ g(X, c) and by
24 See Prohorov’s theorem [15, Th 2.4]. part (i). More is true, if the sequence of rvs is uniformly 
tight, then there exists a subsequence converging in distribution, which is Theorem [15, Th 2.4].  
part (ii). 
Appendix
229
Theorem 8.3, part (b), we are done. To prove (iii) we simply invoke the inequality 
d((Xn, Yn), (X, Y)) ⩽d(Xn, X) + d(Yn, Y). 
█
It is worth noting that Slutsky’s lemma can be deduced by Theorem 8.12 in the 
following sense. By part (ii), if Xn 
d−→ X and Yn 
P
−→ c we have (Xn, Yn) 
d−→(X, c), 
and by the continuous mapping Theorem 8.3 we also have g(Xn, Yn) 
d−→ g(X, c) for 
a function g(x, y) which is continuous at every point in R × {c} where the random 
vector (X, c) takes values. Choosing g(x, y) = x + y or g(x, y) = xy entails part 
(b) of Theorem 8.4. 
Complements on CHF 
Any CHF phi Subscript upper X Baseline left parenthesis u right parenthesis equals sans serif upper E left parenthesis normal e Superscript normal i u upper X Baseline right parenthesisφX(u) = E(eiuX) is uniformly continuous: 
StartLayout 1st Row 1st Column StartAbsoluteValue phi Subscript upper X Baseline left parenthesis u plus h right parenthesis minus phi Subscript upper X Baseline left parenthesis u right parenthesis EndAbsoluteValue 2nd Column equals 3rd Column StartAbsoluteValue sans serif upper E left parenthesis normal e Superscript left parenthesis normal i plus h right parenthesis u upper X Baseline right parenthesis minus sans serif upper E left parenthesis normal e Superscript normal i u upper X Baseline right parenthesis EndAbsoluteValue 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartAbsoluteValue sans serif upper E left parenthesis normal e Superscript normal i u upper X Baseline left parenthesis normal e Superscript normal i h upper X Baseline minus 1 right parenthesis right parenthesis EndAbsoluteValue 3rd Row 1st Column Blank 2nd Column less than or slanted equals 3rd Column sans serif upper E left parenthesis StartAbsoluteValue normal e Superscript normal i u upper X Baseline EndAbsoluteValue StartAbsoluteValue normal e Superscript normal i h upper X Baseline minus 1 EndAbsoluteValue right parenthesis equals sans serif upper E left parenthesis StartAbsoluteValue normal e Superscript normal i h upper X Baseline minus 1 EndAbsoluteValue right parenthesis comma EndLayout|φX(u + h) −φX(u)| = |E(e(i+h)uX) −E(eiuX)|
= |E(eiuX(eihX −1))|
⩽E(|eiuX||eihX −1|) = E(|eihX −1|),
so limit Underscript h right arrow 0 Endscripts sans serif upper E left parenthesis StartAbsoluteValue normal e Superscript normal i h upper X Baseline minus 1 EndAbsoluteValue right parenthesis equals 0 lim
h→0 E(|eihX −1|) = 0 and by the Lebesgue’s dominated convergence Theo-
rem 4.12 the convergence is for all u. Moreover, from Euler’s formula we can take 
conjugate as normal e Superscript minus normal i x Baseline equals ModifyingAbove normal e Superscript normal i x Baseline With quotation dash equals cosine x minus i sine xe−ix = eix = cos x −i sin x then: 
StartLayout 1st Row 1st Column phi Subscript upper X Baseline left parenthesis negative u right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis normal e Superscript minus normal i u upper X Baseline right parenthesis equals sans serif upper E left parenthesis ModifyingAbove normal e Superscript normal i u upper X Baseline With quotation dash right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper E left parenthesis cosine left parenthesis u upper X right parenthesis right parenthesis minus normal i sans serif upper E left parenthesis sine left parenthesis u upper X right parenthesis right parenthesis equals ModifyingAbove sans serif upper E left parenthesis normal e Superscript normal i u upper X Baseline right parenthesis With quotation dash equals ModifyingAbove phi Subscript upper X Baseline left parenthesis u right parenthesis With quotation dash period EndLayoutφX(−u) = E(e−iuX) = E(eiuX)
= E(cos(uX)) −iE(sin(uX)) = E(eiuX) = φX(u).
In this respect, we also have phi Subscript negative upper X Baseline left parenthesis u right parenthesis equals sans serif upper E left parenthesis normal e Superscript minus normal i u upper X Baseline right parenthesis equals phi Subscript upper X Baseline left parenthesis negative u right parenthesisφ−X(u) = E(e−iuX) = φX(−u) which in turn yields 
the conjugate CHF ModifyingAbove phi Subscript upper X Baseline left parenthesis u right parenthesis With quotation dashφX(u). Moreover, the CHF determines the distribution, i.e., 
phi Subscript upper X Baseline left parenthesis u right parenthesis equals phi Subscript upper Y Baseline left parenthesis u right parenthesisφX(u) = φY (u) for all u implies upper X equals Overscript d Endscripts upper YX d= Y, since 
sans serif upper P left parenthesis x less than upper X less than y right parenthesis equals limit Underscript k right arrow normal infinity Endscripts integral Subscript negative k Superscript k Baseline StartFraction normal e Superscript minus normal i u x Baseline minus normal e Superscript minus normal i u x Baseline Over normal i u EndFraction phi Subscript upper X Baseline left parenthesis u right parenthesis normal d u comma x comma y con period points of upper F Subscript upper X Baseline commaP(x < X < y) = lim
k→∞
⎨k
−k
e−iux −e−iux
iu
φX(u)du, x, y con. points of FX,
see for example [10, Th 6.5], and then 
upper F Subscript upper X Baseline left parenthesis x right parenthesis minus upper F Subscript upper X Baseline left parenthesis y right parenthesis equals upper F Subscript upper Y Baseline left parenthesis x right parenthesis minus upper F Subscript upper Y Baseline left parenthesis y right parenthesisFX(x) −FX(y) = FY (x) −FY (y)
230
8
Convergence Concepts
so that taking the limits as y right arrow negative normal infinityy →−∞we have upper F Subscript upper X Baseline left parenthesis x right parenthesis equals upper F Subscript upper Y Baseline left parenthesis x right parenthesisFX(x) = FY (x) for every continuity 
point25 x. We have seen in Sect. 4.4 that for an absolutely continuous rv X its 
symmetric density around zero can be recovered by the inverse Fourier transform. 
In general a sufﬁcient condition for the inverse to exist is absolute integrability of 
the CHF: 
integral StartAbsoluteValue phi Subscript upper X Baseline left parenthesis u right parenthesis EndAbsoluteValue normal d u less than normal infinity period
⎨
|φX(u)|du < ∞.
If this is fulﬁlled then X is an absolutely continuous rv with continuous and bounded 
density f Subscript upper X Baseline left parenthesis x right parenthesis equals StartFraction 1 Over 2 pi EndFraction integral normal e Superscript minus normal i u x Baseline phi Subscript upper X Baseline left parenthesis u right parenthesis normal d ufX(x) =
1
2π
⎨
e−iuxφX(u)du, see [10, Th 6.7]. For example, for a standard 
normal upper X tilde left parenthesis 0 comma 1 right parenthesisX ∼(0, 1) we have phi left parenthesis u right parenthesis equals normal e Superscript minus u squared divided by 2φ(u) = e−u2/2 which is absolutely integrable since 
integral StartAbsoluteValue normal e Superscript minus u squared divided by 2 Baseline EndAbsoluteValue normal d u equals integral normal e Superscript minus u squared divided by 2 Baseline equals StartRoot 2 pi EndRoot comma
⎨
|e−u2/2|du =
⎨
e−u2/2 =
√
2π,
and the inverse Fourier transform can be obtained analytically by complex contour 
integration. 
Remark 8.4 For an absolutely continuous rv X, its CHF is the Fourier transform 
phi Subscript upper X Baseline left parenthesis u right parenthesis equals German upper F left parenthesis f Subscript upper X Baseline right parenthesis right parenthesisφX(u) = F(fX)) of the density function. More generally, we can handle CDFs: 
phi Subscript upper X Baseline left parenthesis u right parenthesis equals integral normal e Superscript normal i u x Baseline normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis periodφX(u) =
⎨
eiuxdFX(x).
Thus we have phi Subscript upper X Baseline left parenthesis u right parenthesis equals German upper F left parenthesis upper F Subscript upper X Baseline right parenthesis right parenthesisφX(u) = F(FX)) is a transform acting on the space of CDFs (with 
value onto the complex numbers double struck upper CC). 
For discrete rvs X the mass function can be recovered via 
sans serif upper P left parenthesis upper X equals x right parenthesis equals limit Underscript k right arrow normal infinity Endscripts StartFraction 1 Over 2 k EndFraction integral Subscript negative k Superscript k Baseline normal e Superscript minus normal i u x Baseline phi Subscript upper X Baseline left parenthesis u right parenthesis normal d u commaP(X = x) = lim
k→∞
1
2k
⎨k
−k
e−iuxφX(u)du,
see [10, Prop 6.9]. If moments sans serif upper E left parenthesis upper X Superscript p Baseline right parenthesisE(Xp) exist, they can be obtained by the pth 
derivative of the CHF phi Subscript upper X Baseline left parenthesis u right parenthesisφX(u) evaluated at zero, see [10, Th 6.11]. For example, for 
upper X element of upper L squaredX ∈L2 we have sans serif upper E left parenthesis upper X right parenthesis equals minus i StartFraction normal d Over normal d u EndFraction phi Subscript upper X Baseline left parenthesis 0 right parenthesisE(X) = −i d
duφX(0) and sans serif upper E left parenthesis upper X squared right parenthesis equals minus StartFraction normal d squared Over normal d u squared EndFraction phi Subscript upper X Baseline left parenthesis 0 right parenthesisE(X2) = −d2
du2 φX(0). It is also true that  
assuming the pth derivative StartFraction normal d Superscript p Baseline Over normal d u Superscript p Baseline EndFraction phi Subscript upper X Baseline left parenthesis 0 right parenthesis dp
dup φX(0) exists for even p, then all even moments exist 
since sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline right parenthesisE(|X|p) is ﬁnite, see [10, Th 6.12]. Turning things around, if sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline right parenthesis less than normal infinityE(|X|p) < ∞
for some integer p greater than or slanted equals 1p ⩾1, we can take the Taylor series expansion of the CHF: 
phi Subscript upper X Baseline left parenthesis u right parenthesis equals sigma summation Underscript i equals 0 Overscript p Endscripts StartFraction left parenthesis normal i u right parenthesis Superscript i Baseline Over i factorial EndFraction sans serif upper E left parenthesis upper X Superscript i Baseline right parenthesis plus o left parenthesis StartAbsoluteValue u EndAbsoluteValue Superscript p Baseline right parenthesis commaφX(u) =
p
⎲
i=0
(iu)i
i! E(Xi) + o(|u|p),
(8.5)
25 This gives upper F Subscript upper X Baseline left parenthesis x right parenthesis equals upper F Subscript upper Y Baseline left parenthesis x right parenthesisFX(x) = FY (x) also for all x element of double struck upper Rx ∈R, since CDFs have at most countably many 
discontinuous points. 
Appendix
231
where o left parenthesis StartAbsoluteValue u EndAbsoluteValue Superscript p Baseline right parenthesis right arrow 0o(|u|p) →0 as u right arrow 0u →0. When we are sure that the MGF upper M Subscript upper X Baseline left parenthesis u right parenthesis equals sans serif upper E left parenthesis normal e Superscript u upper X Baseline right parenthesisMX(u) = E(euX)
exists, then it is possible to recover it by phi Subscript upper X Baseline left parenthesis u right parenthesis equals upper M Subscript upper X Baseline left parenthesis i u right parenthesisφX(u) = MX(iu), i.e., upper M Subscript upper X Baseline left parenthesis u right parenthesis equals phi Subscript upper X Baseline left parenthesis minus i u right parenthesisMX(u) = φX(−iu). 
For a random vector bold upper X equals left parenthesis upper X 1 comma ellipsis comma upper X Subscript n Baseline right parenthesisX = (X1, . . . , Xn) and a deterministic vector bold u equals u 1 comma ellipsis comma u Subscript n Baselineu = u1, . . . , un, 
the CHF is deﬁned as 
phi Subscript bold upper X Baseline left parenthesis bold u right parenthesis equals sans serif upper E left parenthesis normal e Superscript normal i bold upper X dot bold u Baseline right parenthesis equals sans serif upper E left parenthesis exp left parenthesis normal i sigma summation Underscript j equals 1 Overscript n Endscripts upper X Subscript j Baseline u Subscript j Baseline right parenthesis right parenthesis periodφX(u) = E(eiX·u) = E
⎛
⎝exp
⎛
⎝i
n
⎲
j=1
Xjuj
⎞
⎠
⎞
⎠.
(8.6) 
The multivariate CHF share the same properties than those of the univariate 
counterpart. We list them below.
•
.φX(u) is uniformly continuous.
•
.φX(−u) = φX(u) = φ−X(u).
•
For independent bold upper X 1 comma ellipsis comma bold upper X Subscript m BaselineX1, . . . , Xm it holds phi Subscript bold upper X 1 plus midline horizontal ellipsis plus bold upper X Sub Subscript m Subscript Baseline left parenthesis bold u right parenthesis equals phi Subscript bold upper X 1 Baseline left parenthesis bold u right parenthesis midline horizontal ellipsis phi Subscript bold upper X Sub Subscript m Subscript Baseline left parenthesis bold u right parenthesisφX1+···+Xm(u) = φX1(u) · · · φXm(u)
•
.X d= Y iff phi Subscript bold upper X Baseline left parenthesis bold u right parenthesis equals phi Subscript bold upper Y Baseline left parenthesis bold u right parenthesisφX(u) = φY(u) for every bold u element of double struck upper R Superscript nu ∈Rn.
•
The components upper X Subscript iXi of bold upper XX are independent iff phi Subscript bold upper X Baseline left parenthesis bold u right parenthesis equals product Underscript i equals 1 Overscript n Endscripts phi Subscript upper X Sub Subscript i Baseline left parenthesis u Subscript i Baseline right parenthesisφX(u) = ∏n
i=1 φXi(ui).
•
(Levy’s Continuity theorem) Let bold upper X Subscript n Baseline comma bold upper XXn, X be random vectors with CHFs 
phi Subscript bold upper X Sub Subscript n Subscript Baseline left parenthesis bold u right parenthesis comma phi Subscript bold upper X Baseline left parenthesis bold u right parenthesisφXn(u), φX(u). Then bold upper X Subscript n Baseline right arrow Overscript d Endscripts bold upper XXn
d−→X iff limit Underscript n right arrow normal infinity Endscripts phi Subscript bold upper X Sub Subscript n Baseline left parenthesis bold u right parenthesis equals phi Subscript bold upper X Baseline left parenthesis bold u right parenthesis lim
n→∞φXn(u) = φX(u), at every bold u element of double struck upper R Superscript nu ∈Rn. 
If limit Underscript n right arrow normal infinity Endscripts phi Subscript bold upper X Sub Subscript n Baseline left parenthesis bold u right parenthesis equals f left parenthesis bold u right parenthesis lim
n→∞φXn(u) = f (u), for all bold u element of double struck upper R Superscript nu ∈Rn, where f left parenthesis bold u right parenthesisf (u) is continuous at bold 0 element of double struck upper R Superscript n0 ∈Rn, then 
f left parenthesis bold u right parenthesis equals phi Subscript bold upper X Baseline left parenthesis bold u right parenthesisf (u) = φX(u) and bold upper X Subscript n Baseline right arrow Overscript d Endscripts bold upper XXn
d−→X. 
To prove that convergence of a linear combination of components in each bold upper X Subscript nXn do 
converges in distribution to a linear combination of components in bold upper XX, with the same 
coefﬁcients, deﬁne the rvs upper Y Subscript n Baseline equals bold upper X Subscript n Baseline dot bold uYn = Xn · u and upper Y equals bold upper X dot bold uY = X · u, actually linear combinations 
of upper X Subscript j nXjn and upper X Subscript jXj with coefﬁcients u Subscript juj, respectively, for j equals 1 comma ellipsis comma nj = 1, . . . , n. If bold upper X Subscript n Baseline dot bold u right arrow Overscript d Endscripts bold upper X dot bold uXn ·u
d−→X·u
we have phi Subscript upper Y Sub Subscript n Baseline left parenthesis v right parenthesis right arrow phi Subscript upper Y Baseline left parenthesis v right parenthesisφYn(v) →φY (v) for an arbitrary v element of double struck upper Rv ∈R as n right arrow normal infinityn →∞. Thus choosing v equals 1v = 1
we have phi Subscript bold upper X Sub Subscript n Baseline left parenthesis bold u right parenthesis right arrow phi Subscript bold upper X Baseline left parenthesis bold u right parenthesisφXn(u) →φX(u) as n right arrow normal infinityn →∞and bold upper X Subscript n Baseline right arrow Overscript d Endscripts bold upper XXn
d−→X is established. 
Complements on MGF 
When a rv X admits MGF, then all its moments exist ﬁnite since from basic 
calculus courses we know that limit Underscript x right arrow normal infinity Endscripts StartFraction x Superscript normal e Baseline Over normal e Superscript x Baseline EndFraction equals 0 lim
x→∞
xe
ex = 0 and then normal e Superscript StartAbsoluteValue u x EndAbsoluteValuee|ux| is greater than any 
polynomial of ﬁnite degree in u xux, as StartAbsoluteValue x EndAbsoluteValue right arrow normal infinity|x| →∞. Next, a useful application of the 
Lebesgue’s dominated convergence theorem 4.12 enable us computing moments 
via the Taylor series expansion of the MGF around zero. The starting point is to 
replace the sequence of rvs assumed in Theorem 4.12 with any indexed family of 
rvs left parenthesis upper X Subscript u Baseline right parenthesis Subscript u element of upper I(Xu)u∈I deﬁned on the same probability space and such that limit Underscript u right arrow 0 Endscripts upper X Subscript u Baseline left parenthesis omega right parenthesis equals upper X 0 left parenthesis omega right parenthesislimu→0 Xu(ω) =
X0(ω) pointwise, where upper I subset of double struck upper RI ⊂R is any nonempty set. This implies the pointwise 
convergence upper X Subscript u Sub Subscript n Baseline left parenthesis omega right parenthesis right arrow upper X 0 left parenthesis omega right parenthesisXun(ω) →X0(ω) for any subsequence u 1 less than u 2 less than midline horizontal ellipsisu1 < u2 < · · · of indexes with
232
8
Convergence Concepts
u Subscript k Baseline down arrow 0uk ↓0 as n right arrow normal infinityn →∞. Thus, Theorem 4.12 guarantees that limit sans serif upper E left parenthesis upper X Subscript u Sub Subscript n Subscript Baseline right parenthesis equals sans serif upper E left parenthesis upper X 0 right parenthesislim E(Xun) = E(X0) and 
consequently limit Underscript u right arrow 0 Endscripts sans serif upper E left parenthesis upper X Subscript u Baseline right parenthesis equals sans serif upper E left parenthesis upper X 0 right parenthesislimu→0 E(Xu) = E(X0). We have:  
Theorem 8.13 (Differentiating Inside the Expectation) Let left parenthesis upper X Subscript u Baseline right parenthesis Subscript u element of left parenthesis a comma b right parenthesis(Xu)u∈(a,b) be an 
indexed family of rvs deﬁned on the same probability space. Assume that the partial 
derivative StartFraction partial differential Over partial differential u EndFraction upper X Subscript u Baseline left parenthesis omega right parenthesis ∂
∂uXu(ω) exists, for every omega element of upper Omegaω ∈Ω and every u element of left parenthesis a comma b right parenthesisu ∈(a, b). Furthermore, let 
upper Y element of upper L Superscript 1Y ∈L1 be a random variable such that StartAbsoluteValue StartFraction partial differential Over partial differential u EndFraction upper X Subscript u Baseline EndAbsoluteValue less than or slanted equals upper Y| ∂
∂uXu| ⩽Y holds for every scenario omegaω
and every u. Then, StartFraction partial differential Over partial differential u EndFraction upper X Subscript u Baseline left parenthesis omega right parenthesis ∂
∂uXu(ω) is a random variable and the function u right arrow from bar sans serif upper E left parenthesis upper X Subscript u Baseline right parenthesisu ⍿→E(Xu) has 
derivative sans serif upper E left parenthesis StartFraction partial differential Over partial differential u EndFraction upper X Subscript u Baseline right parenthesis commaE( ∂
∂uXu), for every a less than u less than ba < u < b. 
Observe that the indexed family in the above theorem can be though of as a 
collection of functions upper X left parenthesis u comma omega right parenthesisX(u, ω) of two variables, see Chap. 9. 
Proof Let u Subscript k Baseline equals u plus StartFraction 1 Over k EndFractionuk = u + 1
k and take u Subscript k Baseline down arrow uuk ↓u as k right arrow normal infinityk →∞. First, we show that StartFraction partial differential Over partial differential u EndFraction upper X Subscript u ∂
∂uXu is 
a random variable. The Newton quotient StartFraction upper X Subscript u Sub Subscript k Subscript Baseline left parenthesis omega right parenthesis minus upper X Subscript u Baseline left parenthesis omega right parenthesis Over 1 divided by n EndFraction
Xuk (ω)−Xu(ω)
1/n
is a rv. This is nothing but 
the partial derivative claimed. Now, write f prime left parenthesis u right parenthesis equals limit Underscript h right arrow 0 Endscripts StartFraction f left parenthesis u plus h right parenthesis minus f left parenthesis u right parenthesis Over h EndFractionf '(u) = limh→0
f (u+h)−f (u)
h
and observe 
that StartAbsoluteValue StartFraction f left parenthesis u plus h right parenthesis minus f left parenthesis u right parenthesis Over h EndFraction EndAbsoluteValue less than or slanted equals StartAbsoluteValue StartFraction partial differential Over partial differential u EndFraction upper X Subscript u Baseline EndAbsoluteValue less than or slanted equals upper Y| f (u+h)−f (u)
h
| ⩽| ∂
∂uXu| ⩽Y by assumption. Then the Lebesgue’s dominated 
convergence theorem gives: 
StartLayout 1st Row 1st Column limit Underscript h right arrow 0 Endscripts StartFraction f left parenthesis u plus h right parenthesis minus f left parenthesis u right parenthesis Over h EndFraction 2nd Column equals limit Underscript h right arrow 0 Endscripts sans serif upper E left parenthesis StartFraction upper X Subscript u plus h Baseline minus upper X Subscript u Baseline Over h EndFraction right parenthesis equals sans serif upper E left parenthesis limit Underscript h right arrow 0 Endscripts StartFraction upper X Subscript u plus h Baseline minus upper X Subscript u Baseline Over h EndFraction right parenthesis 2nd Row 1st Column Blank 2nd Column equals sans serif upper E left parenthesis StartFraction partial differential Over partial differential u EndFraction upper X Subscript u Baseline right parenthesis period EndLayout lim
h→0
f (u + h) −f (u)
h
= lim
h→0 E
⎛Xu+h −Xu
h
⎞
= E
⎛
lim
h→0
Xu+h −Xu
h
⎞
= E
⎛∂
∂uXu
⎞
.
This limit is ﬁnite, since the rvs StartFraction partial differential Over partial differential u EndFraction upper X Subscript u ∂
∂uXu are dominated by Y. Taking expectation we 
have sans serif upper E left parenthesis StartAbsoluteValue StartFraction partial differential Over partial differential u EndFraction upper X Subscript u Baseline EndAbsoluteValue right parenthesis less than or slanted equals sans serif upper E left parenthesis upper Y right parenthesis less than normal infinityE(| ∂
∂uXu|) ⩽E(Y) < ∞. 
█
Theorem 8.13 enable us to differentiate inside the expectation as StartFraction normal d Over normal d u EndFraction sans serif upper E left parenthesis upper X left parenthesis u comma omega right parenthesis right parenthesis equals sans serif upper E left parenthesis StartFraction partial differential Over partial differential u EndFraction upper X Subscript u Baseline right parenthesis d
duE(X(u, ω)) =
E( ∂
∂uXu). As a consequence we are in position to deﬁne the MGF upper M Subscript upper X Baseline left parenthesis u right parenthesis equals sans serif upper E left parenthesis normal e Superscript u upper X Baseline right parenthesisMX(u) = E(euX)
under the condition that t not equals 0t /= 0 is chosen so that the expectation exists and is ﬁnite. 
The assumption upper X element of upper L Superscript 1X ∈L1 is in general not sufﬁcient to apply the change of variable 
formula to the transformation normal e Superscript u upper XeuX, since we must ensure that normal e Superscript u upper X Baseline element of upper L Superscript 1euX ∈L1 depending 
on the values u element of double struck upper Ru ∈R. Indeed, normal e Superscript u upper XeuX is nonnegative and its expectation always exists, 
although it may be normal infinity∞. For the ﬁniteness we must impose sans serif upper E left parenthesis normal e Superscript u upper X Baseline right parenthesis less than normal infinityE(euX) < ∞for u less than deltau < δ, 
and delta greater than 0δ > 0. If  X is itself nonnegative, then the ﬁniteness of its MGF holds for all 
u less than or slanted equals 0u ⩽0, since normal e Superscript u upper XeuX is bounded and upper M Subscript upper X Baseline left parenthesis negative u right parenthesisMX(−u) does exist and is called the Laplace 
transform of upper F Subscript upper XFX, or of  X. Using the Taylor series expansion of normal e Superscript u xeux around zero and 
using the linearity of expectation we have: 
upper M Subscript upper X Baseline left parenthesis u right parenthesis equals sans serif upper E left parenthesis sigma summation Underscript p equals 0 Overscript normal infinity Endscripts StartFraction left parenthesis u upper X right parenthesis Superscript p Baseline Over p factorial EndFraction right parenthesis equals sigma summation Underscript p equals 0 Overscript normal infinity Endscripts StartFraction u Superscript p Baseline Over p factorial EndFraction sans serif upper E left parenthesis upper X Superscript p Baseline right parenthesis periodMX(u) = E
⎛
⎝
∞
⎲
p=0
(uX)p
p!
⎞
⎠=
∞
⎲
p=0
up
p! E(Xp).
Appendix
233
see for example [2]. Indeed, if upper M Subscript upper X Baseline left parenthesis u right parenthesisMX(u) exists we may apply recursively Theorem 8.13 
and get left parenthesis StartFraction normal d Over normal d u EndFraction right parenthesis Superscript p Baseline upper M Subscript upper X Baseline left parenthesis u right parenthesis equals sans serif upper E left parenthesis left parenthesis StartFraction partial differential Over partial differential u EndFraction right parenthesis Superscript p Baseline normal e Superscript u upper X Baseline right parenthesis equals sans serif upper E left parenthesis upper X Superscript p Baseline normal e Superscript u upper X Baseline right parenthesis
( d
du
)pMX(u) = E
(( ∂
∂u
)peuX)
= E(XpeuX) and set u equals 0u = 0. There is a 
version of MGF for random vectors. 
Theorem 8.14 Let bold upper X comma bold upper YX, Y be n-dimensional random vectors with MGFs upper M Subscript bold upper XMX and 
upper M Subscript bold upper YMY. 
(i) If bold upper AA is an m times nm × n matrix with real entries and bold b element of double struck upper R Superscript mb ∈Rm, then 
upper M Subscript bold upper A bold upper X Sub Superscript prime Subscript plus bold b Baseline left parenthesis bold u right parenthesis equals normal e Superscript bold u dot bold b Baseline upper M Subscript bold upper X Baseline left parenthesis bold upper A bold upper X Superscript prime Baseline right parenthesis commaMAX'+b(u) = eu·bMX(AX'),
for bold u element of double struck upper R Superscript mu ∈Rm s.t. double vertical bar bold u double vertical bar less than delta‖u‖ < δ, with delta greater than 0δ > 0 depending on bold upper AA. 
(ii) .X d= Y if and only if there exists some delta greater than 0δ > 0 such that upper M Subscript bold upper X Baseline left parenthesis bold u right parenthesisMX(u) equals upper M Subscript bold upper Y Baseline left parenthesis bold u right parenthesis commaMY(u),
for all bold u element of double struck upper R Superscript nu ∈Rn with double vertical bar bold u double vertical bar less than delta period‖u‖ < δ.
Property (ii) of Theorem 8.14 specializes to the one-dimensional case n equals 1 comman = 1, but 
indeed it requires that the two rvs have ﬁnite moments of all orders that do not grow 
too fast, or equivalently it is required that sans serif upper P Subscript upper XPX has tails of exponential order 
sans serif upper P left parenthesis StartAbsoluteValue upper X EndAbsoluteValue greater than x right parenthesis less than or slanted equals upper M normal e Superscript minus alpha x Baseline commaP(|X| > x) ⩽Me−αx,
for upper M comma alpha greater than 0M, α > 0, see [2]. Recall that double vertical bar bold x double vertical bar equals StartRoot sigma summation Underscript i equals 1 Overscript n Endscripts x Subscript i Superscript 2 Baseline EndRoot‖x‖ =
/∑n
i=1 x2
i for vectors bold x equals left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesisx = (x1, . . . , xn), 
considered as row vectors for which a prime prime' denotes transposition. Also we used 
the dot product between two vectors in double struck upper R Subscript nRn, i.e., bold x dot bold y equals sigma summation Underscript i equals 1 Overscript n Endscripts x Subscript i Baseline y Subscript ix · y = ∑n
i=1 xiyi. For two rvs upper X comma upper YX, Y
taken from a bi-variate random vector bold upper X equals left parenthesis upper X comma upper Y right parenthesis commaX = (X, Y), their joint MGF is 
upper M Subscript bold upper X Baseline left parenthesis bold u right parenthesis equals sans serif upper E left parenthesis normal e Superscript u 1 upper X plus u 2 upper Y Baseline right parenthesis equals double integral normal e Superscript u 1 x plus u 2 y Baseline normal d upper F Subscript bold upper X Baseline left parenthesis x comma y right parenthesis commaMX(u) = E(eu1X+u2Y ) =
⎨⎨
eu1x+u2ydFX(x, y),
where bold u equals u 1 comma u 2u = u1, u2. It specializes to the case of a continuous bi-variate random vector 
with a joint density, replacing normal d upper F Subscript bold upper X Baseline left parenthesis x comma y right parenthesisdFX(x, y) with f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis normal d x normal d yfX(x, y)dxdy. The  joint moment 
sans serif upper E left parenthesis upper X Superscript n Baseline upper Y Superscript m Baseline right parenthesisE(XnY m) can be recovered by the joint MGF as 
sans serif upper E left parenthesis upper X Superscript n Baseline upper Y Superscript m Baseline right parenthesis equals StartFraction partial differential Superscript n plus m Baseline Over partial differential Superscript n Baseline u Subscript i Baseline partial differential Superscript m Baseline u 2 EndFraction upper M Subscript bold upper X Baseline left parenthesis u 1 comma u 2 right parenthesis vertical bar Subscript u 1 equals u 2 equals 0 Baseline periodE(XnY m) =
∂n+m
∂nui∂mu2
MX(u1, u2)
|||
u1=u2=0.
Whatever the joint MGF does not exists, we can obtain the joint CHF in Theo-
rem 8.14 by formally replacing bold uu with i bold uiu and dropping the proviso double vertical bar bold u double vertical bar less than delta‖u‖ < δ in part 
(ii). In the bi-variate case bold upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y) we can write: 
phi Subscript bold upper X Baseline left parenthesis bold u right parenthesis equals sans serif upper E left parenthesis normal e Superscript normal i u 1 upper X plus normal i u 2 upper Y Baseline right parenthesis equals double integral normal e Superscript normal i u 1 x plus normal i u 2 y Baseline normal d upper F Subscript bold upper X Baseline left parenthesis x comma y right parenthesis commaφX(u) = E(eiu1X+iu2Y ) =
⎨⎨
eiu1x+iu2ydFX(x, y),
and we can recover the marginal CHFs as 
phi Subscript upper X Baseline left parenthesis u 1 right parenthesis equals phi Subscript bold upper X Baseline left parenthesis u 1 comma 0 right parenthesis comma phi Subscript upper Y Baseline left parenthesis u 2 right parenthesis equals phi Subscript bold upper X Baseline left parenthesis 0 comma u 2 right parenthesis periodφX(u1) = φX(u1, 0),
φY (u2) = φX(0, u2).
234
8
Convergence Concepts
Proof of Theorem 8.8 
Proof Let φXi (u) be the CHF of each term in the sequence. Thanks to the 
hypotheses we have that φXi (u) is differentiable at least once at u = 0, then 
d 
du φXi (u)
||
u=0 = iμ. Using the Taylor series expansion (8.5), we can write φXi (u) = 
1 + iμu + o(t). Thus, the CHF of the sample mean is 
phi Subscript upper Y overbar Sub Subscript n Subscript Baseline left parenthesis u right parenthesis equals left parenthesis phi Subscript upper Y Sub Subscript i Subscript Baseline left parenthesis t divided by n right parenthesis right parenthesis Superscript n Baseline equals left parenthesis 1 plus StartFraction normal i mu u Over n EndFraction plus o left parenthesis n Superscript negative 1 Baseline right parenthesis right parenthesis Superscript n Baseline commaφ ¯Yn(u) = (φYi(t/n))n =
⎛
1 + iμu
n
+ o(n−1)
⎞n
,
where f (n)  = o(n−1) means that lim 
n→∞ nf (n) = 0. As byproduct, the limit of the 
latter expression, as n →∞, is eiμu which together with the Levy’s Continuity 
Theorem 8.5 entails the result. 
█
Proof of Theorem 8.11 
We present a short proof based on [15, Th 19.1]. 
Proof Let double vertical bar double struck upper F Subscript n Baseline minus upper F Subscript upper X Baseline double vertical bar Subscript normal infinity Baseline colon equals sup Underscript x Endscripts StartAbsoluteValue double struck upper F Subscript n Baseline left parenthesis omega comma x right parenthesis minus upper F Subscript upper X Baseline left parenthesis x right parenthesis EndAbsoluteValue‖Fn −FX‖∞:= supx |Fn(ω, x) −FX(x)|. By SLLN, Theorem 8.7, we  
have double struck upper F Subscript n Baseline left parenthesis omega comma x right parenthesis right arrow Overscript a period s period Endscripts upper F Subscript upper X Baseline left parenthesis x right parenthesisFn(ω, x)
a.s.
−−→FX(x) at all x element of double struck upper Rx ∈R. A.s. convergence holds also for left-limits, 
i.e., double struck upper F Subscript n Baseline left parenthesis omega comma x minus right parenthesis right arrow Overscript a period s period Endscripts upper F Subscript upper X Baseline left parenthesis x minus right parenthesisFn(ω, x−)
a.s.
−−→FX(x−). Take epsilon greater than 0ϵ > 0 and partition points negative normal infinity equals x 0 less than x 1 less than midline horizontal ellipsis less than x Subscript k Baseline equals normal infinity−∞= x0 < x1 <
· · · < xk = ∞of double struck upper RR, s.t. the left-limit of upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x) at any x Subscript ixi does not exceed the right-
limit at x Subscript i minus 1xi−1 more than epsilonϵ, i.e., upper F Subscript upper X Baseline left parenthesis x Subscript i Baseline minus right parenthesis minus upper F Subscript upper X Baseline left parenthesis x Subscript i minus 1 Baseline right parenthesis less than epsilonFX(xi−) −FX(xi−1) < ϵ, for all i equals 0 comma 1 comma ellipsis comma ki = 0, 1, . . . , k. 
As byproduct, for x element of left bracket x Subscript i minus 1 Baseline comma x Subscript i Baseline right parenthesisx ∈[xi−1, xi) we can take StartAbsoluteValue double struck upper F Subscript n Baseline left parenthesis omega comma x right parenthesis minus upper F Subscript upper X Baseline left parenthesis x right parenthesis EndAbsoluteValue|Fn(ω, x) −FX(x)| within the closed 
interval 
left bracket double struck upper F Subscript n Baseline left parenthesis omega comma x Subscript i minus 1 Baseline right parenthesis minus upper F Subscript upper X Baseline left parenthesis x Subscript i minus 1 Baseline right parenthesis minus epsilon comma double struck upper F Subscript n Baseline left parenthesis omega comma x Subscript i Baseline minus right parenthesis minus upper F Subscript upper X Baseline left parenthesis x Subscript i Baseline minus right parenthesis plus epsilon right bracket period[Fn(ω, xi−1) −FX(xi−1) −ϵ, Fn(ω, xi−) −FX(xi−) + ϵ] .
Hence, the convergence of double struck upper F Subscript n Baseline left parenthesis omega comma x right parenthesisFn(ω, x) and double struck upper F Subscript n Baseline left parenthesis omega comma x minus right parenthesisFn(ω, x−) is uniform for x element of StartSet x 1 comma ellipsis comma x Subscript k Baseline EndSetx ∈{x1, . . . , xk}, 
then we conclude that limit sup double vertical bar double struck upper F Subscript n Baseline minus upper F Subscript upper X Baseline double vertical bar Subscript normal infinity Baseline less than or slanted equals epsilonlim sup‖Fn−FX‖∞⩽ϵ, a.s., for all epsilonϵ and double vertical bar double struck upper F Subscript n Baseline minus upper F Subscript upper X Baseline double vertical bar Subscript normal infinity Baseline right arrow Overscript a period s period Endscripts 0‖Fn−FX‖∞
a.s.
−−→
0 as desired. 
█
Further Details on Lp Spaces 
The collection script upper L Superscript 0L0 of all rvs deﬁned over the same probability space has subspaces 
script upper L Superscript pLp where sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline right parenthesis less than normal infinityE(|X|p) < ∞, for 1 less than or slanted equals p less than normal infinity1 ⩽p < ∞, see Sect. 4.6, Chap. 4. In fact, upper L Superscript pLp is the
Appendix
235
quotient space of script upper L Superscript pLp with respect to the equivalence relation26 upper X script upper R upper YXRY iff upper X equals Overscript a period s period Endscripts upper YX a.s.
= Y, for  
all upper X comma upper Y element of script upper L Superscript pX, Y ∈Lp, see Exercise 8.7. Hence, double vertical bar upper X double vertical bar Subscript p Baseline colon equals left parenthesis sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline right parenthesis right parenthesis Superscript 1 divided by p‖X‖p := (E(|X|p))1/p is ﬁnite whenever 
upper X element of script upper L Superscript pX ∈Lp, and we can deﬁne double vertical bar upper X minus upper Y double vertical bar Subscript p‖X −Y‖p as a pseudo-metric on script upper L Superscript pLp which turn to be a  
metric if we restrict ourselves to the quotient space upper L Superscript pLp. It is worth noting that double vertical bar upper X double vertical bar Subscript p‖X‖p
is a norm on upper L Superscript pLp, see Appendix G, since:
•
.‖X‖p = 0 iff upper X equals 0X = 0, for upper X element of upper L Superscript pX ∈Lp;
•
.‖X + Y‖p ⩽‖X‖p + ‖Y‖p, by Minkowski’s inequality, see Theorem 4.5, 
Sect. 4.6, for upper X comma upper Y element of upper L Superscript pX, Y ∈Lp;
•
.‖λX‖p = |λ|‖X‖p, for lamda element of double struck upper Rλ ∈R and upper X element of upper L Superscript pX ∈Lp. 
Remark 8.5 The ﬁrst item should be written double vertical bar upper X double vertical bar Subscript p Baseline equals 0‖X‖p = 0 then upper X equals 0X = 0 for upper X element of script upper L Superscript pX ∈Lp, 
whenever upper X equals Overscript a period s period Endscripts 0X a.s.
= 0. This is ruled out passing to the quotient space, and considering 
equivalence classes of rvs which are equal sans serif upper PP-a.s. 
Therefore, this norm induces the metric d left parenthesis upper X comma upper Y right parenthesis equals double vertical bar upper X minus upper Y double vertical bar Subscript pd(X, Y) = ‖X −Y‖p which drives 
convergence in upper L Superscript pLp spaces. For a sequence left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N Baseline subset of upper L Superscript p(Xn)n∈N ⊂Lp and a rv upper X element of upper L Superscript pX ∈Lp it holds: 
upper X Subscript n Baseline right arrow Overscript upper L Superscript p Baseline Endscripts upper X long right double arrow upper X Subscript n Baseline right arrow Overscript upper L Superscript q Baseline Endscripts upper X comma for every 1 less than or slanted equals q less than or slanted equals p periodXn
Lp
−−→X =⇒Xn
Lq
−−→X,
for every 1 ⩽q ⩽p.
This is a consequence of the (Lyapunov’s) inequality double vertical bar upper X minus upper Y double vertical bar Subscript q Baseline less than or slanted equals double vertical bar upper X minus upper Y double vertical bar Subscript p‖X−Y‖q ⩽‖X−Y‖p, which 
in turn is due to the Hölder’s inequality, see Theorem 4.4, Sect. 4.6, by setting upper Y equals 1Y = 1
and replacing p with StartFraction p Over q EndFractionp
q in such a way sans serif upper E left parenthesis left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript q Baseline right parenthesis right parenthesis Superscript 1 divided by q Baseline less than or slanted equals sans serif upper E left parenthesis left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript p Baseline right parenthesis right parenthesis Superscript 1 divided by pE((|X|q))1/q ⩽E((|X|p))1/p. Clearly upper L Superscript pLp
convergence implies convergence in probability since upper X Subscript n Baseline right arrow Overscript upper L Superscript p Baseline Endscripts upper XXn
Lp
−−→X yields upper X Subscript n Baseline right arrow Overscript upper L Superscript 1 Baseline Endscripts upper XXn
L1
−−→X
and this in turn gives upper X Subscript n Baseline right arrow Overscript sans serif upper P Endscripts upper XXn
P
−→X by Theorem 8.1. A special subspace is upper L squaredL2, which is 
endowed with the inner product 
left angle bracket upper X comma upper Y right angle bracket colon equals sans serif upper E left parenthesis upper X upper Y right parenthesis comma for all upper X comma upper Y element of upper L squared period〈X, Y〉:= E(XY),
for all X, Y ∈L2.
This is well deﬁned since by the Cauchy-Schwarz inequality in Theorem 4.3 we 
have 
StartAbsoluteValue sans serif upper E left parenthesis upper X upper Y right parenthesis EndAbsoluteValue less than or slanted equals left parenthesis sans serif upper E left parenthesis upper X squared right parenthesis right parenthesis Superscript 1 divided by 2 Baseline left parenthesis sans serif upper E left parenthesis upper Y squared right parenthesis right parenthesis Superscript 1 divided by 2 Baseline less than normal infinity comma|E(XY)| ⩽(E(X2))1/2(E(Y 2))1/2 < ∞,
for upper X comma upper Y element of upper L squaredX, Y ∈L2. Note that left angle bracket upper X comma upper Y right angle bracket greater than or slanted equals 0〈X, Y〉⩾0 and equality occurs27 iff upper X equals 0X = 0. Observe that 
the inner product is bilinear, i.e., linear in each component,28 
left angle bracket a upper X plus b upper Z comma upper Y right angle bracket equals a left angle bracket upper X comma upper Z right angle bracket plus b left angle bracket upper Z comma upper Y right angle bracket〈aX + bZ, Y〉= a〈X, Z〉+ b〈Z, Y〉
26 script upper RR is reﬂexive, symmetric and transitive. 
27 We have that left angle bracket upper X comma upper Y right angle bracket equals 0〈X, Y〉= 0 is equivalent to upper X equals Overscript a period s period Endscripts 0X a.s.
= 0 which implies upper X equals 0X = 0 when the quotient space 
upper L squaredL2 replaces script upper L squaredL2. 
28 Recall that upper L squaredL2 is indeed a vector space. 
236
8
Convergence Concepts
and 
left angle bracket upper X comma a upper Y plus b upper Z right angle bracket equals a left angle bracket upper X comma upper Y right angle bracket plus b left angle bracket upper X comma upper Z right angle bracket period〈X, aY + bZ〉= a〈X, Y〉+ b〈X, Z〉.
The inner product and the norm are connected by left angle bracket upper X comma upper X right angle bracket Superscript 1 divided by 2 Baseline equals double vertical bar upper X double vertical bar Subscript 2〈X, X〉1/2 = ‖X‖2, and this turns 
upper L squaredL2 to be a normed space. It can be showed that Cauchy sequences left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N Baseline subset of upper L squared(Xn)n∈N ⊂L2
converge to a limit rv upper X element of upper L squaredX ∈L2, which means that the latter is an Hilbert space.29 Two 
rvs upper X comma upper Y element of upper L squaredX, Y ∈L2 are said to be orthogonal if left angle bracket upper X comma upper Y right angle bracket equals 0〈X, Y〉= 0 and in this case double vertical bar upper X plus upper Y double vertical bar Subscript 2 Superscript 2 Baseline equals double vertical bar upper X double vertical bar Subscript 2 Superscript 2 Baseline plus double vertical bar upper Y double vertical bar Subscript 2 Superscript 2‖X + Y‖2
2 =
‖X‖2
2 + ‖Y‖2
2, i.e., sans serif upper E left parenthesis left parenthesis upper X plus upper Y right parenthesis squared right parenthesis equals sans serif upper E left parenthesis upper X squared right parenthesis plus sans serif upper E left parenthesis upper Y squared right parenthesisE((X + Y)2) = E(X2) + E(Y 2). The important feature of upper L squaredL2 as 
an Hilbert space is that we can always ﬁnd the projection of upper X element of upper L squaredX ∈L2 as the unique 
upper Y element of upper L squaredY ∈L2 s.t. the latter is closest to X, see [8, Ch 22] for a brief yet complete review 
of all these concepts. 
Remark 8.6 Convergence in upper L Superscript 0L0 spaces cannot be expressed by the norm 
double vertical bar dot double vertical bar Subscript p‖ · ‖p used in smaller upper L Superscript pLp spaces. Apart convergence in distribution, upper L Superscript 0L0 can be 
metrized by d left parenthesis upper X comma upper Y right parenthesis equals sans serif upper E left parenthesis StartFraction StartAbsoluteValue upper X minus upper Y EndAbsoluteValue Over 1 plus StartAbsoluteValue upper X minus upper Y EndAbsoluteValue EndFraction right parenthesisd(X, Y) = E
⎛
|X−Y|
1+|X−Y|
⎞
. Thus, we can write upper X Subscript n Baseline right arrow upper XXn →X in upper L Superscript 0L0 iff 
limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis StartFraction StartAbsoluteValue upper X Subscript n Baseline minus upper X EndAbsoluteValue Over 1 plus StartAbsoluteValue upper X Subscript n Baseline minus upper X EndAbsoluteValue EndFraction right parenthesis equals 0 lim
n→∞E
⎛
|Xn −X|
1 + |Xn −X|
⎞
= 0, for every left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N Baseline subset of upper L Superscript 0(Xn)n∈N ⊂L0 and upper X element of upper L Superscript 0X ∈L0. This turns to 
be equivalent to convergence in probability, see [8, Th 17.1]. A further equivalent 
metric is d left parenthesis upper X comma upper Y right parenthesis equals sans serif upper E left parenthesis min left brace 1 comma StartAbsoluteValue upper X minus upper Y EndAbsoluteValue right brace right parenthesisd(X, Y) = E(min{1, |X −Y|}).
29 Cauchy sequences of rvs in upper L squaredL2 are s.t. double vertical bar upper X Subscript n Baseline minus upper X Subscript m Baseline double vertical bar Subscript 2 Baseline right arrow 0‖Xn −Xm‖2 →0 as n comma m right arrow normal infinityn, m →∞. The fact that for such 
sequences it holds upper X Subscript n Baseline right arrow Overscript ms Endscripts upper XXn
ms
−−→X and upper X element of upper L squaredX ∈L2 is called completeness of upper L squaredL2. 
Chapter 9 
Introduction to Stochastic Processes 
9.1 
Deﬁnition and Preliminary Classiﬁcation 
Any collection of observations x Subscript t Baseline element of double struck upper Rxt ∈R recorded at ﬁxed times t is called a times 
series. For example, x Subscript txt may represent a stock price at end of the day t or a log-return. 
In this case the time series is indexed by discrete time indices and we can call it 
historical prices or returns. Since nowadays electronic trading is almost continuous 
in time, we can have a continuous-time series over some time interval left bracket 0 comma upper T right bracket[0, T ]. Our  
aim is to build a model to describe the time evolution of such quantities in the future, 
trying to ﬁt some probabilistic framework to the past behavior of a time series. From 
now on, we assume left parenthesis upper Omega comma script upper F comma sans serif upper P right parenthesis(Ω, F, P) is a ﬁxed probability space. 
Deﬁnition 9.1 A stochastic process denoted by upper X equals left parenthesis upper X Subscript t Baseline right parenthesis Subscript t element of upper IX = (Xt)t∈I, or upper X equals StartSet upper X Subscript t Baseline vertical bar t element of upper I EndSetX = {Xt | t ∈I}, 
is an indexed family of rvs where upper I not equals empty setI /= ∅is the index set. 
Equivalently, a stochastic process can be thought of as a function of two variables 
upper X colon upper I times upper Omega right arrow double struck upper R commaX : I × Ω →R, where upper X left parenthesis dot comma omega right parenthesisX(·, ω) is a rv for each t and upper X left parenthesis t comma dot right parenthesisX(t, ·) is a function called 
sample path of trajectory, that maps each scenario omega element of upper Omegaω ∈Ω into a curve in the space 
upper I times double struck upper RI × R. When upper I equals left bracket 0 comma normal infinity right parenthesisI = [0, ∞), a sample path is the graph of a function in the Cartesian 
plane with abscissa t greater than or slanted equals 0 periodt ⩾0. Usually t is understood as ‘time’, whence a stochastic 
process is a model of the random evolution of a system in time, e.g. left parenthesis upper S Subscript t Baseline right parenthesis Subscript t greater than or slanted equals 0(St)t⩾0 is 
referred to a stock price process, left parenthesis upper R Subscript t Baseline right parenthesis Subscript t greater than or slanted equals 0(Rt)t⩾0 is referred to a log-return process, and so 
on, see Fig. 9.1. The  value upper X Subscript tXt is the state of the process at time t, then the state space 
is the set of all upper X Subscript tXt. When the time is indexed by left bracket 0 comma normal infinity right parenthesis[0, ∞) we have a continuous-time 
stochastic process, while for upper I equals double struck upper NI = N we have a discrete-time stochastic process. 
The law of each rv upper X Subscript tXt is called the unconditional distribution, see Fig. 9.2. Each 
upper X Subscript tXt can be discrete, (absolutely) continuous or mixed. We are also interested in the 
conditional distribution, e.g. sans serif upper P left parenthesis upper X Subscript t Baseline less than or slanted equals x vertical bar upper X Subscript s Baseline less than or slanted equals y right parenthesisP(Xt ⩽x | Xs ⩽y), for times 0 less than or slanted equals s less than t0 ⩽s < t. 
We can ask ourselves how a process X could be at some point in time t greater than 0t > 0
compared to its past history at 0 less than or slanted equals s less than t period0 ⩽s < t. We endow left parenthesis upper Omega comma script upper F right parenthesis(Ω, F) with an increasing 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4_9
237
238
9
Introduction to Stochastic Processes
Fig. 9.1 Three trajectories of 
a process X as graphs of 
functions in t element of left bracket 0 comma upper T right bracket ∈[0, T ]
Fig. 9.2 One unconditional 
continuous distribution at 
time t 
collection left brace script upper F Subscript t Baseline right brace Subscript t greater than or slanted equals 0{Ft}t⩾0 of sub-sigma-algebras of script upper FF, 
script upper F 0 subset of midline horizontal ellipsis subset of script upper F Subscript s Baseline subset of script upper F Subscript t Baseline subset of midline horizontal ellipsis subset of script upper F for all s less than t commaF0 ⊂· · · ⊂Fs ⊂Ft ⊂· · · ⊂F
for all s < t,
called ﬁltration.1 The quadruple left parenthesis upper Omega comma script upper F comma StartSet script upper F Subscript t Baseline EndSet comma sans serif upper P right parenthesis(Ω, F, {Ft}, P) is said to be a ﬁltered probability 
space. We interpret StartSet script upper F Subscript t Baseline EndSet{Ft} as a ﬂow of information that elapses in time. We can set 
script upper F Subscript t Baseline equals sigma left parenthesis upper X Subscript s Baseline comma s less than or slanted equals t right parenthesisFt = σ(Xs, s ⩽t), meant to be the smallest sigma hyphen algebraσ-algebra containing events left brace upper X Subscript t Baseline element of upper B right brace{Xt ∈B}
for all t element of left bracket 0 comma normal infinity right parenthesist ∈[0, ∞) and all suitable sets upper B subset of double struck upper RB ⊂R. This is the sigma hyphen algebraσ-algebra generated by 
the process upper X commaX, called the natural ﬁltration, such that upper X Subscript tXts are script upper F Subscript tFt-measurable for all 
t periodt. X is adapted to the ﬁltration StartSet script upper F Subscript t Baseline EndSet{Ft} if upper X Subscript tXt is script upper F Subscript tFt-measurable rv each t; X is clearly 
adapted to its natural ﬁltration. To verify that A is in script upper F Subscript tFt one should observes the 
value x equals upper X Subscript t Baseline left parenthesis omega right parenthesisx = Xt(ω) instead of omega commaω, i.e. script upper F Subscript tFt contains all the information about upper X Subscript t Baseline periodXt.
Example 9.1 Consider the random experiment of observing the exchange rate 
Yen/Euro in the next nine days. We can model this quantity through a stochastic 
process upper X equals left parenthesis upper X Subscript t Baseline right parenthesis Subscript 0 less than or slanted equals t less than or slanted equals 9X = (Xt)0⩽t⩽9 with respect to its natural ﬁltration. If we know that 
upper X Subscript t Baseline equals 150Xt = 150 at some t element of left bracket 0 comma 9 right brackett ∈[0, 9] we can decide if upper A equals left brace upper X Subscript t Baseline less than or slanted equals 150 right braceA = {Xt ⩽150} is occurred, for 
upper A element of sigma left parenthesis upper X Subscript s Baseline comma s less than or slanted equals 9 right parenthesis periodA ∈σ(Xs, s ⩽9).
Remark 9.1 We always have sigma left parenthesis upper X Subscript s Baseline right parenthesis subset of sigma left parenthesis upper X Subscript s Baseline comma s less than or slanted equals t right parenthesisσ(Xs) ⊂σ(Xs, s ⩽t), since sigma left parenthesis upper X Subscript s Baseline right parenthesisσ(Xs) contains only 
information on the values of the process at time s greater than or slanted equals 0s ⩾0, given by the rv upper X Subscript sXs.
1 It is required that script upper F 0F0 contains all impossible events. 
9.2
Filtration and Distribution of a Process
239
Remark 9.2 For a process upper X equals left parenthesis upper X Subscript t Baseline right parenthesis Subscript t greater than or slanted equals 0X = (Xt)t⩾0 its generated sigma hyphen algebraσ-algebras can be collected 
together by varying t as follows: 
sigma left parenthesis upper X right parenthesis colon equals sigma left parenthesis union Subscript t element of left bracket 0 comma normal infinity right parenthesis Baseline left brace upper X Subscript t Baseline element of upper B right brace right parenthesis equals sigma left parenthesis upper X Subscript t Baseline element of upper B comma t greater than or slanted equals 0 comma upper B subset of double struck upper R right parenthesis commaσ(X) := σ
(
∪t∈[0,∞){Xt ∈B}
)
= σ (Xt ∈B, t ⩾0, B ⊂R) ,
where B are suitable subsets of reals (actually Borel sets, i.e. upper B element of script upper BB ∈B). This is 
the smallest sigma hyphen algebraσ-algebra that makes all upper X Subscript tXt’s true rvs (i.e. simultaneously measurable 
functions) and is equivalently generated by sets of the form 
StartSet omega element of upper Omega vertical bar left parenthesis upper X Subscript t 1 Baseline left parenthesis omega right parenthesis comma ellipsis comma upper X Subscript t Sub Subscript n Subscript Baseline left parenthesis omega right parenthesis right parenthesis element of upper B EndSet comma upper B subset of double struck upper R Superscript n Baseline comma t Subscript i Baseline element of left bracket 0 comma normal infinity right parenthesis comma distinct comma i element of double struck upper N comma{ω ∈Ω | (Xt1(ω), . . . , Xtn(ω)) ∈B},
B ⊂Rn,
ti ∈[0, ∞), distinct,
i ∈N,
where left parenthesis upper X Subscript t 1 Baseline comma ellipsis comma upper X Subscript t Sub Subscript n Subscript Baseline right parenthesis(Xt1, . . . , Xtn) is a random vector collecting a ﬁnite number of rvs from X. 
These sets are sometimes called cylinder sets. Here the suitable upper B subset of double struck upper R Superscript nB ⊂Rn are as usual 
Borel sets, picked from the n-dimensional Borel sigma hyphen algebra script upper B Superscript nσ-algebra Bn, which is generated 
by Cartesian products upper B equals upper B 1 times midline horizontal ellipsis times upper B Subscript nB = B1 × · · · × Bn, referred to as measurable rectangles, 
where upper B Subscript i Baseline element of script upper BBi ∈B each i is a Borel set. 
9.2 
Filtration and Distribution of a Process 
The probability distribution of a process upper X equals left parenthesis upper X Subscript t Baseline right parenthesis Subscript t greater than or slanted equals 0X = (Xt)t⩾0 requires the knowledge of 
probabilities sans serif upper P left parenthesis upper X element of upper B overTilde right parenthesisP(X ∈˜B) for some set upper B overTilde˜B belonging to the collection 
double struck upper R Superscript left bracket 0 comma normal infinity right parenthesis Baseline equals left brace omega left parenthesis t right parenthesis vertical bar omega colon left bracket 0 comma normal infinity right parenthesis right arrow double struck upper R right braceR[0,∞) = {ω(t) | ω : [0, ∞) →R}
(9.1) 
of all functions omega left parenthesis t right parenthesisω(t) from the index set left bracket 0 comma normal infinity right parenthesis[0, ∞) to double struck upper R periodR. The symbol omegaω better describes 
the association of a trajectory to each point in the sample space upper OmegaΩ. Things are easier 
if we are legitimate to use the FIDIS, see (3.18) in Sect. 3.5, Chap. 3: 
sans serif upper P Subscript t 1 comma ellipsis comma t Sub Subscript n Subscript Baseline left parenthesis upper B right parenthesis equals sans serif upper P left parenthesis left parenthesis upper X Subscript t 1 Baseline comma ellipsis comma upper X Subscript t Sub Subscript n Subscript Baseline right parenthesis element of upper B right parenthesis comma upper B subset of double struck upper R Superscript nPt1,...,tn(B) = P
(
(Xt1, . . . , Xtn) ∈B
)
,
B ⊂Rn
(9.2) 
with respect to the random vector bold upper X equals left parenthesis upper X Subscript t 1 Baseline comma ellipsis comma upper X Subscript t Sub Subscript n Subscript Baseline right parenthesisX = (Xt1, . . . , Xtn) and all choices of distinct 
time indexes t 1 comma ellipsis comma t Subscript n Baselinet1, . . . , tn. Note that this random vector is a subset of the stochastic 
process, containing only a ﬁnite number of its component rvs, thus any FIDIS 
expresses the joint probability at ﬁnite points in time when the process is represented 
by events StartSet upper X Subscript t 1 Baseline element of upper B 1 comma ellipsis comma upper X Subscript t Sub Subscript n Subscript Baseline element of upper B Subscript n Baseline EndSet{Xt1 ∈B1, . . . , Xtn ∈Bn} provided that further upper B equals upper B 1 times midline horizontal ellipsis times upper B Subscript nB = B1 × · · · × Bn. 
Remark 9.3 For a discrete-times process the probability law is based on a count-
able collection upper X equals left parenthesis upper X 1 comma upper X 2 comma ellipsis right parenthesisX = (X1, X2, . . .) of rvs. Thus we can ﬁgure out its joint distribution 
as sans serif upper P left parenthesis upper X 1 element of upper B 1 comma upper X 2 element of upper B 2 comma ellipsis right parenthesisP(X1 ∈B1, X2 ∈B2, . . .), using the joint event intersection Subscript t equals 1 Superscript normal infinity Baseline left brace upper X Subscript t Baseline element of upper B Subscript t Baseline right brace∩∞
t=1{Xt ∈Bt} which belongs to 
script upper FF since it is made of a countable intersection of events, provided that left brace upper X Subscript t Baseline element of upper B Subscript t Baseline right brace element of script upper F Subscript t{Xt ∈Bt} ∈Ft
for each time t. Problems arise when X is a continuous-time process, since it is 
no more a countable collection of rvs. For example, the uncountable intersection 
upper A equals intersection Subscript t greater than or slanted equals 0 Baseline left brace upper X Subscript t Baseline element of upper B Subscript t Baseline right braceA = ∩t⩾0{Xt ∈Bt} is an event but it is no necessarily true that upper A element of script upper FA ∈F, and then to 
some script upper F Subscript tFt.
240
9
Introduction to Stochastic Processes
We say that FIDIS of X are consistent if 
sans serif upper P Subscript t 1 comma ellipsis comma t Sub Subscript n Subscript Baseline left parenthesis upper B 1 times midline horizontal ellipsis times upper B Subscript n minus 1 Baseline times double struck upper R right parenthesis equals sans serif upper P Subscript t 1 comma ellipsis comma t Sub Subscript n minus 1 Subscript Baseline left parenthesis upper B 1 times midline horizontal ellipsis times upper B Subscript n minus 1 Baseline right parenthesis commaPt1,...,tn(B1 × · · · × Bn−1 × R) = Pt1,...,tn−1(B1 × · · · × Bn−1),
for any choice of distinct times t 1 comma ellipsis comma t Subscript n Baselinet1, . . . , tn and n element of double struck upper Nn ∈N. The probability that 
left parenthesis upper X Subscript t 1 Baseline comma ellipsis comma upper X Subscript t Sub Subscript n minus 1 Subscript Baseline right parenthesis(Xt1, . . . , Xtn−1) takes values on the rectangle upper B 1 times midline horizontal ellipsis times upper B Subscript n minus 1B1 × · · · × Bn−1 can be obtained 
by that of left parenthesis upper X Subscript t 1 Baseline comma ellipsis comma upper X Subscript t Sub Subscript n minus 1 Subscript Baseline comma upper X Subscript t Sub Subscript n Subscript Baseline right parenthesis(Xt1, . . . , Xtn−1, Xtn) by varying the nth coordinate upper X Subscript t Sub Subscript nXtn anywhere in double struck upper R commaR,
so that it does not matter at all. FIDIS can be equivalently deﬁned via the joint 
distribution functions 
upper F Subscript t 1 comma ellipsis comma t Sub Subscript n Subscript Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis equals sans serif upper P left parenthesis upper X Subscript t 1 Baseline less than or slanted equals x 1 comma ellipsis upper X Subscript t Sub Subscript n Subscript Baseline less than or slanted equals x Subscript n Baseline right parenthesis commaFt1,...,tn(x1, . . . , xn) = P(Xt1 ⩽x1, . . . Xtn ⩽xn),
for any choice of time indexes t Subscript iti. Then FIDIS are collections 
StartSet upper F Subscript bold t Baseline left parenthesis dot right parenthesis vertical bar bold t subset of upper I EndSet colon equals StartSet upper F Subscript t 1 comma ellipsis comma t Sub Subscript n Subscript Baseline left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis vertical bar all left parenthesis t 1 comma ellipsis comma t Subscript n Baseline right parenthesis subset of upper I EndSet
{
Ft( · ) | t ⊂I
}
:=
{
Ft1,...,tn(x1, . . . , xn) | all (t1, . . . , tn) ⊂I
}
with left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis equals bold x element of double struck upper R Superscript n(x1, . . . , xn) = x ∈Rn. We present a simpliﬁed version of a key result about 
existence of a stochastic process with prescribed FIDIS. 
Theorem 9.1 (Kolmogorov’s Theorem) 
The FIDIS StartSet upper F Subscript bold italic t Baseline left parenthesis dot right parenthesis vertical bar bold italic t subset of upper I EndSet
{
Ft( · ) | t ⊂I
}
are the 
CDFs of some stochastic process iff for every n equals 1 comma 2 comma ellipsisn = 1, 2, . . ., bold italic t subset of upper It ⊂I and integer 
i element of StartSet 1 comma ellipsis comma n EndSeti ∈{1, . . . , n} we have 
limit Underscript x Subscript i Baseline right arrow normal infinity Endscripts upper F Subscript bold italic t Baseline left parenthesis bold italic x right parenthesis equals upper F Subscript bold italic t left parenthesis i right parenthesis Baseline left parenthesis bold italic x left parenthesis i right parenthesis right parenthesis comma lim
xi→∞Ft(x) = Ft(i)(x(i)),
where bold italic t left parenthesis i right parenthesis equals bold italic t minus StartSet t Subscript i Baseline EndSett(i) = t \ {ti} and bold italic x left parenthesis i right parenthesis equals bold italic x minus StartSet x Subscript i Baseline EndSet element of double struck upper R Superscript n minus 1x(i) = x \ {xi} ∈Rn−1. 
Notation bold italic t left parenthesis i right parenthesist(i) is adapted from [4, Th 1.2.1]. Actually, what the Kolmogorov’s 
theorem says is more involved than it may appear. Given that probability measures 
sans serif upper P Subscript t 1 comma ellipsis comma t Sub Subscript n SubscriptPt1,...,tn on double struck upper R Superscript nRn are collected by varying the t Subscript iti’s together with n element of double struck upper Nn ∈N, and each sans serif upper P Subscript t 1 comma ellipsis comma t Sub Subscript n SubscriptPt1,...,tn
is consistent then we can ﬁnd a process X having such collection as its FIDIS. This 
means that there exists a probability space left parenthesis double struck upper R Superscript left bracket 0 comma normal infinity right parenthesis Baseline comma script upper F Superscript left bracket 0 comma normal infinity right parenthesis Baseline comma sans serif upper P right parenthesis(R[0,∞), F[0,∞), P) and rvs left parenthesis upper X Subscript t Baseline right parenthesis Subscript t greater than or slanted equals 0(Xt)t⩾0 s.t. 
for each n 
sans serif upper P left parenthesis left parenthesis upper X Subscript t 1 Baseline comma ellipsis comma upper X Subscript t Sub Subscript n Subscript Baseline right parenthesis element of upper B right parenthesis equals sans serif upper P Subscript t 1 comma ellipsis comma t Sub Subscript n Subscript Baseline left parenthesis upper B right parenthesis comma upper B element of script upper B Superscript n Baseline commaP((Xt1, . . . , Xtn) ∈B) = Pt1,...,tn(B),
B ∈Bn,
where script upper F Superscript left bracket 0 comma normal infinity right parenthesisF[0,∞) is the sigma hyphen algebraσ-algebra generated by the family containing events left brace upper X Subscript t Baseline element of upper B Subscript t Baseline right brace{Xt ∈Bt}
with t greater than or slanted equals 0t ⩾0 and Borel sets upper B Subscript t Baseline subset of double struck upper RBt ⊂R. On the other hand, given double struck upper R Superscript left bracket 0 comma normal infinity right parenthesis Baseline comma script upper F Superscript left bracket 0 comma normal infinity right parenthesisR[0,∞), F[0,∞) as 
above we can deﬁne sans serif upper PP starting from events of the form left brace left parenthesis upper X Subscript t 1 Baseline comma ellipsis comma upper X Subscript t Sub Subscript n Subscript Baseline right parenthesis element of upper B right brace comma{(Xt1, . . . , Xtn) ∈B}, for 
n-dimensional Borel sets upper B subset of double struck upper R Superscript nB ⊂Rn and distinct t 1 comma ellipsis comma t Subscript n Baselinet1, . . . , tn, and then we can extend to 
the whole sigma hyphen algebraσ-algebra script upper F Superscript left bracket 0 comma normal infinity right parenthesisF[0,∞). Thanks to these necessary and sufﬁcient conditions we 
can model a process using FIDIS usually taken with respect to upper B equals upper B 1 times midline horizontal ellipsis times upper B Subscript nB = B1 × · · · × Bn. 
Two more general versions of Theorem 9.1 can be found, for example, in [5, Th  
4.7 and Th 4.18]. Really, Theorem 9.1 is an extension theorem from measure theory 
as applied to probability, see also [3, Th 2.18]. Let upper X equals left parenthesis upper X Subscript t Baseline right parenthesis Subscript t greater than or slanted equals 0X = (Xt)t⩾0 be a process
9.3
Distributional Characteristics
241
deﬁned on a ﬁltered probability space left parenthesis upper Omega comma script upper F comma StartSet script upper F Subscript t Baseline EndSet comma sans serif upper P right parenthesis period(Ω, F, {Ft}, P). Since the distribution of X is 
speciﬁed by its FIDIS, we can write sans serif upper P Subscript t 1 comma ellipsis comma t Sub Subscript n Subscript Baseline left parenthesis upper B 1 times midline horizontal ellipsis times upper B Subscript n Baseline right parenthesisPt1,...,tn(B1 ×· · ·×Bn) using the multiplication 
formula (see Lemma 3.1, Sect. 3.4): 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper X Subscript t 1 Baseline element of upper B 1 comma ellipsis comma upper X Subscript t Sub Subscript n Subscript Baseline element of upper B Subscript n Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis upper X Subscript t 1 Baseline element of upper B 1 right parenthesis 2nd Row 1st Column Blank 2nd Column times 3rd Column sans serif upper P left parenthesis upper X Subscript t 2 Baseline element of upper B 2 vertical bar upper X Subscript t 1 Baseline element of upper B 1 right parenthesis 3rd Row 1st Column Blank 2nd Column times 3rd Column sans serif upper P left parenthesis upper X Subscript t 3 Baseline element of upper B 3 vertical bar upper X Subscript t 2 Baseline element of upper B 2 comma upper X Subscript t 1 Baseline element of upper B 1 right parenthesis 4th Row 1st Column Blank 2nd Column vertical ellipsis 3rd Column Blank 5th Row 1st Column Blank 2nd Column times 3rd Column sans serif upper P left parenthesis upper X Subscript t Sub Subscript n Subscript Baseline element of upper B Subscript n Baseline vertical bar upper X Subscript t Sub Subscript n minus 1 Subscript Baseline element of upper B Subscript n minus 1 Baseline comma ellipsis comma upper X Subscript t 1 Baseline element of upper B 1 right parenthesis comma EndLayoutP(Xt1 ∈B1, . . . , Xtn ∈Bn) = P(Xt1 ∈B1)
× P(Xt2 ∈B2 | Xt1 ∈B1)
× P(Xt3 ∈B3 | Xt2 ∈B2, Xt1 ∈B1)
...
× P(Xtn ∈Bn | Xtn−1 ∈Bn−1, . . . , Xt1 ∈B1),
for any choice of distinct t 1 comma ellipsis comma t Subscript n Baselinet1, . . . , tn and suitable sets upper B Subscript i Baseline subset of double struck upper R commaBi ⊂R, each i equals 1 comma ellipsis comma ni = 1, . . . , n. 
Choosing upper B Subscript i Baseline equals left parenthesis negative normal infinity comma x Subscript i Baseline right bracketBi = (−∞, xi] we can turn to the joint CDF upper F left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesisF(x1, . . . , xn) and get: 
• 
the marginal distribution upper F 1 left parenthesis x 1 right parenthesis equals sans serif upper P left parenthesis upper X Subscript t 1 Baseline less than or slanted equals x 1 right parenthesisF1(x1) = P(Xt1 ⩽x1) setting upper F left parenthesis x 1 comma normal infinity comma ellipsis comma normal infinity right parenthesisF(x1, ∞, . . . , ∞), at t 1t1; 
• 
the conditional distribution 
upper F 2 left parenthesis x 2 vertical bar x 1 right parenthesis equals StartFraction sans serif upper P left parenthesis upper X Subscript t 1 Baseline less than or slanted equals x 1 comma upper X Subscript t 2 Baseline less than or slanted equals x 2 right parenthesis Over sans serif upper P left parenthesis upper X Subscript t 1 Baseline less than or slanted equals x 1 right parenthesis EndFractionF2(x2 | x1)
=
P(Xt1 ⩽x1, Xt2 ⩽x2)
P(Xt1 ⩽x1)
, setting 
StartFraction upper F left parenthesis x 1 comma x 2 comma normal infinity comma ellipsis comma normal infinity right parenthesis Over upper F left parenthesis x 1 comma normal infinity comma ellipsis comma normal infinity right parenthesis EndFraction equals StartFraction upper F Subscript 1 comma 2 Baseline left parenthesis x 1 comma x 2 right parenthesis Over upper F 1 left parenthesis x 1 right parenthesis EndFractionF(x1, x2, ∞, . . . , ∞)
F(x1, ∞, . . . , ∞)
= F1,2(x1, x2)
F1(x1)
, at t 2t2; 
• 
the conditional distribution upper F 3 left parenthesis x 3 vertical bar x 1 comma x 2 right parenthesis equals StartFraction sans serif upper P left parenthesis upper X Subscript t 1 Baseline less than or slanted equals x 1 comma upper X Subscript t 2 Baseline less than or slanted equals x 2 comma upper X Subscript t 3 Baseline less than or slanted equals x 3 right parenthesis Over sans serif upper P left parenthesis upper X Subscript t 1 Baseline less than or slanted equals x 1 comma upper X Subscript t 2 Baseline less than or slanted equals x 2 right parenthesis EndFractionF3(x3 | x1, x2) = P(Xt1 ⩽x1, Xt2 ⩽x2, Xt3 ⩽x3)
P(Xt1 ⩽x1, Xt2 ⩽x2)
, 
where we set StartFraction upper F left parenthesis x 1 comma x 2 comma x 3 comma normal infinity comma ellipsis comma normal infinity right parenthesis Over upper F left parenthesis x 1 comma x 2 comma normal infinity comma ellipsis comma normal infinity right parenthesis EndFraction equals StartFraction upper F Subscript 1 comma 2 comma 3 Baseline left parenthesis x 1 comma x 2 comma x 3 right parenthesis Over upper F Subscript 1 comma 2 Baseline left parenthesis x 1 comma x 2 right parenthesis EndFractionF(x1, x2, x3, ∞, . . . , ∞)
F(x1, x2, ∞, . . . , ∞)
= F1,2,3(x1, x2, x3)
F1,2(x1, x2)
, at t 3t3; 
• 
. 
...
• 
the
conditional
distribution
upper F Subscript n Baseline left parenthesis x Subscript n Baseline vertical bar x 1 comma x 2 comma ellipsis comma x Subscript n minus 1 Baseline right parenthesis equalsFn(xn | x1, x2, . . . , xn−1)
=
StartFraction sans serif upper P left parenthesis upper X Subscript t 1 Baseline less than or slanted equals x 1 comma upper X Subscript t 2 Baseline less than or slanted equals x 2 comma ellipsis comma upper X Subscript t Sub Subscript n Subscript Baseline less than or slanted equals x Subscript n Baseline right parenthesis Over sans serif upper P left parenthesis upper X Subscript t 1 Baseline less than or slanted equals x 1 comma upper X Subscript t 2 Baseline less than or slanted equals x 2 comma ellipsis comma upper X Subscript t Sub Subscript n minus 1 Subscript Baseline less than or slanted equals x Subscript n minus 1 Baseline right parenthesis EndFraction
P(Xt1 ⩽x1, Xt2 ⩽x2, . . . , Xtn ⩽xn)
P(Xt1 ⩽x1, Xt2 ⩽x2, . . . , Xtn−1 ⩽xn−1), setting StartFraction upper F left parenthesis x 1 comma x 2 comma ellipsis comma x Subscript n Baseline right parenthesis Over upper F left parenthesis x 1 comma x 2 comma ellipsis comma x Subscript n minus 1 Baseline comma normal infinity right parenthesis EndFraction equals StartFraction upper F left parenthesis x 1 comma x 2 comma ellipsis comma x Subscript n Baseline right parenthesis Over upper F Subscript 1 comma 2 comma ellipsis comma n minus 1 Baseline left parenthesis x 1 comma x 2 comma ellipsis comma n minus 1 right parenthesis EndFraction comma
F(x1, x2, . . . , xn)
F(x1, x2, . . . , xn−1, ∞) =
F(x1, x2, . . . , xn)
F1,2,...,n−1(x1, x2, . . . , n −1), at t Subscript ntn. 
Interpreting each upper X Subscript t Sub Subscript iXti as a stock price or a log-return, sequential conditioning 
suggests how the dependence structure in the law of a stochastic process is crucial 
as well the past history of prices and returns up to some point in time. 
9.3 
Distributional Characteristics 
Given an adapted process upper X equals left parenthesis upper X Subscript t Baseline right parenthesis Subscript t greater than or slanted equals 0X = (Xt)t⩾0, if  upper X Subscript t Baseline element of upper L Superscript 1Xt ∈L1, i.e., any component rv has 
ﬁnite expectation each t, we can deﬁne the mean function 
sans serif upper E left parenthesis t right parenthesis colon equals sans serif upper E left parenthesis upper X Subscript t Baseline right parenthesis less than normal infinity comma for all t greater than 0 commaE(t) := E(Xt) < ∞,
for all t > 0,
(9.3)
242
9
Introduction to Stochastic Processes
Fig. 9.3 Mean function as an 
‘average’ path 
see Fig. 9.3. If  upper X element of upper L squaredX ∈L2, i.e., any component rv has ﬁnite second moment, we can 
deﬁne the auto-covariance function 
sans serif c o v left parenthesis s comma t right parenthesis equals sans serif upper E left parenthesis left parenthesis upper X Subscript s Baseline minus sans serif upper E left parenthesis s right parenthesis right parenthesis left parenthesis upper X Subscript t Baseline minus sans serif upper E left parenthesis t right parenthesis right parenthesis right parenthesis comma for all 0 less than or slanted equals s less than or slanted equals t periodcov(s, t) = E((Xs −E(s))(Xt −E(t))),
for all 0 ⩽s ⩽t.
(9.4) 
If s equals ts = t we have sans serif c o v left parenthesis t comma t right parenthesis equals sans serif upper V left parenthesis upper X Subscript t Baseline right parenthesis periodcov(t, t) = V(Xt). The mean function represents the ‘trend’ in the 
sample paths of upper X semicolonX; the auto-covariance tells us how each pair of rvs upper X Subscript sXs and upper X Subscript tXt are 
(linearly) correlated in time. 
A process upper X equals left parenthesis upper X Subscript t Baseline right parenthesis Subscript t greater than or slanted equals 0X = (Xt)t⩾0 is said to be strictly stationary if for any pair of n-
dimensional random vectors taken from X we have 
left parenthesis upper X Subscript t 1 Baseline comma ellipsis comma upper X Subscript t Sub Subscript n Subscript Baseline right parenthesis equals Overscript d Endscripts left parenthesis upper X Subscript t 1 plus h Baseline comma ellipsis comma upper X Subscript t Sub Subscript n Subscript plus h Baseline right parenthesis comma(Xt1, . . . , Xtn) d= (Xt1+h, . . . , Xtn+h),
whatever are t 1 comma ellipsis comma t Subscript n Baselinet1, . . . , tn and their shifted version obtained by h greater than 0h > 0. The probability 
laws that govern the behavior of the process do not change over time. The statistical 
properties of a stationary process are identical wherever we look at the data. For 
example, upper X equals left parenthesis upper X Subscript t Baseline right parenthesis Subscript t greater than or slanted equals 0X = (Xt)t⩾0 is strictly stationary iff upper X Subscript tXt’s are IID rvs. A process X is said 
to be weakly stationary provided that: 
1. .E(t) = c, for c element of double struck upper Rc ∈R and every t periodt.
2. .cov(s, s + h) = cov(t, t + h) for every s less than t commas < t, i.e. the auto-covariance function 
only depends upon a temporal shift h periodh.
A special case of weakly stationary process is when for every s less than ts < t we have 
upper X Subscript t Baseline minus upper X Subscript s Baseline equals Overscript d Endscripts upper X Subscript t plus h Baseline minus upper X Subscript s plus h Baseline comma for all h greater than 0 periodXt −Xs
d= Xt+h −Xs+h,
∀h > 0.
(9.5) 
Then, X is said to have stationary increments. If for any choice of time indexes 
t 1 comma t 2 comma ellipsis comma t Subscript n Baselinet1, t2, . . . , tn
upper X Subscript t 2 Baseline minus upper X Subscript t 1 Baseline comma ellipsis comma upper X Subscript t Sub Subscript n Subscript Baseline minus upper X Subscript t Sub Subscript n minus 1 Subscript BaselineXt2 −Xt1, . . . , Xtn −Xtn−1
(9.6) 
are independent rvs then X is said to have independent increments. Observe that: 
• 
strict stationarity implies weak stationarity iff X has ﬁnite second moments; 
• 
weak stationarity implies constant variance function sans serif upper V left parenthesis t right parenthesis colon equals sans serif upper V left parenthesis upper X Subscript t Baseline right parenthesisV(t) := V(Xt) each t.
9.4
Special Kinds of Processes
243
The auto-covariance function of a weakly stationary process is s.t. 
sans serif c o v left parenthesis t comma t plus h right parenthesis colon equals gamma left parenthesis h right parenthesis equals gamma left parenthesis negative h right parenthesis periodcov(t, t + h) := γ (h) = γ (−h).
The auto-correlation function is 
sans serif c o r r left parenthesis s comma t right parenthesis equals StartFraction sans serif c o v left parenthesis s comma t right parenthesis Over StartRoot sans serif upper V left parenthesis s right parenthesis sans serif upper V left parenthesis t right parenthesis EndRoot EndFraction comma 0 less than or slanted equals s less than t periodcorr(s, t) =
cov(s, t)
√V(s)V(t),
0 ⩽s < t.
Thus for weakly stationary process we also have: 
rho left parenthesis h right parenthesis colon equals sans serif c o r r left parenthesis t comma t plus h right parenthesis equals StartFraction sans serif c o v left parenthesis t comma t plus h right parenthesis Over sans serif upper V left parenthesis t right parenthesis EndFraction equals StartFraction gamma left parenthesis h right parenthesis Over gamma left parenthesis 0 right parenthesis EndFraction periodρ(h) := corr(t, t + h) = cov(t, t + h)
V(t)
= γ (h)
γ (0).
9.4 
Special Kinds of Processes 
Kolmogorov’s Theorem 9.1 enable us to use FIDIS and related distributional char-
acteristics in order to identify special kinds of processes employed in application. 
9.4.1 
White Noise Processes 
Let X be a weakly stationary process at time, t equals 1 comma 2 comma ellipsist = 1, 2, . . .. If sans serif upper E left parenthesis t right parenthesis equals 0E(t) = 0 for all t and 
rho left parenthesis h right parenthesis equals sans serif c o v left parenthesis t comma t plus h right parenthesis equals gamma left parenthesis h right parenthesis equals StartLayout Enlarged left brace 1st Row 1st Column 0 comma 2nd Column if h not equals 0 2nd Row 1st Column sigma squared comma 2nd Column if h equals 0 EndLayout commaρ(h) = cov(t, t + h) = γ (h) =
⌠0, if h /= 0
σ 2, if h = 0 ,
where sigma greater than 0σ > 0, then X is called white noise. A version with nonzero mean function 
is obtained by letting sans serif upper E left parenthesis t right parenthesis equals muE(t) = μ for mu element of double struck upper Rμ ∈R. We need only two parameters to model 
such a process, since all upper X Subscript tXt’s have the same expectation and variance sans serif upper V left parenthesis upper X Subscript t Baseline right parenthesis equals sigma squared equals sans serif c o v left parenthesis t comma t right parenthesisV(Xt) = σ 2 =
cov(t, t). We have  rho left parenthesis h right parenthesis equals StartFraction gamma left parenthesis h right parenthesis Over gamma left parenthesis 0 right parenthesis EndFraction equals StartFraction 0 Over sigma squared EndFraction equals 0ρ(h) = γ (h)
γ (0) =
0
σ 2 = 0 for h not equals 0h /= 0 and equals rho left parenthesis h right parenthesis equals StartFraction gamma left parenthesis 0 right parenthesis Over gamma left parenthesis 0 right parenthesis EndFraction equals StartFraction sigma squared Over sigma squared EndFraction equals 1ρ(h) = γ (0)
γ (0) =
σ 2
σ 2 = 1 for h equals 0h = 0, thus a white noise is made by uncorrelated rvs. We may further 
assume serial independence among upper X Subscript tXts, but recall that no correlation does not imply 
independence. From now on we will refer to a white noise upper X equals left parenthesis upper X Subscript t Baseline right parenthesis Subscript t element of double struck upper NX = (Xt)t∈N with IID 
rvs upper X Subscript tXt each with sans serif upper E left parenthesis upper X Subscript t Baseline right parenthesis equals 0E(Xt) = 0 and sans serif upper V left parenthesis upper X Subscript t Baseline right parenthesis equals sigma squaredV(Xt) = σ 2. 
Remark 9.4 The term uncorrelated process is used when the autocorrelation 
function rho left parenthesis h right parenthesis equals sans serif c o r r left parenthesis t comma t plus h right parenthesisρ(h) = corr(t, t + h) is 1 for h equals 0h = 0 and 0 for h greater than 0h > 0, whether it is 
stationary or not. The best linear forecast of upper X Subscript t plus 1Xt+1, see Sect. 7.2, is its unconditional 
expectation.
244
9
Introduction to Stochastic Processes
9.4.2 
Gaussian Processes 
Recall the multivariate Gaussian distribution 
bold italic upper X tilde bold italic upper N left parenthesis bold italic mu comma bold italic upper Sigma right parenthesis commaX
∼
N(μ, ∑), where 
bold italic mu equals left parenthesis sans serif upper E left parenthesis upper X 1 right parenthesis comma ellipsis comma sans serif upper E left parenthesis upper X Subscript n Baseline right parenthesis right parenthesis equals left parenthesis mu 1 comma ellipsis comma mu Subscript n Baseline right parenthesisμ
=
(E(X1), . . . , E(Xn)) = (μ1, . . . , μn) and bold italic upper Sigma∑is the (positive semi-deﬁnite) n times nn × n
covariance matrix, with entries c Subscript i i Baseline equals sans serif upper V left parenthesis upper X Subscript i Baseline right parenthesis equals sigma Subscript i Superscript 2cii = V(Xi) = σ 2
i and c Subscript i j Baseline equals sans serif c o v left parenthesis upper X Subscript i Baseline comma upper X Subscript j Baseline right parenthesis equals rho Subscript i comma j Baseline sigma Subscript i Baseline sigma Subscript jcij = cov(Xi, Xj) =
ρi,jσiσj for i not equals ji /= j and i comma j element of StartSet 1 comma ellipsis comma n EndSeti, j ∈{1, . . . , n}, with rho Subscript i comma jρi,j being the Pearson correlation 
coefﬁcient between pairs upper X Subscript i Baseline comma upper X Subscript j BaselineXi, Xj. Thus, upper X equals left parenthesis upper X Subscript t Baseline right parenthesis Subscript t element of upper IX = (Xt)t∈I is said to be a Gaussian 
process if for any choice of distinct times t 1 comma ellipsis comma t Subscript n Baselinet1, . . . , tn its FIDIS are multivariate 
Gaussian, i.e. bold upper X equals left parenthesis upper X Subscript t 1 Baseline comma ellipsis comma upper X Subscript t Sub Subscript n Subscript Baseline right parenthesisX = (Xt1, . . . , Xtn) is a Gaussian vector. From Theorem 5.3 in 
Sect. 5.7 we easily deduce: 
Theorem 9.2 For a Gaussian random vector bold upper X equals left parenthesis upper X Subscript t 1 Baseline comma ellipsis comma upper X Subscript t Sub Subscript n Subscript Baseline right parenthesisX = (Xt1, . . . , Xtn) the following are 
equivalent: 
1. each upper X Subscript t Sub Subscript i Baseline tilde normal upper N left parenthesis mu Subscript i Baseline comma sigma Subscript i Superscript 2 Baseline right parenthesisXti ∼N(μi, σ 2
i ); 
2. .Y = ∑n
i=1 aiXti is a Gaussian rv, for every a 1 comma ellipsis comma a Subscript n Baseline element of double struck upper Ra1, . . . , an ∈R. 
As byproduct, a Gaussian process is strictly stationary iff it is weakly stationary. 
In fact, Assuming upper X equals left parenthesis upper X Subscript t Baseline right parenthesis Subscript t element of upper IX = (Xt)t∈I is a strictly stationary Gaussian process, then both 
left parenthesis upper X Subscript t 1 Baseline comma ellipsis comma upper X Subscript t Sub Subscript n Subscript Baseline right parenthesis(Xt1, . . . , Xtn) and left parenthesis upper X Subscript t 1 plus h Baseline comma ellipsis comma upper X Subscript t Sub Subscript n Subscript plus h Baseline right parenthesis(Xt1+h, . . . , Xtn+h) are normal upper N left parenthesis bold italic mu comma bold italic upper Sigma right parenthesisN(μ, ∑) for h greater than 0h > 0, thus by Theorem 9.2 
we have 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X Subscript t Sub Subscript i Subscript Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis upper X Subscript t Sub Subscript i Subscript plus h Baseline right parenthesis equals mu Subscript i Baseline comma and sans serif upper V left parenthesis upper X Subscript t Sub Subscript i Subscript Baseline right parenthesis equals sans serif upper V left parenthesis upper X Subscript t Sub Subscript i Subscript plus h Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sigma Subscript i Superscript 2 Baseline for every h greater than 0 comma t Subscript i Baseline comma i element of double struck upper N comma EndLayoutE(Xti) = E(Xti+h) = μi, and V(Xti) = V(Xti+h)
= σ 2
i
for every h > 0, ti, i ∈N,
and then 
left parenthesis upper X Subscript t Sub Subscript i Subscript Baseline comma upper X Subscript t Sub Subscript i Subscript plus h Baseline right parenthesis tilde normal upper N left parenthesis StartBinomialOrMatrix mu Subscript i Baseline Choose mu Subscript i Baseline EndBinomialOrMatrix comma Start 2 By 2 Matrix 1st Row 1st Column sigma Subscript i Superscript 2 Baseline 2nd Column rho sigma Subscript i Baseline sigma Subscript j Baseline 2nd Row 1st Column rho sigma Subscript i Baseline sigma Subscript j Baseline 2nd Column sigma Subscript i Superscript 2 Baseline EndMatrix right parenthesis(Xti, Xti+h) ∼N
⎛⎾μi
μi
⏋
,
⎾σ 2
i
ρσiσj
ρσiσj
σ 2
i
⏋⎞
which implies sans serif c o v left parenthesis t Subscript i Baseline comma t Subscript i Baseline plus h right parenthesis equals sans serif c o v left parenthesis t Subscript j Baseline comma t Subscript j Baseline plus h right parenthesiscov(ti, ti + h) = cov(tj, tj + h) for t Subscript i Baseline less than t Subscript jti < tj. For the converse, 
assuming upper X equals left parenthesis upper X Subscript t Baseline right parenthesis Subscript t element of upper IX = (Xt)t∈I is a weakly stationary Gaussian process then sans serif upper E left parenthesis upper X Subscript t Sub Subscript i Subscript Baseline right parenthesis equals mu Subscript iE(Xti) = μi
for every t Subscript i Baseline comma i element of double struck upper Nti, i ∈N and also sans serif c o v left parenthesis t Subscript i Baseline comma t Subscript i Baseline plus h right parenthesis equals sans serif c o v left parenthesis t Subscript j Baseline comma t Subscript j Baseline plus h right parenthesiscov(ti, ti + h) = cov(tj, tj + h) for every h greater than 0h > 0
and t Subscript i Baseline less than t Subscript jti < tj which implies sans serif upper V left parenthesis upper X Subscript t Sub Subscript i Subscript Baseline right parenthesis equals sans serif upper V left parenthesis upper X Subscript t Sub Subscript i Subscript plus h Baseline right parenthesis equals sigma Subscript i Superscript 2V(Xti) = V(Xti+h) = σ 2
i . Since both left parenthesis upper X Subscript t 1 Baseline comma ellipsis comma upper X Subscript t Sub Subscript n Subscript Baseline right parenthesis(Xt1, . . . , Xtn)
and left parenthesis upper X Subscript t 1 plus h Baseline comma ellipsis comma upper X Subscript t Sub Subscript n Subscript plus h Baseline right parenthesis(Xt1+h, . . . , Xtn+h) are normal upper N left parenthesis bold italic mu comma bold italic upper Sigma right parenthesisN(μ, ∑) it follows upper X equals left parenthesis upper X Subscript t Baseline right parenthesis Subscript t element of upper IX = (Xt)t∈I is a strictly stationary 
Gaussian process. 
Example 9.2 Let upper R equals left parenthesis upper R Subscript t Baseline right parenthesis Subscript t element of double struck upper NR = (Rt)t∈N a discrete-time white noise process with mean 
function sans serif upper E left parenthesis t right parenthesis equals muE(t) = μ, modelling subsequent log-returns upper R Subscript tRt. Because of the lack of 
serial correlation, forecasting the future movements of R from its past realizations 
is not possible. Assuming R is in addition a Gaussian process, then we have: 
sans serif upper E left parenthesis upper R Subscript t plus n Baseline vertical bar upper R 1 comma upper R 2 comma ellipsis comma upper R Subscript n Baseline right parenthesis equals mu comma for all t greater than or slanted equals 1 periodE(Rt+n | R1, R2, . . . , Rn) = μ,
for all t ⩾1.
9.4
Special Kinds of Processes
245
Possible deviations of the R’s trajectories from muμ are difﬁcult to predict. This 
is because the future realization upper R Subscript t plus nRt+n is independent from the past realizations 
upper R 1 comma upper R 2 comma ellipsis comma upper R Subscript n BaselineR1, R2, . . . , Rn and the best forecast is just muμ, see Sect. 7.2, Chap. 7. 
When handling Gaussian processes further properties of multivariate Gaussian 
distributions are useful. First, yet another consequence of Theorem 5.3 is: 
Corollary 9.1 For a bi-variate Gaussian vector bold upper X equals left parenthesis upper X 1 comma upper X 2 right parenthesisX = (X1, X2) the parameter rhoρ is 
the correlation coefﬁcient of upper X 1X1 and upper X 2X2. 
Proof First recall: 
• 
. E(E(X | Y)) = E(X)
• 
.E(X Y | Y) = Y E(X | Y). 
Now, assume left parenthesis upper X 1 comma upper X 2 right parenthesis(X1, X2) is bi-variate Gaussian and let upper Z 1 comma upper Z 2Z1, Z2 be two standard normal 
rvs. Thus: 
StartLayout 1st Row 1st Column sans serif c o v left parenthesis upper Z 1 comma upper Z 2 right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis upper Z 1 upper Z 2 right parenthesis equals sans serif upper E left parenthesis sans serif upper E left parenthesis upper Z 1 upper Z 2 vertical bar upper Z 1 right parenthesis right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper E left parenthesis upper Z 1 sans serif upper E left parenthesis upper Z 2 vertical bar upper Z 1 right parenthesis right parenthesis equals rho sans serif upper E left parenthesis upper Z 1 squared right parenthesis equals rho comma EndLayoutcov(Z1, Z2) = E(Z1Z2) = E (E(Z1Z2 | Z1))
= E (Z1E(Z2 | Z1)) = ρE(Z2
1) = ρ,
where we used the fact (to be proved later) that sans serif upper E left parenthesis upper Z 2 vertical bar upper Z 1 right parenthesis equals rho upper Z 1 periodE(Z2 | Z1) = ρZ1. Since upper Z 1 comma upper Z 2Z1, Z2
are standard normal rvs also rho equals sans serif c o r r left parenthesis upper Z 1 comma upper Z 2 right parenthesisρ = corr(Z1, Z2). Now letting upper X Subscript i Baseline equals mu Subscript i Baseline plus sigma Subscript i Baseline upper Z Subscript iXi = μi + σiZi for 
i equals 1 comma 2i = 1, 2 we have upper X Subscript i Baseline tilde normal upper N left parenthesis mu Subscript i Baseline comma sigma Subscript i Superscript 2 Baseline right parenthesisXi ∼N(μi, σ 2
i ) as required. Moreover: 
sans serif c o v left parenthesis upper X 1 comma upper X 2 right parenthesis equals sans serif c o v left parenthesis upper X 1 minus mu 1 comma upper X 2 minus mu 2 right parenthesis equals sans serif c o v left parenthesis sigma 1 upper Z 1 comma sigma 2 upper Z 2 right parenthesiscov(X1, X2) = cov(X1 −μ1, X2 −μ2) = cov(σ1Z1, σ2Z2)
and eventually sans serif c o r r left parenthesis upper X 1 comma upper X 2 right parenthesis equals sans serif c o r r left parenthesis sigma 1 upper Z 1 comma sigma 2 upper Z 2 right parenthesiscorr(X1, X2) = corr(σ1Z1, σ2Z2) which equals sans serif c o r r left parenthesis upper Z 1 comma upper Z 2 right parenthesis equals rhocorr(Z1, Z2) = ρ. 
█
Proposition 9.1 If left parenthesis upper X 1 comma upper X 2 right parenthesis(X1, X2) is bi-variate Gaussian, then for ﬁxed x element of double struck upper Rx ∈R the 
conditional distribution of upper X 2X2 given upper X 1 equals xX1 = x is univariate Gaussian: 
upper X 2 vertical bar upper X 1 tilde normal upper N left parenthesis mu 2 plus rho StartFraction sigma 2 Over sigma 1 EndFraction left parenthesis x minus mu 1 right parenthesis comma sigma 2 squared left parenthesis 1 minus rho squared right parenthesis right parenthesis periodX2 | X1 ∼N
⎛
μ2 + ρ σ2
σ1
(x −μ1), σ 2
2 (1 −ρ2)
⎞
.
Proof Let f Subscript upper X 2 vertical bar upper X 1 Baseline left parenthesis x 2 right parenthesis equals StartFraction f Subscript left parenthesis upper X 1 comma upper X 2 right parenthesis Baseline left parenthesis x 1 comma x 2 right parenthesis Over f Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis EndFractionfX2 | X1(x2) =
f(X1,X2)(x1,x2)
fX1(x1)
be the conditional density of upper X 2X2 given upper X 1X1. 
Performing the division we get the expression of a Gaussian density with location 
parameter mu 2 plus rho StartFraction sigma 2 Over sigma 1 EndFraction left parenthesis x minus mu 1 right parenthesisμ2 + ρ σ2
σ1 (x −μ1) and dispersion parameter sigma 2 squared left parenthesis 1 minus rho squared right parenthesisσ 2
2 (1 −ρ2). 
█
Remark 9.5 Proposition 9.1 yields 
sans serif upper E left parenthesis upper X 2 vertical bar upper X 1 right parenthesis equals mu 2 plus rho StartFraction sigma 2 Over sigma 1 EndFraction left parenthesis upper X 1 minus mu 1 right parenthesis commaE(X2 | X1) = μ2 + ρ σ2
σ1
(X1 −μ1),
246
9
Introduction to Stochastic Processes
i.e. the location parameter above is a conditional expectation depending on the 
values of upper X 1 periodX1. In particular, for two standard normal rvs upper X 1 comma upper X 2X1, X2 we get: 
sans serif upper E left parenthesis upper X 2 vertical bar upper X 1 right parenthesis equals 0 plus rho one oneth left parenthesis upper X 1 minus 0 right parenthesis equals rho upper X 1 periodE(X2 | X1) = 0 + ρ 1
1(X1 −0) = ρX1.
9.4.3 
Random Walk Processes 
A discrete time process upper W equals left parenthesis upper W Subscript t Baseline right parenthesis Subscript t element of double struck upper NW = (Wt)t∈N is called a symmetric random walk if it can 
be represented by the recursive equation 
upper W Subscript t plus 1 Baseline equals upper W Subscript t Baseline plus upper Z Subscript t plus 1 Baseline comma t equals 0 comma 1 comma 2 comma ellipsisWt+1 = Wt + Zt+1,
t = 0, 1, 2, . . .
(9.7) 
where upper W 0 equals upper Z 0 equals 0W0 = Z0 = 0 and upper Z 1 comma upper Z 2 comma ellipsisZ1, Z2, . . . are IID rvs with sans serif upper P left parenthesis upper Z Subscript t Baseline equals 1 right parenthesis equals sans serif upper P left parenthesis upper Z Subscript t Baseline equals negative 1 right parenthesis equals one half commaP(Zt = 1) = P(Zt = −1) =
1
2, mean function sans serif upper E left parenthesis upper Z Subscript t Baseline right parenthesis equals 0E(Zt) = 0 for t equals 1 comma 2 comma ellipsist = 1, 2, . . . and variance function sans serif upper V left parenthesis upper Z Subscript t Baseline right parenthesis equals sans serif upper E left parenthesis upper Z Subscript t Superscript 2 Baseline right parenthesis equals 1V(Zt) =
E(Z2
t ) = 1 for t equals 1 comma 2 comma ellipsist = 1, 2, . . . Of course we have upper W Subscript t Baseline equals upper Z 1 plus midline horizontal ellipsis plus upper Z Subscript tWt = Z1 + · · · + Zt. Note that 
sans serif upper E left parenthesis t right parenthesis equals sans serif upper E left parenthesis upper W Subscript t Baseline right parenthesis equals sans serif upper E left parenthesis upper Z 1 plus midline horizontal ellipsis plus upper Z Subscript t Baseline right parenthesis equals 0E(t) = E(Wt) = E(Z1 + · · · + Zt) = 0
and sans serif upper V left parenthesis t right parenthesis equals sans serif upper V left parenthesis upper W Subscript t Baseline right parenthesis equals sans serif upper V left parenthesis upper Z 1 plus midline horizontal ellipsis plus upper Z Subscript t Baseline right parenthesis equals t periodV(t) = V(Wt) = V(Z1 + · · · + Zt) = t. The random walk has independent and 
stationary increments, but it is not weakly stationary. 
Example 9.3 Let upper R equals left parenthesis upper R Subscript t Baseline right parenthesis Subscript t element of double struck upper NR = (Rt)t∈N be a discrete-time process for the log-returns. 
Recall that upper R Subscript t plus 1 Baseline equals log left parenthesis StartFraction upper S Subscript t plus 1 Baseline Over upper S Subscript t Baseline EndFraction right parenthesisRt+1 = log
⎛
St+1
St
⎞
, where upper S Subscript tSt is the stock price at t equals 0 comma 1 comma 2 comma ellipsist = 0, 1, 2, . . .. Thus, 
upper R Subscript t plus 1 Baseline equals ln left parenthesis upper S Subscript t plus 1 Baseline right parenthesis minus ln left parenthesis upper S Subscript t Baseline right parenthesisRt+1 = ln(St+1) −ln(St) and the stochastic model for the log-price differences 
might be a random walk with drift: 
ln left parenthesis upper S Subscript t plus 1 Baseline right parenthesis equals mu plus ln left parenthesis upper S Subscript t Baseline right parenthesis plus upper Z Subscript t plus 1 Baseline commaln(St+1) = μ + ln(St) + Zt+1,
where mu equals sans serif upper E left parenthesis ln left parenthesis upper S Subscript t plus 1 Baseline right parenthesis minus ln left parenthesis upper S Subscript t Baseline right parenthesis right parenthesisμ = E(ln(St+1) −ln(St)) and as usual upper Z equals left parenthesis upper Z Subscript t Baseline right parenthesis Subscript t element of double struck upper NZ = (Zt)t∈N is a white noise. 
The sample paths of a random walk can be represented by a binomial tree, see 
Fig. 9.4. We can interpret upper W Subscript t Baseline equals upper Z 1 plus midline horizontal ellipsis plus upper Z Subscript tWt = Z1 + · · · + Zt as a repeated bet: we either win 
upper Z Subscript t Baseline equals 1Zt = 1 e at time t equals 1 comma 2 comma ellipsist = 1, 2, . . . if, for example, the log-price in Example 9.3 moved 
up from t minus 1t −1 to t, or we loose upper Z Subscript t Baseline equals negative 1Zt = −1 e if the log-price moved down. Thus, 
upper W Subscript tWt is the accumulated fortune up to time t. The tree in Fig. 9.4 may recombine, see 
Fig. 9.5. 
It is worth noting that each upper Z Subscript t Baseline equals upper X minus left parenthesis 1 minus upper X right parenthesisZt
= X −(1 −X) with Bernoulli rv upper X tilde upper B e r left parenthesis one half right parenthesisX ∼
Ber( 1
2), thus upper Z Subscript tZt has the same Bernoulli distribution. Then, the FIDIS of a random 
walk and related conditional distributions are binomial and, for example, we have 
StartBinomialOrMatrix t Choose m EndBinomialOrMatrix p Superscript m Baseline left parenthesis 1 minus p right parenthesis Superscript t minus m
( t
m
)
pm(1 −p)t−m with m equals 0 comma 1 comma ellipsis comma tm = 0, 1, . . . , t and t equals 1 comma 2 comma 3t = 1, 2, 3. Here  m denotes the 
number of successes, i.e., the number of upward movements (viz. upper Z Subscript t Baseline equals 1Zt = 1) along 
the binomial tree. So, we can compute sans serif upper P left parenthesis upper W 3 equals 1 vertical bar upper W 2 equals 2 comma upper W 1 equals 1 right parenthesis equals 1 minus pP(W3 = 1 | W2 = 2, W1 = 1) = 1 −p and
9.4
Special Kinds of Processes
247
Fig. 9.4 Binomial tree for 
the random walk 
upper W equals left parenthesis upper W Subscript t Baseline right parenthesis Subscript t equals 1 comma 2 comma 3W = (Wt)t=1,2,3. Each rv upper Z Subscript tZt
contributes with its support 
StartSet negative 1 comma 1 EndSet{−1, 1} at each node 
Fig. 9.5 Recombined 
binomial tree for the random 
walk upper W equals left parenthesis upper W Subscript t Baseline right parenthesis Subscript t equals 1 comma 2 comma 3W = (Wt)t=1,2,3
sans serif upper P left parenthesis upper W 3 equals 1 right parenthesis equals 3 p squared left parenthesis 1 minus p right parenthesisP(W3 = 1) = 3p2(1 −p), and upper W 3 tilde Bin left parenthesis t comma p right parenthesisW3 ∼Bin(t, p), with t equals 3t = 3 and p equals one halfp = 1
2. A typical 
plot of the W’s path is depicted in Fig. 9.6. The behavior of a symmetric random 
walk without drift can be simulated by the following R code: 
A 11-lin e pro
gram c od e. Li ne  1 re ads n p at h l
ess than hyphen 1 s
emi co lon p less than hyphen 0.5 semicol
on n s tep s less tha
n 30. Li ne  2
 reads  se t dot seed
 left pa re nthesis 45568223  r ight parenthesis.
When p not equals one halfp /= 1
2 we no longer have a symmetric random walk. The number of simulated 
values upper W Subscript tWt per path is t equalst = nsteps set to 30. The for-next loop aims at ﬁll the matrix 
RW, using the uniform random number generator runif(1): comparing it with the 
success probability p, in case of a smaller value each entry RW[i,j] is incremented 
by 1, otherwise is reduced by negative 1−1. We used a matrix since by specifying npath
248
9
Introduction to Stochastic Processes
Fig. 9.6 Sample path of a 
symmetric random walk 
0
5
10
15
20
25
30 
−1 
0 
1 
2 
3 
4 
time step 
W(t) 
greater than 1, we can simulate more sample paths at once. Note that we used NA in 
the matrix speciﬁcation since no available data are loaded into RW, because we ﬁll it 
with simulated values. Clearly, incrementing npath we pass from an array vector 
to a nsteps times× npath matrix. The command matplot yields a plot of the path 
with the following arguments: type="l" connects the dots given by pch=16; 
lty=1 draws a solid line; lwd=2 makes the line thicker; col="black" entails 
a black solid line; panel.first=grid() adds grid lines. 
9.4.4 
Martingale Process 
A process upper X equals left parenthesis upper X Subscript t Baseline right parenthesis Subscript t element of upper I Baseline commaX = (Xt)t∈I, is said to be a martingale if it satisﬁes: 
1. X is adapted to the ﬁltration StartSet script upper F Subscript t Baseline EndSet period{Ft}.
2. For every t greater than or slanted equals 0t ⩾0 the rv upper X Subscript tXt has ﬁnite expectation. 
3. .E(Xt | Fs) a.s.
= Xs, for every 0 less than or slanted equals s less than t period0 ⩽s < t.
Property 3 is usually taken as the deﬁnition of a martingale. If we try to forecast 
the future values of X using conditional expectation, then the best we get is the 
present value upper X Subscript sXs and we do not know how the process will evolve (there is no 
trend). Replacing equals= in property 3 with less than or slanted equals⩽or greater than or slanted equals⩾we have that X is a supermartingale 
or submartingale respectively: the process is increasing or decreasing on average. A 
process is a martingale iff it is both a supermartingale and a submartingale. We can 
apply all the properties of conditional expectation to a martingale, see Sect. 6.4 in 
Chap. 6. For example: 
sans serif upper E left parenthesis upper X Subscript t Baseline vertical bar script upper F Subscript s Baseline right parenthesis equals sans serif upper E left parenthesis sans serif upper E left parenthesis upper X Subscript t Baseline vertical bar script upper F Subscript s Baseline right parenthesis vertical bar script upper F Subscript t Baseline right parenthesisE(Xt | Fs) = E
(
E(Xt | Fs) | Ft
)
9.4
Special Kinds of Processes
249
for s less than t commas < t, since script upper F Subscript s Baseline subset of script upper F Subscript t Baseline periodFs ⊂Ft. If we condition on the sigma hyphen algebraσ-algebra sigma left parenthesis upper X Subscript s Baseline right parenthesisσ(Xs) then: 
sans serif upper E left parenthesis upper X Subscript t Baseline vertical bar sigma left parenthesis upper X Subscript s Baseline right parenthesis right parenthesis colon equals sans serif upper E left parenthesis upper X Subscript t Baseline vertical bar upper X Subscript s Baseline right parenthesis equals upper X Subscript s Baseline comma for all 0 less than or slanted equals s less than tE(Xt | σ(Xs)) := E(Xt | Xs) = Xs,
for all 0 ⩽s < t
or equivalently 
sans serif upper E left parenthesis upper X Subscript t Baseline minus upper X Subscript s Baseline vertical bar upper X Subscript s Baseline right parenthesis equals 0 comma for all 0 less than or slanted equals s less than t periodE(Xt −Xs | Xs) = 0,
for all 0 ⩽s < t.
Observe that sans serif upper E left parenthesis upper X Subscript s Baseline vertical bar script upper F Subscript s Baseline right parenthesis equals upper X Subscript s Baseline sans serif upper E left parenthesis 1 vertical bar script upper F Subscript s Baseline right parenthesisE(Xs | Fs) = XsE(1 | Fs) since upper X Subscript sXs is script upper F Subscript sFs-measurable. 
Example 9.4 Let upper X equals left parenthesis upper X Subscript t Baseline right parenthesis Subscript t element of double struck upper NX = (Xt)t∈N be a discrete-time stochastic process. It is a 
martingale if and only if for all integer t we have that upper X Subscript tXt has ﬁnite expectation 
and with probability 1 
sans serif upper E left parenthesis upper X Subscript t plus 1 Baseline vertical bar script upper F Subscript t Baseline right parenthesis equals upper X Subscript t Baseline commaE(Xt+1 | Ft) = Xt,
that is on average the value of upper X Subscript t plus 1Xt+1 is the same as that of upper X Subscript tXt. Since sans serif upper E left parenthesis upper X Subscript t plus 1 Baseline vertical bar script upper F Subscript t Baseline right parenthesisE(Xt+1 | Ft)
is a script upper F Subscript tFt-measurable rv, by the Law of Iterated Expectations and the fact that 
sigma left parenthesis upper X 0 comma upper X 1 comma ellipsis comma upper X Subscript t Baseline right parenthesisσ(X0, X1, . . . , Xt) is a sub-sigma hyphen algebraσ-algebra of script upper F Subscript tFt we have 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X Subscript t plus 1 Baseline vertical bar upper X 0 comma upper X 1 comma ellipsis comma upper X Subscript t Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis sans serif upper E left parenthesis upper X Subscript t plus 1 Baseline vertical bar script upper F Subscript t Baseline right parenthesis vertical bar sigma left parenthesis upper X 0 comma upper X 1 comma ellipsis comma upper X Subscript t Baseline right parenthesis right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper E left parenthesis upper X Subscript t Baseline vertical bar upper X 0 comma upper X 1 comma ellipsis comma upper X Subscript t Baseline right parenthesis equals upper X Subscript t Baseline comma EndLayoutE(Xt+1 | X0, X1, . . . , Xt) = E
(
E(Xt+1 | Ft) | σ(X0, X1, . . . , Xt)
)
= E(Xt | X0, X1, . . . , Xt) = Xt,
and the two deﬁnition are equivalent. 
By differentiating a discrete-time martingale we get an uncorrelated process. 
Example 9.5 Let upper X equals left parenthesis upper X Subscript t Baseline right parenthesis Subscript t element of double struck upper NX = (Xt)t∈N be the discrete-time martingale of Example 9.4. 
Thus, using the information provided by its own history, i.e., the 
sigma hyphen algebraσ-algebra
sigma left parenthesis upper X Subscript t minus 1 Baseline comma upper X Subscript t minus 2 Baseline ellipsis right parenthesisσ(Xt−1, Xt−2 . . .) we get 
sans serif upper E left parenthesis upper X Subscript t Baseline vertical bar upper X Subscript t minus 1 Baseline comma upper X Subscript t minus 2 Baseline comma ellipsis right parenthesis equals upper X Subscript t Baseline periodE(Xt | Xt−1, Xt−2, . . .) = Xt.
Observe that we can deﬁne a discrete-time process with double struck upper ZZ as the time index set, 
so negative integers can be interpreted as past dates. Now, taking the difference 
upper D Subscript t Baseline equals upper X Subscript t Baseline minus upper X Subscript t minus 1Dt = Xt −Xt−1 we have that the process upper D equals left parenthesis upper D Subscript t Baseline right parenthesis Subscript t element of double struck upper ZD = (Dt)t∈Z is a martingale difference 
with 
sans serif upper E left parenthesis upper D Subscript t Baseline vertical bar upper D Subscript t minus 1 Baseline comma upper D Subscript t minus 2 Baseline comma ellipsis right parenthesis equals 0 commaE(Dt | Dt−1, Dt−2, . . .) = 0,
and zero mean function, sans serif upper E left parenthesis t right parenthesis equals 0E(t) = 0. It follows that D is also an uncorrelated process, 
and if we add stationarity it also becomes a white noise.
250
9
Introduction to Stochastic Processes
There is a property slightly similar to that characterizing a martingale: upper X equals left parenthesis upper X Subscript t Baseline right parenthesis Subscript t element of upper IX =
(Xt)t∈I is said to be a Markov process if for s less than ts < t it satisﬁes 
sans serif upper P left parenthesis upper X Subscript t Baseline element of upper B vertical bar script upper F Subscript s Baseline right parenthesis equals sans serif upper P left parenthesis upper X Subscript t Baseline element of upper B vertical bar upper X Subscript s Baseline right parenthesis commaP(Xt ∈B | Fs) = P(Xt ∈B | Xs),
where we used the general conditional probability for any Borel set upper B subset of double struck upper RB ⊂R. 
Equivalently we have: 
sans serif upper P left parenthesis upper X Subscript t Sub Subscript n plus 1 Subscript Baseline element of upper B vertical bar upper X Subscript t 1 Baseline comma ellipsis comma upper X Subscript t Sub Subscript n Subscript Baseline right parenthesis equals sans serif upper P left parenthesis upper X Subscript t Sub Subscript n plus 1 Subscript Baseline element of upper B vertical bar upper X Subscript t Sub Subscript n Subscript Baseline right parenthesis periodP(Xtn+1 ∈B | Xt1, . . . , Xtn) = P(Xtn+1 ∈B | Xtn).
Another equivalent characterization is: 
sans serif upper E left parenthesis g left parenthesis upper X Subscript t Baseline right parenthesis vertical bar script upper F Subscript s Baseline right parenthesis equals sans serif upper E left parenthesis g left parenthesis upper X Subscript t Baseline right parenthesis vertical bar upper X Subscript s Baseline right parenthesis comma g is measurable and sans serif upper E left parenthesis g left parenthesis upper X Subscript t Baseline right parenthesis right parenthesis less than normal infinity periodE(g(Xt) | Fs) = E(g(Xt) | Xs),
g is measurable and E(g(Xt)) < ∞.
Only the information at time s less than ts < t matter in forecasting the future value upper X Subscript t Baseline periodXt. The 
past is forgotten. It can be shown that any process with independent increment is 
also of the Markov type. Taking g left parenthesis x right parenthesis equals xg(x) = x we get sans serif upper E left parenthesis upper X Subscript t Baseline vertical bar script upper F Subscript s Baseline right parenthesis equals sans serif upper E left parenthesis upper X Subscript t Baseline vertical bar upper X Subscript s Baseline right parenthesisE(Xt | Fs) = E(Xt | Xs). Do  
not confuse this with the martingale property. By the equivalent characterization it 
follows 
sans serif upper E left parenthesis g left parenthesis upper X Subscript t Baseline right parenthesis vertical bar script upper F Subscript s Baseline right parenthesis equals sans serif upper E left parenthesis g left parenthesis upper X Subscript t Baseline right parenthesis vertical bar upper X Subscript s Baseline right parenthesis comma g is measurable and sans serif upper E left parenthesis g left parenthesis upper X Subscript t Baseline right parenthesis right parenthesis less than normal infinityE(g(Xt) | Fs) = E(g(Xt) | Xs),
g is measurable and E(g(Xt)) < ∞
and we get 
sans serif upper E left parenthesis g left parenthesis upper X Subscript t Baseline right parenthesis vertical bar upper X Subscript s Baseline right parenthesis equals f left parenthesis upper X Subscript s Baseline right parenthesis comma 0 less than or slanted equals s less than t periodE(g(Xt) | Xs) = f (Xs),
0 ⩽s < t.
A Markov process need not to be a martingale, since this only happens when 
g left parenthesis upper X Subscript t Baseline right parenthesis equals upper X Subscript tg(Xt) = Xt and f left parenthesis upper X Subscript s Baseline right parenthesis equals upper X Subscript sf (Xs) = Xs. A full account of martingale theory is [12], while a 
brief though precise analysis of discrete time martingale is [16]. 
9.4.5 
Autoregressive and GARCH Processes 
Let upper X equals left parenthesis upper X Subscript t Baseline right parenthesis Subscript t element of double struck upper NX = (Xt)t∈N be a white noise with zero mean function sans serif upper E left parenthesis t right parenthesis equals 0E(t) = 0. We can 
construct another discrete-time process upper Y equals left parenthesis upper Y Subscript t Baseline right parenthesis Subscript t element of double struck upper NY = (Yt)t∈N by letting 
upper Y Subscript t Baseline minus mu equals theta left parenthesis upper Y Subscript t minus 1 Baseline minus mu right parenthesis plus upper X Subscript t Baseline comma for all t element of double struck upper N and theta comma mu element of double struck upper R periodYt −μ = θ(Yt−1 −μ) + Xt,
for all t ∈N and θ, μ ∈R.
(9.8) 
The process Y is called autoregressive or AR(1) process; we can choose upper X Subscript t Baseline tilde normal upper N left parenthesis 0 comma sigma squared right parenthesisXt ∼
N(0, σ 2) with sans serif c o v left parenthesis upper X Subscript s Baseline comma upper X Subscript t Baseline right parenthesis equals 0cov(Xs, Xt) = 0 for all s less than ts < t. We only conﬁne ourselves to ﬁrst 
order AR processes, meaning that the stochastic difference equation (9.8) involves  
only two subsequent rvs upper Y Subscript t Baseline comma upper Y Subscript t minus 1 BaselineYt, Yt−1 with time lag 1. For AR of greater integer order 
see [4]. The term theta left parenthesis upper Y Subscript t minus 1 Baseline minus mu right parenthesisθ(Yt−1−μ) records the past deviation from the mean, affecting the 
current behavior of Y. If  thetaθ has large absolute value the ‘feedback’ of the past into
9.4
Special Kinds of Processes
251
the future is large too. If theta equals 0θ = 0 we have upper Y Subscript t Baseline equals mu plus upper X Subscript tYt = μ + Xt which is a white noise. If upper Y Subscript tYt is 
the rate of return of a ﬁnancial asset with t equals 1t = 1 day, then upper X Subscript tXt can be though of as the 
effect on the asset’s price of new information revealed at time t. But this information 
cannot be anticipated, so upper X Subscript tXt should be independent of upper X Subscript t minus 1Xt−1. It can be shown that 
if StartAbsoluteValue theta EndAbsoluteValue less than 1|θ| < 1 then Y is weakly stationary, see [4], and we made this assumption from 
now on. The expression for Y can be written as 
upper Y Subscript t Baseline equals left parenthesis 1 minus theta right parenthesis mu plus theta upper Y Subscript t minus 1 Baseline plus upper X Subscript t Baseline commaYt = (1 −θ)μ + θYt−1 + Xt,
(9.9) 
which is a regression equation. By weak stationarity the mean function (viz. 
unconditional expectation) is constant, say c element of double struck upper Rc ∈R, and from Eq. (9.9): 
StartLayout 1st Row 1st Column c equals sans serif upper E left parenthesis upper Y Subscript t Baseline right parenthesis 2nd Column equals 3rd Column left parenthesis 1 minus theta right parenthesis mu plus theta sans serif upper E left parenthesis upper Y Subscript t Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column mu minus theta mu plus theta c 3rd Row 1st Column Blank 2nd Column long left right double arrow 3rd Column Blank 4th Row 1st Column c left parenthesis 1 minus theta right parenthesis 2nd Column equals 3rd Column mu left parenthesis 1 minus theta right parenthesis period EndLayoutc = E(Yt)
=
(1 −θ)μ + θE(Yt)
=
μ −θμ + θc
⇐⇒
c(1 −θ)
=
μ(1 −θ).
Let a equals left parenthesis 1 minus theta right parenthesis mua = (1 −θ)μ, then recalling what a best linear prediction means we have: 
• 
.E(Yt | Yt−1) = a + θYt−1 (one period forecast)2 
• 
. V(Yt | Yt−1) = V(Xt) = σ 2
• 
. E(Yt) =
a
1−θ
• 
.V(Yt) =
σ 2
1−θ2 . 
The ﬁrst item is trivial, for the other two see Appendix in Chap. 9. Yet another 
equivalent formulation is 
StartLayout 1st Row upper Y Subscript t Baseline equals mu plus sigma summation Underscript h equals 0 Overscript normal infinity Endscripts theta upper X Subscript t minus h Baseline comma EndLayoutYt = μ +
∞
⎲
h=0
θXt−h,
obtained by recursive substitutions in (9.8), which holds for times t element of double struck upper Zt ∈Z. A process 
related to AR(1) is the GARCH(1,1) which is used in modelling the volatility of 
asset prices, namely a measure of price variability over some time horizon. Before 
to explain it in detail, we complete the partial list of stylized facts about asset returns 
introduced in Sect. 2.7, Remark 2.9. 
1. Daily returns have little correlation, sans serif c o r r left parenthesis r Subscript t Baseline comma r Subscript t minus h Baseline right parenthesiscorr(rt, rt−h), whatever the time lag h equals 1 comma 2 comma ellipsish =
1, 2, . . .. 
2. The unconditional probability distribution sans serif upper P Subscript r Sub Subscript tPrt is not Gaussian. 
3. . Prt is not symmetric (it is skewed), i.e., market exhibits very large drawdown but 
not equally large drawup.
2 Parameters a comma thetaa, θ must be estimated. 
252
9
Introduction to Stochastic Processes
4. Standard deviation sans serif upper S upper D left parenthesis r Subscript t Baseline right parenthesisSD(rt) completely dominates the mean sans serif upper E left parenthesis r Subscript t Baseline right parenthesisE(rt), at short time 
horizon (usually days). 
5. Squared returns r Subscript t Superscript 2r2
t as measures of variability displays positive correlation with 
its own past, i.e. sans serif c o r r left parenthesis r Subscript t plus h Superscript 2 Baseline comma r Subscript t Superscript 2 Baseline right parenthesis greater than 0corr(r2
t+h, r2
t ) > 0. 
6. Leverage effects: equities (stocks and indices) display negative correlation 
between variance and mean returns. 
7. Correlation between assets returns sans serif c o r r left parenthesis r Subscript t Superscript asset number sign 1 Baseline comma r Subscript t Superscript asset number sign 2 Baseline right parenthesiscorr(rasset #1
t
, rasset #2
t
) varies in t: it increases 
in highly volatile down markets or during market crashes. 
8. .PRt has fatter tails, even after standardizing returns by a time-varying volatility 
measure. 
9. The more increases horizon, the more sans serif upper P Subscript r Sub Subscript tPrt aggregates as a Gaussian distribution. 
Note that all the above facts apply as well to daily log-returns. As a result, the 
price volatility varies as time elapses and clusters in period of high and low 
market movements. In particular, item 5 suggests that squared returns are positively 
autocorrelated, thus if we want to model returns only one discrete-time process is 
not enough: we need a second discrete-time process for the volatility. In its simplest 
form we have: 
StartLayout 1st Row 1st Column r Subscript t 2nd Column equals 3rd Column mu plus sigma Subscript t Baseline epsilon Subscript t Baseline comma epsilon Subscript t Baseline IID normal upper N left parenthesis 0 comma 1 right parenthesis EndLayout StartLayout 2nd Row 1st Column sigma Subscript t Superscript 2 2nd Column equals 3rd Column alpha 1 plus alpha 2 left parenthesis r Subscript t minus 1 Baseline minus mu right parenthesis squared plus alpha 3 sigma Subscript t minus 1 Superscript 2 Baseline alpha 1 comma alpha 2 comma alpha 3 greater than or slanted equals 0 period EndLayoutrt = μ + σtϵt,
ϵt IID N(0, 1)Alt-text already available with first equation in this block
(9.10) 
σ 2 
t = α1 + α2(rt−1 −μ)2 + α3σ 2 
t−1 
α1, α2, α3 ⩾0.
(9.11) 
The nonnegative constrains ensure that sigma Subscript t Superscript 2σ 2
t is never negative, as it should be. It is 
further assumed that alpha 2 plus alpha 3 greater than 1α2 + α3 > 1 and alpha 1 greater than 0α1 > 0, in order the GARCH(1,1) being 
strictly stationary, see [4]. 
9.5 
Brownian Motion Process 
A standard Wiener process or Brownian motion upper B equals left parenthesis upper B Subscript t Baseline right parenthesis Subscript t greater than or slanted equals 0B = (Bt)t⩾0 is a continuous-time 
process that satisﬁes the following properties: 
1. .B0 = 0. 
2. B has independent increments. 
3. .Bt −Bs ∼N(0, t −s), for 0 less than or slanted equals s less than t period0 ⩽s < t.
4. .E(Bt | Fs) = Bs, for 0 less than or slanted equals s less than t0 ⩽s < t
5. For any omega element of upper Omega commaω ∈Ω, the sample path t right arrow from bar upper B Subscript t Baseline left parenthesis omega right parenthesist ⍿→Bt(ω) is a continuous and nowhere 
differentiable function. 
A Brownian motion is a Gaussian process, a stationary process with stationary 
increments, a martingale and a (strong) Markov process, see [12, Ch III, §3]. 
Intuitively, this means that the increments upper B Subscript t Sub Subscript n Baseline minus upper B Subscript t Sub Subscript n minus 1Btn −Btn−1 do not depend on the position
9.5
Brownian Motion Process
253
Fig. 9.7 Sample path of a 
standard Brownian motion 
0
100
200
300
400
500 
−1 
0 
1 
2 
3 
time 
B(t) 
at t Subscript n minus 1tn−1 over the time interval left bracket t Subscript n minus 1 Baseline comma t Subscript n Baseline right bracket[tn−1, tn]. It follows  that  
StartLayout 1st Row 1st Column Blank 2nd Column Blank 3rd Column sans serif upper P left parenthesis upper B Subscript t Sub Subscript n Subscript Baseline less than or slanted equals x Subscript n Baseline vertical bar upper B Subscript t Sub Subscript i Subscript Baseline equals x Subscript i Baseline comma 0 less than or slanted equals i less than or slanted equals n minus 1 right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper B Subscript t Sub Subscript n Subscript Baseline less than or slanted equals x Subscript n Baseline minus x Subscript n minus 1 Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript x Subscript n Baseline minus x Subscript n minus 1 Baseline Baseline StartFraction 1 Over StartRoot 2 pi left parenthesis t Subscript n Baseline minus t Subscript n minus 1 Baseline right parenthesis EndRoot EndFraction exp left parenthesis minus StartFraction u squared Over 2 left parenthesis t Subscript n Baseline minus t Subscript n minus 1 Baseline right parenthesis EndFraction right parenthesis normal d u period EndLayout
P
(
Btn ⩽xn | Bti = xi, 0 ⩽i ⩽n −1
)
= P
(
Btn ⩽xn −xn−1
)
=
⎰xn−xn−1
−∞
1
√
2π(tn −tn−1)
exp
⎛
−
u2
2(tn −tn−1)
⎞
du.
The behavior of a standard Brownian motion can be analyzed via simulation in R: 
A progra m cod
e. Line  1  rea
ds n steps less th
an hy phen 600. Line 2 reads set dot
 seed lef t parenthes
is 82210 56  right par en thesis.
For more details on this code see Sect. 9.4.3. Here  sqrt(0.05) guarantees a time 
interval of size 0.050.05 for the nsteps increments of the simulated path. Figure 9.7 
shows one typical sample path of a standard Brownian motion. 
An additional property of a standard Brownian motion is the reﬂection principle: 
the ﬁrst time upper B Subscript tBt hits a element of double struck upper Ra ∈R, called the hitting time3 upper T Subscript a Baseline colon equals inf left brace t greater than or slanted equals 0 vertical bar upper B Subscript t Baseline equals a right braceTa := inf{t ⩾0 | Bt = a}, it is  
equally likely that B moves either up or down, so each path is reﬂected about upper B Subscript upper T Sub Subscript a Baseline equals aBTa =
3 Note that it is a rv. 
254
9
Introduction to Stochastic Processes
a with equal distribution of the path after the point left parenthesis a comma upper T Subscript a Baseline right parenthesis(a, Ta) in the Cartesian plane. 
It is interesting how the symmetric random walk we have seen in Sect. 9.4.3 can 
be used to get the Brownian motion using appropriate asymptotic stochastic limits. 
First, by CLT the scaled version converges in distribution to a normal standard: 
StartFraction upper W Subscript t Baseline Over StartRoot t EndRoot EndFraction right arrow Overscript d Endscripts normal upper N left parenthesis 0 comma 1 right parenthesis Wt
√t
d−→N(0, 1), as integer times t right arrow normal infinityt →∞. On the other hand, considering the time 
horizon left bracket 0 comma t right bracket[0, t] with t greater than 0t > 0 ﬁxed, we could increase the number of rvs upper Z Subscript tZt in the 
deﬁnition of W being aware that t is a natural number. Thus, we can deﬁne 
upper W Subscript t Baseline colon equals c left parenthesis upper Z 1 plus midline horizontal ellipsis plus upper Z Subscript left floor t divided by h right floor Baseline right parenthesis commaWt := c(Z1 + · · · + Z⎿t/h⏌),
(9.12) 
for a constant c element of double struck upper Rc ∈R and h greater than 0h > 0 s.t. n equals left floor t divided by h right floorn = ⎿t/h⏌is the number of subintervals of 
left bracket 0 comma t right bracket[0, t] with equal length h, where left floor dot right floor⎿· ⏌is the ﬂoor function giving the greater positive 
integer less than or slanted equals StartFraction t Over h EndFraction⩽
t
h. Thus, for example, if t equals 4.4t = 4.4 and h equals 0.5h = 0.5 we get StartFraction t Over h EndFraction equals 8.8 t
h = 8.8 and 
left floor t divided by h right floor equals 8⎿t/h⏌= 8. If StartFraction t Over h EndFractiont
h is not integer, we can interpolate upper W Subscript s Baseline comma upper W Subscript u BaselineWs, Wu, for s less than t less than us < t < u, whenever 
StartFraction s Over h EndFraction comma StartFraction u Over h EndFraction s
h, u
h are positive integer: 
upper W Subscript t Baseline equals alpha upper W Subscript s Baseline plus left parenthesis 1 minus alpha right parenthesis upper W Subscript u Baseline comma alpha equals StartFraction u minus t Over u minus s EndFraction element of left bracket 0 comma 1 right bracket periodWt = αWs + (1 −α)Wu,
α = u−t
u−s ∈[0, 1].
Substituting the expressions of upper W Subscript s Baseline comma upper W Subscript u BaselineWs, Wu given by (9.12) and of alphaα, then rearranging 
we get upper W Subscript tWt. The expectation and variance are: 
sans serif upper E left parenthesis upper W Subscript t Baseline right parenthesis equals 0 comma sans serif upper V left parenthesis upper W Subscript t Baseline right parenthesis equals c squared left floor t divided by h right floor periodE(Wt) = 0,
V(Wt) = c2 ⎿t/h⏌.
By setting c equals StartRoot h EndRootc =
√
h and letting n right arrow normal infinityn →∞we have 
limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis upper W Subscript t Baseline right parenthesis equals 0 comma limit Underscript n right arrow normal infinity Endscripts sans serif upper V left parenthesis upper W Subscript t Baseline right parenthesis equals t period lim
n→∞E(Wt) = 0,
lim
n→∞V(Wt) = t.
The second equation follows since t divided by h minus left floor t divided by h right floort/h −⎿t/h⏌is the decimal part of StartFraction t Over h EndFractiont
h and to 
recover the integer one we can write 
left floor StartFraction t Over h EndFraction right floor equals StartFraction t Over h EndFraction minus sigma summation Underscript k equals 1 Overscript normal infinity Endscripts c Subscript k Baseline 10 Superscript negative k Baseline comma c Subscript k Baseline element of StartSet 1 comma 2 comma ellipsis comma 9 EndSet period⎿t
h⏌= t
h −
∞
⎲
k=1
ck10−k,
ck ∈{1, 2, . . . , 9}.
Now, n right arrow normal infinityn →∞is equivalent to taking the limit 
limit Underscript h right arrow 0 Endscripts h left parenthesis StartFraction t Over h EndFraction minus sigma summation Underscript k equals 1 Overscript normal infinity Endscripts c Subscript k Baseline 10 Superscript negative k Baseline right parenthesis equals t lim
h→0 h
⎛
t
h −
∞
⎲
k=1
ck10−k
⎞
= t
and we are done. Eventually, by CLT and standardization we get: 
StartFraction upper W Subscript t Baseline Over StartRoot h left floor t divided by h right floor EndRoot EndFraction right arrow Overscript normal d Endscripts normal upper N left parenthesis 0 comma 1 right parenthesis comma as n right arrow normal infinity
Wt
√h⎿t/h⏌
d−→N(0, 1),
as n →∞
9.5
Brownian Motion Process
255
which together with h left floor StartFraction t Over h EndFraction right floor right arrow th⎿t
h⏌→t implies StartFraction upper W Subscript t Baseline Over StartRoot t EndRoot EndFraction tilde normal upper N left parenthesis 0 comma 1 right parenthesis Wt
√t
∼N(0, 1) or equivalently upper W Subscript t Baseline tilde normal upper N left parenthesis 0 comma t right parenthesisWt ∼
N(0, t). It is apparent how the limit rv upper W Subscript tWt and upper B Subscript tBt have the same distribution. This 
construction suggests why properties 1–4 of a Brownian motion hold. In particular, 
properties 2 and 3 depends on (9.12), since the scaled symmetric random walk is 
made of IID rvs. It follows that the MGF 
StartLayout 1st Row 1st Column upper M Subscript upper B Sub Subscript t Subscript minus upper B Sub Subscript s Baseline left parenthesis u right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis normal e Superscript u left parenthesis upper B Super Subscript t Superscript minus upper B Super Subscript s Superscript right parenthesis Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper E left parenthesis normal e Superscript u upper B Super Subscript t Superscript Baseline right parenthesis sans serif upper E left parenthesis normal e Superscript u left parenthesis minus upper B Super Subscript s Superscript right parenthesis Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column upper M Subscript upper B Sub Subscript t Baseline left parenthesis u right parenthesis upper M Subscript minus upper B Sub Subscript s Baseline left parenthesis u right parenthesis equals normal e Superscript u squared left parenthesis t minus s right parenthesis EndLayoutMBt−Bs(u) = E(eu(Bt−Bs))
= E(euBt )E(eu(−Bs))
= MBt (u)M−Bs(u) = eu2(t−s)
it clearly that of a Gaussian rv, see Eq. (5.12) in Sect. 5.7. Moreover, it has been 
tacitly assumed that B is adapted to the ﬁltration StartSet script upper F Subscript t Baseline EndSet{Ft}, and again the construction via 
the symmetric random walk yields that the rv upper B Subscript t Baseline minus upper B Subscript sBt −Bs, for s less than ts < t, is s.t. its generated 
sigma hyphen algebraσ-algebra sigma left parenthesis upper B Subscript t Baseline minus upper B Subscript s Baseline right parenthesisσ(Bt −Bs) is independent from script upper F Subscript sFs, i.e., the possible trajectories of B 
from t equals 0t = 0 up to s greater than 0s > 0 do not affect the values of upper B Subscript t Baseline minus upper B Subscript sBt −Bs. Form this and the 
properties of the general conditional expectation it follows: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper B Subscript t Baseline vertical bar script upper F Subscript s Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis left parenthesis upper B Subscript t Baseline minus upper B Subscript s Baseline right parenthesis plus upper B Subscript s Baseline vertical bar script upper F Subscript s Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper E left parenthesis upper B Subscript t Baseline minus upper B Subscript s Baseline vertical bar script upper F Subscript s Baseline right parenthesis plus sans serif upper E left parenthesis upper B Subscript s Baseline vertical bar script upper F Subscript s Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column ModifyingBelow sans serif upper E left parenthesis upper B Subscript t Baseline minus upper B Subscript s Baseline right parenthesis With bottom brace Underscript equals 0 Endscripts plus upper B Subscript s Baseline period EndLayoutE(Bt | Fs) = E((Bt −Bs) + Bs | Fs)
= E(Bt −Bs | Fs) + E(Bs | Fs)
= E(Bt −Bs)
◟
◝◜
◞
= 0
+Bs.
Since for s less than ts < t we have 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis left parenthesis left parenthesis upper B Subscript t Baseline minus upper B Subscript s Baseline right parenthesis plus upper B Subscript s Baseline right parenthesis upper B Subscript s Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis left parenthesis upper B Subscript t Baseline minus upper B Subscript s Baseline right parenthesis upper B Subscript s Baseline right parenthesis plus sans serif upper E left parenthesis upper B Subscript s Superscript 2 Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column ModifyingBelow sans serif upper E left parenthesis upper B Subscript t Baseline minus upper B Subscript s Baseline right parenthesis sans serif upper E left parenthesis upper B Subscript s Baseline right parenthesis With bottom brace Underscript equals 0 Endscripts plus s 3rd Row 1st Column Blank 2nd Column equals 3rd Column s comma EndLayoutE
⎛(
(Bt −Bs) + Bs
)
Bs
⎞
= E
(
(Bt −Bs)Bs
)
+ E(B2
s )
= E(Bt −Bs)E(Bs)
◟
◝◜
◞
=0
+s
= s,
and similarly for the reverse direction t less than s commat < s, it holds: 
sans serif c o v left parenthesis s comma t right parenthesis colon equals sans serif upper E left parenthesis upper B Subscript s Baseline upper B Subscript t Baseline right parenthesis equals min left brace s comma t right brace periodcov(s, t) := E(Bs Bt) = min{s, t}.
A proof of property 5 is in [2]. More detailed accounts of Brownian motion are [9] 
and [12]. Some processes can be derived by a standard Brownian motion. The ﬁrst 
is Brownian motion starting at x 0 element of double struck upper Rx0 ∈R, which can be obtained as x 0 plus upper B Subscript tx0 + Bt for every 
t greater than or slanted equals 0t ⩾0. Scaled Brownian motions are upper B Subscript c tBc t and StartRoot c EndRoot upper B Subscript t√cBt, for all t greater than or slanted equals 0t ⩾0. A  Brownian 
motion with drift is the process given by 
upper B overTilde Subscript t Baseline colon equals mu t plus sigma upper B Subscript t Baseline comma for all t greater than or slanted equals 0 comma ˜Bt := μt + σBt,
for all t ⩾0,
(9.13)
256
9
Introduction to Stochastic Processes
where mu element of double struck upper Rμ ∈R is called the drift and sigma greater than 0σ > 0 is called the diffusion parameter. This  
process can be used as a model for continuous-time log-returns, where muμ can be 
thought of as the mean instantaneous compounded return, and sigmaσ can be interpreted 
as the instantaneous volatility of the underlying price process. In fact, the price 
process can be modelled as a geometric Brownian motion: 
upper S Subscript t Baseline colon equals upper S 0 normal e Superscript mu t plus sigma upper B Super Subscript t Superscript Baseline equals upper S 0 normal e Superscript upper B overTilde Super Subscript t Superscript Baseline comma for all t greater than or slanted equals 0 comma and constant upper S 0 element of double struck upper R periodSt := S0eμt+σBt = S0e ˜Bt ,
for all t ⩾0, and constant S0 ∈R.
(9.14) 
Clearly, upper S 0S0 can be interpreted as the initial stock price and ln left parenthesis StartFraction upper S Subscript t Baseline Over upper S 0 EndFraction right parenthesis equals upper B overTilde Subscript tln( St
S0 ) =
˜Bt. Since 
upper B overTilde Subscript t Baseline tilde normal upper N left parenthesis mu t comma sigma squared t right parenthesis ˜Bt ∼N(μt, σ 2t) it follows that upper S Subscript tSt is log-normal with the same parameters, i.e., 
its natural logarithm is normal upper N left parenthesis mu t comma sigma squared t right parenthesisN(μt, σ 2t), while sans serif upper E left parenthesis upper S Subscript t Baseline right parenthesis equals upper S 0 normal e Superscript mu t plus sigma squared 2 t divided by 2E(St) = S0eμt+σ 22t/2 and sans serif upper V left parenthesis upper S Subscript t Baseline right parenthesis equals upper S 0 squared normal e Superscript 2 mu t plus sigma squared t Baseline left parenthesis normal e Superscript sigma squared t Baseline minus 1 right parenthesisV(St) =
S2
0e2μt+σ 2t(eσ 2t −1), see Exercise 9.3. 
9.6 
Exercises 
9.1 Prove that Bc t  and √cBt yield a Brownian motion, for all t ⩾0. 
9.2 Compute the probability that a standard Brownian motion is below b ∈ R at 
t = 4, conditional on B1 = a, for  a ∈ R. 
9.3 Find the distribution of a Brownian motion with drift and of a geometric 
Brownian motion. 
9.4 Given a standard Brownian motion, ﬁnd the distribution of the hitting time 
Ta = inf{t ⩾0 | BT = a}, for a constant a >  0. 
9.5 Given a standard Brownian motion, ﬁnd the CDF of the running maximum 
¯Bt := supu∈[0,t] Bu, i.e., compute F ¯Bt (a) for a, t > 0. 
Appendix 
Details on AR(1) and GARCH(1,1) Processes 
We show that sans serif upper V left parenthesis upper Y Subscript t Baseline vertical bar upper Y Subscript t minus 1 Baseline right parenthesis equals sans serif upper V left parenthesis upper X Subscript t Baseline right parenthesis equals sigma squaredV(Yt | Yt−1) = V(Xt) = σ 2. Note that by construction f left parenthesis upper Y Subscript t minus 1 Baseline right parenthesis equals a plus theta upper Y Subscript t minus 1f (Yt−1) =
a + θYt−1 and upper X Subscript tXt are independent thus we have: 
StartLayout 1st Row 1st Column sans serif upper V left parenthesis upper Y Subscript t Baseline vertical bar upper Y Subscript t minus 1 Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper V left parenthesis a plus theta upper Y Subscript t minus 1 Baseline vertical bar upper Y Subscript t minus 1 Baseline right parenthesis plus sans serif upper V left parenthesis upper X Subscript t Baseline vertical bar upper Y Subscript t minus 1 Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper E left parenthesis left parenthesis a plus theta upper Y Subscript t minus 1 Baseline right parenthesis squared vertical bar upper Y Subscript t minus 1 Baseline right parenthesis minus left brace sans serif upper E left parenthesis a plus theta upper Y Subscript t minus 1 Baseline vertical bar upper Y Subscript t minus 1 Baseline right parenthesis right brace squared plus sans serif upper V left parenthesis upper X Subscript t Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column left parenthesis a plus theta upper Y Subscript t minus 1 Baseline right parenthesis squared minus left parenthesis a plus theta upper Y Subscript t minus 1 Baseline right parenthesis squared plus sans serif upper V left parenthesis upper X Subscript t Baseline right parenthesis equals sans serif upper V left parenthesis upper X Subscript t Baseline right parenthesis period EndLayoutV(Yt | Yt−1) = V(a + θYt−1 | Yt−1) + V(Xt | Yt−1)
= E((a + θYt−1)2 | Yt−1) −{E(a + θYt−1 | Yt−1)}2 + V(Xt)
= (a + θYt−1)2 −(a + θYt−1)2 + V(Xt) = V(Xt).
Appendix
257
Next we show sans serif upper E left parenthesis upper Y Subscript t Baseline right parenthesis equals StartFraction a Over 1 minus theta EndFractionE(Yt) =
a
1−θ and sans serif upper V left parenthesis upper Y Subscript t Baseline right parenthesis equals StartFraction sigma squared Over 1 minus theta squared EndFractionV(Yt) =
σ 2
1−θ2 . If  Y is weakly stationary, then 
sans serif upper E left parenthesis upper Y Subscript t Baseline right parenthesis equals cE(Yt) = c, sans serif upper V left parenthesis upper Y Subscript t Baseline right parenthesis equals gamma left parenthesis 0 right parenthesisV(Yt) = γ (0) and sans serif c o v left parenthesis upper Y Subscript t Baseline comma upper Y Subscript t plus h Baseline right parenthesis equals gamma left parenthesis h right parenthesiscov(Yt, Yt+h) = γ (h), for integer h element of double struck upper Nh ∈N. Moreover, 
sans serif upper E left parenthesis upper Y Subscript t Baseline right parenthesis equals a plus theta sans serif upper E left parenthesis upper Y Subscript t minus 1 Baseline right parenthesis iff c equals a plus theta c iff c equals StartFraction a Over 1 minus theta EndFraction periodE(Yt) = a + θE(Yt−1) iff c = a + θc iff c =
a
1 −θ .
Note what this implies: the mean function of upper Y Subscript tYt exists iff theta not equals 1θ /= 1, and is zero iff 
a equals 0a = 0. For the converse, assume StartAbsoluteValue theta EndAbsoluteValue less than 1|θ| < 1. Now, by repeated substitutions (as time 
goes to normal infinity∞): 
StartLayout 1st Row 1st Column upper Y Subscript t 2nd Column equals 3rd Column a plus theta upper Y Subscript t minus 1 plus upper X Subscript t 2nd Row 1st Column Blank 2nd Column equals 3rd Column a plus theta left parenthesis a plus theta upper Y Subscript t minus 2 Baseline plus upper X Subscript t minus 1 Baseline right parenthesis plus upper X Subscript t 3rd Row 1st Column Blank 2nd Column vertical ellipsis 3rd Column Blank 4th Row 1st Column Blank 2nd Column equals 3rd Column a left parenthesis 1 plus theta plus theta squared plus midline horizontal ellipsis right parenthesis plus left parenthesis upper X Subscript t Baseline plus theta upper X Subscript t minus 1 Baseline plus theta squared upper X Subscript t minus 2 Baseline plus midline horizontal ellipsis right parenthesis 5th Row 1st Column Blank 2nd Column equals 3rd Column a sigma summation Underscript i equals 0 Overscript normal infinity Endscripts theta Superscript i Baseline plus sigma summation Underscript i equals 0 Overscript normal infinity Endscripts theta Superscript i Baseline upper X Subscript t minus i Baseline period EndLayoutYt = a + θYt−1 + Xt
= a + θ(a + θYt−2 + Xt−1) + Xt
...
= a(1 + θ + θ2 + · · · ) + (Xt + θXt−1 + θ2Xt−2 + · · · )
= a
∞
⎲
i=0
θi +
∞
⎲
i=0
θiXt−i.
Then sigma summation Underscript i equals 0 Overscript normal infinity Endscripts theta Superscript i Baseline equals StartFraction 1 Over 1 minus theta EndFraction∑∞
i=0 θi =
1
1−θ and 
sans serif upper E left parenthesis upper Y Subscript t Baseline right parenthesis equals sans serif upper E left parenthesis a sigma summation Underscript i equals 0 Overscript normal infinity Endscripts theta Superscript i Baseline right parenthesis plus sans serif upper E left parenthesis sigma summation Underscript i equals 0 Overscript normal infinity Endscripts theta Superscript i Baseline upper X Subscript t minus i Baseline right parenthesis equals StartFraction a Over 1 minus theta EndFraction plus 0 periodE(Yt) = E
⎛
a
∞
⎲
i=0
θi
⎞
+ E
⎛∞
⎲
i=0
θiXt−i
⎞
=
a
1 −θ + 0.
Moreover we see that: 
StartLayout 1st Row 1st Column sans serif upper V left parenthesis upper Y Subscript t Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper V left parenthesis StartFraction a Over 1 minus theta EndFraction plus sigma summation Underscript i equals 0 Overscript normal infinity Endscripts theta Superscript i Baseline upper X Subscript t minus i Baseline right parenthesis equals sans serif upper V left parenthesis sigma summation Underscript i equals 0 Overscript normal infinity Endscripts theta Superscript i Baseline upper X Subscript t minus i Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column StartLayout 1st Row indep period 2nd Row equals EndLayout 3rd Column sigma summation Underscript i equals 0 Overscript normal infinity Endscripts sans serif upper V left parenthesis theta Superscript i Baseline upper X Subscript t minus i Baseline right parenthesis equals sigma squared left parenthesis 1 plus theta squared plus theta Superscript 4 Baseline plus midline horizontal ellipsis right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction sigma squared Over 1 minus theta squared EndFraction comma since also StartAbsoluteValue theta squared EndAbsoluteValue less than 1 period EndLayoutV(Yt)
=
V
⎛
a
1 −θ +
∞
⎲
i=0
θiXt−i
⎞
= V
⎛∞
⎲
i=0
θiXt−i
⎞
indep.
=
∞
⎲
i=0
V(θiXt−i) = σ 2(1 + θ2 + θ4 + · · · )
=
σ 2
1 −θ2 , since also |θ2| < 1.
258
9
Introduction to Stochastic Processes
Further, the autocovariance function is:4 
StartLayout 1st Row 1st Column sans serif c o v left parenthesis upper Y Subscript t Baseline comma upper Y Subscript t minus h Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis left parenthesis sigma summation Underscript i equals 0 Overscript normal infinity Endscripts theta Superscript i Baseline upper X Subscript t minus i Baseline right parenthesis dot left parenthesis sigma summation Underscript j equals 0 Overscript normal infinity Endscripts theta Superscript i Baseline upper X Subscript t minus j minus h Baseline right parenthesis right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript i equals 0 Overscript normal infinity Endscripts sigma summation Underscript j equals 0 Overscript normal infinity Endscripts theta Superscript i Baseline theta Superscript j Baseline sans serif upper E left parenthesis upper X Subscript t minus i Baseline upper X Subscript t minus j minus h Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column StartLayout 1st Row k equals j plus h 2nd Row equals EndLayout 3rd Column sigma summation Underscript i equals 0 Overscript normal infinity Endscripts sigma summation Underscript k equals h Overscript normal infinity Endscripts theta Superscript i Baseline theta Superscript j Baseline sans serif upper E left parenthesis upper X Subscript t minus i Baseline upper X Subscript t minus k Baseline right parenthesis 4th Row 1st Column Blank 2nd Column equals 3rd Column sigma squared sigma summation Underscript i equals 0 Overscript normal infinity Endscripts theta Superscript i Baseline theta Superscript i plus h Baseline equals StartFraction sigma squared theta Superscript h Baseline Over 1 minus theta squared EndFraction equals theta Superscript h Baseline sans serif upper V left parenthesis upper Y Subscript t Baseline right parenthesis period EndLayoutcov(Yt, Yt−h)
=
E
⎛
⎝
⎛∞
⎲
i=0
θiXt−i
⎞
·
⎛
⎝
∞
⎲
j=0
θiXt−j−h
⎞
⎠
⎞
⎠
=
∞
⎲
i=0
∞
⎲
j=0
θiθjE(Xt−iXt−j−h)
k=j+h
=
∞
⎲
i=0
∞
⎲
k=h
θiθjE(Xt−iXt−k)
=
σ 2
∞
⎲
i=0
θiθi+h = σ 2θh
1 −θ2 = θhV(Yt).
As a consequence, the autocorrelation function is rho left parenthesis h right parenthesis equals theta Superscript hρ(h) = θh, for  h equals 0 comma 1 comma 2 comma ellipsish = 0, 1, 2, . . .. 
Notice that all the autocovariance are ﬁnite by the Cauchy-Schwarz inequality. For 
GARCH(1,1) Eq. (9.11) can be rewritten 
sigma Subscript t Superscript 2 Baseline equals alpha 1 plus left parenthesis alpha 2 upper X Subscript t minus 1 Superscript 2 Baseline plus alpha 3 right parenthesis sigma Subscript t minus 1 Superscript 2 Baseline commaσ 2
t = α1 + (α2X2
t−1 + α3)σ 2
t−1,
from which its expectation is 
sans serif upper E left parenthesis sigma Subscript t Superscript 2 Baseline right parenthesis equals alpha 1 plus left parenthesis alpha 2 plus alpha 3 right parenthesis sans serif upper E left parenthesis sigma Subscript t minus 1 Superscript 2 Baseline right parenthesis commaE(σ 2
t ) = α1 + (α2 + α3)E(σ 2
t−1),
by independence of upper X Subscript t minus 1Xt−1 and sigma Subscript t minus 1 Superscript 2σ 2
t−1. It is possible to generalize the representation 
of GARCH(1,1), if we consider the distribution of return r Subscript trt conditional on its past 
history sigma left parenthesis r Subscript t minus 1 Baseline comma r Subscript t minus 2 Baseline comma ellipsis right parenthesisσ(rt−1, rt−2, . . .) as normal upper N left parenthesis mu comma sigma Subscript t Superscript 2 Baseline right parenthesisN(μ, σ 2
t ), written 
r Subscript t Baseline vertical bar r Subscript t minus 1 Baseline comma r Subscript t minus 2 Baseline comma ellipsis tilde normal upper N left parenthesis mu comma sigma Subscript t Superscript 2 Baseline right parenthesis commart | rt−1, rt−2, . . . ∼N(μ, σ 2
t ),
with volatility given by 
sigma Subscript t Superscript 2 Baseline equals alpha 1 plus alpha 2 left parenthesis r Subscript t minus 1 Baseline minus mu right parenthesis squared plus alpha 3 sigma Subscript t minus 1 Superscript 2 Baseline periodσ 2
t = α1 + α2(rt−1 −μ)2 + α3σ 2
t−1.
It can be shown that the unconditional variance sans serif upper V left parenthesis sigma Subscript t Superscript 2 Baseline right parenthesisV(σ 2
t ) is ﬁnite, the correlation 
left parenthesis r Subscript t Baseline comma r Subscript t minus h Baseline right parenthesis equals 0(rt, rt−h) = 0 for every lag h greater than 0h > 0, and the correlation sans serif c o r r left parenthesis left parenthesis r Subscript t Baseline minus mu right parenthesis squared comma left parenthesis r Subscript t minus h Baseline minus mu right parenthesis squared right parenthesis greater than 0corr((rt −μ)2, (rt−h−μ)2) >
0 for every lag h greater than 0h > 0. By standardization we also have: 
StartFraction r Subscript t Baseline minus mu Over sigma Subscript t Baseline EndFraction vertical bar r Subscript t minus 1 Baseline comma r Subscript t minus 2 Baseline comma ellipsis tilde upper N left parenthesis 0 comma 1 right parenthesis periodrt −μ
σt
| rt−1, rt−2, . . . ∼N(0, 1).
4 We used that a sigma summation Underscript i equals 0 Overscript normal infinity Endscripts theta Superscript ia ∑∞
i=0 θi is a constant. 
Appendix
259
Donsker’s Invariance Principle 
We give some details on one possible construction of a standard Brownian motion, 
for which we gave an heuristic explanation in Sect. 9.5. Let  upper Z 1 comma upper Z 2 comma ellipsisZ1, Z2, . . . be a 
sequence of IID rvs with sans serif upper E left parenthesis upper Z Subscript i Baseline right parenthesis equals 0E(Zi) = 0 and sans serif upper V left parenthesis upper Z Subscript i Baseline right parenthesis equals 1V(Zi) = 1, for  i equals 1 comma 2 comma ellipsisi = 1, 2, . . . Let 
upper S Subscript k Baseline equals upper Z 1 plus midline horizontal ellipsis upper Z Subscript k BaselineSk = Z1 + · · · Zk, for k greater than or slanted equals 1k ⩾1 and set upper S 0 equals 0S0 = 0. Next, deﬁne 
upper S Subscript t Superscript left parenthesis n right parenthesis Baseline colon equals StartFraction upper S Subscript k minus 1 Baseline Over StartRoot n EndRoot EndFraction plus n left parenthesis t minus StartFraction k minus 1 Over n EndFraction right parenthesis StartFraction upper S Subscript k Baseline minus upper S Subscript k minus 1 Baseline Over StartRoot n EndRoot EndFraction commaS(n)
t
:= Sk−1
√n + n
⎛
t −k −1
n
⎞Sk −Sk−1
√n
,
for t element of left bracket StartFraction k minus 1 Over n EndFraction comma StartFraction k Over n EndFraction right brackett ∈[ k−1
n , k
n] and 1 less than or slanted equals k less than or slanted equals n1 ⩽k ⩽n. This means that upper S Subscript t Superscript left parenthesis n right parenthesis Baseline equals StartFraction upper S Subscript k Baseline Over StartRoot n EndRoot EndFractionS(n)
t
=
Sk
√n at points t equals StartFraction k Over n EndFractiont = k
n, for  
0 less than or slanted equals k less than or slanted equals n0 ⩽k ⩽n, and the mapping t right arrow from bar upper S Subscript t Superscript left parenthesis n right parenthesist ⍿→S(n)
t
is linearly interpolated in left bracket StartFraction k minus 1 Over n EndFraction comma StartFraction k Over n EndFraction right bracket[ k−1
n , k
n]. Thus we 
have: 
Theorem 9.3 The stochastic process upper S Superscript left parenthesis n right parenthesis Baseline equals left parenthesis upper S Subscript t Superscript left parenthesis n right parenthesis Baseline right parenthesis Subscript t greater than or slanted equals 0S(n) = (S(n)
t
)t⩾0 converge in distribution to 
the standard Brownian motion, as n right arrow normal infinityn →∞. 
Remark 9.6 They are the FIDIS of upper S Superscript left parenthesis n right parenthesisS(n) that converge to those of the standard 
Brownian motion. This is the notion of convergence in distribution for stochastic 
processes.
Chapter 10 
Introduction to Market Risk Measures 
and Option Pricing 
10.1 
Value-at-Risk 
Let upper X equals upper V Subscript upper T Baseline minus upper V 0X = VT −V0 be a rv describing the proﬁts or losses (P&L) of a single asset 
or portfolio, with future traded value upper V Subscript upper TVT and initial value upper V 0V0. For a single asset we 
have upper V Subscript t Baseline equals upper S Subscript tVt = St for t equals 0 comma upper Tt = 0, T and the actual rv is upper S Subscript upper TST , e.g. a future stock price. In 
case of a portfolio it is possible that upper V Subscript upper TVT depends on several underlying assets, i.e., 
upper V Subscript upper T Baseline equals f left parenthesis upper T comma upper S Subscript 1 comma upper T Baseline comma ellipsis comma upper S Subscript n comma upper T Baseline right parenthesisVT = f (T, S1,T , . . . , Sn,T ), where upper S Subscript i comma upper TSi,T is the T -value of the ith asset or risk factor. 
Financial institutions (e.g. insurance companies, banks, etc.) can use internal value-
at-risk (VaR) models to asses some measures of risk since the 1 st1st Basel Capital 
Accord in 1998, see http://www.bis.org. 
Deﬁnition 10.1 Given a P&L rv X, an horizon upper T greater than 0T > 0 representing the near future, 
value-at-risk at probability level c is given by 
VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis colon equals minus upper Q Subscript upper X Baseline left parenthesis c right parenthesis comma for c element of left parenthesis 0 comma 1 right parenthesis periodVaRc,T (X) := −QX(c),
for c ∈(0, 1).
(10.1) 
It is a measure quantifying the loss due to portfolio changes over left bracket 0 comma upper T right bracket[0, T ], s.t. one is 
conﬁdent at 100 left parenthesis 1 minus c right parenthesis percent sign100(1−c)% to undertake an actual loss not exceeding VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis identical to upper KVaRc,T (X) ≡K
e, while there is only a 100 c percent sign100c% chance of a larger loss. Usually upper T equalsT = 1 day or 1 week 
and c equals 0.01c = 0.01 or c equals 0.05c = 0.05, equivalently 1 percent sign1% or 5 percent sign5%. In some textbooks the loss rv 
X is deﬁned as upper V 0 minus upper V Subscript upper T Baseline equals minus left parenthesis upper V Subscript upper T Baseline minus upper V 0 right parenthesisV0 −VT = −(VT −V0), thus an actual loss in T is represented by 
some scenario omega element of upper Omegaω ∈Ω s.t. upper X left parenthesis omega right parenthesis greater than or slanted equals 0X(ω) ⩾0. The deﬁnition of X used in Eq. (10.1) gives  
upper X left parenthesis omega right parenthesis less than or slanted equals 0X(ω) ⩽0 so we need to take its negative to report a meaningful value. Hence with 
the convention upper X equals upper V 0 minus upper V Subscript upper TX = V0 −VT the value-at-risk in Deﬁnition 10.1 need to be stated 
without the minus sign: 
VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis colon equals upper Q Subscript upper X Baseline left parenthesis c right parenthesis comma for c element of left parenthesis 0 comma 1 right parenthesis periodVaRc,T (X) := QX(c),
for c ∈(0, 1).
(10.2) 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4_10
261
262
10
Introduction to Market Risk Measures and Option Pricing
The interpretation changes accordingly and becomes more transparent. For exam-
ple, the same value-at-risk of K e must be reported now with a probability c equals 0.99c = 0.99
or 0.950.95 (equivalently 99 percent sign99% or 95 percent sign95%) and quantiﬁes the loss given portfolio changes 
over the same horizon; 1 percent sign1% or 5 percent sign5% of the time one could experience an actual loss 
exceeding K e (not acceptable), i.e. sans serif upper P left parenthesis upper X greater than VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis right parenthesis equals 1 minus cP(X > VaRc,T (X)) = 1 −c. The latter 
formulation is equivalent to sans serif upper P left parenthesis upper X greater than or slanted equals VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis right parenthesis less than or slanted equals 1 minus cP(X ⩾VaRc,T (X)) ⩽1−c. For absolutely continuous 
distributions we have 
c equals integral Subscript negative normal infinity Superscript upper Q Subscript upper X Baseline left parenthesis c right parenthesis Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x equals upper F Subscript upper X Baseline left parenthesis upper Q Subscript upper X Baseline left parenthesis c right parenthesis right parenthesis comma for every c element of left parenthesis 0 comma 1 right parenthesis periodc =
⎰QX(c)
−∞
fX(x)dx = FX(QX(c)),
for every c ∈(0, 1).
(10.3) 
VaR is one possible choice for a market risk measure needed in risk management. 
Financial markets witnessed increasing risks over the last few decades, especially 
because equity returns, interest rates as well as foreign exchange rates become more 
volatile, and volumes traded in derivatives market are nowadays huge. Financial 
risks can be listed (not exhaustively) as: 
• Market Risk: changes in quoted prices. 
• Credit Risk: counterparts fail to meet contractual obligations. 
• Liquidity Risk: investments (in general positions) cannot be bought or sold 
quickly enough to prevent (or minimize) losses. 
Senior management should asses the risks that junior managers or traders are 
assuming (on behalf of ﬁrms). The economic interpretation of VaR is that it yields 
the amount of extra capital a ﬁrm1 needs as cushion for possible losses with 100 c percent sign100c%
probability of occurrence (e.g. in case of bankruptcy). This economic capital is 
interpreted as a risk-free investment which added to the ﬁnancial exposure makes it 
acceptable to an external regulator. Hence, a negative VaR would imply that the ﬁrm 
may give back a part of its capital to shareholders, or alternatively it might accept 
more risk. In fact, another equivalent deﬁnition is: 
VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis colon equals inf left brace m element of double struck upper R vertical bar sans serif upper P left parenthesis upper X plus m less than 0 right parenthesis less than or slanted equals c right brace comma c element of left parenthesis 0 comma 1 right parenthesis periodVaRc,T (X) := inf
⎨
m ∈R
|| P(X + m < 0) ⩽c
⎬
,
c ∈(0, 1).
(10.4) 
Remark 10.1 Consider the rv upper X equals upper V Subscript upper T Baseline minus upper V 0X = VT −V0 as in Deﬁnition 10.1, Eq. (10.1). 
Its negative negative upper X equals minus left parenthesis upper V Subscript upper T Baseline minus upper V 0 right parenthesis equals upper V 0 minus upper V Subscript upper T−X = −(VT −V0) = V0 −VT , corresponds to the rv used in the 
alternative deﬁnition of VaR in Eq. (10.2). Now we give a uniﬁed deﬁnition2 of 
VaR corresponding to these two rvs and the same probability threshold c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1). 
Assuming the CDF upper F Subscript upper XFX’s graph has no ﬂats, it is easy to verify 
VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis equals minus upper Q Subscript upper X Baseline left parenthesis c right parenthesis equals upper Q Subscript negative upper X Baseline left parenthesis 1 minus c right parenthesis periodVaRc,T (X) = −QX(c) = Q−X(1 −c).
1 We have mentioned banks and insurance companies, i.e. ﬁnancial ﬁrms. But VaR can be used by 
non-ﬁnancial ﬁrms to quantify risks associated to their ﬁnancial exposure. 
2 Is crucial to understand that we start with upper X equals upper V Subscript upper T Baseline minus upper V 0X = VT −V0 and interpret its negative value as possible 
losses, with negative upper X−X being the same losses reported as positive monetary amounts. 
10.1
Value-at-Risk
263
The latter equality can be deduced by observing the plots of the density. In case of 
ﬂats, the situation is slightly more involved, see Appendix. 
For a better understanding of Eq. (10.4) we observe that any CDF provides us with 
two deﬁnitions of inverses: 
upper Q Subscript upper X Superscript minus Baseline left parenthesis c right parenthesis colon equals sup left brace x element of double struck upper R vertical bar upper F Subscript upper X Baseline left parenthesis x right parenthesis less than c right brace comma bold l e f t hyphen bold i n v e r s eQ−
X(c) := sup
⎨
x ∈R
|| FX(x) < c
⎬
,
left-inverse
(10.5) 
upper Q Subscript upper X Superscript plus Baseline left parenthesis c right parenthesis colon equals inf left brace x element of double struck upper R vertical bar upper F Subscript upper X Baseline left parenthesis x right parenthesis greater than c right brace comma bold r i g h t hyphen bold i n v e r s e periodQ+
X(c) := inf
⎨
x ∈R
|| FX(x) > c
⎬
,
right-inverse.
(10.6) 
It can be easily seen that 
• 
.sup
⎨
x ∈R
|| P(X ⩽x) < c
⎬
= inf
⎨
x ∈R
|| P(X ⩽x) ⩾c
⎬
, 
• 
. inf
⎨
x ∈R
|| P(X ⩽x) > c
⎬
= sup
⎨
x ∈R
|| P(X ⩽x) ⩽c
⎬
and the two supremum remains the same by using sans serif upper P left parenthesis upper X less than x right parenthesis equals upper F Subscript upper X Baseline left parenthesis x Superscript minus Baseline right parenthesisP(X < x) = FX(x−). Actually, 
a quantile upper Q Subscript upper X Baseline left parenthesis c right parenthesisQX(c) is any function from left parenthesis 0 comma 1 right parenthesis(0, 1) to double struck upper RR s.t. 
upper Q Subscript upper X Superscript minus Baseline left parenthesis c right parenthesis less than or slanted equals upper Q Subscript upper X Baseline left parenthesis c right parenthesis less than or slanted equals upper Q Subscript upper X Superscript plus Baseline left parenthesis c right parenthesis periodQ−
X(c) ⩽QX(c) ⩽Q+
X(c).
We usually set upper Q Subscript upper X Baseline left parenthesis c right parenthesis equals upper Q Subscript upper X Superscript minus Baseline left parenthesis c right parenthesisQX(c) = Q−
X(c), see Deﬁnition 2.8 in Sect. 2.8, but upper Q Subscript upper X Baseline left parenthesis c right parenthesis equals upper Q Subscript upper X Superscript plus Baseline left parenthesis c right parenthesisQX(c) = Q+
X(c)
is also possible. Consequence: we might deﬁne VaR using right-inverses or left-
inverses as well. In fact, quantiles are, for any CDF upper F Subscript upper XFX, all the values in the 
following intervals: 
• closed, left bracket upper Q Subscript upper X Superscript minus Baseline left parenthesis c right parenthesis comma upper Q Subscript upper X Superscript plus Baseline left parenthesis c right parenthesis right bracket
⎾
Q−
X(c), Q+
X(c)
⏋
, if sans serif upper P left parenthesis upper X equals upper Q Subscript upper X Superscript plus Baseline left parenthesis c right parenthesis right parenthesis equals 0P
(
X = Q+
X(c)
)
= 0, 
• right-open, left bracket upper Q Subscript upper X Superscript minus Baseline left parenthesis c right parenthesis comma upper Q Subscript upper X Superscript plus Baseline left parenthesis c right parenthesis right parenthesis
⎾
Q−
X(c), Q+
X(c)
)
, if sans serif upper P left parenthesis upper X equals upper Q Subscript upper X Superscript plus Baseline left parenthesis c right parenthesis right parenthesis greater than 0P
(
X = Q+
X(c)
)
> 0. 
But observe that upper Q Subscript upper X Superscript minus Baseline left parenthesis c right parenthesis equals upper Q Subscript upper X Superscript plus Baseline left parenthesis c right parenthesis equals upper Q Subscript upper X Baseline left parenthesis c right parenthesisQ−
X(c) = Q+
X(c) = QX(c) if and only if upper F Subscript upper XFX has no ﬂat. Thus, VaR 
can be further rewritten as 
VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis equals minus upper Q Subscript upper X Superscript plus Baseline left parenthesis c right parenthesis equals upper Q Subscript negative upper X Superscript minus Baseline left parenthesis 1 minus c right parenthesis comma fro any c element of left parenthesis 0 comma 1 right parenthesis commaVaRc,T (X) = −Q+
X(c) = Q−
−X(1 −c),
fro any c ∈(0, 1),
(10.7) 
see Exercise 10.2. The economic deﬁnition of VaR is then based on Eq. (10.7) 
relating lower and upper quantiles, see also Appendix. Thus, using 
VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis colon equals inf left brace m element of double struck upper R vertical bar sans serif upper P left parenthesis upper X plus m less than 0 right parenthesis less than or slanted equals c right braceVaRc,T (X) := inf
⎨
m ∈R
|| P(X + m < 0) ⩽c
⎬
one can additionally see that: 
1. if upper X greater than or slanted equals 0X ⩾0, then VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis less than or slanted equals 0VaRc,T (X) ⩽0 and VaR is correctly interpreted as the capital 
amount m that added to the risky position X makes it acceptable; 
2. if upper X less than or slanted equals upper YX ⩽Y, then VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis greater than or slanted equals VaR Subscript c comma upper T Baseline left parenthesis upper Y right parenthesisVaRc,T (X) ⩾VaRc,T (Y), i.e. for a riskier position X the VaR is 
greater; 
3. if lamda greater than or slanted equals 0λ ⩾0, then VaR Subscript c comma upper T Baseline left parenthesis lamda upper X right parenthesis equals lamda VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesisVaRc,T (λX) = λVaRc,T (X), i.e. if a position is scaled (e.g. with 
lamda equals 2λ = 2 it is doubled) the VaR is scaled too;
264
10
Introduction to Market Risk Measures and Option Pricing
4. .VaRc,T (X+k) = VaRc,T (X)−k, for any k element of double struck upper Rk ∈R interpreted as additional risk-free 
cash added to the position (making it safer). 
In item 2, upper X less than or slanted equals upper YX ⩽Y means that increasing the payoff proﬁle of the position the risk 
is reduced. This in related to the usual stochastic order, see Deﬁnition 2.6, Sect. 2.6. 
Indeed, we have: 
• if upper X left parenthesis omega right parenthesis less than or slanted equals upper Y left parenthesis omega right parenthesisX(ω) ⩽Y(ω) for every scenario omegaω then left brace upper X less than or slanted equals x right brace superset of left brace upper Y less than or slanted equals x right brace{X ⩽x} ⊃{Y ⩽x} for any x element of double struck upper Rx ∈R. 
Indeed, reversing the set inclusion, left brace upper X less than or slanted equals x right brace subset of left brace upper Y less than or slanted equals x right brace{X ⩽x} ⊂{Y ⩽x}, we would have that 
there exists a scenario omega element of left brace upper Y less than or slanted equals x right braceω ∈{Y ⩽x} which belongs to left brace upper X greater than x right brace{X > x}, but this implies 
x less than upper X left parenthesis omega right parenthesis less than or slanted equals upper Y left parenthesis omega right parenthesisx < X(ω) ⩽Y(ω) contradicting upper Y left parenthesis omega right parenthesis less than or slanted equals xY(ω) ⩽x; 
• as byproduct upper Omega equals left brace upper X less than or slanted equals upper Y right brace superset of left brace upper X less than or slanted equals x right brace superset of left brace upper Y less than or slanted equals x right braceΩ = {X ⩽Y} ⊃{X ⩽x} ⊃{Y ⩽x}; 
• applying the probability measure we have 1 greater than or slanted equals upper F Subscript upper X Baseline left parenthesis x right parenthesis greater than or slanted equals upper F Subscript upper Y Baseline left parenthesis x right parenthesis1 ⩾FX(x) ⩾FY (x), i.e., the usual 
stochastic order upper X less than or slanted equals Subscript st Baseline upper YX ⩽st Y. 
Remark 10.2 If upper F Subscript upper X overTilde Baseline left parenthesis x right parenthesis greater than or slanted equals upper F Subscript upper Y overTilde Baseline left parenthesis x right parenthesisF ˜X(x) ⩾F ˜Y (x) for all x element of double struck upper Rx ∈R is the usual stochastic order between 
the pair of rvs upper X overTilde comma upper Y overTilde ˜X, ˜Y, then set upper X equals upper Q Subscript upper X overTilde Baseline left parenthesis c right parenthesisX = Q ˜X(c) and upper Y equals upper Q Subscript upper Y overTilde Baseline left parenthesis c right parenthesisY = Q ˜Y (c) with normal upper U tilde normal upper U left parenthesis 0 comma 1 right parenthesisU ∼U(0, 1): we  
have upper Q Subscript upper X overTilde Baseline left parenthesis c right parenthesis less than or slanted equals upper Q Subscript upper Y overTilde Baseline left parenthesis c right parenthesisQ ˜X(c) ⩽Q ˜Y (c) for every c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1) and as byproduct upper X less than or slanted equals upper YX ⩽Y with probability 
1. Therefore, upper X less than or slanted equals upper YX ⩽Y sans serif upper PP-a.s. implies upper X less than or slanted equals upper YX ⩽Y. 
In the context of risk management, the usual stochastic order means that the P&L 
X is more risky than the P&L Y iff the VaR associated to the former is greater than 
the VaR associated to the latter. This is because upper F Subscript upper X Baseline left parenthesis x right parenthesis greater than or slanted equals upper F Subscript upper Y Baseline left parenthesis x right parenthesisFX(x) ⩾FY (x) for all x element of double struck upper Rx ∈R is 
equivalent to upper Q Subscript upper X Baseline left parenthesis c right parenthesis less than or slanted equals upper Q Subscript upper Y Baseline left parenthesis c right parenthesisQX(c) ⩽QY (c) for every c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1). Using arithmetic returns and 
assuming upper T equals 1T = 1, we can write 
upper X equals upper V 1 minus upper V 0 equals upper V 0 r comma for r equals StartFraction upper V 1 minus upper V 0 Over upper V 0 EndFraction commaX = V1 −V0 = V0r,
for r = V1 −V0
V0
,
thus Deﬁnition 10.1 can be restated as 
VaR Subscript c comma 1 Baseline left parenthesis upper X right parenthesis equals minus upper V 0 upper Q Subscript r Baseline left parenthesis c right parenthesis comma for c element of left parenthesis 0 comma 1 right parenthesis periodVaRc,1(X) = −V0Qr(c),
for c ∈(0, 1).
Now the VaR of a P&L is reduced to that of the corresponding arithmetic return, 
then we can let VaR Subscript c comma 1 Baseline left parenthesis upper R right parenthesis equals minus left parenthesis 1 plus upper Q Subscript r Baseline left parenthesis c right parenthesis right parenthesisVaRc,1(R) = −(1 + Qr(c)). Observe that in this daily basis we 
can also use log-returns, but be warned that this is true for a single asset, since 
portfolio log-returns are not equal to the linear combination of individual log-returns 
of the underlying components with given portfolio weights. Indeed, let r Subscript 1 comma t Baseline comma r Subscript 2 comma t Baseliner1,t, r2,t be 
two arithmetic returns and let w 1 comma w 2w1, w2 be the corresponding portfolio weights, see 
Example 2.11, Sect. 2.5, and recall that w 1 plus w 2 equals 1w1 + w2 = 1 and w 1 comma w 2 element of left bracket 0 comma 1 right bracketw1, w2 ∈[0, 1]. Thus, we  
have 
StartLayout 1st Row 1st Column ln left parenthesis 1 plus w 1 r Subscript 1 comma t Baseline plus w 2 r Subscript 2 comma t Baseline right parenthesis 2nd Column equals 3rd Column ln left parenthesis w 1 plus w 2 plus w 1 r Subscript 1 comma t Baseline plus w 2 r Subscript 2 comma t Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column ln left parenthesis w 1 left parenthesis 1 plus r Subscript 1 comma t Baseline right parenthesis plus w 2 left parenthesis 1 plus r Subscript 2 comma t Baseline right parenthesis right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column ln left parenthesis w 1 upper R Subscript 1 comma t Baseline plus w 2 upper R Subscript 2 comma t Baseline right parenthesis EndLayout ln(1 + w1r1,t + w2r2,t) = ln(w1 + w2 + w1r1,t + w2r2,t)
= ln
(
w1(1 + r1,t) + w2(1 + r2,t)
)
= ln
(
w1R1,t + w2R2,t
)
10.2
Coherent Risk Measures
265
from which it is apparent that the portfolio log-return (viz. the last term on the 
right-hand side) is different from portfolio arithmetic return w 1 r Subscript 1 comma t plus w 2 r Subscript 2 comma tw1r1,t + w2r2,t, where 
1 plus r Subscript i comma t Baseline equals upper R Subscript 1 comma t Baseline equals StartFraction upper S Subscript i comma t Baseline Over upper S Subscript i comma t minus 1 Baseline EndFraction1 + ri,t = R1,t =
Si,t
Si,t−1 for i equals 1 comma 2i = 1, 2 and any time t equals 1 comma 2 comma ellipsist = 1, 2, . . .. It only holds that for 
daily or intradaily arithmetic returns r Subscript i comma t Baseline almost equals ln left parenthesis upper R Subscript i comma t Baseline right parenthesisri,t ≈ln(Ri,t), see Sect. 8.5. If r tilde normal upper N left parenthesis mu comma sigma squared right parenthesisr ∼N(μ, σ 2)
we have the following simple formula for daily VaR 
VaR Subscript c comma 1 Baseline left parenthesis upper X right parenthesis equals minus upper V 0 upper Q Subscript mu plus sigma upper Z Baseline left parenthesis c right parenthesis equals minus upper V 0 left parenthesis mu plus sigma upper Q Subscript upper Z Baseline left parenthesis c right parenthesis right parenthesis commaVaRc,1(X) = −V0Qμ+σZ(c) = −V0(μ + σQZ(c)),
where upper Z tilde normal upper N left parenthesis 0 comma 1 right parenthesisZ ∼N(0, 1). 
10.2 
Coherent Risk Measures 
One can think of a risk measure as a mapping rho colon upper L right arrow double struck upper Rϱ : L →R. Possible choices for the 
domain are upper L Superscript 1L1 or upper L squaredL2. Sometimes we can use upper L Superscript normal infinityL∞deﬁned as the collection of rvs X 
s.t. 
inf left brace a greater than or slanted equals 0 vertical bar sans serif upper P left parenthesis StartAbsoluteValue upper X EndAbsoluteValue greater than a right parenthesis equals 0 right brace equals inf left brace a greater than or slanted equals 0 vertical bar sans serif upper P left parenthesis negative a less than or slanted equals upper X less than or slanted equals a right parenthesis equals 1 right brace less than normal infinity commainf{a ⩾0 | P(|X| > a) = 0} = inf{a ⩾0 | P(−a ⩽X ⩽a) = 1} < ∞,
i.e. those rvs which are bounded with probability 1. It is advisable that rhoϱ satisﬁes 
desirable properties (axioms), to meet some requirements called for regulatory 
authorities and supervisory agencies. The following is a partial list of properties. 
Deﬁnition 10.2 (Coherence) A risk measure rho colon upper L Superscript p Baseline right arrow double struck upper Rϱ : Lp →R satisfying 
• monotonicity, upper X less than or slanted equals upper YX ⩽Y implies rho left parenthesis upper X right parenthesis greater than or slanted equals rho left parenthesis upper Y right parenthesis commaϱ(X) ⩾ϱ(Y),
• positive homogeneity, rho left parenthesis lamda upper X right parenthesis equals lamda rho left parenthesis upper X right parenthesisϱ(λX) = λϱ(X), for lamda greater than or slanted equals 0 commaλ ⩾0,
• cash (translation) invariance, if m element of double struck upper Rm ∈R then rho left parenthesis upper X plus m right parenthesis equals rho left parenthesis upper X right parenthesis minus m commaϱ(X + m) = ϱ(X) −m,
• subadditivity, rho left parenthesis upper X plus upper Y right parenthesis less than or slanted equals rho left parenthesis upper X right parenthesis plus rho left parenthesis upper Y right parenthesis commaϱ(X + Y) ⩽ϱ(X) + ϱ(Y),
is called coherent. 
The ﬁrst three properties are the same as those in items 2, 3 and 4 satisﬁed by VaRVaR, 
see Sect. 10.1. If rhoϱ satisﬁes monotonicity and cash invariance, then it is called a 
monetary risk measure. Interpreting X as P&L generated by some trading strategy, 
the former property means that the risk of a loss can be cut off by passing to a 
greater Y with increased payoff. Cash invariance means that rho left parenthesis upper X right parenthesisϱ(X) can be interpreted 
as a capital requirement, needed to cushion the position underlying X and make 
it acceptable.3 Subadditivity means that merging two separate positions X and Y 
cannot increase risk. VaRVaR is not subadditive in general. 
Remark 10.3 For a monetary risk measure rhoϱ, positive homogeneity implies nor-
malization: rho left parenthesis 0 right parenthesis equals 0ϱ(0) = 0. Indeed, for lamda greater than 0λ > 0 and rho left parenthesis 0 right parenthesis equals rho left parenthesis lamda Baseline 0 right parenthesisϱ(0) = ϱ(λ 0) we have lamda rho left parenthesis 0 right parenthesis equals rho left parenthesis 0 right parenthesisλϱ(0) = ϱ(0)
iff rho left parenthesis 0 right parenthesis equals 0ϱ(0) = 0. In the case rho left parenthesis 0 right parenthesis equals rho left parenthesis 0 upper X right parenthesis equals 0ϱ(0) = ϱ(0 X) = 0, the latter is equal to 0 rho left parenthesis upper X right parenthesis0 ϱ(X) which in
3 This is the typical point of view of a supervising agency. 
266
10
Introduction to Market Risk Measures and Option Pricing
turn is equal to zero. Now, a monetary risk measure is convex whenever 
rho left parenthesis lamda upper X plus left parenthesis 1 minus lamda right parenthesis upper Y right parenthesis less than or slanted equals lamda rho left parenthesis upper X right parenthesis plus left parenthesis 1 minus lamda right parenthesis rho left parenthesis upper Y right parenthesis comma for all lamda element of left bracket 0 comma 1 right bracket commaϱ(λX + (1 −λ)Y) ⩽λϱ(X) + (1 −λ)ϱ(Y),
for all λ ∈[0, 1],
which can be interpreted as diversiﬁcation (viz. the position lamda upper X plus left parenthesis 1 minus lamda right parenthesis upper YλX + (1 −λ)Y, with 
a percentage lamdaλ invested in X and the remaining left parenthesis 1 minus lamda right parenthesis(1 −λ) invested in Y) reduces the 
risk. A convex risk measure is coherent if it is in addition positive homogeneous, 
since it can be shown that convexity together with positive homogeneity imply 
subadditivity, see [7, Ch 4]. On the other hand, any coherent risk measure is convex. 
Further desirable properties are the following: 
• instead of subadditivity, given the dependence structure of left parenthesis upper X comma upper Y right parenthesis(X, Y) we can have 
additivity, rho left parenthesis upper X plus upper Y right parenthesis equals rho left parenthesis upper X right parenthesis plus rho left parenthesis upper Y right parenthesisϱ(X + Y) = ϱ(X) + ϱ(Y) provided upper X comma upper YX, Y are comonotonic. Putting 
this kind of P&L together is not an hedge against each other (riskiness never 
decreases); 
• If left parenthesis upper X Subscript n Baseline right parenthesis Subscript n element of double struck upper N(Xn)n∈N is a sequence of P&L’s converging in distribution to the P&L X, then 
limit Underscript n right arrow normal infinity Endscripts rho left parenthesis upper X Subscript n Baseline right parenthesis equals rho left parenthesis upper X right parenthesis period lim
n→∞ϱ(Xn) = ϱ(X).
The following results characterize coherent risk measures using either probability 
laws or their Radon-Nikodým derivatives with respect to equivalent probability 
measures, see Theorem 6.3, Sect. 6.4. 
Theorem 10.1 (Robust Representation of Coherent Risk Measures) Any coher-
ent risk measure is scenario-based, i.e. it can be represented as 
rho left parenthesis upper X right parenthesis equals minus inf left brace sans serif upper E Subscript sans serif upper Q Baseline left parenthesis upper X right parenthesis vertical bar sans serif upper Q element of script upper P right brace equals sup left brace sans serif upper E Subscript sans serif upper Q Baseline left parenthesis negative upper X right parenthesis vertical bar sans serif upper Q element of script upper P right brace commaϱ(X) = −inf{EQ(X) | Q ∈P} = sup{EQ(−X) | Q ∈P},
(10.8) 
where script upper PP is a (convex) set of probability measures and sans serif upper E Subscript sans serif upper QEQ means expectation taken 
w.r.t. sans serif upper QQ. 
Theorem 10.2 (Dual Representation of Coherent Risk Measures) 
Any coherent 
risk measure being scenario-based may be represented as 
rho left parenthesis upper X right parenthesis equals minus inf left brace sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X upper Z right parenthesis vertical bar upper Z greater than or slanted equals 0 comma sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper Z right parenthesis equals 1 right braceϱ(X) = −inf{EP(XZ) | Z ⩾0, EP(Z) = 1}
(10.9) 
where Z is the Radon-Nikodým derivative StartFraction normal d sans serif upper P overTilde Over normal d sans serif upper P EndFractiond ˜P
dP of probability measures sans serif upper P overTilde˜P equivalent 
to the ﬁxed sans serif upper PP. 
Based on the concept of coherent risk measure and since VaRVaR does not account4 
for the magnitude of losses greater than it (beyond the c-level) the following founds 
alternative application.
4 Moreover, VaRVaR can discourages diversiﬁcation. 
10.2
Coherent Risk Measures
267
Deﬁnition 10.3 Given a P&L rv upper X element of upper L Superscript 1X ∈L1 the expected shortfall for the horizon 
left bracket 0 comma upper T right bracket[0, T ] is deﬁned as 
sans serif upper E upper S Subscript c Baseline left parenthesis upper X right parenthesis colon equals minus StartFraction 1 Over c EndFraction integral Subscript 0 Superscript c Baseline VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis normal d c comma for c element of left parenthesis 0 comma 1 right parenthesis commaESc(X) := −1
c
⎰c
0
VaRc,T (X)dc,
for c ∈(0, 1),
which can be equivalently given by 
StartLayout 1st Row 1st Column sans serif upper E upper S Subscript c Baseline left parenthesis upper X right parenthesis 2nd Column colon equals 3rd Column minus StartFraction VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis Over c EndFraction left parenthesis c minus sans serif upper P left parenthesis upper X less than or slanted equals minus VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis right parenthesis right parenthesis 2nd Row 1st Column Blank 2nd Column minus 3rd Column StartFraction 1 Over c EndFraction sans serif upper E left parenthesis upper X bold upper I Subscript left brace upper X less than or slanted equals minus VaR Sub Subscript c comma upper T Subscript left parenthesis upper X right parenthesis right brace Baseline right parenthesis period EndLayoutESc(X) := −VaRc,T (X)
c
(
c −P(X ⩽−VaRc,T (X))
)
(10.10)
−1
c E
(
XI{X⩽−VaRc,T (X)}
)
.
Assuming the P&L X in Deﬁnition 10.3 being absolutely continuous, then 
Eq. (10.10) reduces to 
sans serif upper E upper S Subscript c Baseline left parenthesis upper X right parenthesis equals minus sans serif upper E left parenthesis upper X vertical bar upper X less than or slanted equals minus VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis right parenthesis equals minus StartFraction sans serif upper E left parenthesis upper X bold upper I Subscript left brace upper X less than or slanted equals minus VaR Sub Subscript c comma upper T Subscript left parenthesis upper X right parenthesis right brace Baseline right parenthesis Over sans serif upper P left parenthesis upper X less than or slanted equals minus VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis right parenthesis EndFraction periodESc(X) = −E(X | X ⩽−VaRc,T (X)) = −E
(
XI{X⩽−VaRc,T (X)}
)
P(X ⩽−VaRc,T (X)).
Thus, we can interpret sans serif upper E upper SES as the mean value of the P&L variable conditional 
on it (short)fall below a threshold given by the 100 c percent sign100c% VaRVaR, which is taken with 
negative sign as representing the c-th left-quantile of the X’s distribution. Observe 
that sans serif upper P left parenthesis upper X less than or slanted equals minus VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis right parenthesis equals upper F Subscript upper X Baseline left parenthesis minus VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis right parenthesis equals cP(X ⩽−VaRc,T (X)) = FX(−VaRc,T (X)) = c, for continuous distributions, 
and minus VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis equals upper Q Subscript upper X Baseline left parenthesis c right parenthesis−VaRc,T (X) = QX(c). For an in depth account of monetary risk measures see 
[7, Ch 4]. A last risk measure we present is based on the following deﬁnition. The 
expectile of upper X element of upper L squaredX ∈L2, at a probability level c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1), is  
e Subscript upper X Baseline left parenthesis c right parenthesis equals arg min Underscript z element of double struck upper R Endscripts left brace sans serif upper E left parenthesis upper S left parenthesis z comma upper X right parenthesis right parenthesis right brace commaeX(c) = argmin
z∈R {E(S(z, X))},
(10.11) 
based on the asymmetric quadratic score function 
upper S left parenthesis z comma upper X right parenthesis colon equals StartAbsoluteValue c minus bold upper I Subscript left brace upper X minus z less than 0 right brace Baseline EndAbsoluteValue left parenthesis upper X minus z right parenthesis squared periodS(z, X) := |c −I{X−z<0}|(X −z)2.
The scoring function is equal to c left parenthesis upper X minus z right parenthesis squaredc(X −z)2 whenever bold upper I Subscript left brace upper X greater than or slanted equals z right brace Baseline equals 1I{X⩾z} = 1, while it is left parenthesis 1 minus c right parenthesis left parenthesis upper X minus z right parenthesis squared(1 −
c)(X −z)2 if bold upper I Subscript left brace upper X less than z right brace Baseline equals 1I{X<z} = 1. The mean scoring function can be written at once as 
sans serif upper E left parenthesis c left parenthesis left parenthesis upper X minus z right parenthesis squared right parenthesis Superscript plus Baseline minus left parenthesis 1 minus c right parenthesis left parenthesis left parenthesis upper X minus z right parenthesis squared right parenthesis Superscript minus Baseline right parenthesisE
(
c((X −z)2)+ −(1 −c)((X −z)2)−)
. The minimum is attained at z equals e Subscript upper X Baseline left parenthesis c right parenthesisz = eX(c), 
by differentiating inside the expectation w.r.t. z. We used the deﬁnition of absolute 
value together with that of indicator function and positive/negative part of a rv. E.g., 
if z minus bold upper I Subscript left brace upper X less than z right brace Baseline greater than or slanted equals 0z −I{X<z} ⩾0 it must hold bold upper I Subscript left brace upper X greater than or slanted equals z right brace Baseline equals 1I{X⩾z} = 1. Expectiles are asymmetric generalization 
of the mean and also quadratic versions of the usual quantiles. The corresponding 
ﬁrst order condition and then the equivalent deﬁnition of c-expectile which holds 
also for upper X element of upper L Superscript 1X ∈L1 is, 
c sans serif upper E left parenthesis upper X minus e Subscript upper X Baseline left parenthesis c right parenthesis right parenthesis Superscript plus Baseline minus left parenthesis 1 minus c right parenthesis sans serif upper E left parenthesis upper X minus e Subscript upper X Baseline left parenthesis c right parenthesis right parenthesis Superscript minus Baseline equals 0c E (X −eX(c))+ −(1 −c)E (X −eX(c))−= 0
(10.12) 
giving e Subscript upper X Baseline left parenthesis c right parenthesiseX(c) as a unique minimizer, see [11, Sec 8.2.2].
268
10
Introduction to Market Risk Measures and Option Pricing
Remark 10.4 A scoring function upper S colon double struck upper R times double struck upper R right arrow left bracket 0 comma normal infinity right parenthesisS : R × R →[0, ∞) fulﬁlls the following 
properties: 
• 
.S(x, y) ⩾0, and for x equals yx = y it is zero; 
• 
.S(x, y) is increasing for x greater than yx > y and decreasing for x less than yx < y; 
• 
.S(x, y) is continuous in the ﬁrst component x. 
It can be shown that the quantile function upper Q Subscript upper X Baseline left parenthesis c right parenthesisQX(c) can be associated to the scoring 
function upper S left parenthesis z comma upper X right parenthesis equals StartAbsoluteValue c minus bold upper I Subscript left brace upper X minus z less than or slanted equals 0 right brace Baseline EndAbsoluteValue StartAbsoluteValue upper X minus z EndAbsoluteValueS(z, X) = |c −I{X−z⩽0}||X −z|, see [11, Sec 9.3.3]. 
Proposition 10.1 (Properties of Expectiles) 
Let upper X element of upper L Superscript 1X ∈L1 be a random return with 
CDF upper F Subscript upper XFX and c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1). Then: 
(a) Translation equivariance and homogeneity, e Subscript a upper X plus b Baseline left parenthesis c right parenthesis equals a e Subscript upper X Baseline left parenthesis c right parenthesis plus beaX+b(c) = a eX(c) + b, for every 
a greater than or slanted equals 0a ⩾0 and b element of double struck upper Rb ∈R; 
(b) Monotonicity, upper X less than or slanted equals upper Y sans serif upper PX ⩽Y P-a.s. implies e Subscript upper X Baseline left parenthesis c right parenthesis less than or slanted equals e Subscript upper Y Baseline left parenthesis c right parenthesiseX(c) ⩽eY (c), for all c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1). 
(c) Strict Monotonicity, upper X less than or slanted equals upper Y sans serif upper PX ⩽Y P-a.s. and sans serif upper P left parenthesis upper X less than upper Y right parenthesis greater than 0P(X < Y) > 0 implies e Subscript upper X Baseline left parenthesis c right parenthesis less than e Subscript upper Y Baseline left parenthesis c right parenthesiseX(c) < eY (c), 
for all c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1). 
(d) Parameter continuity and monotonicity, e Subscript upper X Baseline left parenthesis dot right parenthesis colon left parenthesis 0 comma 1 right parenthesis right arrow left parenthesis ess inf upper X comma ess sup upper X right parenthesiseX( · ) : (0, 1) →(ess inf X, ess sup X)
is continuous and strictly increasing, except when X is degenerate and then 
e Subscript upper X Baseline left parenthesis c right parenthesiseX(c) is constant for every c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1); the function c right arrow from bar e Subscript upper X Baseline left parenthesis c right parenthesisc ⍿→eX(c) maps the unit 
interval left parenthesis 0 comma 1 right parenthesis(0, 1) onto StartSet x element of double struck upper R vertical bar 0 less than upper F Subscript upper X Baseline left parenthesis x right parenthesis less than 1 EndSet{x ∈R | 0 < FX(x) < 1}. 
(e) .limc↓0 eX(c) = ess inf X and limit Underscript c up arrow 1 Endscripts e Subscript upper X Baseline left parenthesis c right parenthesis equals ess sup upper Xlimc↑1 eX(c) = ess sup X. 
(f) Superadditivity and subadditivity, for another upper Y element of upper L Superscript 1Y ∈L1, if c element of left parenthesis 0 comma one half right bracketc ∈(0, 1
2], then 
e Subscript upper X plus upper Y Baseline left parenthesis c right parenthesis greater than or slanted equals e Subscript upper X Baseline left parenthesis c right parenthesis plus e Subscript upper Y Baseline left parenthesis c right parenthesiseX+Y (c) ⩾eX(c) + eY (c); if c element of left bracket one half comma 1 right parenthesisc ∈[ 1
2, 1), then e Subscript upper X plus upper Y Baseline left parenthesis c right parenthesis less than or slanted equals e Subscript upper X Baseline left parenthesis c right parenthesis plus e Subscript upper Y Baseline left parenthesis c right parenthesiseX+Y (c) ⩽eX(c) + eY (c). 
(g) Additivity for positively linear dependent returns, if upper Y equals a upper X plus bY = aX + b with a greater than 0a > 0
and b element of double struck upper Rb ∈R, i.e. sans serif c o r r left parenthesis upper X comma upper Y right parenthesis equals 1corr(X, Y) = 1, then e Subscript upper X plus upper Y Baseline left parenthesis c right parenthesis equals e Subscript upper X Baseline left parenthesis c right parenthesis plus e Subscript upper Y Baseline left parenthesis c right parenthesiseX+Y (c) = eX(c) + eY (c). 
(h) Upper and lower expectiles, e Subscript upper X Baseline left parenthesis c right parenthesis equals minus e Subscript negative upper X Baseline left parenthesis 1 minus c right parenthesiseX(c) = −e−X(1 −c), for all c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1); 
(i) Law invariance, for random returns upper X comma upper Y element of upper L Superscript 1X, Y ∈L1 sharing the same distribution, 
i.e. upper X equals Overscript d Endscripts upper YX d= Y, is equivalent to have e Subscript upper X Baseline left parenthesis c right parenthesis equals e Subscript upper Y Baseline left parenthesis c right parenthesiseX(c) = eY (c) for all c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1). 
From Eqs. (10.11) and (10.12) it is clear that e Subscript upper X Baseline left parenthesis one half right parenthesis equals sans serif upper E left parenthesis upper X right parenthesiseX( 1
2) = E(X). 
Remark 10.5 For a relation among random returns, the sufﬁx sans serif upper PP-a.s. is understood 
with probability 1. For example, upper X less than or slanted equals upper Y sans serif upper PX ⩽Y P-a.s. stands for sans serif upper P left parenthesis upper X less than or slanted equals upper Y right parenthesis equals 1P(X ⩽Y) = 1. Given  
upper Y left parenthesis omega right parenthesis equals cY(ω) = c for every omega element of upper Omegaω ∈Ω, we recall that the essential supremum of a random 
return is deﬁned as inf left brace c element of double struck upper R vertical bar upper X less than or slanted equals c sans serif upper P hyphen a period s period right braceinf{c ∈R | X ⩽c P-a.s.}, denoted ess sup upper Xess sup X. Similarly, the 
essential inﬁmum is deﬁned as sup left brace c element of double struck upper R vertical bar upper X greater than or slanted equals c sans serif upper P hyphen a period s period right bracesup{c ∈R | X ⩾c P-a.s.}, denoted ess inf upper Xess inf X. We  
have upper X less than or slanted equals ess sup upper X sans serif upper PX ⩽ess sup X P-a.s. and upper X greater than or slanted equals ess inf upper X sans serif upper PX ⩾ess inf X P-a.s., provided that the essential 
supremum and the essential inﬁmum are both ﬁnite. Otherwise, it could be the case 
that ess sup upper X equals normal infinityess sup X = ∞or ess inf upper X equals negative normal infinityess inf X = −∞.
10.2
Coherent Risk Measures
269
A further consequence of properties (a), (g) and (h) is that 
e Subscript a upper X plus b Baseline left parenthesis c right parenthesis equals a e Subscript upper X Baseline left parenthesis 1 minus c right parenthesis plus b commaeaX+b(c) = aeX(1 −c) + b,
for b less than 0b < 0. This together with (a) gives that expectiles are location and scale 
equivariant. When X is a P&L, the functional minus e Subscript upper X Baseline left parenthesis c right parenthesis−eX(c) is a coherent risk measure 
for c less than or slanted equals one halfc ⩽1
2, also called expectile VaR. It is worth noting that the expectile VaR is 
a continuous function of the probability level c element of left parenthesis 0 comma 1 right parenthesisc ∈(0, 1) also for discrete X, while 
VaR is not since it is based on quantile which takes ﬁnite values for typical discrete 
distribution. It is possible to associate to each CDF upper F Subscript upper XFX a derived CDF through 
expectile e Subscript upper X Baseline left parenthesis c right parenthesiseX(c). Indeed, 
ModifyingAbove upper F With tilde Subscript upper X Baseline left parenthesis x right parenthesis equals StartFraction sans serif upper E left parenthesis upper X minus x right parenthesis Superscript minus Baseline Over sans serif upper E left parenthesis StartAbsoluteValue upper X minus x EndAbsoluteValue right parenthesis EndFraction comma ˜FX(x) = E(X −x)−
E(|X −x|) ,
(10.13) 
is actually a new CDF, continuous and strictly increasing on StartSet t element of double struck upper R vertical bar 0 less than upper F Subscript upper X Baseline left parenthesis x right parenthesis less than 1 EndSet{t ∈R | 0 < FX(x) <
1}. It is worth noticing that sans serif upper E left parenthesis upper X minus x right parenthesis Superscript minus Baseline less than or slanted equals sans serif upper E left parenthesis StartAbsoluteValue upper X minus x EndAbsoluteValue right parenthesisE(X −x)−⩽E(|X −x|), then for all x element of double struck upper Rx ∈R the 
ratio deﬁning ModifyingAbove upper F With tilde Subscript upper X Baseline left parenthesis x right parenthesis ˜FX(x) is less than or equal to 1. The point now is that e Subscript upper X Baseline left parenthesis c right parenthesiseX(c) is the 
c-quantile of the derived CDF ModifyingAbove upper F With tilde Subscript upper X Baseline left parenthesis c right parenthesis ˜FX(c), i.e 
StartLayout 1st Row 1st Column Blank 2nd Column ModifyingAbove upper F With tilde Subscript upper X Baseline left parenthesis c right parenthesis equals e Subscript upper X Superscript negative 1 Baseline left parenthesis x right parenthesis comma for all x element of left parenthesis ess inf upper X comma ess sup upper X right parenthesis 3rd Column Blank 2nd Row 1st Column Blank 2nd Column long left right double arrow 3rd Column Blank 3rd Row 1st Column Blank 2nd Column ModifyingAbove upper F With tilde Subscript upper X Superscript negative 1 Baseline left parenthesis c right parenthesis equals e Subscript upper X Baseline left parenthesis c right parenthesis comma for all c element of left parenthesis 0 comma 1 right parenthesis period 3rd Column Blank EndLayout ˜FX(c) = e−1
X (x), for all x ∈(ess inf X, ess sup X)
⇐⇒
˜F −1
X (c) = eX(c), for all c ∈(0, 1).
Observe that sans serif upper E left parenthesis StartAbsoluteValue upper X minus x EndAbsoluteValue right parenthesisE(|X −x|) equals sans serif upper E left parenthesis upper X minus x right parenthesis Superscript plus plus sans serif upper E left parenthesis upper X minus x right parenthesis Superscript minusE(X −x)+ + E(X −x)−, and the derived CDF 
in (10.13) can be rearranged as 
ModifyingAbove upper F With tilde Subscript upper X Baseline left parenthesis x right parenthesis equals StartFraction sans serif upper E left parenthesis upper X minus x right parenthesis Superscript plus Baseline minus sans serif upper E left parenthesis upper X right parenthesis plus x Over 2 sans serif upper E left parenthesis upper X minus x right parenthesis Superscript plus Baseline minus sans serif upper E left parenthesis upper X right parenthesis plus x EndFraction comma˜FX(x) = E(X −x)+ −E(X) + x
2E(X −x)+ −E(X) + x ,
where sans serif upper E left parenthesis upper X minus x right parenthesis Superscript plusE(X −x)+ is the stop-loss transform (decreasing and convex in x). 
Remark 10.6 For those x element of double struck upper Rx
∈
R such that sans serif upper E left parenthesis upper X minus x right parenthesis Superscript plus Baseline greater than 0E(X −x)+
>
0, the stop-loss 
transform is strictly decreasing with limit Underscript x right arrow negative normal infinity Endscripts sans serif upper E left parenthesis upper X minus x right parenthesis Superscript plus Baseline minus sans serif upper E left parenthesis upper X right parenthesis plus x equals 0 lim
x→−∞E(X −x)+ −E(X) + x = 0 and 
limit Underscript x right arrow normal infinity Endscripts sans serif upper E left parenthesis upper X minus x right parenthesis Superscript plus Baseline equals 0 lim
x→∞E(X −x)+ = 0. Observe that sans serif upper E left parenthesis upper X minus x right parenthesis Superscript plus Baseline equals 0E(X −x)+
= 0 for such x element of double struck upper Rx
∈R with 
sans serif upper P left parenthesis upper X greater than x right parenthesis equals 0P(X > x) = 0 and sans serif upper E left parenthesis upper X minus x right parenthesis Superscript plus Baseline minus sans serif upper E left parenthesis upper X right parenthesis plus x equals 0E(X−x)+ −E(X)+x = 0 for such x element of double struck upper Rx ∈R with sans serif upper P left parenthesis upper X less than x right parenthesis equals 0P(X < x) = 0. 
Yet other equivalent expressions for the stop-loss transform are 
sans serif upper E left parenthesis upper X minus x right parenthesis Superscript plus Baseline equals sans serif upper E left parenthesis upper X right parenthesis Superscript plus Baseline minus integral Subscript 0 Superscript x Baseline left bracket 1 minus upper F Subscript upper X Baseline left parenthesis u right parenthesis right bracket normal d u equals integral Subscript x Superscript normal infinity Baseline left bracket 1 minus upper F Subscript upper X Baseline left parenthesis u right parenthesis right bracket normal d u periodE(X −x)+ = E(X)+ −
⎰x
0
[1 −FX(u)]du =
⎰∞
x
[1 −FX(u)]du.
Derived CDFs should be continuous although the original ones are not, see 
Figs. 10.1 and 10.2.
270
10
Introduction to Market Risk Measures and Option Pricing
Fig. 10.1 Comparing 
upper F Subscript upper X Baseline comma upper F Subscript upper Y BaselineFX, FY : the rv X has law 
sans serif upper P left parenthesis upper X equals negative 1 right parenthesis equals 0.65P(X = −1) = 0.65 and 
sans serif upper P left parenthesis upper X equals 1 right parenthesis equals 0.35P(X = 1) = 0.35 (dashed, 
black); upper Y tilde upper B e r left parenthesis 0.5 right parenthesisY ∼Ber(0.5) (solid, 
gray) 
Fig. 10.2 Comparing derived 
CDFs: upper F overTilde Subscript upper X ˜FX (dashed, black) 
and upper F overTilde Subscript upper Y˜FY (solid, gray)
-10
-5
0
5
10 
0 
0.2 
0.4 
0.6 
0.8 
1 
10.3 
Working Examples 
Assume to invest only in one stock, say the S&P500 market index, with spot price 
upper S 0 equals 35 comma 409S0 = 35, 409, and assume the log-normal model for the upper T equals 1T = 1 day price upper S 1 equals upper S 0 normal e Superscript mu plus sigma upper ZS1 =
S0eμ+σZ with Standard Normal upper Z tilde upper N left parenthesis 0 comma 1 right parenthesisZ ∼N(0, 1). In addition we let mu equals 0.005μ = 0.005 and 
sigma equals 0.02σ = 0.02 and consider to hold 500 shares of the underlying index. To compute 
VaR Subscript c comma 1 Baseline left parenthesis upper X right parenthesisVaRc,1(X) we handle the P&L rv 
upper X equals 500 left parenthesis upper S 1 minus upper S 0 right parenthesis equals 500 upper S 0 r commaX = 500 (S1 −S0) = 500 S0r,
where r equals StartFraction upper S 1 minus upper S 0 Over upper S 0 EndFractionr = S1−S0
S0
so upper S 1 equals upper S 0 left parenthesis 1 plus r right parenthesisS1 = S0(1 + r). To compute a daily VaR at level c equals 0.01c = 0.01 or 
c equals 0.05c = 0.05 we only need to obtain the negative of the quantile upper Q Subscript upper Z Baseline left parenthesis c right parenthesisQZ(c) and compute 
VaR Subscript c comma 1 Baseline left parenthesis upper X right parenthesis equals minus 500 upper S 0 left parenthesis mu plus sigma upper Q Subscript upper Z Baseline left parenthesis c right parenthesis right parenthesis periodVaRc,1(X) = −500 S0 (μ + σ QZ(c)).
Here the Matlab code for inverting the CDF of Z, i.e. upper Q Subscript upper Z Baseline left parenthesis c right parenthesis equals upper F Subscript upper Z Superscript negative 1 Baseline left parenthesis c right parenthesisQZ(c) = F −1
Z (c), then 
computing VaR with two different c-levels. 
A 5-line  prog
ram code. Z equals norminv 0
.01 0.05 0
.1, mu e quals 0.005,
 sigma equals 0.02,  v ar equals
 neg at
ive 500 a
sterisk 35409 asterisk mu plus sima asterisk z, and var equals 735214.02 and 493903.72.
10.3 Working Examples
271 
The command VaR = -500*35409*(mu + sigma*z) is not followed by a 
semicolon, then Matlab displays the two computed values showed in the last line. 
Buying 500 shares in the S&P500 with spot price upper S 0 equals 35,409S0 = 35,409 we hold a portfolio 
value 17,704,500.0017,704,500.00 $. Holding this portfolio we may suffer a loss greater than 
VaR Subscript 0.01 comma 1 Baseline left parenthesis upper X right parenthesis equals 735,214.02 dollar sign commaVaR0.01,1(X) = 735,214.02 $,
1% of times within 1 day, or 
VaR Subscript 0.05 comma 1 Baseline left parenthesis upper X right parenthesis equals 493,903.72 dollar sign commaVaR0.05,1(X) = 493,903.72 $,
5% of times. We are conﬁdent to suffer smaller losses 100 left parenthesis 1 minus c right parenthesis percent sign equals 99 percent sign100(1 −c)% = 99% or 
100 left parenthesis 1 minus c right parenthesis percent sign equals 95 percent sign100(1−c)% = 95% of times, during the next day. The two VaR ﬁgures also quantify 
the amount of economic capital to set aside for handling unfavorable scenarios. 
Under the log-normal hypotheses we can compute a VaR ﬁgure for more than 1 day, 
using the same value mu comma sigmaμ, σ referred as the 1-day drift and 1-day volatility. Here the 
‘recipe’: 
VaR Subscript c comma upper T Baseline left parenthesis upper X right parenthesis equals minus number sign shares upper S 0 left parenthesis mu upper T plus sigma StartRoot upper T EndRoot upper Q Subscript upper Z Baseline left parenthesis c right parenthesis right parenthesisVaRc,T (X) = −# shares S0
⎛
μT + σ
√
T QZ(c)
⎞
where upper T equalsT = number of days within the horizon. Dropping the assumption that P&Ls 
are of the form upper X equals minus number sign shares upper S 0 left parenthesis mu plus sigma upper N left parenthesis 0 comma 1 right parenthesis right parenthesisX = −# shares S0
(
μ + σN(0, 1)
)
, we can resort to nonparametric 
estimation of VaR. Once we have at disposal n data referring to returns, being 
historical values or simulated via Monte Carlo method, we consider them as 
realizations of an IID sample: 
x 1 comma ellipsis comma x Subscript n Baseline equals upper X 1 left parenthesis omega right parenthesis comma ellipsis comma upper X Subscript n Baseline left parenthesis omega right parenthesis periodx1, . . . , xn = X1(ω), . . . , Xn(ω).
We use the sample for computing the c-VaR without assuming any parametric 
probability distribution as follows. 
1. Order returns from the smallest to the greatest 
2. Compute left ceiling c n right ceiling⎾cn⏋, the greatest integer greater than or slanted equals c n⩾cn
3. Write x Subscript left parenthesis left ceiling c n right ceiling right parenthesisx(⎾cn⏋) for the corresponding ordered value within the sample 
4. Compute the daily estimated ModifyingAbove VaR Subscript c comma 1 Baseline left parenthesis upper X right parenthesis With caret equals minus number sign shares upper S 0 x Subscript left parenthesis left ceiling c n right ceiling right parenthesis Baseline
 ̂
VaRc,1(X) = −# shares S0x(⎾cn⏋). 
Here the number left ceiling c n right ceiling⎾cn⏋approximates the ith position of the value x Subscript ixi in the sample 
to which corresponds a probability c for the theoretical quantile upper Q Subscript upper Z Baseline left parenthesis c right parenthesisQZ(c). This is  
especially true if we assume a continuous CDF upper F Subscript upper ZFZ of the population Z and recalling 
the empirical CDF 
double struck upper F Subscript n Baseline left parenthesis x right parenthesis equals StartFraction 1 Over n EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts bold upper I Subscript left brace upper Z Sub Subscript i Subscript less than or slanted equals x right brace Baseline comma x element of double struck upper R periodFn(x) = 1
n
n
⎲
i=1
I{Zi⩽x},
x ∈R.
(10.14)
272
10
Introduction to Market Risk Measures and Option Pricing
It measures the random proportion of the data points in the sample being less than or slanted equals x⩽x. We  
can estimate it through the observed data, ModifyingAbove double struck upper F With caret Subscript n Baseline left parenthesis x right parenthesis equals StartFraction number of data x Subscript i Baseline less than or slanted equals x Over n EndFractionˆFn(x) = number of data xi⩽x
n
, see Sect. 8.3. 
Considering the ordered statistics upper Z Subscript left parenthesis 1 right parenthesis Baseline less than midline horizontal ellipsis less than upper Z Subscript left parenthesis n right parenthesisZ(1) < · · · < Z(n) we arrive to: 
ModifyingAbove upper Q Subscript upper Z Baseline left parenthesis c right parenthesis With caret equals double struck upper F Subscript n Superscript negative 1 Baseline left parenthesis c right parenthesis equals upper Z Subscript left parenthesis i right parenthesis Baseline long left right double arrow double struck upper F Subscript n Baseline left parenthesis upper Z Subscript left parenthesis i right parenthesis Baseline right parenthesis equals StartFraction i Over n EndFraction comma  ̂
QZ(c) = F−1
n (c) = Z(i) ⇐⇒Fn(Z(i)) = i
n,
(10.15) 
for c element of left parenthesis StartFraction i minus 1 Over n EndFraction comma StartFraction i Over n EndFraction right bracketc ∈( i−1
n , i
n] and i equals 1 comma ellipsis comma ni = 1, . . . , n. To illustrate this, we start from a dataset 
comprising 1119 values s Subscript isi of the daily S&P500’s quotes, from 31 December 2012 
to 12 June 2017. Then we get daily log-returns x Subscript i minus 1 Baseline equals log left parenthesis s Subscript i Baseline right parenthesis minus log left parenthesis s Subscript i minus 1 Baseline right parenthesisxi−1 = log(si) −log(si−1) for 
i equals 2 comma 3 comma ellipsis comma 1118i = 2, 3, . . . , 1118, which approximate arithmetic returns StartFraction s Subscript i Baseline minus s Subscript i minus 1 Baseline Over s Subscript i minus 1 Baseline EndFraction si−si−1
si−1 . Considering 
again to invest in 500 shares of this market index with initial price upper S 0 equals 35,409S0 = 35,409, we  
obtain the estimated VaR at c equals 0.01c = 0.01 level using Matlab: 
A 5-line  prog
ram code.
 X equal
s 0 .0251 nega
tive 0.0021 ellipse
s negative 0.0010
, y eq
uals prctile (x, 0.01), var equals negative 500 asterisk 35409 asterisk y, and var equals 711720.
By the ﬁrst command, historical log-returns are collected into the array x, which is a 
1118 times 11118 × 1 vector.5 The function prctile(x,0.01) yields the empirical quantile 
negative 0.0402−0.0402 corresponding to the left ceiling c n right ceiling equals 11⎾cn⏋= 11th ordered statistic upper Z Subscript left parenthesis 11 right parenthesisZ(11) with c equals 0.01c = 0.01 and 
n equals 1118n = 1118. It could be considered as the value obtained by inverting the empirical 
CDF through double struck upper F 1118 Superscript negative 1 Baseline left parenthesis 0.01 right parenthesisF−1
1118(0.01). 
10.4 
Option Pricing 
In Sect. 2.5, Example 2.8, we have seen that an European call option is a ﬁnancial 
contract giving the right, but not the obligation, to buy an underlying asset at strike 
price upper K greater than 0K > 0 at maturity upper T greater than 0T > 0. The value in T , called payoff, is upper C Subscript upper T Baseline equals max left brace 0 comma upper S Subscript upper T Baseline minus upper K right brace equals left parenthesis upper S Subscript upper T Baseline minus upper K right parenthesis Superscript plusCT = max{0, ST −
K} = (ST −K)+, and we can ask what the fair price at some date 0 less than or slanted equals t less than upper T0 ⩽t < T should 
be since it is clear how it depends on the whole path followed by the stochastic 
process upper S equals left parenthesis upper S Subscript t Baseline right parenthesis Subscript t greater than or slanted equals 0S = (St)t⩾0 modelling the underlying. Any such a contract whose value in 
left bracket 0 comma upper T right bracket[0, T ] depends on S is called contingent claim. Observe that the payoff left parenthesis x minus upper K right parenthesis Superscript plus(x −K)+
as a function of x equals upper S Subscript upper Tx = ST is zero for x minus upper K less than 0x −K < 0 (out-of-the money) and is equal 
to x minus upper Kx −K otherwise (in-the money), thus the graph of y equals left parenthesis x minus upper K right parenthesis Superscript plus Baseline equals bold upper I Subscript left brace x minus upper K greater than or slanted equals 0 right bracey = (x −K)+ = I{x−K⩾0}
is piecewise linear convex. Our aim is to determine upper C Subscript upper TCT , and our ﬁrst assumption is
5 We have displayed only the ﬁrst two and the last. 
10.4
Option Pricing
273
that the payoff is replicable, i.e. upper C Subscript upper T Baseline equals Overscript a period s period Endscripts upper V Subscript upper TCT
a.s.
= VT for some portfolio bold hh, as the following 
example explains. 
Example 10.1 Assume negative 1 less than r−1 < r is the continuously compounded return of a risk-
free asset. In t equals 0t = 0 we form a portfolio bold h equals left parenthesis h Superscript 1 Baseline comma h squared right parenthesish = (h1, h2), where the holding h Superscript 1 Baseline equals minus upper K normal e Superscript minus r upper Th1 =
−Ke−rT is given by short selling6 and the corresponding position is risk-free, while 
h squared equals 1h2 = 1 is holding given by buying a corresponding share of the risky security. The 
initial value of the portfolio is7 
upper V 0 equals h Superscript 1 Baseline upper D 0 plus h squared upper S 0 equals minus upper K normal e Superscript minus r upper T Baseline plus upper S 0 commaV0 = h1 D0 + h2 S0 = −Ke−rT + S0,
where upper D 0 equals 1D0 = 1, without loss of generality, is the risk-free initial price and upper S 0S0 is the 
initial price of the risky security. We keep bold hh unchanged until T , thus the ﬁnal value 
of the portfolio is 
upper V Subscript upper T Baseline equals h Superscript 1 Baseline upper D Subscript upper T Baseline plus h squared upper S Subscript upper T Baseline equals minus upper K normal e Superscript minus r upper T Baseline upper D 0 normal e Superscript r upper T Baseline plus h squared upper S Subscript upper T Baseline equals negative upper K plus upper S Subscript upper T Baseline periodVT = h1 DT + h2 ST = −Ke−rT D0 erT + h2 ST = −K + ST .
This trading strategy has succeeded in create a ﬁnal monetary value equal to the 
in-the money option payoff. If we choose bold h equals left parenthesis 0 comma 0 right parenthesish = (0, 0) then we replicate the out-of-
the money option payoff. Here we have tacitly assumed that the time evolution of 
the risk-free price is deterministic, and this is can be described by the ordinary ﬁrst 
order differential equation StartFraction normal d Over normal d t EndFraction upper D Subscript t Baseline equals upper D Subscript t Baseline normal e Superscript r t d
dt Dt = Dtert, equivalently written as normal d upper D Subscript t Baseline equals upper D Subscript t Baseline normal e Superscript r t Baseline normal d tdDt = Dtertdt. 
Yet another formulation is upper D Subscript t Baseline equals upper D 0 plus integral Subscript 0 Superscript t Baseline upper D Subscript u Baseline normal e Superscript r u Baseline normal d uDt = D0 +
⎰t
0 Duerudu, in fact the solution in both 
cases8 is upper D Subscript t Baseline equals upper D 0 normal e Superscript r tDt = D0ert. 
Next, we assume that the market is free of arbitrage, since simultaneously buying 
a given asset where it is traded at a lower price, and selling it where it is traded 
at a higher price yields an arbitrage proﬁt (at zero initial cost) which is followed 
by the action of many ‘arbitrageurs’ on a large scale. This will force that market, 
i.e., the price will raise in the ﬁrst market and will fall in the second, thus we 
arrive at the same price. Then, a mathematical model of a ﬁnancial market should 
not allow arbitrage. We refer to a ﬁltered probability space left parenthesis upper Omega comma script upper F comma StartSet script upper F Subscript t Baseline EndSet comma sans serif upper P right parenthesis(Ω, F, {Ft}, P), where 
StartSet script upper F Subscript t Baseline EndSet equals sigma left parenthesis upper B Subscript s Baseline comma s less than or slanted equals t right parenthesis{Ft} = σ(Bs, s ⩽t) is the natural ﬁltration of a standard Brownian motion, 
whose role will be clariﬁed soon. Armed with the notion of replicating portfolio, 
we choose as components a risk-free asset with price process left parenthesis upper D Subscript t Baseline right parenthesis Subscript t greater than or slanted equals 0(Dt)t⩾0, and a risky 
security9 with price process left parenthesis upper S Subscript t Baseline right parenthesis Subscript t greater than or slanted equals 0(St)t⩾0. Further, the replicating portfolio bold h equals left parenthesis h Subscript t Superscript 1 Baseline comma h Subscript t Superscript 2 Baseline right parenthesish = (h1
t , h2
t )
6 This means that in t equals 0t = 0 we sell the asset with delivery in t equals upper Tt = T , which is equivalent to borrow 
money. 
7 We further assume to invest all our wealth in the portfolio. 
8 In deterministic calculus, differentials and integral equations are equivalent. 
9 Actually we refer to a stock paying no dividend.  
274
10
Introduction to Market Risk Measures and Option Pricing
has components left parenthesis h Subscript t Superscript i Baseline right parenthesis Subscript t greater than or slanted equals 0(hi
t)t⩾0 which are adapted to StartSet script upper F Subscript t Baseline EndSet{Ft}, for i equals 1 comma 2i = 1, 2. This means that the 
portfolio value process left parenthesis upper V Subscript t Baseline right parenthesis Subscript t greater than or slanted equals 0(Vt)t⩾0 with 
upper V Subscript t Baseline equals h Subscript t Superscript 1 Baseline upper D Subscript t Baseline plus h Subscript t Superscript 2 Baseline upper S Subscript t Baseline commaVt = h1
t Dt + h2
t St,
(10.16) 
is adjusted continuously in a non anticipated way. We require that V is self-
ﬁnancing, i.e., the changes in upper V Subscript tVt depends upon trading in the risk-free and the 
risk security, but not upon either injection or withdraw of additional money. More 
precisely, given 0 less than or slanted equals t Subscript i minus 1 Baseline less than or slanted equals t Subscript i Baseline less than or slanted equals upper T0 ⩽ti−1 ⩽ti ⩽T , where T is the maturity of the contingent claim, 
for i greater than or slanted equals 1i ⩾1, 
upper V Subscript t Sub Subscript i minus 1 Subscript Baseline equals h Subscript t Sub Subscript i minus 1 Subscript Superscript 1 Baseline upper D Subscript t Sub Subscript i minus 1 Subscript Baseline plus h Subscript t Sub Subscript i minus 1 Subscript Superscript 2 Baseline upper S Subscript t Sub Subscript i minus 1 Subscript Baseline equals h Subscript t Sub Subscript i Subscript Superscript 1 Baseline upper D Subscript t Sub Subscript i minus 1 Subscript Baseline plus h Subscript t Sub Subscript i Subscript Superscript 2 Baseline upper S Subscript t Sub Subscript i minus 1 Subscript Baseline periodVti−1 = h1
ti−1Dti−1 + h2
ti−1Sti−1 = h1
tiDti−1 + h2
tiSti−1.
which means that the investor readjusts his positions from h Subscript t Sub Subscript n minus 1 Superscript ihi
tn−1 to h Subscript t Sub Subscript n Superscript ihi
tn without 
bringing or consuming any wealth, i.e., the wealth before a trading and that after 
are equal. As byproduct, the net trading gain from price changes is 
StartLayout 1st Row 1st Column upper V Subscript t Sub Subscript n Baseline minus upper V 0 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript n Endscripts left parenthesis upper V Subscript t Sub Subscript i Subscript Baseline minus upper V Subscript t Sub Subscript i minus 1 Subscript Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript n Endscripts left parenthesis h Subscript t Sub Subscript i Subscript Superscript 1 Baseline left parenthesis upper D Subscript t Sub Subscript i Subscript Baseline minus upper D Subscript t Sub Subscript i minus 1 Subscript Baseline right parenthesis plus h Subscript t Sub Subscript i Subscript Superscript 2 Baseline left parenthesis upper S Subscript t Sub Subscript i Subscript Baseline minus upper S Subscript t Sub Subscript i minus 1 Subscript Baseline right parenthesis right parenthesis 3rd Row 1st Column Blank 2nd Column Blank 3rd Column left bracket use upper V Subscript t Sub Subscript i minus 1 Subscript Baseline equals h Subscript t Sub Subscript i Subscript Superscript 1 Baseline upper D Subscript t Sub Subscript i minus 1 Subscript Baseline plus h Subscript t Sub Subscript i Subscript Superscript 2 Baseline upper S Subscript t Sub Subscript i minus 1 Subscript Baseline right bracket 4th Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript n Endscripts h Subscript t Sub Subscript i Subscript Superscript 1 Baseline normal upper Delta upper D Subscript t Sub Subscript i Subscript Baseline plus sigma summation Underscript i equals 1 Overscript n Endscripts h Subscript t Sub Subscript i Subscript Superscript 2 Baseline normal upper Delta upper S Subscript t Sub Subscript i Subscript Baseline comma EndLayoutVtn −V0 =
n
⎲
i=1
(
Vti −Vti−1
)
=
n
⎲
i=1
⎛
h1
ti(Dti −Dti−1) + h2
ti(Sti −Sti−1)
⎞
[use Vti−1 = h1
tiDti−1 + h2
tiSti−1]
=
n
⎲
i=1
h1
tiΔDti +
n
⎲
i=1
h2
tiΔSti,
where upper Delta upper D Subscript t Sub Subscript i Baseline equals upper D Subscript t Sub Subscript i Baseline minus upper D Subscript t Sub Subscript i minus 1ΔDti = Dti −Dti−1 for i equals 1 comma ellipsis comma ni = 1, . . . , n, and similarly for S. We are interested in 
the behavior of upper Delta upper V Subscript t Sub Subscript i Baseline equals upper V Subscript t Sub Subscript i Baseline minus upper V Subscript t Sub Subscript i minus 1ΔVti = Vti −Vti−1 for ﬁner partitions 0 less than or slanted equals t 0 less than t 1 less than midline horizontal ellipsis less than t Subscript n Baseline less than or slanted equals upper T0 ⩽t0 < t1 < · · · < tn ⩽T
of the horizon left bracket 0 comma upper T right bracket[0, T ], in the limit. What we expect is to get something like upper V Subscript t Baseline equals upper V 0 plus integral Subscript 0 Superscript t Baseline h Subscript u Superscript 1 Baseline normal d upper D Subscript u Baseline plus integral Subscript 0 Superscript t Baseline h Subscript u Superscript 2 Baseline normal d upper S Subscript u BaselineVt =
V0+
⎰t
0 h1
udDu+
⎰t
0 h2
udSu. While the integral integral Subscript 0 Superscript t Baseline h Subscript u Superscript 1 Baseline normal d upper D Subscript u
⎰t
0 h1
udDu poses no problem, due to the 
assumption of the deterministic dynamics of the risk-free rate, what is the meaning 
of integral Subscript 0 Superscript t Baseline h Subscript u Superscript 2 Baseline normal d upper S Subscript u
⎰t
0 h2
udSu? We try to give an answer ﬁrstly by recalling that a reasonable model 
for the risky price process could be that introduced in Sect. 8.5, the log-normal stock 
price model and a ﬁrst attempt should be letting upper S Subscript t Baseline equals upper S 0 normal e Superscript mu t plus sigma upper B Super Subscript tSt = S0eμt+σBt with upper B Subscript tBt being a 
standard Brownian motion. In order to develop a unifying approach, we propose to 
specify upper S equals left parenthesis upper S Subscript t Baseline right parenthesis Subscript t greater than or slanted equals 0S = (St)t⩾0 as a process based on B via the theory of stochastic integration. 
We limit ourselves to a very short excursion to this theory tailored to our current 
setting. The dynamics of the risky security is speciﬁed by the stochastic differential 
equation (SDE) equation 
normal d upper S Subscript t Baseline equals alpha upper S Subscript t Baseline normal d t plus sigma upper S Subscript t Baseline normal d upper B Subscript t Baseline commadSt = αStdt + σStdBt,
(10.17)
10.4
Option Pricing
275
whose solution10 is upper S Subscript t Baseline equals upper S 0 normal e Superscript left parenthesis alpha minus sigma squared divided by 2 right parenthesis t plus sigma upper B Super Subscript tSt = S0e(α−σ 2/2)t+σBt , corresponding to the log-normal model 
for the stock price, see Exercise 10.3. Hence, the portfolio value’s dynamics can be 
speciﬁed by the diffusive equation 
normal d upper V Subscript t Baseline equals h Subscript t Superscript 1 Baseline normal d upper D Subscript t Baseline plus h Subscript t Superscript 2 Baseline normal d upper S Subscript t Baseline commadVt = h1
t dDt + h2
t dSt,
(10.18) 
due to the self-ﬁnancing assumption. The above SDE is actually 
upper V Subscript t Baseline equals upper V 0 plus integral Subscript 0 Superscript t Baseline h Subscript s Superscript 1 Baseline normal d upper D Subscript s Baseline plus integral Subscript 0 Superscript t Baseline h Subscript s Superscript 2 Baseline normal d upper B Subscript s Baseline commaVt = V0 +
⎰t
0
h1
sdDs +
⎰t
0
h2
sdBs,
(10.19) 
where the ﬁrst integral on the right-hand side is of the Riemann type, while the 
second is an Itô stochastic integral, see Appendix. In fact, upper S Subscript t Baseline equals f left parenthesis t comma upper B Subscript t Baseline right parenthesisSt = f (t, Bt) so the 
stock price is adapted to the natural ﬁltration generated by the Brownian motion and 
in addition sigma left parenthesis upper S Subscript t Baseline right parenthesis subset of sigma left parenthesis upper B Subscript t Baseline right parenthesisσ(St) ⊂σ(Bt), for every t element of left bracket 0 comma upper T right brackett ∈[0, T ]. Recall that the holdings processes 
h Superscript 1 Baseline equals left parenthesis h Subscript t Superscript 1 Baseline right parenthesis Subscript t greater than or slanted equals 0h1 = (h1
t )t⩾0 and h squared equals left parenthesis h Subscript t Superscript 2 Baseline right parenthesis Subscript t greater than or slanted equals 0h2 = (h2
t )t⩾0 are also adapted to the above ﬁltration. Thanks 
to the replicating hypotheses we have upper V Subscript upper T Baseline equals left parenthesis upper S Subscript upper T Baseline minus upper K right parenthesis Superscript plusVT = (ST −K)+, thus the pricing problem 
can be tackled by handling the hedge portfolio instead of the original European call 
option payoff upper C Subscript upper TCT . This is guaranteed by the following: 
Lemma 10.1 Let upper C equals left parenthesis upper C Subscript t Baseline right parenthesis Subscript t element of left bracket 0 comma upper T right bracketC = (Ct)t∈[0,T ] be the process for the contingent claim. Assume 
that the portfolio with price process upper V equals left parenthesis upper V Subscript t Baseline right parenthesis Subscript t element of left bracket 0 comma upper T right bracketV = (Vt)t∈[0,T ] over the horizon replicates the 
claim and there are no arbitrage opportunity. Then, we have hedging, i.e., upper C Subscript t Baseline equals upper V Subscript tCt = Vt
for t element of left bracket 0 comma upper T right brackett ∈[0, T ]. 
Proof Assume upper C Subscript upper T Baseline equals upper V Subscript upper TCT = VT and upper C Subscript t Baseline less than upper V Subscript tCt < Vt. We show that arbitrage exists, so we found 
a contradiction. Sell the portfolio bold hh underlying upper V Subscript tVt and buy the claim at price minus upper C Subscript t−Ct. 
Thus, invest the amount upper V Subscript t Baseline minus upper C Subscript tVt −Ct at the risk-free instantaneous rate of return r greater than negative 1r > −1
for upper T minus tT −t. At the horizon T we get the amount left parenthesis upper V Subscript t Baseline minus upper C Subscript t Baseline right parenthesis normal e Superscript r left parenthesis upper T minus t right parenthesis Baseline greater than 0(Vt −Ct)er(T −t) > 0; the delivery 
of upper V Subscript upper TVT stems from the claim. This is actually an arbitrage. 
█
Lemma 10.1 enable us to formally deﬁne an arbitrage portfolio. 
Deﬁnition 10.4 A self-ﬁnancing portfolio bold h equals left parenthesis h Superscript 1 Baseline comma h squared right parenthesish = (h1, h2), where h 1 comma h squaredh1, h2 are adapted 
processes, is an arbitrage whenever: 
• 
. Vt ⩽0
• 
.P(VT ⩾0) = 1 and sans serif upper P left parenthesis upper V Subscript upper T Baseline greater than 0 right parenthesis greater than 0P(VT > 0) > 0. 
Observe that the last item above implies sans serif upper E left parenthesis upper V Subscript upper T Baseline right parenthesis greater than or slanted equals 0E(VT ) ⩾0. Now we turn to discounted 
values: 
• 
. ˜St = f (t, St) = e−rtSt, for the stock price; 
• 
. ˜Vt = f (t, Vt) = e−rtVt, for the replicating portfolio. 
It is worth noting that upper S overTilde Subscript 0 Baseline equals upper S 0 ˜S0 = S0 and upper V overTilde Subscript 0 Baseline equals upper V 0 ˜V0 = V0.
10 A strong solution to this type of SDE is called diffusive process, see [9] and [12]. 
276
10
Introduction to Market Risk Measures and Option Pricing
For the former we apply Itô’s formula (see Appendix) and get: 
StartLayout 1st Row 1st Column normal d upper S overTilde Subscript t Baseline equals normal d left parenthesis normal e Superscript minus r t Baseline upper S Subscript t Baseline right parenthesis 2nd Column equals 3rd Column normal e Superscript minus r t Baseline ModifyingBelow left parenthesis alpha upper S Subscript t Baseline normal d t plus sigma upper S Subscript t Baseline normal d upper B Subscript t Baseline right parenthesis With bottom brace Underscript equals normal d upper S Subscript t Baseline Endscripts minus r normal e Superscript minus r t Baseline upper S Subscript t Baseline normal d t 2nd Row 1st Column Blank 2nd Column equals 3rd Column alpha upper S overTilde Subscript t Baseline normal d t plus sigma upper S overTilde Subscript t Baseline normal d upper B Subscript t minus r upper S overTilde Subscript t Baseline normal d t 3rd Row 1st Column Blank 2nd Column equals 3rd Column upper S overTilde Subscript t Baseline normal d left parenthesis left parenthesis alpha minus r right parenthesis t plus sigma upper B Subscript t Baseline right parenthesis period EndLayoutd ˜St = d
(
e−rtSt
)
= e−rt (αStdt + σStdBt)
◟
◝◜
◞
=dSt
−re−rtStdt
= α ˜Stdt + σ ˜StdBt −r ˜Stdt
= ˜Std ((α −r)t + σBt) .
Observe that we used StartFraction partial differential f Over partial differential upper S Subscript t Baseline EndFraction equals normal e Superscript minus r t ∂f
∂St = e−rt; StartFraction partial differential f Over partial differential t EndFraction equals minus r upper S Subscript t Baseline normal e Superscript minus r t ∂f
∂t
= −rSte−rt; StartFraction partial differential squared f Over partial differential upper S Subscript t Superscript 2 Baseline EndFraction equals 0 ∂2f
∂S2t
= 0. Now, let upper B overTilde Subscript t Baseline equals upper B Subscript t Baseline plus StartFraction alpha minus r Over sigma EndFraction t˜Bt =
Bt + α−r
σ t and rewrite the last line above as normal d upper S overTilde Subscript t Baseline equals sigma upper S overTilde Subscript t Baseline normal d upper B overTilde Subscript td ˜St = σ ˜Std ˜Bt. The following result is 
crucial. 
Theorem 10.3 (Girsanov) 
Let a ﬁltered probability space left parenthesis upper Omega comma script upper F comma StartSet script upper F Subscript t Baseline EndSet comma sans serif upper P right parenthesis(Ω, F, {Ft}, P) where 
a Brownian motion is deﬁned with script upper F Subscript t Baseline equalsFt = script upper F Subscript t Baseline equals sigma left parenthesis upper B Subscript s Baseline comma s less than or slanted equals t right parenthesisFt = σ(Bs, s ⩽t) for every t element of left bracket 0 comma upper T right brackett ∈[0, T ]. 
Then: 
• 
.Mt = e−qBt−1
2 q2 t is an script upper F Subscript tFt-martingale, for q element of double struck upper Rq ∈R; 
• 
. ˜P(A) =
⎰
A MT dP is a probability measure equivalent to the original one, i.e., 
sans serif upper P overTilde tilde sans serif upper P ˜P ∼P, with upper M Subscript upper T Baseline greater than or slanted equals 0MT ⩾0 and sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper M Subscript upper T Baseline right parenthesis equals 1EP(MT ) = 1, for every event upper A element of script upper F equals script upper F Subscript upper TA ∈F = FT ; 
• 
. ˜Bt = Bt + q t is again a Brownian motion w.r.t. the ﬁltered probability space 
left parenthesis upper Omega comma script upper F comma StartSet script upper F Subscript t Baseline EndSet comma sans serif upper P overTilde right parenthesis(Ω, F, {Ft}, ˜P). 
Therefore, under the new measure sans serif upper P overTilde˜P, for q equals StartFraction alpha minus r Over sigma EndFractionq = α−r
σ
we have that the discounted price 
process upper S overTilde equals left parenthesis upper S overTilde Subscript t Baseline right parenthesis Subscript t element of left bracket 0 comma upper T right bracket ˜S = ( ˜St)t∈[0,T ] is a martingale (its diffusive equation has no more drift). We 
can conclude that the SDE normal d upper S overTilde Subscript t Baseline equals sigma upper S overTilde Subscript t Baseline normal d upper B overTilde Subscript td ˜St = σ ˜Std ˜Bt has solution 
upper S overTilde Subscript t Baseline equals upper S overTilde Subscript 0 Baseline normal e Superscript minus StartFraction sigma squared Over 2 EndFraction t plus sigma upper B overTilde Super Subscript t Superscript Baseline long left right double arrow StartEnclose box upper S Subscript t Baseline equals upper S 0 normal e Superscript left parenthesis r minus sigma squared divided by 2 right parenthesis t plus sigma upper B overTilde Super Subscript t Superscript Baseline EndEnclose comma˜St = ˜S0e−σ2
2 t+σ ˜Bt ⇐⇒St = S0e(r−σ 2/2)t+σ ˜Bt ,
and the stock price process in the new ﬁltered probability space has a risk-neutral 
drift r greater than negative 1r > −1. For the discounted portfolio value process we have a similar caveat: 
StartLayout 1st Row 1st Column normal d upper V overTilde Subscript t 2nd Column equals 3rd Column minus r normal e Superscript minus r t Baseline upper V Subscript t Baseline normal d t plus normal e Superscript minus r t Baseline normal d upper V Subscript t 2nd Row 1st Column Blank 2nd Column equals 3rd Column minus r normal e Superscript minus r t Baseline left parenthesis h Subscript t Superscript 1 Baseline upper D Subscript t Baseline plus h Subscript t Superscript 2 Baseline upper S Subscript t Baseline right parenthesis normal d t plus normal e Superscript minus r t Baseline left parenthesis h Subscript t Superscript 1 Baseline normal d upper D Subscript t Baseline plus h Subscript t Superscript 2 Baseline normal d upper S Subscript t Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column h Subscript t Superscript 2 Baseline left parenthesis minus r normal e Superscript minus r t Baseline upper S Subscript t Baseline normal d t plus normal e Superscript minus r t Baseline normal d upper S Subscript t Baseline right parenthesis 4th Row 1st Column Blank 2nd Column equals 3rd Column h Subscript t Superscript 2 Baseline normal d upper S overTilde Subscript t Baseline comma left bracket see first line of normal d upper S overTilde Subscript t Baseline right single quotation mark s equation right bracket EndLayoutd ˜Vt = −re−rtVtdt + e−rtdVt
= −re−rt(h1
t Dt + h2
t St)dt + e−rt ⎛
h1
t dDt + h2
t dSt
⎞
= h2
t
(
−re−rtStdt + e−rtdSt
)
= h2
t d ˜St,
⎾
see ﬁrst line of d ˜St’s equation
⏋
where we have used the self-ﬁnancing condition together with the deﬁnition of the 
portfolio value process upper V Subscript tVt for t greater than or slanted equals 0t ⩾0 and upper D Subscript t Baseline equals upper D 0 normal e Superscript r tDt = D0ert. This SDE in integral form is 
upper V overTilde Subscript t Baseline equals upper V overTilde Subscript 0 Baseline plus integral Subscript 0 Superscript t Baseline h Subscript u Superscript 2 Baseline upper S overTilde Subscript u Baseline normal d upper B overTilde Subscript u Baseline comma ˜Vt = ˜V0 +
⎰t
0
h2
u ˜Sud ˜Bu,
10.4
Option Pricing
277
where we known that upper S overTilde˜S is a martingale and now also integral Subscript 0 Superscript t Baseline h Subscript u Superscript 2 Baseline upper S overTilde Subscript u Baseline normal d upper B overTilde Subscript u
⎰t
0 h2
u ˜Sud ˜Bu is, by the 
martingale representation theorem, see [9] and [12] where it can be found a more 
general version of the Girsanov theorem. 
Remark 10.7 We applied Itô’s Formula to upper V overTilde Subscript t Baseline equals f left parenthesis t comma upper V Subscript t Baseline right parenthesis equals e Superscript minus r t Baseline upper V Subscript t ˜Vt = f (t, Vt) = e−rtVt in the form 
normal d f left parenthesis t comma upper V Subscript t Baseline right parenthesis equals StartFraction partial differential f Over partial differential t EndFraction normal d t plus StartFraction partial differential f Over partial differential upper V Subscript t Baseline EndFraction normal d upper V Subscript t Baseline plus one half StartFraction partial differential squared f Over partial differential upper V Subscript t Superscript 2 Baseline EndFraction left parenthesis normal d upper V Subscript t Baseline right parenthesis squareddf (t, Vt) = ∂f
∂t dt + ∂f
∂Vt
dVt + 1
2
∂2f
∂V 2t
(dVt)2
given by equation (10.23), with partials 
• 
. ∂f
∂Vt = e−rt
• 
. ∂f
∂t = −re−rtVt
• 
. ∂2f
∂V 2t = 0. 
NB. The term h Subscript t Superscript 1 Baseline left parenthesis normal d e Superscript minus r t Baseline upper D Subscript t Baseline plus e Superscript minus r t Baseline normal d upper D Subscript t Baseline right parenthesish1
t
(
de−rtDt + e−rtdDt
)
vanished because (recall that upper D Subscript tDt is not 
stochastic): 
StartLayout 1st Row 1st Column normal d left parenthesis e Superscript minus r t Baseline upper D Subscript t Baseline plus e Superscript minus r t Baseline normal d upper D Subscript t Baseline right parenthesis 2nd Column equals 3rd Column normal d left parenthesis e Superscript minus r t Baseline upper D Subscript t Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column normal d left parenthesis e Superscript minus r t Baseline upper D 0 e Superscript r t Baseline right parenthesis equals normal d upper D 0 equals 0 period EndLayoutd
(
e−rtDt + e−rtdDt
)
= d
(
e−rtDt
)
= d
(
e−rtD0ert)
= dD0 = 0.
We arrive to the following pricing formula: 
StartLayout 1st Row 1st Column upper V overTilde Subscript t 2nd Column equals 3rd Column sans serif upper E Subscript sans serif upper P overTilde Baseline left parenthesis upper V overTilde Subscript upper T Baseline vertical bar script upper F Subscript t Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column long left right double arrow 3rd Column Blank 3rd Row 1st Column normal e Superscript r left parenthesis upper T minus t right parenthesis Baseline upper V Subscript t 2nd Column equals 3rd Column sans serif upper E Subscript sans serif upper P overTilde Baseline left parenthesis upper V Subscript upper T Baseline vertical bar script upper F Subscript t Baseline right parenthesis period EndLayout˜Vt
=
E ˜P
⎛
˜VT | Ft
⎞
⇐⇒
er(T −t)Vt
=
E ˜P (VT | Ft) .
To get a closed form formula for the European call option, we recall that by the 
replicating hypotheses and no arbitrage we have upper V Subscript t Baseline equals upper C Subscript tVt = Ct and upper V Subscript upper T Baseline equals left parenthesis upper S Subscript upper T Baseline minus upper K right parenthesis Superscript plusVT = (ST −K)+. 
Plugging in the expression for the log-normal stock price process with risk-neutral 
drift we have: 
StartLayout 1st Row 1st Column upper C Subscript t 2nd Column equals 3rd Column sans serif upper E Subscript sans serif upper P overTilde Baseline left parenthesis normal e Superscript minus r left parenthesis upper T minus t right parenthesis Baseline left parenthesis upper S Subscript t Baseline normal e Superscript left parenthesis r minus sigma squared slash 2 right parenthesis left parenthesis upper T minus t right parenthesis plus sigma left parenthesis upper B overTilde Super Subscript upper T Superscript minus upper B overTilde Super Subscript t Superscript right parenthesis Baseline minus upper K right parenthesis Superscript plus Baseline vertical bar script upper F Subscript t Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column normal e Superscript minus r left parenthesis upper T minus t right parenthesis Baseline integral Subscript negative normal infinity Superscript normal infinity Baseline left parenthesis y normal e Superscript left parenthesis r minus sigma squared slash 2 right parenthesis left parenthesis upper T minus t right parenthesis plus sigma left parenthesis z StartRoot upper T minus t EndRoot right parenthesis Baseline minus upper K right parenthesis Superscript plus Baseline f Subscript upper Z Baseline left parenthesis z right parenthesis normal d z period EndLayoutCt = E ˜P
⎛
e−r(T −t) ⎛
Ste(r−σ 2/2)(T −t)+σ( ˜BT −˜Bt) −K
⎞+
| Ft
⎞
= e−r(T −t)
⎰∞
−∞
⎛
ye(r−σ 2/2)(T −t)+σ(z√T −t) −K
⎞+
fZ(z)dz.
The second equality, with upper S Subscript t Baseline equals Overscript a period s period Endscripts ySt
a.s.
= y, follows11 since upper S Subscript tSt is a measurable function of upper B Subscript tBt
and then it is script upper F Subscript tFt-measurable, the increment upper B overTilde Subscript upper T Baseline minus upper B overTilde Subscript t ˜BT −˜Bt is independent from script upper F Subscript tFt, then 
all these imply that the above expectation is indeed unconditional and computed
11 Actually, we have also used a property of the Itô stochastic integral, see Exercise 10.4 
278
10
Introduction to Market Risk Measures and Option Pricing
(using the change of variable formula) via the standard normal density f Subscript upper Z Baseline left parenthesis z right parenthesisfZ(z) for 
upper Z tilde normal upper N left parenthesis 0 comma 1 right parenthesisZ ∼N(0, 1), which is the formula in Example 6.8, Chap. 6. The fact that here we 
have an unconditional expectation is due to formula (6.24) which we report here for 
the reader convenience: 
sans serif upper E left parenthesis h left parenthesis upper X comma upper Y right parenthesis vertical bar script upper A right parenthesis equals psi left parenthesis upper X right parenthesis commaE (h(X, Y) | A) = ψ(X),
where for a rv X independent from the sub-sigma hyphen algebraσ-algebra script upper A subset of script upper FA ⊂F and Y being script upper AA-
measurable we have a function h colon double struck upper R squared right arrow double struck upper Rh : R2 →R s.t. h left parenthesis upper X comma upper Y right parenthesis element of upper L Superscript 1h(X, Y) ∈L1, and then psi left parenthesis x right parenthesis equals sans serif upper E left parenthesis h left parenthesis x comma upper Y right parenthesis right parenthesisψ(x) =
E(h(x, Y)) given by the expectation of the rv h left parenthesis x comma upper Y right parenthesish(x, Y), which is obtained by keeping 
X as a constant becomes unconditional thus we get we get psi left parenthesis upper X right parenthesis equals sans serif upper E left parenthesis h left parenthesis upper X comma upper Y right parenthesis right parenthesisψ(X) = E(h(X, Y)). In  
the current setting, we have script upper A equals script upper F Subscript tA = Ft, upper X equals upper B overTilde Subscript upper T Baseline minus upper B overTilde Subscript tX = ˜BT −˜Bt and upper Y equals upper S Subscript upper TY = ST . With a further 
little effort we eventually arrive to the Black-Scholes formula 
upper C Subscript t Baseline equals y upper F Subscript upper Z Baseline left parenthesis normal d 1 right parenthesis minus normal e Superscript minus r left parenthesis upper T minus t right parenthesis Baseline upper K upper F Subscript upper Z Baseline left parenthesis normal d 2 right parenthesis commaCt = yFZ(d1) −e−r(T −t)KFZ(d2),
(10.20) 
where 
StartLayout 1st Row 1st Column normal d 1 2nd Column equals 3rd Column StartStartFraction ln left parenthesis StartFraction y Over upper K EndFraction right parenthesis plus left parenthesis r plus one half sigma squared right parenthesis left parenthesis upper T minus t right parenthesis OverOver sigma StartRoot upper T minus t EndRoot EndEndFraction 2nd Row 1st Column normal d 2 2nd Column equals 3rd Column normal d 1 minus sigma StartRoot upper T minus t EndRoot comma EndLayoutd1 = ln
( y
K
)
+
(
r + 1
2σ 2)
(T −t)
σ√T −t
d2 = d1 −σ
√
T −t,
see Exercise . It is apparent that evaluating this formula at t equals 0t = 0, for the known12 
upper S 0 equals yS0 = y, the known r and the (estimated) value of volatility sigmaσ we get a numerical 
result without the need of Monte Carlo simulation, see Sect. 8.4. 
10.5 
Exercises 
10.1 Suppose the weekly random loss X e is discrete with masses 
StartLayout 1st Row sans serif upper P left parenthesis upper X equals negative 105 right parenthesis equals 0.03 comma sans serif upper P left parenthesis upper X equals negative 57 right parenthesis equals 0.015 comma sans serif upper P left parenthesis upper X equals negative 10 right parenthesis equals 0.12 comma 2nd Row sans serif upper P left parenthesis upper X equals 39 right parenthesis equals 0.3 comma sans serif upper P left parenthesis upper X equals 98 right parenthesis equals 0.1 comma sans serif upper P left parenthesis upper X equals 226 right parenthesis equals 0.435 period EndLayoutP(X = −105) = 0.03,
P(X = −57) = 0.015,
P(X = −10) = 0.12,
P(X = 39) = 0.3,
P(X = 98) = 0.1,
P(X = 226) = 0.435.
Compute the 5% VaR. 
10.2 Prove that VaRc,T (X) = −Q+ 
X(c) = Q− 
−X(1 −c), for any c ∈ (0, 1). 
10.3 Show that the diffusive equation (10.17) has solution St = S0e(α−σ 2/2)t+σBt . 
10.4 Prove the Black-Scholes formula for t = 0.
12 Obviously, the strike price K and the maturity are also known. 
Appendix
279
Appendix 
Details on VaR and Quantiles 
Given a set StartSet x element of double struck upper R vertical bar upper P left parenthesis x right parenthesis EndSet
⎨
x ∈R | P(x)
⎬
, where upper P left parenthesis x right parenthesisP(x) is a property depending on x, we have that 
inf left brace x element of double struck upper R vertical bar upper P left parenthesis negative x right parenthesis right brace equals minus sup left brace y element of double struck upper R vertical bar upper P left parenthesis y right parenthesis right brace comma where y equals negative x period inf
⎨
x ∈R | P(−x)
⎬
= −sup
⎨
y ∈R | P(y)
⎬
,
where y = −x.
(10.21) 
As an example upper P left parenthesis negative x right parenthesisP(−x) given by the relation 3 less than negative x less than 53 < −x < 5. Thus, rewrite the set 
as StartSet x element of double struck upper R vertical bar negative 5 less than x less than negative 3 EndSet{x ∈R | −5 < x < −3} and take the inﬁmum to get negative 5−5. On the other hand, 
applying Eq. (10.21) yields minus sup left brace y element of double struck upper R vertical bar 3 less than y less than 5 right brace equals negative 5 comma with y equals negative 5 period−sup
⎨
y ∈R | 3 < y < 5
⎬
= −5,
with y = −5.
Equation (10.21) holds true by interchanging the inﬁmum with the supremum. More 
generally we have for y equals a plus b xy = a + b x: 
• 
.inf
⎨
x ∈R | P(a + bx)
⎬
= a + b inf
⎨
y ∈R | P(y)
⎬
, with a element of double struck upper Ra ∈R and b greater than 0b > 0; 
• 
.inf
⎨
x ∈R | P(a + bx)
⎬
= a + b sup
⎨
y ∈R | P(y)
⎬
, with a element of double struck upper Ra ∈R and b less than 0b < 0. 
The ﬁrst property implies that for quantiles upper Q Subscript a plus b upper X Baseline left parenthesis c right parenthesis equals a plus b upper Q Subscript upper X Baseline left parenthesis c right parenthesisQa+bX(c) = a + b QX(c), for b greater than 0b > 0. 
Itô Stochastic Integral 
It essentially in the treatment of stochastic integrals depending on Brownian motion 
that the ﬁltered probability space left parenthesis upper Omega comma script upper F comma StartSet script upper F Subscript t Baseline EndSet comma sans serif upper P right parenthesis(Ω, F, {Ft}, P) refers to StartSet script upper F Subscript t Baseline EndSet equals sigma left parenthesis upper B Subscript s Baseline comma s less than or slanted equals t right parenthesis{Ft} = σ(Bs, s ⩽t). 
Here we assume that if upper A element of script upper FA ∈F and sans serif upper P left parenthesis upper A right parenthesis equals 0P(A) = 0 then upper A element of script upper F Subscript tA ∈Ft for all t greater than or slanted equals 0t ⩾0. This  
technical condition ensures that each script upper F Subscript tFt contains all the sans serif upper PP-null events of script upper FF, which 
implies that for rvs upper X equals Overscript a period s period Endscripts upper YX a.s.
= Y, with Y being script upper F Subscript tFt-measurable we also have X as script upper F Subscript tFt-
measurable. We start from integral Subscript 0 Superscript t Baseline upper Z Subscript u Baseline normal d upper B Subscript u
⎰t
0 ZudBu, where upper Z equals left parenthesis upper Z Subscript t Baseline right parenthesis Subscript t greater than or slanted equals 0Z = (Zt)t⩾0 is a continuous-time 
process driven by the Brownian motion. The problem is that this stochastic integral 
integral Subscript 0 Superscript t Baseline upper Z Subscript u Baseline left parenthesis omega right parenthesis normal d upper B Subscript u Baseline left parenthesis omega right parenthesis
⎰t
0 Zu(ω)dBu(ω) cannot be deﬁned as a Riemann-Stieltjes integral for each scenario 
(i.e. each path), because omega right arrow from bar upper B Subscript t Baseline left parenthesis omega right parenthesisω ⍿→Bt(ω) is nowhere differentiable. This is linked to B 
having paths with unbounded variation on every ﬁnite interval left bracket 0 comma upper T right bracket[0, T ]. Heuristically, 
taking 
sup Underscript script upper P Subscript n Endscripts sigma summation Underscript i Superscript 1 Baseline Overscript n Endscripts StartAbsoluteValue upper B Subscript t Sub Subscript i Subscript Baseline minus upper B Subscript t Sub Subscript i minus 1 Subscript Baseline EndAbsoluteValuesup
Pn
n
⎲
i1
|Bti −Bti−1|
for each omega element of upper Omegaω ∈Ω and each partition 
script upper P Subscript n Baseline equals StartSet 0 equals t 0 comma t 1 comma ellipsis comma t Subscript n Baseline EndSet subset of left bracket 0 comma upper T right bracket commaPn = {0 = t0, t1, . . . , tn} ⊂[0, T ],
280
10
Introduction to Market Risk Measures and Option Pricing
it can be showed that it goes to normal infinity∞as n right arrow normal infinityn →∞and sup StartAbsoluteValue t Subscript i Baseline minus t Subscript i minus 1 Baseline EndAbsoluteValue right arrow 0sup |ti −ti−1| →0, see [9] or  
[12]. Instead, the quadratic variation 
sigma summation Underscript i equals 1 Overscript n Endscripts left parenthesis upper B Subscript t Sub Subscript i Subscript Baseline minus upper B Subscript t Sub Subscript i minus 1 Subscript Baseline right parenthesis squared
n
⎲
i=1
(Bti −Bti−1)2
is ﬁnite on left bracket 0 comma upper T right bracket[0, T ], and to see this intuitively we let t Subscript i minus 1 Baseline equals StartFraction left parenthesis i minus 1 right parenthesis t Over 2 Superscript n Baseline EndFractionti−1 = (i−1)t
2n
and t Subscript i Baseline equals StartFraction i t Over 2 Superscript n Baseline EndFractionti = it
2n , for a  
dyadic partition of any left bracket 0 comma t right bracket subset of left bracket 0 comma upper T right bracket[0, t] ⊂[0, T ], then rewrite the quadratic variation rv as 
upper H Subscript n Baseline colon equals sigma summation Underscript i equals 1 Overscript 2 Superscript n Baseline minus 1 Endscripts left parenthesis upper B Subscript t Sub Subscript i Subscript Baseline minus upper B Subscript t Sub Subscript i minus 1 Subscript Baseline right parenthesis squaredHn :=
2n−1
⎲
i=1
(Bti −Bti−1)2
for which13 upper H Subscript n Baseline right arrow Overscript a period s period Endscripts tHn
a.s.
−−→t. Observe that 
sans serif upper E left parenthesis upper H Subscript n Baseline right parenthesis equals sans serif upper E left parenthesis sigma summation Underscript i equals 1 Overscript 2 Superscript n Baseline minus 1 Endscripts left parenthesis upper B Subscript t Sub Subscript i Subscript Baseline minus upper B Subscript t Sub Subscript i minus 1 Subscript Baseline right parenthesis squared right parenthesis equals sigma summation Underscript i equals 1 Overscript 2 Superscript n Baseline minus 1 Endscripts left parenthesis StartFraction i t Over 2 Superscript n Baseline EndFraction minus StartFraction left parenthesis i minus 1 right parenthesis t Over 2 Superscript n Baseline EndFraction right parenthesis equals t periodE(Hn) = E
⎛
⎝
2n−1
⎲
i=1
(Bti −Bti−1)2
⎞
⎠=
2n−1
⎲
i=1
⎛it
2n −(i −1)t
2n
⎞
= t.
This can be written left parenthesis normal d upper B Subscript t Baseline right parenthesis squared equals normal d t(dBt)2 = dt or left angle bracket upper B right angle bracket Subscript t〈B〉t. 
Remark 10.8 Let upper Delta upper B Subscript t Baseline equals upper B Subscript t plus upper Delta t Baseline minus upper B Subscript t Baseline equals upper Z StartRoot upper Delta t EndRootΔBt = Bt+Δt −Bt = Z
√
Δt, where upper Z tilde normal upper N left parenthesis 0 comma 1 right parenthesisZ ∼N(0, 1), apply 
Chebyshev’s inequality: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis StartAbsoluteValue left parenthesis upper Delta upper B Subscript t Baseline right parenthesis squared minus upper Delta t EndAbsoluteValue greater than epsilon right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis upper Delta t StartAbsoluteValue upper Z squared minus t EndAbsoluteValue greater than epsilon right parenthesis 2nd Row 1st Column Blank 2nd Column less than or slanted equals 3rd Column StartFraction left parenthesis upper Delta t right parenthesis squared sans serif upper E left parenthesis upper Z squared minus 1 right parenthesis Over epsilon squared EndFraction period EndLayoutP
⎛||(ΔBt)2 −Δt
|| > ϵ
⎞
= P
⎛
Δt
||Z2 −t
|| > ϵ
⎞
⩽(Δt)2E(Z2 −1)
ϵ2
.
Then, the right-hand side of the inequality tends to zero as upper Delta t right arrow 0Δt →0. 
Knowing the behavior of B for t greater than or slanted equals 0t ⩾0, we deﬁne the Itô stochastic integral of a 
simple process: 
• partition left bracket 0 comma t right bracket[0, t] into subintervals left bracket t Subscript i minus 1 Baseline comma t Subscript i Baseline right bracket[ti−1, ti], through 
script upper P Subscript n Baseline equals StartSet 0 equals t 0 comma t 1 comma ellipsis comma t Subscript n Baseline equals t EndSet semicolonPn = {0 = t0, t1, . . . , tn = t};
• deﬁne upper C Subscript s Superscript left parenthesis n right parenthesis Baseline equals upper Z Subscript t Sub Subscript nC(n)
s
= Ztn, if s equals t Subscript ns = tn, and upper C Subscript s Superscript left parenthesis n right parenthesis Baseline equals upper Z Subscript t Sub Subscript i minus 1C(n)
s
= Zti−1 if t Subscript i minus 1 Baseline less than or slanted equals s less than t Subscript iti−1 ⩽s < ti, for i equals 1 comma ellipsis comma ni = 1, . . . , n, 
where upper Z equals left parenthesis upper Z Subscript t Baseline right parenthesis Subscript t greater than or slanted equals 0Z = (Zt)t⩾0 is a continuous time process;
13 Actually, the convergence is upper H Subscript n Baseline right arrow Overscript ms Endscripts tHn
ms
−−→t and then upper H Subscript n Baseline right arrow Overscript sans serif upper P Endscripts tHn
P
−→t, from which we can extract an a.s. 
convergent subsequence. 
Appendix
281
• deﬁne Z adapted to the Brownian natural ﬁltration, s.t. upper Z Subscript t Sub Subscript i minus 1Zti−1 is script upper F Subscript t Sub Subscript i minus 1Fti−1 measurable, 
and interpret this as a gamble where at each t Subscript i minus 1ti−1 we stake the amount upper Z Subscript t Sub Subscript i minus 1Zti−1 to be 
repaid by upper Z Subscript t Sub Subscript i minus 1 Baseline left parenthesis upper B Subscript t Sub Subscript i Subscript Baseline minus upper B Subscript t Sub Subscript i minus 1 Subscript Baseline right parenthesisZti−1(Bti −Bti−1) at t Subscript iti in a non anticipative way; 
• assume sans serif upper E left parenthesis upper Z Subscript t Sub Subscript i Subscript Superscript 2 Baseline right parenthesis less than normal infinityE(Z2
ti) < ∞, each t Subscript iti. 
The total ‘amount stacked’ is the desired stochastic integral 
upper I Subscript t Baseline left parenthesis upper C Superscript left parenthesis n right parenthesis Baseline right parenthesis equals sigma summation Underscript i equals 1 Overscript n Endscripts upper C Subscript t Sub Subscript i minus 1 Subscript Superscript left parenthesis n right parenthesis Baseline left parenthesis upper B Subscript t Sub Subscript i Subscript Baseline minus upper B Subscript t Sub Subscript i minus 1 Subscript Baseline right parenthesis commaIt(C(n)) =
n
⎲
i=1
C(n)
ti−1(Bti −Bti−1),
where obviously upper C Subscript t Sub Subscript i minus 1 Superscript left parenthesis n right parenthesis Baseline equals upper Z Subscript t Sub Subscript i minus 1C(n)
ti−1 = Zti−1, of the simple process upper C Superscript left parenthesis n right parenthesis Baseline equals left parenthesis upper C Subscript t Superscript left parenthesis n right parenthesis Baseline right parenthesis Subscript t greater than or slanted equals 0C(n) = (C(n)
t
)t⩾0. It can be 
shown that: 
• 
.E(It(C(n))) = 0; 
• 
.E
(
(It(C(n)))2)
is equal to sans serif upper E left parenthesis sigma summation Underscript i equals 1 Overscript n Endscripts upper Z Subscript t Sub Subscript i minus 1 Subscript Superscript 2 Baseline left parenthesis t Subscript i Baseline minus t Subscript i minus 1 Baseline right parenthesis right parenthesisE
⎛∑n
i=1 Z2
ti−1(ti −ti−1)
⎞
, by the independence of 
increments upper B Subscript t Sub Subscript i Baseline minus upper B Subscript t Sub Subscript i minus 1Bti −Bti−1 from script upper F Subscript t Sub Subscript i minus 1Fti−1 and the fact that sans serif upper V left parenthesis upper B Subscript t Sub Subscript i Subscript Baseline minus upper B Subscript t Sub Subscript i minus 1 Subscript Baseline right parenthesis equals t Subscript i Baseline minus t Subscript i minus 1V(Bti −Bti−1) = ti −ti−1. 
If 
integral Subscript 0 Superscript t Baseline sans serif upper E left parenthesis upper Z Subscript s Baseline minus upper C Subscript s Superscript left parenthesis n right parenthesis Baseline normal d s right parenthesis equals sans serif upper E left parenthesis integral Subscript 0 Superscript t Baseline upper Z Subscript s Baseline minus upper C Subscript s Superscript left parenthesis n right parenthesis Baseline normal d s right parenthesis right arrow 0
⎰t
0
E
⎛
Zs −C(n)
s ds
⎞
= E
⎛⎰t
0
Zs −C(n)
s ds
⎞
→0
as n right arrow normal infinityn →∞and script upper P Subscript nPn becomes ﬁner and ﬁner, then upper I Subscript t Baseline left parenthesis upper C Superscript left parenthesis n right parenthesis Baseline right parenthesis right arrow Overscript ms Endscripts upper I Subscript t Baseline left parenthesis upper Z right parenthesisIt(C(n))
ms
−−→It(Z). 
Remark 10.9 Actually, the stronger condition 
sans serif upper E left parenthesis sup Underscript 0 less than or slanted equals s less than or slanted equals t Endscripts StartAbsoluteValue upper I Subscript s Baseline left parenthesis upper Z right parenthesis minus upper I Subscript s Baseline left parenthesis upper C Superscript left parenthesis n right parenthesis Baseline right parenthesis EndAbsoluteValue squared right parenthesis right arrow 0 commaE
⎛
sup
0⩽s⩽t
||Is(Z) −Is(C(n))
||2
⎞
→0,
as n right arrow normal infinityn →∞implies mean square convergence. 
Thus, upper I equals left parenthesis upper I Subscript t Baseline left parenthesis upper Z right parenthesis right parenthesis Subscript t greater than or slanted equals 0I = (It(Z))t⩾0 is script upper F Subscript tFt-adapted with sans serif upper E left parenthesis upper I Subscript t Baseline left parenthesis upper Z right parenthesis right parenthesis equals 0E(It(Z)) = 0 and variance: 
StartLayout 1st Row 1st Column sans serif upper V left parenthesis upper I Subscript t Baseline left parenthesis upper Z right parenthesis right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis left parenthesis upper I Subscript t Baseline left parenthesis upper Z right parenthesis right parenthesis squared right parenthesis equals sans serif upper E left parenthesis left parenthesis integral Subscript 0 Superscript t Baseline upper Z Subscript s Baseline normal d upper B Subscript s Baseline right parenthesis squared right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper E left parenthesis integral Subscript 0 Superscript t Baseline upper Z Subscript s Superscript 2 Baseline normal d upper B Subscript s Baseline right parenthesis equals integral Subscript 0 Superscript t Baseline sans serif upper E left parenthesis upper Z Subscript s Superscript 2 Baseline right parenthesis normal d s period EndLayoutV(It(Z)) = E
⎛
(It(Z))2⎞
= E
⎛⎛⎰t
0
ZsdBs
⎞2⎞
= E
⎛⎰t
0
Z2
s dBs
⎞
=
⎰t
0
E(Z2
s )ds.
The latter property is called Itô isometry. As an alternative notation,14 we can write
14 It is only s typographical convention, since what has been deﬁned is the stochastic integral. 
282
10
Introduction to Market Risk Measures and Option Pricing
normal d upper I Subscript t Baseline left parenthesis upper Z right parenthesis equals upper Z Subscript t Baseline normal d upper B Subscript t Baseline long left right double arrow upper I Subscript t Baseline left parenthesis upper Z right parenthesis equals upper I 0 left parenthesis upper Z right parenthesis plus integral Subscript 0 Superscript t Baseline upper Z Subscript s Baseline normal d upper B Subscript s Baseline perioddIt(Z) = ZtdBt ⇐⇒It(Z) = I0(Z) +
⎰t
0
ZsdBs.
For example, we can write integral Subscript 0 Superscript t Baseline normal d upper B Subscript s Baseline equals upper B Subscript t Baseline minus upper B 0 equals upper B Subscript t
⎰t
0 dBs = Bt −B0 = Bt.15 A further property of the Itô 
integral is linearity: 
integral Subscript 0 Superscript t Baseline left brace a upper Z Subscript s Superscript 1 Baseline plus b upper Z Subscript s Superscript 2 Baseline right brace normal d upper B Subscript s Baseline equals a integral Subscript 0 Superscript t Baseline upper Z Subscript s Superscript 1 Baseline normal d upper B Subscript s Baseline plus b integral Subscript 0 Superscript t Baseline upper Z Subscript s Superscript 2 Baseline normal d upper B Subscript s Baseline
⎰t
0
⎨
a Z1
s + b Z2
s
⎬
dBs = a
⎰t
0
Z1
s dBs + b
⎰t
0
Z2
s dBs
for all a comma b element of double struck upper Ra, b ∈R and a pair of Itô-integrable processes upper Z Superscript 1 Baseline comma upper Z squaredZ1, Z2. The Itô integral is also 
linear with respect to intervals where it is computed: 
integral Subscript 0 Superscript t Baseline upper Z Subscript s Baseline normal d upper B Subscript s Baseline equals integral Subscript 0 Superscript u Baseline upper Z s normal d upper B Subscript s Baseline plus integral Subscript u Superscript t Baseline upper Z Subscript s Baseline normal d upper B Subscript s Baseline comma
⎰t
0
ZsdBs =
⎰u
0
ZsdBs +
⎰t
u
ZsdBs,
for 0 less than or slanted equals u less than t0 ⩽u < t. Moreover, we can deﬁne upper I Subscript s comma t Baseline left parenthesis upper Z right parenthesis equals integral Subscript s Superscript t Baseline upper Z Subscript u Baseline normal d upper B Subscript u BaselineIs,t(Z) =
⎰t
s ZudBu and it can showed that 
(see [14]) that 
sans serif upper E left parenthesis upper I Subscript s comma t Baseline left parenthesis upper Z right parenthesis vertical bar script upper F Subscript s Baseline right parenthesis equals 0 comma for 0 less than or slanted equals s less than t periodE
(
Is,t(Z) | Fs
)
= 0,
for 0 ⩽s < t.
(10.22) 
This property enable us to show that an Itô integral is a martingale: write upper I Subscript t Baseline left parenthesis upper Z right parenthesis equals upper I Subscript u Baseline left parenthesis upper Z right parenthesis plus upper I Subscript u comma t Baseline left parenthesis upper C upper Z right parenthesisIt(Z) =
Iu(Z) + Iu,t(CZ) and apply the general conditional expectation 
sans serif upper E left parenthesis upper I Subscript t Baseline left parenthesis upper Z right parenthesis vertical bar script upper F Subscript u Baseline right parenthesis equals sans serif upper E left parenthesis upper I Subscript u Baseline left parenthesis upper Z right parenthesis vertical bar script upper F Subscript u Baseline right parenthesis plus sans serif upper E left parenthesis upper I Subscript u comma t Baseline left parenthesis upper Z right parenthesis vertical bar script upper F Subscript u Baseline right parenthesis commaE(It(Z) | Fu) = E(Iu(Z) | Fu) + E(Iu,t(Z) | Fu),
and since upper I Subscript u Baseline left parenthesis upper C right parenthesisIu(C) is script upper F Subscript uFu-measurable we have sans serif upper E left parenthesis upper I Subscript u Baseline left parenthesis upper Z right parenthesis vertical bar script upper F Subscript u Baseline right parenthesis equals upper I Subscript u Baseline left parenthesis upper Z right parenthesisE(Iu(Z) | Fu) = Iu(Z) then by (10.22) 
it follows sans serif upper E left parenthesis upper I Subscript u comma t Baseline left parenthesis upper Z right parenthesis vertical bar script upper F Subscript u Baseline right parenthesis equals 0E(Iu,t(Z) | Fu) = 0, which entails sans serif upper E left parenthesis upper I Subscript t Baseline left parenthesis upper C right parenthesis vertical bar script upper F Subscript u Baseline right parenthesis equals upper I Subscript u Baseline left parenthesis upper C right parenthesisE(It(C) | Fu) = Iu(C) Formally, we 
can mix and write the SDE 
normal d upper Y Subscript t Baseline equals upper X Subscript t Baseline normal d t plus upper Z Subscript t Baseline normal d upper B Subscript tdYt = Xtdt + ZtdBt
to be meant 
upper Y Subscript t Baseline equals upper Y 0 plus integral Subscript 0 Superscript t Baseline upper X Subscript s Baseline normal d s plus integral Subscript 0 Superscript t Baseline upper Z Subscript s Baseline normal d upper B Subscript s Baseline commaYt = Y0 +
⎰t
0
Xsds +
⎰t
0
ZsdBs,
for an additional script upper F Subscript tFt-adapted process upper X Subscript tXt. Such a SDE is called a diffusion equation. 
For x element of double struck upper Rx ∈R, it can be shown that: 
upper X Subscript t Baseline equals limit Underscript h down arrow 0 Endscripts StartFraction 1 Over h EndFraction sans serif upper E left parenthesis upper Y Subscript t plus h Baseline minus upper Y Subscript t Baseline vertical bar upper Y Subscript t Baseline equals x right parenthesis commaXt = lim
h↓0
1
hE (Yt+h −Yt | Yt = x) ,
15 Under suitable conditions, integral Subscript 0 Superscript t Baseline upper Z Subscript s Baseline normal d upper B Subscript s
⎰t
0 ZsdBs can be understood in the Riemann sense, for each path. 
Appendix
283
and 
upper Z Subscript t Superscript 2 Baseline equals limit Underscript h down arrow 0 Endscripts StartFraction 1 Over h EndFraction sans serif upper E left parenthesis StartAbsoluteValue upper Y Subscript t plus h Baseline minus upper Y Subscript t Baseline EndAbsoluteValue squared vertical bar upper Y Subscript t Baseline equals x right parenthesis periodZ2
t = lim
h↓0
1
hE
⎛
|Yt+h −Yt|2 | Yt = x
⎞
.
Moreover, upper X Subscript t Baseline equals alpha left parenthesis t comma upper Y Subscript t Baseline right parenthesisXt = α(t, Yt), called the drift, and upper Z Subscript t Baseline equals sigma left parenthesis y comma upper Y Subscript t Baseline right parenthesisZt = σ(y, Yt), called the diffusive 
term, are suitable functions alpha comma sigmaα, σ. For example, the Brownian motion is a diffusive 
process since upper Y Subscript t Baseline equals upper B Subscript tYt = Bt with alpha left parenthesis t comma upper Y Subscript t Baseline right parenthesis equals 0α(t, Yt) = 0 and sigma left parenthesis y comma upper Y Subscript t Baseline right parenthesis equals 1σ(y, Yt) = 1. An Itô stochastic 
integral, as a process itself, is a continuous times martingale: 
sans serif upper E left parenthesis upper I Subscript t Baseline left parenthesis upper Z right parenthesis vertical bar script upper F Subscript s Baseline right parenthesis equals upper I Subscript s Baseline left parenthesis upper Z right parenthesis comma for 0 less than or slanted equals s less than t periodE (It(Z) | Fs) = Is(Z),
for 0 ⩽s < t.
In general, a diffusive SDE does not provides a martingale, unless the drift is zero. 
The following is crucial in our contingent claim pricing problem. 
Theorem 10.4 (Itô’s Formula) 
Suppose left parenthesis upper Y Subscript t Baseline right parenthesis Subscript t greater than or slanted equals 0(Yt)t⩾0 is a diffusive process and that 
f left parenthesis t comma y right parenthesisf (t, y) is a function with continuous second partial derivatives. Then, the stochastic 
process f left parenthesis t comma upper Y Subscript t Baseline right parenthesisf (t, Yt) satisﬁes the diffusion equation 
normal d f left parenthesis t comma upper Y Subscript t Baseline right parenthesis equals left parenthesis upper X Subscript t Baseline StartFraction partial differential f Over partial differential y EndFraction plus StartFraction partial differential f Over partial differential t EndFraction plus one half upper Z Subscript t Superscript 2 Baseline StartFraction partial differential squared f Over partial differential y squared EndFraction right parenthesis normal d t plus upper Z Subscript t Baseline StartFraction partial differential f Over partial differential y EndFraction normal d upper B Subscript t Baseline commadf (t, Yt) =
⎛
Xt
∂f
∂y + ∂f
∂t + 1
2Z2
t
∂2f
∂y2
⎞
dt + Zt
∂f
∂y dBt,
where the partial derivatives are evaluated at left parenthesis t comma upper Y Subscript t Baseline right parenthesis equals left parenthesis t comma y right parenthesis(t, Yt) = (t, y). 
The above theorem make implicitly use of the following multiplication rules: 
normal d t normal d t equals 0dtdt = 0, left parenthesis normal d upper B Subscript t Baseline right parenthesis squared equals normal d upper B Subscript t Baseline normal d upper B Subscript t Baseline equals normal d t(dBt)2 = dBtdBt = dt and normal d t normal d upper B Subscript t Baseline equals 0dtdBt = 0. In fact, to prove Itô’s Formula 
heuristically we can proceed as follows. Write the Taylor expansion of f left parenthesis t comma upper Y Subscript t Baseline right parenthesisf (t, Yt) up 
to second order: 
StartLayout 1st Row 1st Column normal d f left parenthesis t comma upper Y Subscript t Baseline right parenthesis 2nd Column equals 3rd Column StartFraction partial differential f Over partial differential t EndFraction normal d t plus StartFraction partial differential f Over partial differential upper Y Subscript t Baseline EndFraction normal d upper Y Subscript t plus one half StartFraction partial differential squared f Over partial differential t squared EndFraction left parenthesis normal d t right parenthesis squared 2nd Row 1st Column Blank 2nd Column plus 3rd Column one half StartFraction partial differential squared f Over partial differential upper Y Subscript t Superscript 2 Baseline EndFraction left parenthesis normal d upper Y Subscript t Baseline right parenthesis squared plus StartFraction partial differential squared f Over partial differential t partial differential upper Y Subscript t Baseline EndFraction normal d t normal d upper Y Subscript t Baseline period EndLayoutdf (t, Yt) = ∂f
∂t dt + ∂f
∂Yt
dYt + 1
2
∂2f
∂t2 (dt)2
+ 1
2
∂2f
∂Y 2t
(dYt)2 + ∂2f
∂t∂Yt
dtdYt.
Now, from SDE normal d upper Y Subscript t Baseline equals upper X Subscript t Baseline normal d t plus upper Z Subscript t Baseline normal d upper B Subscript tdYt = Xtdt + ZtdBt and using the above multiplication rules we 
compute: 
StartLayout 1st Row 1st Column left parenthesis normal d upper Y Subscript t Baseline right parenthesis squared 2nd Column equals 3rd Column upper X Subscript t Superscript 2 Baseline left parenthesis normal d t right parenthesis squared plus upper Z Subscript t Superscript 2 Baseline left parenthesis normal d upper B Subscript t Baseline right parenthesis squared plus 2 upper X Subscript t Baseline upper Z Subscript t Baseline normal d upper B Subscript t 2nd Row 1st Column Blank 2nd Column equals 3rd Column upper Z Subscript t Superscript 2 Baseline normal d upper B Subscript t Baseline normal d upper B Subscript t Baseline equals upper Z Subscript t Superscript 2 Baseline normal d t period EndLayout(dYt)2 = X2
t (dt)2 + Z2
t (dBt)2 + 2XtZtdBt
= Z2
t dBtdBt = Z2
t dt.
Plugging the above into the Taylor formula we get Itô’s Formula. Indeed, the latter 
can be written 
normal d f left parenthesis t comma upper Y Subscript t Baseline right parenthesis equals StartFraction partial differential f Over partial differential t EndFraction normal d t plus StartFraction partial differential f Over partial differential upper Y Subscript t Baseline EndFraction normal d upper Y Subscript t Baseline plus one half StartFraction partial differential squared f Over partial differential upper Y Subscript t Superscript 2 Baseline EndFraction left parenthesis normal d upper Y Subscript t Baseline right parenthesis squareddf (t, Yt) = ∂f
∂t dt + ∂f
∂Yt
dYt + 1
2
∂2f
∂Y 2t
(dYt)2
(10.23) 
which we used in the expression for upper V overTilde Subscript t˜Vt.
Solutions to Exercises 
Exercises of Chap. 1 
1.1 We have to collect those ω ∈Ω s.t. S1(ω) has value less than or equal to 3.5: 
StartSet omega vertical bar upper S 1 left parenthesis omega right parenthesis less than or slanted equals 3.5 EndSet equals StartSet uud comma udu comma duu comma udd comma dud comma ddu comma ddd EndSet period{ω | S1(ω) ⩽3.5} = {uud, udu, duu, udd, dud, ddu, ddd}.
1.2 First we note that {S1 > 3.5} = {S1 ⩽3.5}c , where for a subset A we write Ac 
the collection containing those outcomes ω ∈Ω s.t. ω /∈ A, given Ω as the universal 
set. Therefore, we have the singleton: 
StartSet omega vertical bar upper S 1 left parenthesis omega right parenthesis greater than 3.5 EndSet equals StartSet uuu EndSet period{ω | S1(ω) > 3.5} = {uuu}.
Moreover {S1 ⩾3.5} = {S1 < 3.5}c = {uuu, uud, udu, duu} while {S1 < 3.5} =  
{udd, dud, ddu, ddd} and {S1 = 3.5} = {uud, udu, duu}. 
1.3 It is easily seen that 
StartSet omega vertical bar upper X left parenthesis omega right parenthesis less than or slanted equals a EndSet union StartSet omega vertical bar a less than upper X left parenthesis omega right parenthesis less than or slanted equals b EndSet{ω | X(ω) ⩽a} ∪{ω | a < X(ω) ⩽b}
is the event containing those outcomes ω for which at the same time X(ω) ⩽b, 
X(ω) > a and X(ω) ⩽a, thus we have the desired event {X ⩽b}. Observe that 
{X ⩽a} ∩{a <  X ⩽b} =  ∅, i.e. they are incompatible events: the rv cannot 
maps the same outcomes ω for which X(ω) > a and X(ω) ⩽a hold. Since X is a 
function, it maps each ω ∈Ω into one real number; it is ruled out that the same ω is 
mapped into the number X(ω) = a and into a different number X(ω) = c >  a.  
1.4 We have 
StartSet omega vertical bar upper X left parenthesis omega right parenthesis greater than a EndSet union StartSet omega vertical bar upper X left parenthesis omega right parenthesis equals a EndSet{ω | X(ω) > a} ∪{ω | X(ω) = a}
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4
285
286
Solutions to Exercises
is the event containing those ω for which either X(ω) > a, or X(ω) = a (but not 
both), thus we have the desired event {X ⩾a}. 
1.5 The assumption prevent us from the need to encode outcomes ω as we did in 
previous examples (using u,d). Now, the event A contains those ω s.t. 1 < S1(ω) < 
3, or X(ω) ∈ B = (1, 3). Then, S1(ω) ⩽3 − 1 
i for some i = 1, 2, . . . .  As 
byproduct, S1(ω) ∈∪∞
i=1(1, 3 − 1 
i ], i.e. at least one of the events Ai = {1 < S1 ⩽
3 −1 
i } occur and we conclude A = ∪∞
i=1Ai. Conversely, if S1(ω) ∈∪∞
i=1(1, 3 −1 
i ] 
then 1 < S1(ω) ⩽3 − 1 
i , for some i = 1, 2, . . .  .  Thus S1(ω) ∈ (1, 3). If Ai ∈ F 
then their union A is also a member of the σ-algebra F: we can assign probabilities 
to each Ai and to A. 
1.6 The event A contains those ω s.t. 1 ⩽S1(ω) ⩽3, or S1(ω) ∈ B = [1, 3]. Then, 
1 − 1 
i < S1(ω) for all i = 1, 2, . . .  .  As byproduct, S1(ω) ∈∩∞
i=1(1 − 1 
i , 3], i.e. all 
events Ai = {1 − 1 
i < S1 ⩽3} occur and we conclude A = ∩∞
i=1Ai. Conversely, 
if S1(ω) ∈∩∞
i=1(1 − 1 
i , 3] then 1 − 1 
i < S1(ω) ⩽3, for all i = 1, 2, . . .  .  Thus 
S1(ω) ∈[1, 3]. 
1.7 Since every event comes from F, by property S2 we have Ac 
i ∈ F for all i = 
1, 2, . . .  .  Thus, by property S3 ∪∞
i=1Ac 
i ∈F and by DeMorgan’s Laws
(
∪∞
i=1Ac 
i
)c = 
∩∞
i=1Ai ∈F. Moreover, recall that A \ B = A ∩ Bc and observe that since Bc ∈F 
by property S2, then A ∩ Bc ∈F by the above reasoning. 
1.8 We establish both A∩(B ∪C) ⊂ (A∩B)∪(A∩C), and (A∩B)∪(A∩C) ⊂ 
A∩(B ∪C). First,  ω ∈ A∩(B ∪C) ⇒ ω ∈ A and ω ∈ B ∪C, thus we have ω ∈ A 
and ω ∈ B or ω ∈ C. Now we distinguish 2 cases. 
ω ∈ B. 
Thus ω ∈ A and ω ∈ B, i.e. ω ∈ A ∩ B 
ω ∈ C. 
Thus ω ∈ A and ω ∈ C, i.e. ω ∈ A ∩ C. 
Both yield ω ∈ (A ∩ B) ∪ (A ∩ C). Summing up: ω ∈ A ∩ (B ∪ C) does imply 
ω ∈ (A∩B)∪(A∩C), which means that A∩(B∪C) is a subset of (A∩B)∪(A∩C). 
Second, we prove the converse (A ∩ B) ∪ (A ∩ C) ⊂ A ∩ (B ∪ C). Let ω ∈ 
(A ∩ B) ∪ (A ∩ C). As a consequence, ω ∈ A ∩B or ω ∈ A ∩ C and we again 
distinguish two cases. 
ω ∈ A ∩ B. 
We have ω ∈ B and so ω ∈ B ∪ C, i.e. ω ∈ A ∩ (B ∪ C). 
ω ∈ A ∩ C. 
We have ω ∈ C and so ω ∈ B ∪ C, i.e. ω ∈ A ∩ (B ∪ C). 
Summing up: ω ∈ (A ∩ B) ∪ (A ∩ C) does imply ω ∈ A ∩ (B ∪ C), i.e. (A ∩ 
B) ∪ (A ∩ C) ⊂ A ∩ (B ∪ C). This together with the reverse inclusion (we proved 
previously) entail the desired equality A ∩ (B ∪ C) = (A ∩ B) ∪ (A ∩ C). 
1.9 We have: 
StartLayout 1st Row 1st Column omega element of left parenthesis union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i Baseline right parenthesis Superscript c 2nd Column long left right double arrow 3rd Column omega not an element of union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i 2nd Row 1st Column Blank 2nd Column long left right double arrow 3rd Column omega not an element of upper A Subscript i Baseline for all i equals 1 comma 2 comma ellipsis 3rd Row 1st Column Blank 2nd Column long left right double arrow 3rd Column omega element of upper A Subscript i Superscript c Baseline for all i equals 1 comma 2 comma ellipsis 4th Row 1st Column Blank 2nd Column long left right double arrow 3rd Column omega element of intersection Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i Superscript c Baseline period EndLayoutω ∈
(
∪∞
i=1Ai
)c ⇐⇒ω /∈∪∞
i=1Ai
⇐⇒ω /∈Ai
for all i = 1, 2, . . .
Solutions to Exercises
287
⇐⇒ ω ∈ Ac 
i 
for all i = 1, 2, . . .  
⇐⇒ ω ∈∩∞
i=1Ac 
i . 
In a similar way, we can prove DeMorgan’s Law
(
∩∞
i=1Ai
)c = ∪∞
i=1Ac 
i . 
1.10
•
First, we rewrite A ∪ (A ∩ B) = (A ∩Ω) ∪ (A ∩ B). Then we use distributivity 
and compute A ∩ (Ω ∪ B) = A ∩Ω = A.
•
First, we use distributivity when intersecting (A ∪ B) with the union A ∪ C : 
StartLayout 1st Row 1st Column left parenthesis upper A union upper B right parenthesis intersection left parenthesis upper A union upper C right parenthesis 2nd Column equals 3rd Column left bracket left parenthesis upper A union upper B right parenthesis intersection upper A right bracket union left bracket left parenthesis upper A union upper B right parenthesis intersection upper C right bracket 2nd Row 1st Column Blank 2nd Column StartLayout 1st Row distrib period again 2nd Row equals EndLayout 3rd Column left parenthesis upper A intersection upper A right parenthesis union left parenthesis upper A intersection upper B right parenthesis union left parenthesis upper A intersection upper C right parenthesis union left parenthesis upper B intersection upper C right parenthesis 3rd Row 1st Column Blank 2nd Column StartLayout 1st Row distrib period again 2nd Row equals EndLayout 3rd Column upper A intersection left parenthesis upper Omega union upper B union upper C right parenthesis union left parenthesis upper B intersection upper C right parenthesis 4th Row 1st Column Blank 2nd Column equals 3rd Column left parenthesis upper A intersection upper Omega right parenthesis union left parenthesis upper B intersection upper C right parenthesis equals upper A union left parenthesis upper B intersection upper C right parenthesis period EndLayout(A ∪B) ∩(A ∪C)
=
[(A ∪B) ∩A] ∪[(A ∪B) ∩C]
distrib. again
=
(A ∩A) ∪(A ∩B) ∪(A ∩C) ∪(B ∩C)
distrib. again
=
A ∩(Ω ∪B ∪C) ∪(B ∩C)
=
(A ∩Ω) ∪(B ∩C) = A ∪(B ∩C).
1.11 Assume P(A ∩ B) = P(B) and P(Ac ) = 1 to ﬁnd a contradiction. We have 
sans serif upper P left parenthesis upper B right parenthesis equals sans serif upper P left parenthesis upper A intersection upper B right parenthesis plus sans serif upper P left parenthesis upper A intersection upper B Superscript c Baseline right parenthesis commaP(B) = P(A ∩B) + P(A ∩Bc),
thus by the ﬁrst hypotheses P(A ∩ Bc ) = 0. This implies P((A ∩ Bc )c ) is 1 and we 
can write: 
StartLayout 1st Row 1st Column 1 2nd Column equals 3rd Column sans serif upper P left parenthesis left parenthesis upper A intersection upper B Superscript c Baseline right parenthesis Superscript c Baseline right parenthesis equals sans serif upper P left parenthesis upper A Superscript c Baseline union upper B right parenthesis 2nd Row 1st Column Blank 2nd Column StartLayout 1st Row subadd period 2nd Row less than or slanted equals EndLayout 3rd Column sans serif upper P left parenthesis upper A Superscript c Baseline right parenthesis plus sans serif upper P left parenthesis upper B right parenthesis period EndLayout1
=
P((A ∩Bc)c) = P(Ac ∪B)
subadd.
⩽
P(Ac) + P(B).
From P(Ac ) = 1 we have  P(A) = 0 and then by the above it holds P(Bc ) ⩾1 
which is false. As byproduct, it must be true P(A ∩ B) = P(B) implies P(A) = 0. 
1.12
•
Checking Pr1. Decompose Ω as the disjoint union A ∪ Ac . Then write P(Ω) =
|Ω| 
n = 1 = |A∪Ac| 
n 
, and recall that |A ∪ Ac| = |A| + |Ac|. Thus 
1 equals StartFraction StartAbsoluteValue upper A EndAbsoluteValue Over n EndFraction plus StartFraction StartAbsoluteValue upper A Superscript c Baseline EndAbsoluteValue Over n EndFraction long left right double arrow StartFraction StartAbsoluteValue upper A Superscript c Baseline EndAbsoluteValue Over n EndFraction equals 1 minus StartFraction StartAbsoluteValue upper A EndAbsoluteValue Over n EndFraction long left right double arrow sans serif upper P left parenthesis upper A Superscript c Baseline right parenthesis equals 1 minus sans serif upper P left parenthesis upper A right parenthesis period1 = |A|
n + |Ac|
n
⇐⇒|Ac|
n
= 1 −|A|
n ⇐⇒P(Ac) = 1 −P(A).
•
Checking Pr2. For A, B ∈F s.t. A ⊂ B we have |A| ⩽|B|, and P(A) = |A| 
n ⩽
|B| 
n = P(B).
•
Checking Pr3. For A, B as above we have |B \ A| = |B| −|A| and the result 
follows easily.
•
Checking Pr4. For events A, B ∈F we have |A ∪ B| = |A| + |B| −|A ∩ B| and 
the result follows easily.
288
Solutions to Exercises
1.13 It sufﬁces to show that H contains ∅ and it is closed under complements and 
countable unions. Indeed, ∅ belong to H as ∅ ∈ Si for all i ∈ I. Assume A ∈ H, 
then every Si ∈ G contains A, then it contains its complement Ac too, which in 
turn belong to H. Now suppose (Ai)i∈N is a sequence of measurable sets in H. This 
implies Ai ∈ G for every i ∈ I. Then ∪iAi belongs to Si ∈ G and consequently 
to H. 
1.14 Let G be the collection of all σ-algebras containing C. Then G is nonempty as 
it contains 2Ω. Furthermore, by Exercise 1.13 and its solution the intersection of all 
σ-algebras in G is itself a σ-algebra which contains the class C. 
1.15 Given A, B ∈ F we have Ac ∈ F by (S2) and B \ A = B ∩ Ac ∈ F, 
thus we have proved the ﬁrst claim regardless the additional hypotheses A ⊂ B. 
Furthermore, any sequence (Ai)i∈N ⊂ F of events in the σ-algebra satisﬁes (S3), 
∪iAi ∈ F, which is obviously holds when, in addition, the sequence is monotone 
increasing. 
1.16 We need to check properties S1–S3 of Deﬁnition 1.2. S1 is veriﬁed, ∅ ∈FE, 
since A = ∅ gives A ∩ E = ∅ or alternatively Ec ∩ E = ∅ ∈ FE, given that 
Ec ∈F. To show S2, for every A ∩ E ∈FE we must have (A ∩ E)c ∈FE, where 
E is the new reference space. Indeed, taking complements has to be redeﬁned as 
(A∩B)c := E\(A∩E). The term on the right-hand side reduces to E∩(A∩E)c = 
E ∩ (Ac ∪ Ec ). But  Ac ∪ Ec ∈F, then the last term on the right-hand side belongs 
to FE and we are done. Finally, for a sequence (Ai)i∈N ⊂F we have Ai ∩ E ∈FE 
for all i, and we have 
left parenthesis upper A 1 intersection upper E right parenthesis union left parenthesis upper A 2 intersection upper E right parenthesis union midline horizontal ellipsis equals union Subscript i Baseline left parenthesis upper A Subscript i Baseline intersection upper E right parenthesis equals left parenthesis union Subscript i Baseline upper A Subscript i Baseline right parenthesis intersection upper E comma(A1 ∩E) ∪(A2 ∩E) ∪· · · = ∪i(Ai ∩E) = (∪iAi) ∩E,
since ∪iAi ∈F. Then, ∪i(Ai ∩ E) ∈FE, and S3 is veriﬁed. 
Exercises of Chap. 2 
2.1 To show (e) we simply consider {X >  a} = {X ⩽a}c and by property Pr1 of 
P( · ) we have 
sans serif upper P left parenthesis upper X greater than a right parenthesis equals 1 minus sans serif upper P left parenthesis upper X less than or slanted equals a right parenthesis equals 1 minus upper F Subscript upper X Baseline left parenthesis a right parenthesis periodP(X > a) = 1 −P(X ⩽a) = 1 −FX(a).
To show (f), ﬁrst consider the decreasing sequence of events {a − 1 
i < X ⩽a} for 
i ∈ N, with intersection ∩∞
i=1{a − 1 
i < X ⩽a} = {X = a}. Thus, by continuity of 
P( · ) we have 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper X equals a right parenthesis 2nd Column equals 3rd Column limit Underscript i right arrow normal infinity Endscripts sans serif upper P left parenthesis a minus StartFraction 1 Over i EndFraction less than upper X less than or slanted equals a right parenthesis 2nd Row 1st Column Blank 2nd Column StartLayout 1st Row Theorem question mark question mark question mark left parenthesis d right parenthesis 2nd Row equals EndLayout 3rd Column limit Underscript i right arrow normal infinity Endscripts left bracket upper F Subscript upper X Baseline left parenthesis a right parenthesis minus upper F Subscript upper X Baseline left parenthesis a minus StartFraction 1 Over i EndFraction right parenthesis right bracket 3rd Row 1st Column Blank 2nd Column equals 3rd Column upper F Subscript upper X Baseline left parenthesis a right parenthesis minus upper F Subscript upper X Baseline left parenthesis a Superscript minus Baseline right parenthesis period EndLayoutP(X = a)
=
lim
i→∞P(a −1
i < X ⩽a)
Solutions to Exercises
289
Theorem 2.1(d) 
=
lim 
i→∞
⎾
FX(a) − FX(a − 1 
i )
⏋
=
FX(a) − FX(a−). 
2.2 The density function is continuous on the closed interval [x −h 
2, x + h 
2], whose 
total length is h. By the mean value theorem we ﬁnd c ∈ (x − h 
2, x  + h 
2) s.t. 
h f Subscript upper X Baseline left parenthesis c right parenthesis equals integral Subscript x minus StartFraction h Over 2 EndFraction Superscript x plus StartFraction h Over 2 EndFraction Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x commahfX(c) =
⎰x+ h
2
x−h
2
fX(x)dx,
which is the required probability P
(
x−h 
2 ⩽X ⩽x+ h 
2
)
. Evaluating the density at a 
different point x /= c inside the above closed interval we have hfX(x) ≈ P(x −h 
2 ⩽
X ⩽x + h 
2), i.e. geometrically the area of a rectangle. When the base becomes 
smaller and smaller, we end with 
sans serif upper P left parenthesis upper X equals x right parenthesis equals limit Underscript h right arrow 0 Endscripts integral Subscript x minus StartFraction h Over 2 EndFraction Superscript x plus StartFraction h Over 2 EndFraction Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x equals integral Subscript x Superscript x Baseline f Subscript upper X Baseline left parenthesis u right parenthesis normal d u equals 0 commaP(X = x) = lim
h→0
⎰x+ h
2
x−h
2
fX(x)dx =
⎰x
x
fX(u)du = 0,
conﬁrming that the density alone is not a probability. 
2.3 Take a suitable B ⊂ R. Then, {IA ∈ B} can be:
•
the impossible event ∅, provided 0 /∈ B and 1 /∈ B;
•
the certain event Ω, whenever both 1 and 0 are in B;
•
the event A, if 0  /∈ B and 1 ∈ B;
•
the contrary event Ac, when 0 ∈ B and 1 /∈ B. 
2.4 The diagram Ω
X
−→ R 
IB
−→ R shows that IB ◦ X is itself an indicator function, 
since it assume value 1 whenever X(ω) ∈ B and 0 otherwise, but this means ω ∈ 
{X ∈ B} thus we have IB(X) = I{X∈B}. 
Remark 1 From Appendix in Chap. 2, we can use the concept of Borel-measurable 
function and the fact that a composition of two measurable functions is again 
measurable. Thus, IB is a Borel-measurable function and the composed map IB ◦ X 
is also measurable because X is a rv. 
2.5 The union of left-open intervals (a, b − 1 
i ] contains those real numbers x such 
that a <  x ⩽b − 1 
i for at least one i ∈ N. On the other hand, the condition 
x ⩽b − 1 
i for at least one i is equivalent to x <  b.  Eventually, (a, b − 1] ∪ (a, b − 
1 
2] ∪ (a, b − 1 
3] ∪· · ·  will be (a, b). Since every left-open interval is a Borel set, 
then their countable union is Borel too. Now, the intersection of left-open intervals 
(a − 1 
i , b] contains those real numbers x such that a − 1 
i < x ⩽b for all i ∈ N. 
The condition a − 1 
i < x  for all i is equivalent to a ⩽x. For i large enough
290
Solutions to Exercises
(a −1, b]∩(a −1 
2, b]∩(a −1 
3, b]∩· · ·  will be [a, b]. The same reasoning as above 
provides this closed interval as a Borel set. 
2.6 
(1) By our convention, the class G contains ﬁnite disjoint unions of left-open 
intervals (a, b] with −∞⩽a <  b  <  ∞ and such that (a, ∞) = (a, ∞]. 
Thus, it sufﬁces to choose a1 = −∞, b1 = a2, b2 = a3 and then take the ﬁnite 
disjoint union 
left parenthesis a 1 comma b 1 right bracket union left parenthesis a 2 comma b 2 right bracket union left parenthesis a 3 comma normal infinity right bracket equals left parenthesis negative normal infinity comma normal infinity right parenthesis element of script upper G period(a1, b1] ∪(a2, b2] ∪(a3, ∞] = (−∞, ∞) ∈G.
But clearly (−∞, ∞) = R. (2) By Formula P0(A) := ∑n 
i=1 F(bi) − F(ai) 
and the previous exercise, with R = (a1, b1] ∪ (a2, b2] ∪ (a3, ∞] we have: 
StartLayout 1st Row 1st Column sans serif upper P 0 left parenthesis double struck upper R right parenthesis 2nd Column equals 3rd Column upper F left parenthesis b 1 right parenthesis minus upper F left parenthesis negative normal infinity right parenthesis plus upper F left parenthesis b 2 right parenthesis minus upper F left parenthesis a 2 right parenthesis plus upper F left parenthesis normal infinity right parenthesis minus upper F left parenthesis a 3 right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column upper F left parenthesis b 1 right parenthesis minus 0 plus upper F left parenthesis b 2 right parenthesis minus upper F left parenthesis b 1 right parenthesis plus 1 minus upper F left parenthesis b 2 right parenthesis equals 1 comma EndLayoutP0(R) = F(b1) −F(−∞) + F(b2) −F(a2) + F(∞) −F(a3)
= F(b1) −0 + F(b2) −F(b1) + 1 −F(b2) = 1,
since F is a distribution function with the additional properties limx→−∞ 
F(x) = 0 and limx→∞ F(x) = 1, and moreover b1 = a2, b2 = a3. (3)  
Formula (2.26) is shown to be ﬁnite additive on ﬁnite disjoint unions of sets 
in G. Since 
sans serif upper P 0 left parenthesis double struck upper R right parenthesis equals sans serif upper P 0 left parenthesis double struck upper R union empty set right parenthesis equals sans serif upper P 0 left parenthesis double struck upper R right parenthesis plus sans serif upper P 0 left parenthesis empty set right parenthesisP0(R) = P0(R ∪∅) = P0(R) + P0(∅)
and P0(R) = 1 we must have  P0(∅) = 0. 
2.7 It sufﬁces to check properties PA1,PA2 of Deﬁnition 1.3 in Sect. 1.3 hold.
•
To verify PA1 we observe that: 
sans serif upper P Subscript upper X Baseline left parenthesis empty set right parenthesis colon equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts p Subscript i Baseline delta Subscript x Sub Subscript i Subscript Baseline left parenthesis empty set right parenthesis equals 0 commaPX(∅) :=
∞
⎲
i=1
piδxi(∅) = 0,
since each δxi (∅) is zero by deﬁnition; similarly 
sans serif upper P Subscript upper X Baseline left parenthesis double struck upper R right parenthesis colon equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts p Subscript i Baseline delta Subscript x Sub Subscript i Subscript Baseline left parenthesis double struck upper R right parenthesis equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts p Subscript i Baseline equals 1 commaPX(R) :=
∞
⎲
i=1
piδxi(R) =
∞
⎲
i=1
pi = 1,
because each δxi (R) is one by deﬁnition.
•
To check countable additivity PA2 for pairwise disjoint Borel sets (Bj)j∈N ⊂B 
we ﬁrst note that 
delta Subscript x Sub Subscript i Subscript Baseline left parenthesis union Subscript j equals 1 Superscript normal infinity Baseline upper B Subscript j Baseline right parenthesis equals sigma summation Underscript j equals 1 Overscript normal infinity Endscripts delta Subscript x Sub Subscript i Subscript Baseline left parenthesis upper B Subscript j Baseline right parenthesis commaδxi(∪∞
j=1Bj) =
∞
⎲
j=1
δxi(Bj),
Solutions to Exercises
291
since by disjointedness either xi ∈ Bj for only one Bj (so δxi (Bj) = 1 and the 
Dirac deltas for all indexes different from j are zero) or xi does not belong to 
any Bj (all δxi (Bj) are zero). Then we compute: 
StartLayout 1st Row 1st Column sans serif upper P Subscript upper X Baseline left parenthesis union Subscript j equals 1 Baseline upper B Subscript j Baseline right parenthesis 2nd Column colon equals 3rd Column sigma summation Underscript i equals 1 Overscript normal infinity Endscripts p Subscript i Baseline delta Subscript x Sub Subscript i Baseline left parenthesis union Subscript j equals 1 Superscript normal infinity Baseline upper B Subscript j Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript normal infinity Endscripts p Subscript i Baseline sigma summation Underscript j equals 1 Overscript normal infinity Endscripts delta Subscript x Sub Subscript i Baseline left parenthesis upper B Subscript j Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript j equals 1 Overscript normal infinity Endscripts sigma summation Underscript i equals 1 Overscript normal infinity Endscripts p Subscript i Baseline delta Subscript x Sub Subscript i Subscript Baseline left parenthesis upper B Subscript j Baseline right parenthesis equals sigma summation Underscript j equals 1 Overscript normal infinity Endscripts sans serif upper P Subscript upper X Baseline left parenthesis upper B Subscript j Baseline right parenthesis period EndLayoutPX(∪j=1Bj) :=
∞
⎲
i=1
piδxi(∪∞
j=1Bj)
=
∞
⎲
i=1
pi
∞
⎲
j=1
δxi(Bj)
=
∞
⎲
j=1
∞
⎲
i=1
piδxi(Bj) =
∞
⎲
j=1
PX(Bj).
2.8 We have to transform the given rv by taking its absolute value, |X|. We also  
have: 
StartAbsoluteValue upper X EndAbsoluteValue equals upper X Superscript plus Baseline plus upper X Superscript minus Baseline comma and upper X equals upper X Superscript plus Baseline minus upper X Superscript minus Baseline period|X| = X+ + X−,
and
X = X+ −X−.
Eventually, X+ and X− are both ⩽|X|. 
2.9 It sufﬁces to draw the graphs of the corresponding functions. 
2.10 Recall that by deﬁnition of quantile function (see Sect. 2.8, Deﬁnition 2.8, 
and Proposition 2.2, items 1 and 2) it holds QX(FX(x)) ⩽x, for all x ∈ R, and 
FX(QX(c)) ⩾c, for all c ∈ (0, 1). Therefore, assuming X ⩽st Y we have FY (x) ⩽
FX(x) for every x and then 
upper Q Subscript upper X Baseline left parenthesis upper F Subscript upper Y Baseline left parenthesis x right parenthesis right parenthesis less than or slanted equals upper Q Subscript upper X Baseline left parenthesis upper F Subscript upper X Baseline left parenthesis x right parenthesis right parenthesis less than or slanted equals x comma for all x element of double struck upper R periodQX(FY (x)) ⩽QX(FX(x)) ⩽x,
for all x ∈R.
Conversely, assuming x ⩾QX(FY (x)) for every x we have 
upper F Subscript upper X Baseline left parenthesis x right parenthesis greater than or slanted equals upper F Subscript upper X Baseline left parenthesis upper Q Subscript upper X Baseline left parenthesis upper F Subscript upper Y Baseline left parenthesis c right parenthesis right parenthesis right parenthesis greater than or slanted equals upper F Subscript upper Y Baseline left parenthesis x right parenthesis comma for all x element of double struck upper R commaFX(x) ⩾FX(QX(FY (c))) ⩾FY (x),
for all x ∈R,
and the equivalence is proved. 
2.11 For a discrete X, we ﬁrst evaluate formula (2.14) at  x+ = limh↓0 x + h for 
h >  0: 
StartLayout 1st Row 1st Column upper F Subscript upper X Baseline left parenthesis a minus x Superscript plus Baseline right parenthesis plus upper F Subscript upper X Baseline left parenthesis a plus left parenthesis limit Underscript h down arrow 0 Endscripts x plus h right parenthesis Superscript minus Baseline right parenthesis 2nd Column equals 3rd Column upper F Subscript upper X Baseline left parenthesis a minus x Superscript plus Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column Blank 3rd Column plus upper F Subscript upper X Baseline left parenthesis a plus left parenthesis limit Underscript h down arrow 0 Endscripts left parenthesis limit Underscript h down arrow 0 Endscripts x plus h right parenthesis minus h right parenthesis right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column upper F Subscript upper X Baseline left parenthesis a minus x Superscript plus Baseline right parenthesis plus upper F Subscript upper X Baseline left parenthesis a plus x right parenthesis equals 1 period EndLayoutFX(a −x+) + FX(a + (lim
h↓0 x + h)−) = FX(a −x+)
+FX(a + (lim
h↓0(lim
h↓0 x + h) −h))
= FX(a −x+) + FX(a + x) = 1.
292
Solutions to Exercises
Now, subtracting the latter expression from (2.14) and rearranging we get 
StartLayout 1st Row 1st Column 1 minus 1 2nd Column equals 3rd Column left bracket upper F Subscript upper X Baseline left parenthesis a minus x right parenthesis minus upper F Subscript upper X Baseline left parenthesis a minus x Superscript plus Baseline right parenthesis right bracket minus left bracket upper F Subscript upper X Baseline left parenthesis a plus x right parenthesis minus upper F Subscript upper X Baseline left parenthesis a plus x Superscript minus Baseline right parenthesis right bracket 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper X equals a minus x right parenthesis minus sans serif upper P left parenthesis upper X equals a plus x right parenthesis comma EndLayout1 −1 =
⎾
FX(a −x) −FX(a −x+)
⏋
−
⎾
FX(a + x) −FX(a + x−)
⏋
= P(X = a −x) −P(X = a + x),
and the above masses must be equal.1 If X is absolutely continuous we simply 
differentiate the CDF and get 
StartFraction normal d Over normal d x EndFraction upper F Subscript upper X Baseline left parenthesis a minus x right parenthesis plus StartFraction normal d Over normal d x EndFraction upper F Subscript upper X Baseline left parenthesis a plus x Superscript minus Baseline right parenthesis equals minus f Subscript upper X Baseline left parenthesis a minus x right parenthesis plus f Subscript upper X Baseline left parenthesis a plus x right parenthesis equals 0 d
dx FX(a −x) + d
dx FX(a + x−) = −fX(a −x) + fX(a + x) = 0
i.e. the above densities are equal.2 
2.12 First, by Theorem 2.3, Y = −X is a rv. By deﬁnition, P(X = −x) = P(X = 
x) and the event {X = −x} is the same as the collection of those scenarios ω ∈Ω s.t. 
{−X = x}. Now, the events {X = x} and {−X = x} have the same probability for 
all x ∈ R, which implies that the rvs X and −X share the same discrete distribution 
fully characterized by the corresponding masses. More generally, by (2.14) in  
Deﬁnition 2.7 we have for all x ∈ R that P(X ⩽−x) = P(X ⩾x) is equivalent to 
P(−X ⩾x) = P(X ⩾x) which in turn equals 
ModifyingBelow 1 minus sans serif upper P left parenthesis negative upper X greater than or slanted equals x right parenthesis With bottom brace Underscript equals sans serif upper P left parenthesis negative upper X less than x right parenthesis Endscripts equals ModifyingBelow 1 minus sans serif upper P left parenthesis upper X greater than or slanted equals x right parenthesis With bottom brace Underscript equals sans serif upper P left parenthesis upper X less than x right parenthesis Endscripts1 −P(−X ⩾x)
◟
◝ ◜
◞
=P(−X<x)
= 1 −P(X ⩾x)
◟
◝ ◜
◞
=P(X<x)
If X is continuous the last two probabilities do not change by adding the endpoints, 
i.e. P(−X ⩽x) = P(X ⩽x) which means F−X(x) = FX(x) so the CDFs are the 
same and −X is distributed as X. In case of absolute continuity, we can differentiate 
both CDFs and get f−X(x) = fX(x). 
2.13 We have to check properties (a) to (d) of Theorem 2.1 in Sect. 2.1. Indeed, 
F(x) is the CDF of some rv Z deﬁned on the same probability space. 
(a) Pick any x1 < x2, then 
StartLayout 1st Row 1st Column upper F left parenthesis x 1 right parenthesis 2nd Column colon equals 3rd Column alpha upper F Subscript upper X Baseline left parenthesis x 1 right parenthesis plus left parenthesis 1 minus alpha right parenthesis upper F Subscript upper Y Baseline left parenthesis x 1 right parenthesis 2nd Row 1st Column less than or slanted equals 2nd Column since 3rd Column less than or slanted equals less than or slanted equals 3rd Row 1st Column upper F left parenthesis x 2 right parenthesis 2nd Column colon equals 3rd Column alpha upper F Subscript upper X Baseline left parenthesis x 2 right parenthesis plus left parenthesis 1 minus alpha right parenthesis upper F Subscript upper Y Baseline left parenthesis x 2 right parenthesis period EndLayoutF(x1) := αFX(x1) + (1 −α)FY (x1)
⩽since
⩽
⩽
F(x2) := αFX(x2) + (1 −α)FY (x2).
1 Note that (a − x)− = limh↓0(a − x) − h = limh↓0 a − (x + h) = a − x+. 
2 Observe that d 
dx FX(a + x−) is the same as  d 
dx FX(a + x), because the CDF is continuous so 
FX(a + x−) = FX(a + x). 
Solutions to Exercises
293
(b) For any h >  0: 
StartLayout 1st Row 1st Column limit Underscript h down arrow 0 Endscripts upper F left parenthesis x plus h right parenthesis 2nd Column colon equals 3rd Column limit Underscript h down arrow 0 Endscripts left brace alpha upper F Subscript upper X Baseline left parenthesis x plus h right parenthesis plus left parenthesis 1 minus alpha right parenthesis upper F Subscript upper Y Baseline left parenthesis x plus h right parenthesis right brace 2nd Row 1st Column Blank 2nd Column equals 3rd Column alpha limit Underscript h down arrow 0 Endscripts upper F Subscript upper X Baseline left parenthesis x plus h right parenthesis plus left parenthesis 1 minus alpha right parenthesis limit Underscript h down arrow 0 Endscripts upper F Subscript upper Y Baseline left parenthesis x plus h right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column alpha upper F Subscript upper X Baseline left parenthesis x right parenthesis plus left parenthesis 1 minus alpha right parenthesis upper F Subscript upper Y Baseline left parenthesis x right parenthesis left bracket the two CDFs are yet right hyphen cont period right bracket 4th Row 1st Column Blank 2nd Column equals 3rd Column upper F left parenthesis x right parenthesis period EndLayoutlim
h↓0 F(x + h) := lim
h↓0
{
αFX(x + h) + (1 −α)FY (x + h)
}
= α lim
h↓0 FX(x + h) + (1 −α) lim
h↓0 FY (x + h)
= αFX(x) + (1 −α)FY (x) [the two CDFs are yet right-cont.]
= F(x).
(c) We have: 
StartLayout 1st Row 1st Column limit Underscript x right arrow negative normal infinity Endscripts upper F left parenthesis x right parenthesis 2nd Column colon equals 3rd Column limit Underscript x right arrow negative normal infinity Endscripts left brace alpha upper F Subscript upper X Baseline left parenthesis x right parenthesis plus left parenthesis 1 minus alpha right parenthesis upper F Subscript upper Y Baseline left parenthesis x right parenthesis right brace 2nd Row 1st Column Blank 2nd Column equals 3rd Column alpha limit Underscript x right arrow negative normal infinity Endscripts upper F Subscript upper X Baseline left parenthesis x right parenthesis Underscript bottom brace Underscript equals 0 Endscripts plus left parenthesis 1 minus alpha right parenthesis limit Underscript x right arrow negative normal infinity Endscripts upper F Subscript upper Y Baseline left parenthesis x right parenthesis Underscript bottom brace Underscript equals 0 Endscripts equals 0 period EndLayout lim
x→−∞F(x) :=
lim
x→−∞
{
αFX(x) + (1 −α)FY (x)
}
= α
lim
x→−∞FX(x)
◟
◝ ◜
◞
=0
+ (1 −α)
lim
x→−∞FY (x)
◟
◝ ◜
◞
=0
= 0.
Similarly: 
StartLayout 1st Row 1st Column limit Underscript x right arrow normal infinity Endscripts upper F left parenthesis x right parenthesis 2nd Column colon equals 3rd Column limit Underscript x right arrow normal infinity Endscripts left brace alpha upper F Subscript upper X Baseline left parenthesis x right parenthesis plus left parenthesis 1 minus alpha right parenthesis upper F Subscript upper Y Baseline left parenthesis x right parenthesis right brace 2nd Row 1st Column Blank 2nd Column equals 3rd Column alpha limit Underscript x right arrow normal infinity Endscripts upper F Subscript upper X Baseline left parenthesis x right parenthesis Underscript bottom brace Underscript equals 1 Endscripts plus left parenthesis 1 minus alpha right parenthesis limit Underscript x right arrow normal infinity Endscripts upper F Subscript upper Y Baseline left parenthesis x right parenthesis Underscript bottom brace Underscript equals 1 Endscripts equals 1 period EndLayout lim
x→∞F(x) := lim
x→∞
{
αFX(x) + (1 −α)FY (x)
}
= α lim
x→∞FX(x)
◟
◝ ◜
◞
=1
+ (1 −α) lim
x→∞FY (x)
◟
◝ ◜
◞
=1
= 1.
(d) To compute P(a < Z ⩽b) for some rv Z we observe that: 
StartLayout 1st Row 1st Column left brace alpha upper F Subscript upper X Baseline left parenthesis b right parenthesis plus left parenthesis 1 minus alpha right parenthesis upper F Subscript upper Y Baseline left parenthesis b right parenthesis right brace 2nd Column minus 3rd Column left brace alpha upper F Subscript upper X Baseline left parenthesis a right parenthesis plus left parenthesis 1 minus alpha right parenthesis upper F Subscript upper Y Baseline left parenthesis a right parenthesis right brace 2nd Row 1st Column Blank 2nd Column equals 3rd Column alpha left brace upper F Subscript upper X Baseline left parenthesis b right parenthesis minus upper F Subscript upper X Baseline left parenthesis a right parenthesis right brace plus left parenthesis 1 minus alpha right parenthesis left brace upper F Subscript upper Y Baseline left parenthesis b right parenthesis minus upper F Subscript upper Y Baseline left parenthesis a right parenthesis right brace 3rd Row 1st Column Blank 2nd Column equals 3rd Column alpha sans serif upper P left parenthesis a less than upper X less than or slanted equals b right parenthesis plus left parenthesis 1 minus alpha right parenthesis sans serif upper P left parenthesis a less than upper Y less than or slanted equals b right parenthesis period EndLayout
{
αFX(b) + (1 −α)FY (b)
}
−
{
αFX(a) + (1 −α)FY (a)
}
= α
{
FX(b) −FX(a)
}
+ (1 −α)
{
FY (b) −FY (a)
}
= α P(a < X ⩽b) + (1 −α) P(a < Y ⩽b).
The last expression is the convex combination of two probabilities of the rvs 
X, Y lying into the interval (a, b], which can be taken as the probability of a 
third rv Z lying in the same interval. 
Exercises of Chap. 3 
3.1 We have 
left parenthesis negative normal infinity comma bold b right bracket minus left parenthesis negative normal infinity comma bold a 1 right bracket union left parenthesis negative normal infinity comma bold a 2 right bracket equals left parenthesis negative normal infinity comma bold b right bracket intersection left bracket left parenthesis negative normal infinity comma bold a 1 right bracket union left parenthesis negative normal infinity comma bold a 2 right bracket right bracket Superscript c Baseline comma(−∞, b] \ (−∞, a1] ∪(−∞, a2] = (−∞, b] ∩
⎾
(−∞, a1] ∪(−∞, a2]
⏋c
,
294
Solutions to Exercises
where the complement equals (−∞, a1]c ∩ (−∞, a2]c. The last intersection equals 
StartSet left parenthesis x comma y right parenthesis element of double struck upper R squared vertical bar x greater than a 1 or y greater than b 2 EndSet intersection StartSet left parenthesis x comma y right parenthesis element of double struck upper R squared vertical bar x greater than b 1 or y greater than a 2 EndSet comma
{
(x, y) ∈R2 | x > a1 or y > b2
}
∩
{
(x, y) ∈R2 | x > b1 or y > a2
}
,
but all its points must also belong to (−∞, b], i.e. x ⩽b1 and y ⩽b2. Putting all 
these conditions together we ﬁnally obtain the set (a, b]. 
3.2 We compute: 
StartLayout 1st Row 1st Column ModifyingBelow sans serif upper P left parenthesis a 1 less than upper X 1 less than or slanted equals b 1 comma a 2 less than upper X 2 less than or slanted equals b 2 right parenthesis With bottom brace Underscript equals sans serif upper P left parenthesis bold a less than bold upper X less than or slanted equals bold b right parenthesis Endscripts 2nd Column equals 3rd Column ModifyingBelow sans serif upper P left parenthesis upper X 1 less than or slanted equals b 1 comma upper X 2 less than or slanted equals b 2 right parenthesis With bottom brace Underscript equals sans serif upper P left parenthesis bold upper X less than or slanted equals bold b right parenthesis Endscripts 2nd Row 1st Column Blank 2nd Column minus 3rd Column left bracket ModifyingBelow sans serif upper P left parenthesis upper X 1 less than or slanted equals a 1 comma upper X 2 less than or slanted equals b 2 right parenthesis With bottom brace Underscript equals sans serif upper P left parenthesis bold upper X less than or slanted equals bold a 1 right parenthesis Endscripts 3rd Row 1st Column Blank 2nd Column Blank 3rd Column plus ModifyingBelow sans serif upper P left parenthesis upper X 1 less than or slanted equals b 1 comma upper X 2 less than or slanted equals a 2 right parenthesis With bottom brace Underscript equals sans serif upper P left parenthesis bold upper X less than or slanted equals bold a 2 right parenthesis Endscripts 4th Row 1st Column Blank 2nd Column minus 3rd Column ModifyingBelow sans serif upper P left parenthesis upper X 1 less than or slanted equals a 1 comma upper X 2 less than or slanted equals a 2 right parenthesis right bracket With bottom brace Underscript equals sans serif upper P left parenthesis bold upper X less than or slanted equals bold a right parenthesis Endscripts EndLayoutP(a1 < X1 ⩽b1, a2 < X2 ⩽b2)
◟
◝ ◜
◞
=P(a<X⩽b)
= P(X1 ⩽b1, X2 ⩽b2)
◟
◝ ◜
◞
=P(X⩽b)
−
⎾
P(X1 ⩽a1, X2 ⩽b2)
◟
◝ ◜
◞
=P(X⩽a1)
+ P(X1 ⩽b1, X2 ⩽a2)
◟
◝ ◜
◞
=P(X⩽a2)
−P(X1 ⩽a1, X2 ⩽a2)
⏋
◟
◝ ◜
◞
=P(X⩽a)
The result now follows from the deﬁnition of joint CDF. It is worth noting that 
left parenthesis negative normal infinity comma a 1 right bracket times left parenthesis negative normal infinity comma a 2 right bracket equals colon left parenthesis negative normal infinity comma bold a right bracket equals left parenthesis negative normal infinity comma bold a 1 right bracket intersection left parenthesis negative normal infinity comma bold a 2 right bracket not equals empty set(−∞, a1] × (−∞, a2] =: (−∞, a] = (−∞, a1] ∩(−∞, a2] /= ∅
and 
left parenthesis negative normal infinity comma bold a 1 right bracket intersection left parenthesis negative normal infinity comma bold a 2 right bracket subset of left parenthesis negative normal infinity comma bold b right bracket period(−∞, a1] ∩(−∞, a2] ⊂(−∞, b].
This together with formula (3.22) yields: 
left brace bold a less than bold upper X less than or slanted equals bold b right brace equals left brace bold upper X less than or slanted equals bold b right brace minus left brace bold upper X less than or slanted equals bold a 1 right brace intersection left brace bold upper X less than or slanted equals bold a 2 right brace comma{a < X ⩽b} = {X ⩽b} \ {X ⩽a1} ∩{X ⩽a2},
where the event {X ⩽b} is bigger than the joint event {X ⩽a1} ∩{X ⩽a2} /= ∅. 
To compute the probability of the event in the right-hand side of the above equation 
we used properties Pr2,Pr3 and Pr4 of Proposition 1.1. 
3.3 Figure 1 illustrates three regions in the plane containing points (x, y) = 
(X1(ω), X2(ω)) whose outcomes ω induce the events A1, A2 and A3. Indeed, all 
scenarios in A1 yield points (x1, x2) s.t. x1 + x2 = 1, i.e. the equation of a straight 
line passing through the points (0, 1) and (1, 0). Next, the condition for A2 is that 
of a circle with radius r = 1 centered at the origin (0, 0), i.e. all the scenarios in 
A2 entail points (x1, x2) s.t.
/
x2 
1 + x2 
2 ⩽1 and
/
x2 
1 + x2 
2 is the Euclidean distance 
from the origin. Finally, those scenarios in A3 ensure max{X1, X2} is less than or 
equal 1: if for some scenarios max{X1, X2} =  X1 then X2 < X1 ⩽1, while for
Solutions to Exercises
295
Fig. 1 Events in Ω are 
mapped into three regions in 
the Cartesian plane 
some of the remaining scenarios max{X1, X2} =  X2 and X1 < X2 ⩽1. There can 
be residual scenarios s.t. X1 = X2 ⩽1. Hence, all these scenarios verify the three 
conditions and we have {max{X1, X2} ⩽1} = {X1 ⩽1} ∩{X2 ⩽1}. 
3.4 In general for a1 ⩽a2 and b1 ⩽b2 
StartLayout 1st Row upper F Subscript bold upper X Baseline left parenthesis a 1 comma b 1 right parenthesis less than or slanted equals upper F Subscript bold upper X Baseline left parenthesis a 2 comma b 1 right parenthesis less than or slanted equals upper F Subscript bold upper X Baseline left parenthesis a 2 comma b 2 right parenthesis 2nd Row upper F Subscript bold upper X Baseline left parenthesis a 1 comma b 1 right parenthesis less than or slanted equals upper F Subscript bold upper X Baseline left parenthesis a 1 comma b 2 right parenthesis less than or slanted equals upper F Subscript bold upper X Baseline left parenthesis a 2 comma b 2 right parenthesis period EndLayoutFX(a1, b1) ⩽FX(a2, b1) ⩽FX(a2, b2)
FX(a1, b1) ⩽FX(a1, b2) ⩽FX(a2, b2).
Now, to verify the ﬁrst equality above we note that 
StartSet upper X less than or slanted equals b 1 comma upper Y less than or slanted equals y EndSet equals StartSet upper X less than or slanted equals a 1 comma upper Y less than or slanted equals y EndSet union StartSet a 1 less than upper X less than or slanted equals b 1 comma upper Y less than or slanted equals y EndSet comma{X ⩽b1, Y ⩽y} = {X ⩽a1, Y ⩽y} ∪{a1 < X ⩽b1, Y ⩽y},
and the union is disjoint. Thus applying the probability function and rearranging we 
have 
sans serif upper P left parenthesis a 1 less than upper X less than or slanted equals b 1 comma upper Y less than or slanted equals y right parenthesis equals sans serif upper P left parenthesis upper X less than or slanted equals b 1 comma upper Y less than or slanted equals y right parenthesis minus sans serif upper P left parenthesis upper X less than or slanted equals a 1 comma upper Y less than or slanted equals y right parenthesisP(a1 < X ⩽b1, Y ⩽y) = P(X ⩽b1, Y ⩽y) −P(X ⩽a1, Y ⩽y)
(1) 
and we are done. The second equality is veriﬁed similarly. 
3.5 Firstly, we have that 
StartSet a 1 less than upper X less than or slanted equals b 1 comma upper Y less than or slanted equals b 2 EndSet equals StartSet a 1 less than upper X less than or slanted equals b 1 comma upper Y less than or slanted equals a 2 EndSet union StartSet a 1 less than upper X less than or slanted equals b 1 comma a 2 less than upper Y less than or slanted equals b 2 EndSet comma{a1 < X ⩽b1, Y ⩽b2} = {a1 < X ⩽b1, Y ⩽a2}∪{a1 < X ⩽b1, a2 < Y ⩽b2},
and the union is disjoint. Thus applying the probability function we have 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis a 1 less than upper X less than or slanted equals b 1 comma upper Y less than or slanted equals b 2 right parenthesis 2nd Column equals sans serif upper P left parenthesis a 1 less than upper X less than or slanted equals b 1 comma upper Y less than or slanted equals a 2 right parenthesis 2nd Row 1st Column Blank 2nd Column plus sans serif upper P left parenthesis a 1 less than upper X less than or slanted equals b 1 comma a 2 less than upper Y less than or slanted equals b 2 right parenthesis period EndLayoutP(a1 < X ⩽b1, Y ⩽b2) = P(a1 < X ⩽b1, Y ⩽a2)
+ P(a1 < X ⩽b1, a2 < Y ⩽b2).
296
Solutions to Exercises
Now applying (1) to the term on the left-hand side and to the ﬁrst term on the right-
hand side of the latter equation, eventually rearranging, we get: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis a 1 less than upper X less than or slanted equals b 1 comma a 2 less than upper Y less than or slanted equals b 2 right parenthesis 2nd Column equals sans serif upper P left parenthesis a 1 less than upper X less than or slanted equals b 1 comma upper Y less than or slanted equals b 2 right parenthesis 2nd Row 1st Column Blank 2nd Column minus sans serif upper P left parenthesis a 1 less than upper X less than or slanted equals b 1 comma upper Y less than or slanted equals a 2 right parenthesis 3rd Row 1st Column Blank 2nd Column equals upper F Subscript bold upper X Baseline left parenthesis b 1 comma b 2 right parenthesis minus upper F Subscript bold upper X Baseline left parenthesis a 1 comma b 2 right parenthesis 4th Row 1st Column Blank 2nd Column minus left bracket upper F Subscript bold upper X Baseline left parenthesis b 1 comma a 2 right parenthesis minus upper F Subscript bold upper X Baseline left parenthesis a 1 comma a 2 right parenthesis right bracket period EndLayoutP(a1 < X ⩽b1, a2 < Y ⩽b2) = P(a1 < X ⩽b1, Y ⩽b2)
−P(a1 < X ⩽b1, Y ⩽a2)
= FX(b1, b2) −FX(a1, b2)
−[FX(b1, a2) −FX(a1, a2)] .
(2) 
This yields the desired result since P(a1 < X ⩽b1, a2 < Y ⩽b2) ⩾0. 
3.6 First we have ∂FX 
∂x (x, y) = limΔx→0 
FX(x+Δx,y)−FX(x,y)
Δx
. Second we also have: 
StartLayout 1st Row 1st Column StartFraction partial differential Over partial differential y EndFraction left bracket StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential x EndFraction right bracket left parenthesis x comma y right parenthesis 2nd Column equals 3rd Column limit Underscript upper Delta y right arrow 0 Endscripts left bracket limit Underscript upper Delta x right arrow 0 Endscripts StartFraction upper F Subscript bold upper X Baseline left parenthesis x plus upper Delta x comma y plus upper Delta y right parenthesis minus upper F Subscript bold upper X Baseline left parenthesis x comma y plus upper Delta y right parenthesis Over upper Delta x EndFraction StartFraction 1 Over upper Delta y EndFraction 2nd Row 1st Column Blank 2nd Column minus 3rd Column limit Underscript upper Delta x right arrow 0 Endscripts StartFraction upper F Subscript bold upper X Baseline left parenthesis x plus upper Delta x comma y right parenthesis minus upper F Subscript bold upper X Baseline left parenthesis x comma y right parenthesis Over upper Delta x EndFraction StartFraction 1 Over upper Delta y EndFraction right bracket period EndLayout ∂
∂y
⎾
∂FX
∂x
⏋
(x, y) = lim
Δy→0
⎾
lim
Δx→0
FX(x+Δx,y+Δy)−FX(x,y+Δy)
Δx
1
Δy
(3)
−lim
Δx→0
FX(x+Δx,y)−FX(x,y)
Δx
1
Δy
⏋
.
By deﬁnition fX(x, y) = ∂2FX 
∂x∂y (x, y), so by the continuity assumption on the second 
order partial3 and by (3) we can write: 
limit Underscript upper Delta y right arrow 0 Overscript upper Delta x right arrow 0 Endscripts Endscripts StartFraction upper F Subscript bold upper X Baseline left parenthesis x plus upper Delta x comma y plus upper Delta y right parenthesis minus upper F Subscript bold upper X Baseline left parenthesis x comma y plus upper Delta y right parenthesis minus upper F Subscript bold upper X Baseline left parenthesis x plus upper Delta x comma y right parenthesis plus upper F Subscript bold upper X Baseline left parenthesis x comma y right parenthesis Over upper Delta x upper Delta y EndFraction period lim
Δx→0
Δy→0
FX(x + Δx, y + Δy) −FX(x, y + Δy) −FX(x + Δx, y) + FX(x, y)
ΔxΔy
.
Since by (2) the numerator in the above expression is ⩾0 we have proved item (a).  
To prove item (b) we interpret the second order differential of the CDF as 
normal d squared upper F Subscript bold upper X Baseline left parenthesis x comma y right parenthesis equals partial differential squared upper F Subscript bold upper X Baseline equals partial differential x partial differential y f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis equals colon f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis normal d x normal d y periodd2FX(x, y) = ∂2FX = ∂x∂yfX(x, y) =: fX(x, y)dxdy.
This acts as dFX(x) in the one-dimensional case. Thus, we integrate it and by 
Fubini’s Theorem get: 
StartLayout 1st Row 1st Column integral Subscript a 1 Superscript b 1 Baseline integral Subscript a 2 Superscript b 2 Baseline f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis normal d x normal d y 2nd Column equals 3rd Column integral Subscript a 1 Superscript b 1 Baseline integral Subscript a 2 Superscript b 2 Baseline normal d squared upper F Subscript bold upper X Baseline left parenthesis x comma y right parenthesis equals integral Underscript left parenthesis a 1 comma b 1 right bracket times left parenthesis a 2 comma b 2 right bracket Endscripts normal d squared upper F Subscript bold upper X Baseline left parenthesis x comma y right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis a 1 less than upper X less than or slanted equals b 1 comma a 2 less than upper Y less than or slanted equals b 2 right parenthesis period EndLayout
⎰b1
a1
⎰b2
a2
fX(x, y)dxdy =
⎰b1
a1
⎰b2
a2
d2FX(x, y) =
⎰
(a1,b1]×(a2,b2]
d2FX(x, y)
= P(a1 < X ⩽b1, a2 < Y ⩽b2).
3 Namely, the limit exists and is ﬁnite. 
Solutions to Exercises
297
To show item (c) we apply item (b) as follows:4 
StartLayout 1st Row 1st Column upper F Subscript bold upper X Baseline left parenthesis x comma y right parenthesis 2nd Column equals 3rd Column limit Underscript n right arrow normal infinity Endscripts sans serif upper P left parenthesis negative n less than upper X less than or slanted equals x comma negative n less than upper Y less than or slanted equals y right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column limit Underscript n right arrow normal infinity Endscripts integral Subscript negative n Superscript x Baseline integral Subscript negative n Superscript y Baseline f Subscript bold upper X Baseline left parenthesis u comma v right parenthesis normal d u normal d v equals integral Subscript negative normal infinity Superscript x Baseline integral Subscript negative normal infinity Superscript y Baseline f Subscript bold upper X Baseline left parenthesis u comma v right parenthesis normal d u normal d v period EndLayoutFX(x, y) = lim
n→∞P(−n < X ⩽x, −n < Y ⩽y)
= lim
n→∞
⎰x
−n
⎰y
−n
fX(u, v)dudv =
⎰x
−∞
⎰y
−∞
fX(u, v)dudv.
Now item (d) easily follows from item (c) by sending x, y to ∞. 
3.7 We show that P( · |  B) satisﬁes all the axioms of a probability measure. 
P(Ω | B) = P(Ω∩B) 
P(B) = P(B) 
P(B) = 1. If events (Ai)i∈N are pairwise disjoint then: 
sans serif upper P left parenthesis union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i Baseline vertical bar upper B right parenthesis equals StartFraction sans serif upper P left parenthesis left parenthesis union Subscript i equals 1 Superscript normal infinity Baseline upper A Subscript i Baseline right parenthesis intersection upper B right parenthesis Over sans serif upper P left parenthesis upper B right parenthesis EndFraction equals StartFraction sans serif upper P left parenthesis union Subscript i equals 1 Superscript normal infinity Baseline left parenthesis upper A Subscript i Baseline intersection upper B right parenthesis right parenthesis Over sans serif upper P left parenthesis upper B right parenthesis EndFraction periodP(∪∞
i=1Ai | B) = P
((
∪∞
i=1Ai
)
∩B
)
P(B)
= P
(
∪∞
i=1(Ai ∩B)
)
P(B)
.
The events (Ai ∩ B)i∈N are pairwise disjoint and the expression on the right-
hand side rewrites: ∑∞ 
i=1 
P(An∩B) 
P(B) 
= ∑∞ 
i=1 P(Ai | B). Thus, P( · |  B) is countably 
additive and we are done. The ‘fraction’ of event B including A is measured by 
P(A ∩ B), as the  area of A ∩ B ⊂ B. Assuming B is occurred yield this event 
behaves as a new sample space Ω' = B whose area is P(B) which is not necessarily 
= 1. The original events A ⊂Ω are then replaced by subsets A ∩ B of Ω' and the 
new σ-algebra for them can be safely be assumed to be {A ∩ B | A ∈ F }. The  
probability P(A) is replaced by P(A∩B) 
P(B) , i.e. the area P(A ∩B) is normalized by the 
reference area P(B). 
. . . Take  a  Look  at  This  Example. . .  
Let Ω = {ω = (i, j) | i, j ∈{1, . . . ,  6}} be the sample space for rolling a 
fair dice twice. Assume a uniform probability space such that P({ω}) = 1 
36 
for every {ω} ∈ F = 2Ω, i.e. event are equally likely. Next, assume B = 
{the ﬁrst roll shows 3} is occurred. Thus, Ω reduces to Ω' = {ω = (3, j)  | 
j = 1, . . . , 6} =  B. Only 6 outcomes are possible with new probability 
P({ω} |  B) = P({ω}∩B) 
P(B) 
= P({ω}) 
P(B) = 6 
36 = 1 
6, where of course {ω} ∩ B = {ω}, 
for every ω ∈Ω'. We may think of a new uniform probability space with 
sample space 
upper Omega prime equals StartSet left parenthesis 3 comma 1 right parenthesis comma left parenthesis 3 comma 2 right parenthesis comma left parenthesis 3 comma 3 right parenthesis comma left parenthesis 3 comma 4 right parenthesis comma left parenthesis 3 comma 5 right parenthesis comma left parenthesis 3 comma 6 right parenthesis EndSet equals upper BΩ' = {(3, 1), (3, 2), (3, 3), (3, 4), (3, 5), (3, 6)} = B
and σ-algebra given by events A ∩ B and A ∈ F. It is easily seen that it 
coincides with 2Ω'.
4 We also apply continuity of P( · ). 
298
Solutions to Exercises
3.8 With all the information available, we can assume a uniform probability space 
with 9 scenarios. Note that P({ω}) >  0 whether ω /∈{du, us}. To compute the 
required probability observe that 
upper A equals left single quotation mark price number sign 1 is fallen right single quotation mark comma upper B equals left single quotation mark price number sign 2 is the same or is raised right single quotation mark periodA = ‘price #1 is fallen’,
B = ‘price #2 is the same or is raised’.
(Do not forget to decompose A, B and A ∩ B into their singletons and then add 
probabilities). We have P(B) = 0.32 > 0 then P(A | B) := P(A∩B) 
P(B) = 0.1 
0.32 ≈ 0.31, 
which gives the required probability of A conditional on B. The re-weighting of 
event A has now produced a greater evaluation of its likelihood. 
3.9 Let the bi-variate random vector Z = (U, V ) has a joint density function 
fZ(u, v) and suppose it equals h(u)k(v), the product of two real-valued functions. 
Thus, let 
integral h left parenthesis u right parenthesis normal d u equals a comma and integral k left parenthesis v right parenthesis normal d v equals b period
⎰
h(u)du = a,
and
⎰
k(v)dv = b.
Then we have 
StartLayout 1st Row 1st Column a b 2nd Column equals 3rd Column left parenthesis integral h left parenthesis u right parenthesis normal d u right parenthesis left parenthesis integral k left parenthesis v right parenthesis normal d v right parenthesis 2nd Row 1st Column Blank 2nd Column StartLayout 1st Row Fubini right single quotation mark s Th period 2nd Row equals EndLayout 3rd Column double integral h left parenthesis u right parenthesis k left parenthesis v right parenthesis normal d u normal d v 3rd Row 1st Column Blank 2nd Column equals 3rd Column double integral f Subscript bold upper Z Baseline left parenthesis u comma v right parenthesis normal d u normal d v equals 1 comma EndLayouta b
=
⎛⎰
h(u)du
⎞⎛⎰
k(v)dv
⎞
Fubini’s Th.
=
⎰⎰
h(u)k(v)dudv
=
⎰⎰
fZ(u, v)dudv = 1,
i.e., a b  = 1. Now, computing the marginals 
f Subscript upper U Baseline left parenthesis u right parenthesis equals integral h left parenthesis u right parenthesis k left parenthesis v right parenthesis normal d v equals h left parenthesis u right parenthesis b comma f Subscript upper V Baseline left parenthesis v right parenthesis equals integral h left parenthesis u right parenthesis k left parenthesis v right parenthesis normal d u equals k left parenthesis v right parenthesis a commafU(u) =
⎰
h(u)k(v)dv = h(u)b,
fV (v) =
⎰
h(u)k(v)du = k(v)a,
and putting things together we have 
f Subscript bold upper Z Baseline left parenthesis u comma v right parenthesis equals h left parenthesis u right parenthesis k left parenthesis v right parenthesis a b equals f Subscript upper U Baseline left parenthesis u right parenthesis f Subscript upper V Baseline left parenthesis v right parenthesis commafZ(u, v) = h(u)k(v)a b = fU(u)fV (v),
i.e., we ﬁnd a necessary condition for independence between U and Y: their joint 
density factors by two functions h(u), k(v) of u alone and of v alone. New, let 
A(u) = {x | h(x) ⩽u} and B(v) = {y | k(y) ⩽v}, then passing to the joint CDF 
we have: 
StartLayout 1st Row 1st Column upper F Subscript bold upper Z Baseline left parenthesis u comma v right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis upper U less than or slanted equals u comma upper V less than or slanted equals v right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper X element of upper A left parenthesis u right parenthesis comma upper Y element of upper B left parenthesis v right parenthesis right parenthesis 3rd Row 1st Column Blank 2nd Column StartLayout 1st Row Indep period of upper X and upper Y 2nd Row equals EndLayout 3rd Column sans serif upper P left parenthesis upper X comma element of upper A left parenthesis u right parenthesis right parenthesis sans serif upper P left parenthesis upper Y element of upper B left parenthesis v right parenthesis right parenthesis period EndLayoutFZ(u, v)
=
P(U ⩽u, V ⩽v)
=
P(X ∈A(u), Y ∈B(v))
Indep. of X and Y
=
P(X, ∈A(u))P(Y ∈B(v)).
Solutions to Exercises
299
Since we can differentiate to get the joint density, 
StartLayout 1st Row 1st Column f Subscript bold upper Z Baseline left parenthesis u comma v right parenthesis 2nd Column equals 3rd Column StartFraction partial differential squared Over partial differential u partial differential v EndFraction upper F Subscript bold upper Z Baseline left parenthesis u comma v right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction normal d Over normal d u EndFraction sans serif upper P left parenthesis upper X element of upper A left parenthesis u right parenthesis right parenthesis StartFraction normal d Over normal d v EndFraction sans serif upper P left parenthesis upper Y element of upper B left parenthesis v right parenthesis right parenthesis comma EndLayoutfZ(u, v) =
∂2
∂u∂v FZ(u, v)
= d
duP(X ∈A(u)) d
dv P(Y ∈B(v)),
we end with the product of two functions, of u alone and of v alone, which 
together with the above necessary condition entails U = f (X)  and V = g(Y) 
as independent. 
Exercises of Chap. 4 
4.1 Linearity of expectation for discrete rvs is: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis a plus b upper X right parenthesis 2nd Column equals 3rd Column sigma summation Underscript i Endscripts left parenthesis a plus b x Subscript i Baseline right parenthesis sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column a sigma summation Underscript i Endscripts sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis plus b sigma summation Underscript i Endscripts x Subscript i Baseline sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis equals a plus b sans serif upper E left parenthesis upper X right parenthesis period EndLayoutE(a + b X) =
⎲
i
(a + b xi) P(X = xi)
= a
⎲
i
P(X = xi) + b
⎲
i
xiP(X = xi) = a + b E(X).
4.2 Taking g(x) = a x  + b we have: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis a plus b upper X right parenthesis 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline left parenthesis a plus b x right parenthesis f Subscript upper X Baseline left parenthesis x right parenthesis normal d x 2nd Row 1st Column Blank 2nd Column equals 3rd Column a integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x plus b integral Subscript negative normal infinity Superscript normal infinity Baseline x f Subscript upper X Baseline left parenthesis x right parenthesis normal d x equals a plus b sans serif upper E left parenthesis upper X right parenthesis period EndLayoutE(a + b X) =
⎰∞
−∞
(a + b x) fX(x) dx
= a
⎰∞
−∞
fX(x) dx + b
⎰∞
−∞
x fX(x) dx = a + b E(X).
4.3 By deﬁnition we have: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X right parenthesis minus sans serif upper E left parenthesis upper Y right parenthesis 2nd Column equals 3rd Column integral Subscript 0 Superscript normal infinity Baseline left bracket 1 minus upper F Subscript upper X Baseline left parenthesis x right parenthesis right bracket normal d x minus integral Subscript negative normal infinity Superscript 0 Baseline upper F Subscript upper X Baseline left parenthesis x right parenthesis normal d x 2nd Row 1st Column Blank 2nd Column minus 3rd Column integral Subscript 0 Superscript normal infinity Baseline left bracket 1 minus upper F Subscript upper Y Baseline left parenthesis x right parenthesis right bracket normal d x plus integral Subscript negative normal infinity Superscript 0 Baseline upper F Subscript upper Y Baseline left parenthesis x right parenthesis normal d x 3rd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript 0 Superscript normal infinity Baseline left bracket upper F Subscript upper Y Baseline left parenthesis x right parenthesis minus upper F Subscript upper X Baseline left parenthesis x right parenthesis right bracket normal d x plus integral Subscript negative normal infinity Superscript 0 Baseline left bracket upper F Subscript upper Y Baseline left parenthesis x right parenthesis minus upper F Subscript upper X Baseline left parenthesis x right parenthesis right bracket normal d x 4th Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket upper F Subscript upper Y Baseline left parenthesis x right parenthesis minus upper F Subscript upper X Baseline left parenthesis x right parenthesis right bracket normal d x less than or slanted equals 0 EndLayoutE(X) −E(Y) =
⎰∞
0
[1 −FX(x)]dx −
⎰0
−∞
FX(x)dx
−
⎰∞
0
[1 −FY (x)]dx +
⎰0
−∞
FY (x)dx
=
⎰∞
0
[FY (x) −FX(x)]dx +
⎰0
−∞
[FY (x) −FX(x)]dx
=
⎰∞
−∞
[FY (x) −FX(x)]dx ⩽0
300
Solutions to Exercises
which yields E(X) ⩽E(Y). Observe that X ≼FSD Y is also equivalent to 
1 minus sans serif upper P left parenthesis upper X greater than x right parenthesis greater than or slanted equals 1 minus sans serif upper P left parenthesis upper Y greater than x right parenthesis long left right double arrow sans serif upper P left parenthesis upper Y greater than x right parenthesis greater than or slanted equals sans serif upper P left parenthesis upper X greater than x right parenthesis period1 −P(X > x) ⩾1 −P(Y > x) ⇐⇒P(Y > x) ⩾P(X > x).
4.4 By assumption X − a d= a − X then: 
sans serif upper P left parenthesis upper X minus a less than or slanted equals 0 right parenthesis equals sans serif upper P left parenthesis a minus upper X less than or slanted equals 0 right parenthesis long left right double arrow sans serif upper P left parenthesis upper X less than or slanted equals a right parenthesis equals sans serif upper P left parenthesis upper X greater than or slanted equals a right parenthesis periodP(X −a ⩽0) = P(a −X ⩽0) ⇐⇒P(X ⩽a) = P(X ⩾a).
Thus we have: 
sans serif upper P left parenthesis upper X less than or slanted equals a right parenthesis equals 1 minus sans serif upper P left parenthesis upper X greater than a right parenthesis greater than or slanted equals 1 minus sans serif upper P left parenthesis upper X greater than or slanted equals a right parenthesis equals 1 minus sans serif upper P left parenthesis upper X less than or slanted equals a right parenthesisP(X ⩽a) = 1 −P(X > a) ⩾1 −P(X ⩾a) = 1 −P(X ⩽a)
which implies at once P(X ⩽a) ⩾1 
2 and P(X ⩾a) ⩾1 
2, i.e. a = med(X). 
Eventually, by symmetry again we have E(X − a) = −E(X − a) iff E(X − a) = 0 
i.e. E(X) = a. 
4.5 First, since fX(x) ⩾0 for all x ∈ R then 1 
b fX
( x−a 
b
)
⩾0, for every x, a ∈ R 
and b >  0. Eventually: 
StartLayout 1st Row 1st Column integral StartFraction 1 Over b EndFraction f Subscript upper X Baseline left parenthesis StartFraction x minus a Over b EndFraction right parenthesis normal d x 2nd Column equals 3rd Column integral f Subscript upper X Baseline left parenthesis y right parenthesis normal d y left bracket let y equals StartFraction x minus a Over b EndFraction then normal d y equals StartFraction 1 Over b EndFraction normal d x right bracket 2nd Row 1st Column Blank 2nd Column equals 3rd Column 1 left bracket because f Subscript upper X Baseline left parenthesis y right parenthesis is a density right bracket period EndLayout
⎰
1
bfX
⎛x −a
b
⎞
dx =
⎰
fX(y)dy
⎾
let y = x−a
b
then dy = 1
bdx
⏋
= 1
⎾
because fX(y) is a density
⏋
.
4.6 First, assume d <  m  without loss of generality. We have |X − α| =  (X − 
α)I{X⩾α} − (X −α)I{X<α}, for α = d, m. Write the difference between absolute 
values and add: 
StartLayout 1st Row 1st Column StartAbsoluteValue upper X minus d EndAbsoluteValue minus StartAbsoluteValue upper X minus m EndAbsoluteValue 2nd Column equals 3rd Column upper X bold upper I Subscript left brace upper X greater than or slanted equals d right brace minus d bold upper I Subscript left brace upper X greater than or slanted equals d right brace minus upper X bold upper I Subscript left brace upper X less than d right brace plus d bold upper I Subscript left brace upper X less than d right brace 2nd Row 1st Column Blank 2nd Column minus 3rd Column upper X bold upper I Subscript left brace upper X greater than or slanted equals m right brace Baseline plus m bold upper I Subscript left brace upper X greater than or slanted equals d right brace Baseline plus upper X bold upper I Subscript left brace upper X less than d right brace Baseline minus m bold upper I Subscript left brace upper X less than d right brace Baseline plus upper X minus upper X period EndLayout|X −d| −|X −m| = XI{X⩾d} −dI{X⩾d} −XI{X<d} + dI{X<d}
−XI{X⩾m} + mI{X⩾d} + XI{X<d} −mI{X<d} + X −X.
Arrange terms in X, 
upper X left parenthesis bold upper I Subscript left brace upper X greater than or slanted equals d right brace Baseline plus 1 minus bold upper I Subscript left brace upper X less than d right brace Baseline right parenthesis minus upper X left parenthesis bold upper I Subscript left brace upper X greater than or slanted equals m right brace Baseline plus 1 minus bold upper I Subscript left brace upper X less than m right brace Baseline right parenthesis commaX
(
I{X⩾d} + 1 −I{X<d}
)
−X
(
I{X⩾m} + 1 −I{X<m}
)
,
and rewrite them as 2XI{X⩾d} − 2XI{X⩾m}, where I{X⩾α} = 1 − I{X<α}. Arrange 
terms in d and write 
StartLayout 1st Row 1st Column d left parenthesis bold upper I Subscript left brace upper X less than d right brace Baseline minus bold upper I Subscript left brace upper X greater than or slanted equals d right brace Baseline right parenthesis 2nd Column equals 3rd Column d left parenthesis 1 minus bold upper I Subscript left brace upper X greater than or slanted equals d right brace Baseline minus bold upper I Subscript left brace upper X greater than or slanted equals d right brace Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column d left parenthesis 1 minus 2 bold upper I Subscript left brace upper X greater than or slanted equals d right brace Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column d minus 2 d bold upper I Subscript left brace upper X greater than or slanted equals d right brace 4th Row 1st Column Blank 2nd Column equals 3rd Column d left parenthesis bold upper I Subscript left brace upper X greater than or slanted equals m right brace Baseline plus bold upper I Subscript left brace upper X less than m right brace Baseline right parenthesis minus 2 d bold upper I Subscript left brace upper X greater than or slanted equals d right brace 5th Row 1st Column Blank 2nd Column equals 3rd Column 2 d bold upper I Subscript left brace upper X greater than or slanted equals m right brace Baseline minus d bold upper I Subscript left brace upper X greater than or slanted equals m right brace Baseline plus d bold upper I Subscript left brace upper X less than m right brace Baseline minus 2 d bold upper I Subscript left brace upper X greater than or slanted equals d right brace Baseline comma EndLayoutd
(
I{X<d} −I{X⩾d}
)
= d
(
1 −I{X⩾d} −I{X⩾d}
)
= d
(
1 −2I{X⩾d}
)
= d −2dI{X⩾d}
= d
(
I{X⩾m} + I{X<m}
)
−2dI{X⩾d}
= 2dI{X⩾m} −dI{X⩾m} + dI{X<m} −2dI{X⩾d},
Solutions to Exercises
301
where in the fourth equality 1 = I{X<m} +I{X⩾m}. Now, arrange all the above terms 
to get: 
left parenthesis m minus q right parenthesis left parenthesis bold upper I Subscript left brace upper X greater than or slanted equals m right brace Baseline minus bold upper I Subscript left brace upper X less than m right brace Baseline right parenthesis plus 2 left parenthesis upper X minus d right parenthesis left parenthesis bold upper I Subscript left brace upper X greater than or slanted equals d right brace Baseline minus bold upper I Subscript left brace upper X greater than or slanted equals m right brace Baseline right parenthesis period(m −q)
(
I{X⩾m} −I{X<m}
)
+ 2(X −d)
(
I{X⩾d} −I{X⩾m}
)
.
Note that I{X⩾d} = 1 − I{X<d} and events {X <  d} and {X ⩾m} are incompatible 
(recall that d <  m) so  I{X<d} + I{X⩾m} = I{X<d}∪{X⩾m} = I{d⩽X<m}. We ﬁnally 
obtain: 
StartAbsoluteValue upper X minus d EndAbsoluteValue minus StartAbsoluteValue upper X minus m EndAbsoluteValue equals left parenthesis m minus d right parenthesis left parenthesis 2 bold upper I Subscript left brace upper X greater than or slanted equals m right brace Baseline minus 1 right parenthesis plus 2 left parenthesis upper X minus d right parenthesis bold upper I Subscript left brace d less than or slanted equals upper X less than m right brace Baseline period|X −d| −|X −m| = (m −d)(2I{X⩾m} −1) + 2(X −d)I{d⩽X<m}.
Taking expectation we have: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis StartAbsoluteValue upper X minus d EndAbsoluteValue right parenthesis minus sans serif upper E left parenthesis StartAbsoluteValue upper X minus m EndAbsoluteValue right parenthesis 2nd Column equals 3rd Column left parenthesis m minus d right parenthesis left parenthesis 2 sans serif upper P left parenthesis upper X greater than or slanted equals m right parenthesis minus 1 right parenthesis 2nd Row 1st Column Blank 2nd Column plus 3rd Column 2 sans serif upper E left bracket left parenthesis upper X minus d right parenthesis bold upper I Subscript left brace d less than or slanted equals upper X less than m right brace Baseline right bracket period EndLayoutE(|X −d|) −E(|X −m|) = (m −d) (2P(X ⩾m) −1)
+ 2E
⎾
(X −d)I{d⩽X<m}
⏋
.
The second term on the right-hand side is ⩾0 as well the ﬁrst, since 2P(X ⩾m) ⩾
1 for  m is the median of FX. This proves the claim. 
4.7 If |X| ⩾1 pointwise then |X|n ⩽|X|m, otherwise for |X| < 1 we have |X|n ⩽
1. Taking expectation we get 
sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript n Baseline right parenthesis less than or slanted equals 1 plus sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue Superscript m Baseline right parenthesis less than normal infinityE(|X|n) ⩽1 + E(|X|m) < ∞
and we are done. We might write |X|n ⩽max{1, |X|m} ⩽1 + |X|m < ∞ at once. 
4.8 Let us write the expression of (g(a + bX))2: 
StartLayout 1st Row 1st Column left parenthesis StartFraction a plus b upper X minus sans serif upper E left parenthesis a plus b upper X right parenthesis Over sans serif upper S upper D left parenthesis a plus b upper X right parenthesis EndFraction right parenthesis squared 2nd Column equals 3rd Column StartFraction left parenthesis a minus a plus b left parenthesis upper X minus sans serif upper E left parenthesis upper X right parenthesis right parenthesis right parenthesis squared Over left parenthesis StartAbsoluteValue b EndAbsoluteValue sans serif upper S upper D left parenthesis upper X right parenthesis right parenthesis squared EndFraction 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction StartAbsoluteValue b EndAbsoluteValue left parenthesis left parenthesis upper X minus sans serif upper E left parenthesis upper X right parenthesis right parenthesis right parenthesis squared Over left parenthesis StartAbsoluteValue b EndAbsoluteValue sans serif upper S upper D left parenthesis upper X right parenthesis right parenthesis squared EndFraction equals StartFraction left parenthesis upper X minus sans serif upper E left parenthesis upper X right parenthesis right parenthesis squared Over left parenthesis sans serif upper S upper D left parenthesis upper X right parenthesis right parenthesis squared EndFraction 3rd Row 1st Column Blank 2nd Column equals 3rd Column left parenthesis g left parenthesis upper X right parenthesis right parenthesis squared period EndLayout
⎛a + bX −E(a + bX)
SD(a + bX)
⎞2
= (a −a + b(X −E(X)))2
(|b|SD(X))2
= |b|((X −E(X)))2
(|b|SD(X))2
= (X −E(X))2
(SD(X))2
= (g(X))2.
4.9 We have |XY| ⩽X2 
2 + Y 2 
2 and taking expectation of both sides E(|XY|) ⩽
1 
2E(X2) + 1 
2E(Y 2) and for X, Y ∈ L2 means E(X2) <  ∞and E(Y 2) <  ∞, then 
E(XY) is ﬁnite, i.e. XY ∈ L1. 
4.10 We ﬁrst compute
⎰1 
0 g(x)dF(x) by deﬁnition, observing that g(x) = 1 for  
x ∈ (0, 1]: 
StartLayout 1st Row 1st Column limit Underscript n right arrow normal infinity Endscripts sigma summation Underscript i equals 1 Overscript n Endscripts left bracket upper F left parenthesis x Subscript i Baseline right parenthesis minus upper F left parenthesis x Subscript i minus 1 Baseline right parenthesis right bracket 2nd Column equals 3rd Column limit Underscript n right arrow normal infinity Endscripts left brace left bracket upper F left parenthesis x 1 right parenthesis minus upper F left parenthesis x 0 right parenthesis right bracket plus left bracket upper F left parenthesis x 2 right parenthesis minus upper F left parenthesis x 1 right parenthesis right bracket 2nd Row 1st Column Blank 2nd Column plus midline horizontal ellipsis plus 3rd Column left bracket upper F left parenthesis x Subscript n Baseline right parenthesis minus upper F left parenthesis x Subscript n minus 1 Baseline right parenthesis right bracket right brace equals limit Underscript n right arrow normal infinity Endscripts left brace upper F left parenthesis 1 right parenthesis minus upper F left parenthesis 0 right parenthesis right brace 3rd Row 1st Column Blank 2nd Column equals 3rd Column upper F left parenthesis 1 right parenthesis minus upper F left parenthesis 0 right parenthesis equals 1 equals integral Subscript 0 Superscript 1 Baseline normal d upper F left parenthesis x right parenthesis comma EndLayout lim
n→∞
n
⎲
i=1
[F(xi) −F(xi−1)]
=
lim
n→∞
{
[F(x1) −F(x0)] + [F(x2) −F(x1)]
302
Solutions to Exercises
+ · · · + [F(xn) − F(xn−1)]
}
= lim 
n→∞
{
F(1) − F(0)
}
=
F(1) − F(0) = 1 =
⎰1 
0 
dF(x), 
where the limit is meant for ﬁner partitions 0 = x0 < x1 < · · ·  < xn = 1 of  (0, 1] 
and the larger xi − xi−1 goes to zero.5 The second integral is
⎰2 
1 g(x)dF(x) = 0 
because g(x) = 0 for  x ∈ (1, 2]. Nevertheless, the integral
⎰2 
0 does not exists: the 
Stieltjes sum 
sigma summation Underscript i equals 1 Overscript n Endscripts g left parenthesis c Subscript i Baseline right parenthesis left bracket upper F left parenthesis x Subscript i Baseline right parenthesis minus upper F left parenthesis x Subscript i minus 1 Baseline right parenthesis right bracket
n
⎲
i=1
g(ci)[F(xi) −F(xi−1)]
has different values depending on the choice ci = 1, when g(ci) = 1, or ci = 
limh↓0(1 + h) = 1+ for h >  0, when g(ci) = 0. Despite the two integrals
⎰1 
0 and
⎰2 
1 exist the whole integral
⎰2 
0 does not. 
4.11 First, observe that nP(X > n) ⩽E(XI{X>n}), since the term on the left-hand 
side of the inequality equals E(nI{X>n}). Now, write the term on the right-hand 
side as E
(
X
⎾
1 − I{X⩽n}
⏋)
, which in turns is E(X) −E(XI{X⩽n}). The sequence of 
nonnegative rvs XI{X⩽n} for n = 1, 2, . . .  is increasing and converges pointwise to 
X, indeed limn→∞ I{X⩽n} = IΩ = 1. Thus applying the MCT we have 
limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis n bold upper I Subscript left brace upper X greater than n right brace Baseline right parenthesis equals sans serif upper E left parenthesis upper X right parenthesis minus sans serif upper E left parenthesis limit Underscript n right arrow normal infinity Endscripts upper X bold upper I Subscript left brace upper X less than or slanted equals n right brace Baseline right parenthesis equals 0 period lim
n→∞E(nI{X>n}) = E(X) −E
⎛
lim
n→∞XI{X⩽n}
⎞
= 0.
Since nP(X > n) is dominated by E(XI{X>n}) for every n ∈ N, then we get the 
desired result.6 
4.12 Take A = {X = ∞}  and consider its truncated version XIA. Thus, using the 
abstract deﬁnition of the expectation and P(A) > 0 we get:  
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesis 2nd Column equals 3rd Column integral Underscript upper Omega Endscripts upper X bold upper I Subscript upper A normal d sans serif upper P 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Underscript upper A Endscripts upper X normal d sans serif upper P equals normal infinity integral Underscript upper A Endscripts normal d sans serif upper P 3rd Row 1st Column Blank 2nd Column equals 3rd Column normal infinity times sans serif upper P left parenthesis upper A right parenthesis equals normal infinity period EndLayoutE(XIA) =
⎰
Ω
XIAdP
=
⎰
A
XdP = ∞
⎰
A
dP
= ∞× P(A) = ∞.
The latter equality contradicts the hypotheses of ﬁnite expectation, since for every 
A ∈F we always have E(XIA) ⩽E(X). The remedy is P(A) = 0 and consequently
5 This can be written n →∞ and sup{xi − xi−1 | i = 1, . . . , n} → 0. 
6 Recall that given two sequences of nonnegative real numbers (xn)n∈N, (yn)n∈N s.t. yn →0 and  
0 ⩽xn ⩽yn, each n, then  xn → 0 too. 
Solutions to Exercises
303
P(X < ∞) = 1, using the multiplication rule ∞×0 = 0 valid for every probability 
measure. 
4.13 We start from discrete nonnegative rvs X, Y. It can be shown that the rv X+Y 
has representation ∑n 
i=1
∑m 
j=1(xi + yj)IAi∩Bj , where events Ai = {X = xi} and 
Bj = {Y = yj} form two different partitions of Ω, thus it is discrete too. Hence, 
StartLayout 1st Row 1st Column sigma summation Underscript i Endscripts sigma summation Underscript j Endscripts x Subscript i Baseline sans serif upper P left parenthesis upper A Subscript i Baseline intersection upper B Subscript j Baseline right parenthesis 2nd Column plus 3rd Column sigma summation Underscript i Endscripts sigma summation Underscript j Endscripts y Subscript j Baseline sans serif upper P left parenthesis upper A Subscript i Baseline intersection upper B Subscript j Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript i Endscripts x Subscript i Baseline sigma summation Underscript j Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline intersection upper B Subscript j Baseline right parenthesis plus sigma summation Underscript j Endscripts y Subscript j Baseline sigma summation Underscript i Endscripts sans serif upper P left parenthesis upper A Subscript i Baseline intersection upper B Subscript j Baseline right parenthesis period EndLayout
⎲
i
⎲
j
xiP(Ai ∩Bj) +
⎲
i
⎲
j
yjP(Ai ∩Bj)
=
⎲
i
xi
⎲
j
P(Ai ∩Bj) +
⎲
j
yj
⎲
i
P(Ai ∩Bj).
But events Ai e Bj decompose Ω and then ∑
j P(Ai ∩ Bj) = P(∪j(Ai ∩ Bj)) = 
P(Ai) and ∑
i P(Ai ∩ Bj) = P(∪i(Ai ∩ Bj)) = P(Bj). Thus, the last equality 
above is just E(X) + E(Y). Applying this reasoning7 to increasing sequences 
(Xn)n∈N, (Yn)n∈N of discrete rvs converging pointwise to two nonnegative rvs X 
and Y, so  Xn + Yn → X + Y, and applying MCT we get linearity again, which can 
be extended to general rvs using positive and negative parts. 
4.14 First, we have X = ∑n 
i=1 xiIAi and Y = ∑m 
i=1 yjIBj since both the rvs are 
discrete, where the events Ai and Bj are two different partition of Ω. Summing we 
get ∑n 
i=1 xiIAi + ∑m 
i=1 yiIBj , but the summation can be arranged to give values 
xi + yj for those scenarios ω ∈ Ai ∩ Bj. In fact we also have Ai ∩ Bj = {X + Y = 
xi + yj}. Eventually, 
upper X plus upper Y equals sigma summation Underscript i equals 1 Overscript n Endscripts sigma summation Underscript j equals 1 Overscript m Endscripts left parenthesis x Subscript i Baseline plus y Subscript j Baseline right parenthesis bold upper I Subscript upper A Sub Subscript i Subscript intersection upper B Sub Subscript j Subscript Baseline commaX + Y =
n
⎲
i=1
m
⎲
j=1
(xi + yj) IAi∩Bj ,
where some Ai ∩ Bj can be the impossible event, and all still form a partition of 
the sample space. It is worth noting that kX is a discrete rv for k ∈ R and X being 
discrete. Also, the product of two discrete rvs XY is discrete too because it can be 
represented as ∑n 
i=1
∑m 
j=1(xiyj) IAi∩Bj . 
4.15 We use the standard machine, starting from discrete rvs X, Y and then 
extending to general rvs via MCT. If X, Y are both discrete and X(ω) ⩽Y(ω) 
for each ω ∈Ω, then xi ⩽yj in their respective representations over Ai ∩ Bj. As  
byproduct: 
sigma summation Underscript i Endscripts sigma summation Underscript j Endscripts x Subscript i Baseline sans serif upper P left parenthesis upper A Subscript i Baseline intersection upper B Subscript j Baseline right parenthesis less than or slanted equals sigma summation Underscript i Endscripts sigma summation Underscript j Endscripts y Subscript j Baseline sans serif upper P left parenthesis upper A Subscript i Baseline intersection upper B Subscript j Baseline right parenthesis long left right double arrow sans serif upper E left parenthesis upper X right parenthesis less than or slanted equals sans serif upper E left parenthesis upper Y right parenthesis period
⎲
i
⎲
j
xiP(Ai ∩Bj) ⩽
⎲
i
⎲
j
yjP(Ai ∩Bj) ⇐⇒E(X) ⩽E(Y).
7 It is sometime called the ‘standard machine’ [16]. 
304
Solutions to Exercises
4.16 Solution 1. Recall that C, the  X’s support, is the set of points x ∈ R where 
FX(x) is strictly increasing. By deﬁnition QX(c) is the smallest value in C where 
FX(QX(c)) ⩾c, for every 0 < c  <  1. In fact, we also have QX(FX(x)) ⩽x 
and for each ﬁnite x ∈ C there is some probability level c ∈ (0, 1) s.t. QX(c) = 
u, for otherwise FX(x) does not increases at x and we may ﬁnd a smaller value 
x' < x  where QX(FX(x')) ⩽x' and thus x' = QX(c) is the correct quantile.8 As 
byproduct, QX(c) = x and we can write: 
sans serif upper E left parenthesis upper X right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline x normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis equals integral Underscript upper C Endscripts upper Q Subscript upper X Baseline left parenthesis c right parenthesis normal d upper F Subscript upper X Baseline left parenthesis upper Q Subscript upper X Baseline left parenthesis c right parenthesis right parenthesis periodE(X) =
⎰∞
−∞
x dFX(x) =
⎰
C
QX(c)dFX(QX(c)).
Now we consider two cases. 
1. If the CDF has not jump discontinuities in the X’s support we safely let 
FX(QX(c)) = c. 
2. If the CDF has jump discontinuities at the points x ∈ C, then here we 
have that xP(X = x) =
⎰FX(x) 
FX(x−) QX(c)dc. Indeed, for c in the open inter-
val
(
FX(x−), FX(x)
)
it holds QX(c) = x and the above integral equals 
x
⎰FX(x) 
FX(x−) dc = x[FX(x) − FX(x−)]. 
Putting things together and considering the (at most countable) sum ∑
x
⎰FX(x) 
FX(x−) 
QX(c)dc we eventually get the desired result. Solution 2. Recall the quantile 
transform: for a rv X with CDF FX and quantile function QX we always have 
X d= QX(U), where U ∼ U(0, 1). We can write 
sans serif upper E left parenthesis upper X right parenthesis equals integral Underscript upper Omega Endscripts upper X normal d sans serif upper P equals integral Underscript upper Omega Endscripts ModifyingBelow upper Q Subscript upper X Baseline left parenthesis upper U right parenthesis With bottom brace Underscript equals g left parenthesis upper U right parenthesis Endscripts normal d sans serif upper P equals integral Subscript 0 Superscript 1 Baseline upper Q Subscript upper X Baseline left parenthesis c right parenthesis normal d c commaE(X) =
⎰
Ω
XdP =
⎰
Ω
QX(U)
◟◝ ◜◞
=g(U)
dP =
⎰1
0
QX(c)dc,
where we used the abstract deﬁnition of expectation and the change of variable 
formula with g(c) = g(U(ω)) and c = U(ω) for every scenario ω ∈Ω s.t. U(ω) 
varies in the unit interval (0, 1). In fact, under these conditions we have 
integral Underscript upper Omega Endscripts g left parenthesis upper U right parenthesis normal d sans serif upper P equals integral Subscript negative normal infinity Superscript normal infinity Baseline g left parenthesis c right parenthesis normal d upper F Subscript upper U Baseline left parenthesis c right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline g left parenthesis c right parenthesis ModifyingBelow f Subscript upper U Baseline left parenthesis c right parenthesis With bottom brace Underscript equals bold upper I Subscript left brace 0 less than or slanted equals c less than or slanted equals 1 right brace Baseline Endscripts normal d c equals integral Subscript 0 Superscript 1 Baseline upper Q Subscript upper X Baseline left parenthesis c right parenthesis normal d c period
⎰
Ω
g(U)dP =
⎰∞
−∞
g(c)dFU(c) =
⎰∞
−∞
g(c) fU(c)
◟◝ ◜◞
=I{0⩽c⩽1}
dc =
⎰1
0
QX(c)dc.
4.17
•
For a discrete X = ∑n 
i=1 xiIAi with xi > 0 then P(Ai) = P(X = xi) = 0 since 
X a.s.
= 0 by hypotheses, thus E(X) = 0. Passing to X ⩾0 with P(X > 0) = 0, 
we consider a discrete rv Z s.t. 0 ⩽Z ⩽X, then it holds Z a.s.
= 0. We can write
8 This happens at all the points in Cc. 
Solutions to Exercises
305
E(X) = sup{0⩽Z⩽X, Z discrete} E(Z) = 0, since each E(Z) = 0. The general case 
follows by the standard machine.
•
Start from discrete rvs X, Y s.t. X a.s.
= Y, i.e. P(X /= Y) = 0. Then: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper Y right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis upper Y bold upper I Subscript left brace upper X not equals upper Y right brace Baseline right parenthesis plus sans serif upper E left parenthesis upper Y bold upper I Subscript left brace upper X equals upper Y right brace Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals Overscript equality a period s period Endscripts 3rd Column sans serif upper E left parenthesis upper Y bold upper I Subscript left brace upper X not equals upper Y right brace Baseline right parenthesis plus sans serif upper E left parenthesis upper X bold upper I Subscript left brace upper X equals upper Y right brace Baseline right parenthesis period EndLayoutE(Y)
=
E(YI{X/=Y}) + E(YI{X=Y})
equality a.s.
=
E(YI{X/=Y}) + E(XI{X=Y}).
Pick a discrete sequence Y1, Y2, . . .  s.t. Yn → Y pointwise. Hence, YnI{X/=Y} 
increases pointwise to YI{X/=Y}. Moreover YnI{X/=Y} ⩽δ each n, since any 
simple rv is bounded above by some δ >  0. Then 
0 less than or slanted equals sans serif upper E left parenthesis upper Y Subscript n Baseline bold upper I Subscript left brace upper X not equals upper Y right brace Baseline right parenthesis less than or slanted equals sans serif upper E left parenthesis delta bold upper I Subscript left brace upper X not equals upper Y right brace Baseline right parenthesis equals delta sans serif upper P left parenthesis upper X not equals upper Y right parenthesis equals 0 comma0 ⩽E(YnI{X/=Y}) ⩽E(δ I{X/=Y}) = δ P(X /= Y) = 0,
so E(YnI{X/=Y}) = 0. Since YnI{X/=Y} → YI{X/=Y} pointwise, MCT gives 0 = 
limn E(YnI{X/=Y}) = E(YI{X/=Y}). Similarly, E(XI{X/=Y}) = 0. Putting things 
together: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper Y right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis upper Y bold upper I Subscript left brace upper X not equals upper Y right brace Baseline right parenthesis plus sans serif upper E left parenthesis upper X bold upper I Subscript left brace upper X equals upper Y right brace Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column 0 plus sans serif upper E left parenthesis upper X bold upper I Subscript left brace upper X equals upper Y right brace Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper E left parenthesis upper X bold upper I Subscript left brace upper X not equals upper Y right brace Baseline right parenthesis plus sans serif upper E left parenthesis upper X bold upper I Subscript left brace upper X equals upper Y right brace Baseline right parenthesis equals sans serif upper E left parenthesis upper X right parenthesis period EndLayoutE(Y) = E(YI{X/=Y}) + E(XI{X=Y})
= 0 + E(XI{X=Y})
= E(XI{X/=Y}) + E(XI{X=Y}) = E(X).
For general rvs, X a.s.
= Y implies X+ a.s.
= Y + and X− a.s.
= Y −. Applying the above 
separately to X+ and X− then adding we are done.
•
Let A = {X >  0} and An = {X ⩾1 
n}. Clearly A1 ⊂ A2 ⊂· · ·  and A = ∪iAi, 
i.e. An ↑ A which implies 
0 less than or slanted equals upper X bold upper I Subscript upper A Sub Subscript n Subscript Baseline less than or slanted equals upper X bold upper I Subscript upper A Baseline period0 ⩽XIAn ⩽XIA.
By monotonicity of expectation we also have 0 ⩽E(XIAn) ⩽E(XIA) ⩽
E(X) = 0. As byproduct, 
0 equals sans serif upper E left parenthesis upper X bold upper I Subscript upper A Sub Subscript n Subscript Baseline right parenthesis greater than or slanted equals sans serif upper E left parenthesis StartFraction 1 Over n EndFraction bold upper I Subscript upper A Sub Subscript n Subscript Baseline right parenthesis equals StartFraction 1 Over n EndFraction sans serif upper P left parenthesis upper A Subscript n Baseline right parenthesis0 = E(XIAn) ⩾E( 1
nIAn) = 1
nP(An)
which further implies P(An) = 0 for all n ⩾1. But P(A) = limn→∞ P(An) and 
we conclude P(A) = 0. 
Remark 2 Combining items 1 and 2 we show that for X a.s.
= Y the condition |X − 
Y| a.s.
= 0 also implies E(X) = E(Y). In fact, we have  
StartAbsoluteValue sans serif upper E left parenthesis upper X right parenthesis minus sans serif upper E left parenthesis upper Y right parenthesis EndAbsoluteValue equals StartAbsoluteValue sans serif upper E left parenthesis upper X minus upper Y right parenthesis EndAbsoluteValue less than or slanted equals sans serif upper E left parenthesis StartAbsoluteValue upper X minus upper Y EndAbsoluteValue right parenthesis period|E(X) −E(Y)| = |E(X −Y)| ⩽E(|X −Y|).
306
Solutions to Exercises
If we assume X a.s.
= Y then |X − Y| a.s.
= 0 because 
1 equals sans serif upper P left parenthesis upper X equals upper Y right parenthesis equals sans serif upper P left parenthesis upper X minus upper Y equals 0 right parenthesis equals sans serif upper P left parenthesis StartAbsoluteValue upper X minus upper Y EndAbsoluteValue equals 0 right parenthesis comma1 = P(X = Y) = P(X −Y = 0) = P(|X −Y| = 0),
and obviously |x − y| = 0 iff  x − y = 0. But this implies E(|X − Y|) = 0 by item 
1 and then 
StartAbsoluteValue sans serif upper E left parenthesis upper X right parenthesis minus sans serif upper E left parenthesis upper Y right parenthesis EndAbsoluteValue equals 0 long left right double arrow sans serif upper E left parenthesis upper X right parenthesis minus sans serif upper E left parenthesis upper Y right parenthesis equals 0 comma|E(X) −E(Y)| = 0 ⇐⇒E(X) −E(Y) = 0,
thus we get E(X) = E(Y). 
Remark 3 Observe that for a nonnegative rv X ⩾0 with Ac = {X = 0} and 
P(A) = 0 then every nonnegative discrete rv Z satisfying 0 ⩽Z ⩽X must be 
zero on the same set Ac . Indeed, for Z = z1IA1 + · · · +  znIAn we have ZIA =
∑n 
i=1 ziIA∩Ai. The expectation of ZIA is clearly ∑n 
i=1 ziP(A ∩ Ai), where P(A ∩ 
Ai) must be zero because A ∩ Ai ⊂ A, and by monotonicity of P it holds P(A ∩ 
Ai) ⩽P(A) = 0. This implies that E(ZIA) = 0 if and only if P(A) = 0. 
4.18 The rv 
upper Y Subscript n Baseline left parenthesis omega right parenthesis equals StartLayout Enlarged left brace 1st Row 1st Column upper X left parenthesis omega right parenthesis 2nd Column if upper X left parenthesis omega right parenthesis element of StartSet x 1 comma x 2 comma ellipsis comma x Subscript n Baseline EndSet 2nd Row 1st Column 0 2nd Column if upper X left parenthesis omega right parenthesis element of StartSet x Subscript n plus 1 Baseline comma x Subscript n plus 2 Baseline comma ellipsis EndSet comma EndLayoutYn(ω) =
⌠
X(ω)
if X(ω) ∈{x1, x2, . . . , xn}
0
if X(ω) ∈{xn+1, xn+2, . . .},
is such that Yn(ω) < X(ω), for every ω ∈Ω and some n ∈ N. Since xi ⩾0 we  
have Yn is discrete. Taking expectation: E(Yn) = ∑n 
i=1 xiP(X = xi). The sequence 
(Yn)n∈N converges pointwise to the nonnegative discrete rv X. Then, by MCT we 
have: 
limit Underscript n Endscripts sans serif upper E left parenthesis upper Y Subscript n Baseline right parenthesis equals limit Underscript n Endscripts sigma summation Underscript i equals 1 Overscript n Endscripts x Subscript i Baseline sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts x Subscript i Baseline sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis equals sans serif upper E left parenthesis upper X right parenthesis periodlim
n E(Yn) = lim
n
n
⎲
i=1
xiP(X = xi) =
∞
⎲
i=1
xiP(X = xi) = E(X).
4.19 Write the ﬁnite sum Sn = ∑n 
i=1 Xi. Of course Sn ⩽Sn+1 for every n ∈ N, 
and further 
limit Underscript n right arrow normal infinity Endscripts upper S Subscript n Baseline equals limit Underscript n right arrow normal infinity Endscripts sigma summation Underscript i equals 1 Overscript n Endscripts upper X Subscript i Baseline equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts upper X Subscript i lim
n→∞Sn = lim
n→∞
n
⎲
i=1
Xi =
∞
⎲
i=1
Xi
pointwise. MCT now yields 
limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis upper S Subscript n Baseline right parenthesis equals sans serif upper E left parenthesis limit Underscript n right arrow normal infinity Endscripts upper S Subscript n Baseline right parenthesis equals sans serif upper E left parenthesis sigma summation Underscript i equals 1 Overscript normal infinity Endscripts upper X Subscript i Baseline right parenthesis period lim
n→∞E(Sn) = E
⎛
lim
n→∞Sn
⎞
= E
⎛∞
⎲
i=1
Xi
⎞
.
4.20 Assume Xn → X pointwise. Then limn→∞(Xn − X) = X − X = 0. By 
deﬁnition (X − Xn)+ = (X − Xn)I{X−Xn⩾0} which is either zero or X − Xn if
Solutions to Exercises
307
0 ⩽X ⩽Xn. This obviously implies (X−Xn)+ ⩽Xn. Analogously, (Xn−X)− = 
−(Xn − X)I{Xn−X⩽0} is either zero or X − Xn whenever 0 ⩽Xn ⩽X so that 
(Xn − X)−⩽X. Veriﬁcation in the case P-a.s. only require to add IA, where 
A = {  lim 
n→∞ Xn = X}. 
4.21 Let g(Rn ) = {y ∈ Rn | ∃x ∈ Rn with y = g(x)}. Since g is a diffeomorphism 
we have that g(Rn ) is an open subset of Rn and the inverse function g−1 is well 
deﬁned on this subset, continuously differentiable with non-zero Jacobian. Let B ∈ 
Bn and ˜B = g−1(B). We have: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis bold upper X element of upper B overTilde right parenthesis 2nd Column equals 3rd Column integral Underscript upper B overTilde Endscripts f Subscript bold upper X Baseline left parenthesis bold x right parenthesis normal d bold x equals integral Underscript bold g Superscript negative 1 Baseline left parenthesis upper B right parenthesis Endscripts f Subscript bold upper X Baseline left parenthesis bold x right parenthesis normal d bold x 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Underscript upper B Endscripts f Subscript bold upper X Baseline left parenthesis bold g Superscript negative 1 Baseline left parenthesis bold y right parenthesis right parenthesis StartAbsoluteValue det bold upper J Subscript bold g Sub Superscript negative 1 Subscript Baseline left parenthesis bold y right parenthesis EndAbsoluteValue normal d bold y comma EndLayoutP(X ∈˜B) =
⎰
˜B
fX(x)dx =
⎰
g−1(B)
fX(x)dx
=
⎰
B
fX(g−1(y))| det Jg−1(y)|dy,
where the third equality is due to Theorem 4.9 with g−1. Furthermore, events {Y ∈ 
B} and {X ∈ ˜B} coincide, then their probabilities are equal, 
sans serif upper P left parenthesis upper X element of upper B overTilde right parenthesis equals integral Underscript upper B Endscripts f Subscript bold upper Y Baseline left parenthesis bold y right parenthesis normal d bold y periodP(X ∈˜B) =
⎰
B
fY(y)dy.
Since B is any Borel set in Rn we get formula (4.28). 
4.22 We have: 
bold g left parenthesis x 1 comma x 2 right parenthesis equals StartBinomialOrMatrix x 1 plus x 2 Choose x 1 minus x 2 EndBinomialOrMatrix equals StartBinomialOrMatrix u Choose v EndBinomialOrMatrix element of double struck upper R squared periodg(x1, x2) =
⎾x1 + x2
x1 −x2
⏋
=
⎾u
v
⏋
∈R2.
Here the function g is a diffeomorphism and the inverse function 
bold g Superscript negative 1 Baseline left parenthesis u comma v right parenthesis equals StartBinomialOrMatrix StartFraction u plus v Over 2 EndFraction Choose StartFraction u minus v Over 2 EndFraction EndBinomialOrMatrixg−1(u, v) =
⎾u+v
2
u−v
2
⏋
is well deﬁned, continuously differentiable with constant Jacobian matrix 
bold upper J Subscript bold g Sub Superscript negative 1 Baseline left parenthesis u comma v right parenthesis equals Start 2 By 2 Matrix 1st Row 1st Column one half 2nd Column one half 2nd Row 1st Column one half 2nd Column negative one half period EndMatrixJg−1(u, v) =
⎾1
2
1
2
1
2 −1
2.
⏋
Its Jacobian does not depends on variables u, v : 
det bold upper J Subscript bold g Sub Superscript negative 1 Subscript Baseline equals one half left parenthesis negative one half right parenthesis minus one half one half equals negative one half period det Jg−1 = 1
2(−1
2) −1
2
1
2 = −1
2.
308
Solutions to Exercises
Note that the new random vector Y = (U, V ) has U = X1 + X2 and V = X1 −X2. 
By formula (4.28) its joint density is 
StartLayout 1st Row 1st Column f Subscript bold upper Y Baseline left parenthesis u comma v right parenthesis 2nd Column equals 3rd Column f Subscript bold upper X Baseline left parenthesis StartFraction u plus v Over 2 EndFraction comma StartFraction u minus v Over 2 EndFraction right parenthesis StartAbsoluteValue det bold upper J Subscript bold g Sub Superscript negative 1 Subscript Baseline EndAbsoluteValue 2nd Row 1st Column Blank 2nd Column equals 3rd Column f Subscript upper X 1 Baseline left parenthesis StartFraction u plus v Over 2 EndFraction right parenthesis f Subscript upper X 2 Baseline left parenthesis StartFraction u minus v Over 2 EndFraction right parenthesis one half 3rd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction 1 Over StartRoot 2 pi EndRoot EndFraction e Superscript minus one half left parenthesis StartFraction u plus v Over 2 EndFraction right parenthesis squared Baseline StartFraction 1 Over StartRoot 2 pi EndRoot EndFraction e Superscript minus one half left parenthesis StartFraction u minus v Over 2 EndFraction right parenthesis squared Baseline one half 4th Row 1st Column Blank 2nd Column equals 3rd Column StartFraction 1 Over StartRoot 4 pi EndRoot EndFraction e Superscript minus StartFraction u squared Over 4 EndFraction Baseline StartFraction 1 Over StartRoot 4 pi EndRoot EndFraction e Superscript minus StartFraction v squared Over 4 EndFraction Baseline comma EndLayoutfY(u, v) = fX
⎛u + v
2
, u −v
2
⎞
| det Jg−1|
= fX1( u+v
2 )fX2( u−v
2 ) 1
2
=
1
√
2π
e−1
2 ( u+v
2
)2
1
√
2π
e−1
2 ( u−v
2
)2 1
2
=
1
√
4π
e−u2
4
1
√
4π
e−v2
4 ,
for u, v ∈ R, where fXi denotes the density of Xi, each i = 1, 2. By visual 
inspection, we recognize the product of two Gaussian densities referring to U, V ∼ 
N(0, 2). Thus Y is a Gaussian vector with independent Gaussian component. 
4.23 Regardless the expectation may be inﬁnite, we use an extension of for-
mula (4.1) for discrete rvs. Therefore we have: 
sans serif upper E left parenthesis upper X right parenthesis equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts i sans serif upper P left parenthesis upper X equals i right parenthesis equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts sans serif upper P left parenthesis upper X greater than or slanted equals i right parenthesis periodE(X) =
∞
⎲
i=1
iP(X = i) =
∞
⎲
i=1
P(X ⩾i).
The second equality follows from the fact that:
•
for i = 1 we have  P(X ⩾1) = P(X = 1)+P(X > 1), and P(X > 1) = P(X = 
2) + P(X = 3) + P(X = 4) + · · · ;
•
for i = 2 we have  P(X ⩾2) = P(X = 2)+P(X > 2), and P(X > 2) = P(X = 
3) + P(X = 4) + · · · ;
•
... 
Collecting the terms we found i = 1 term  P(X = 1) and i = 2 terms  P(X = 2) 
and i = 3 terms  P(X = 3), etc. Summing up we obtain ∑∞ 
i=1 i P(X = i) =
∑∞ 
i=1 P(X ⩾i). 
Remark 4 The integer valued rv X ⩾0 is discrete with image X(Ω) = N. By  
deﬁnition, for x ∈[i − 1, i)  and i = 2, 3, . . .  we have 
sans serif upper P left parenthesis upper X greater than or slanted equals i right parenthesis equals sans serif upper P left parenthesis upper X greater than x right parenthesis equals 1 minus upper F Subscript upper X Baseline left parenthesis x right parenthesis periodP(X ⩾i) = P(X > x) = 1 −FX(x).
In fact, if x = i − 1 then P(X > x) = P(X > i − 1) = P(X ⩾i), and the same 
is true for i − 1 < x  < i  since X is integer valued and the probability between 
two points i − 1, i  ∈ C in its support (where the CDF increases) is zero. Now we 
integrate the survival function 1−FX(x) over (0, ∞) by dividing it into subintervals
Solutions to Exercises
309
[i − 1, i), i.e. we compute the Riemann integrals
⎰i 
i−1[1 − FX(x)]dx and then sum 
up. Eventually: 
integral Subscript 0 Superscript normal infinity Baseline left bracket 1 minus upper F Subscript upper X Baseline left parenthesis x right parenthesis right bracket normal d x equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts integral Subscript i minus 1 Superscript i Baseline left bracket 1 minus upper F Subscript upper X Baseline left parenthesis x right parenthesis right bracket normal d x equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts sans serif upper P left parenthesis upper X greater than or slanted equals i right parenthesis period
⎰∞
0
[1 −FX(x)]dx =
∞
⎲
i=1
⎰i
i−1
[1 −FX(x)]dx =
∞
⎲
i=1
P(X ⩾i).
We used
⎰i 
i−1[1−FX(x)]dx =
⎰i 
i−1 P(X > x)dx =
⎰i 
i−1 P(X ⩾i)dx = P(X ⩾i), 
for x ∈[i − 1, i). 
4.24 First we recall that E(X) =
⎰∞ 
−∞ x dFX(x). Then, we split the Stieltjes 
integral as 
integral Subscript negative normal infinity Superscript 0 Baseline x normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis plus integral Subscript 0 Superscript normal infinity Baseline x normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis comma where x is continuous at zero period
⎰0
−∞
x dFX(x) +
⎰∞
0
x dFX(x),
where x is continuous at zero.
Next, we compute the ﬁrst integral via integration by parts: 
integral Subscript negative normal infinity Superscript 0 Baseline x normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis equals 0 upper F Subscript upper X Baseline left parenthesis 0 right parenthesis minus limit Underscript x right arrow negative normal infinity Endscripts left parenthesis x upper F Subscript upper X Baseline left parenthesis x right parenthesis right parenthesis minus integral Subscript negative normal infinity Superscript 0 Baseline upper F Subscript upper X Baseline left parenthesis x right parenthesis normal d x equals minus integral Subscript negative normal infinity Superscript 0 Baseline upper F Subscript upper X Baseline left parenthesis x right parenthesis normal d x comma
⎰0
−∞
x dFX(x) = 0 FX(0)−lim
x→−∞(x FX(x))−
⎰0
−∞
FX(x)dx = −
⎰0
−∞
FX(x)dx,
On the other hand,
⎰∞ 
0 x dFX(x) =
⎰∞ 
0 [1 − FX(x)]dx by formula (4.5). Since (by 
the ﬁniteness of the expectation) we also have 
0 less than or slanted equals limit Underscript x right arrow negative normal infinity Endscripts StartAbsoluteValue x EndAbsoluteValue upper F Subscript upper X Baseline left parenthesis x right parenthesis equals limit Underscript x right arrow negative normal infinity Endscripts StartAbsoluteValue x EndAbsoluteValue integral Subscript negative normal infinity Superscript x Baseline normal d upper F Subscript upper X Baseline left parenthesis u right parenthesis less than or slanted equals limit Underscript x right arrow negative normal infinity Endscripts integral Subscript negative normal infinity Superscript x Baseline StartAbsoluteValue u EndAbsoluteValue normal d upper F Subscript upper X Baseline left parenthesis u right parenthesis equals 0 comma0 ⩽
lim
x→−∞|x|FX(x) =
lim
x→−∞|x|
⎰x
−∞
dFX(u) ⩽
lim
x→−∞
⎰x
−∞
|u|dFX(u) = 0,
the above limit is zero and we conclude 
sans serif upper E left parenthesis upper X right parenthesis equals integral Subscript 0 Superscript normal infinity Baseline left bracket 1 minus upper F Subscript upper X Baseline left parenthesis x right parenthesis right bracket normal d x minus integral Subscript negative normal infinity Superscript 0 Baseline upper F Subscript upper X Baseline left parenthesis x right parenthesis normal d x periodE(X) =
⎰∞
0
[1 −FX(x)]dx −
⎰0
−∞
FX(x)dx.
(4) 
4.25 First, by the results of the previous exercises let IB(ω, x) with B :=
{
(ω, x) | 0 ⩽x − X(ω)
}
. Thus, the rv (x − X)+ may be written as 
integral Subscript negative normal infinity Superscript x Baseline bold upper I Subscript upper B Baseline left parenthesis omega comma u right parenthesis normal d u equals integral Subscript 0 Superscript x minus upper X left parenthesis omega right parenthesis Baseline normal d u equals x minus upper X left parenthesis omega right parenthesis comma for those omega s period t period 0 less than or slanted equals x minus upper X left parenthesis omega right parenthesis comma
⎰x
−∞
IB(ω, u)du =
⎰x−X(ω)
0
du = x −X(ω),
for those ω s.t. 0 ⩽x −X(ω),
310
Solutions to Exercises
and this equals max{0, x  − X(ω)}. Next, we have the chain of equivalence: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis left parenthesis x minus upper X right parenthesis Superscript plus Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis integral Subscript negative normal infinity Superscript x Baseline bold upper I Subscript left brace upper X less than or slanted equals u right brace Baseline normal d u right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket integral Subscript negative normal infinity Superscript x Baseline bold upper I Subscript left brace upper X less than or slanted equals u right brace Baseline normal d u right bracket normal d upper F Subscript upper X Baseline left parenthesis u right parenthesis 2nd Row 1st Column Blank 2nd Column equals Overscript Fubini right single quotation mark s Th Endscripts 3rd Column integral Subscript negative normal infinity Superscript x Baseline left bracket integral Subscript negative normal infinity Superscript normal infinity Baseline bold upper I Subscript left brace upper X less than or slanted equals u right brace Baseline normal d upper F Subscript upper X Baseline left parenthesis u right parenthesis right bracket normal d u equals integral Subscript negative normal infinity Superscript x Baseline left bracket integral Subscript negative normal infinity Superscript u Baseline normal d upper F Subscript upper X Baseline left parenthesis u right parenthesis right bracket normal d u 3rd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript x Baseline left bracket upper F Subscript upper X Baseline left parenthesis u right parenthesis minus upper F Subscript upper X Baseline left parenthesis negative normal infinity right parenthesis right bracket normal d u equals integral Subscript negative normal infinity Superscript x Baseline upper F Subscript upper X Baseline left parenthesis u right parenthesis normal d u period EndLayoutE
(
(x −X)+)
=
E
⎛⎰x
−∞
I{X⩽u}du
⎞
=
⎰∞
−∞
⎾⎰x
−∞
I{X⩽u}du
⏋
dFX(u)
Fubini’s Th
=
⎰x
−∞
⎾⎰∞
−∞
I{X⩽u}dFX(u)
⏋
du =
⎰x
−∞
⎾⎰u
−∞
dFX(u)
⏋
du
=
⎰x
−∞
[FX(u) −FX(−∞)] du =
⎰x
−∞
FX(u)du.
4.26 We can apply the results of the previous exercises and compute 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis left parenthesis upper X minus s right parenthesis Superscript plus Baseline right parenthesis 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket integral Subscript s Superscript normal infinity Baseline bold upper I Subscript left brace upper X greater than or slanted equals x right brace Baseline normal d x right bracket normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript s Superscript normal infinity Baseline left bracket integral Subscript x Superscript normal infinity Baseline normal d upper F Subscript upper X Baseline left parenthesis u right parenthesis right bracket normal d x equals integral Subscript s Superscript normal infinity Baseline left bracket upper F Subscript upper X Baseline left parenthesis normal infinity right parenthesis minus upper F Subscript upper X Baseline left parenthesis x right parenthesis right bracket normal d x period EndLayoutE
(
(X −s)+)
=
⎰∞
−∞
⎾⎰∞
s
I{X⩾x}dx
⏋
dFX(x)
=
⎰∞
s
⎾⎰∞
x
dFX(u)
⏋
dx =
⎰∞
s
[FX(∞) −FX(x)]dx.
Exercises of Chap. 5 
5.1 Let C = {0, 1, 2, . . .  , n} be the support of X ∼ Bin(n, p) and let xi = i. 
Deﬁning Y = n − X via linear transformation, we have: 
sans serif upper P left parenthesis upper Y equals i right parenthesis equals sans serif upper P left parenthesis upper X equals n minus i right parenthesis equals StartBinomialOrMatrix n Choose n minus i EndBinomialOrMatrix p Superscript n minus i Baseline q Superscript i Baseline equals StartBinomialOrMatrix n Choose i EndBinomialOrMatrix q Superscript n minus i Baseline p Superscript i Baseline commaP(Y = i) = P(X = n −i) =
⎛n
n −i
⎞
pn−iqi =
⎛n
i
⎞
qn−ipi,
where the last line follows by the symmetry of the binomial coefﬁcient. 
5.2 We work out the mass function of X + Y by conditioning on9 X and then using 
the law of total probability (6.11), see Theorem 6.1 in Sect. 6.1 we have: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper X plus upper Y equals i right parenthesis 2nd Column equals 3rd Column sigma summation Underscript j equals 0 Overscript i Endscripts sans serif upper P left parenthesis upper X plus upper Y equals i vertical bar upper X equals j right parenthesis sans serif upper P left parenthesis upper X equals j right parenthesis 2nd Row 1st Column Blank 2nd Column StartLayout 1st Row Indep period and upper X equals j 2nd Row equals EndLayout 3rd Column sigma summation Underscript j equals 0 Overscript i Endscripts sans serif upper P left parenthesis upper X plus upper Y equals i minus j right parenthesis sans serif upper P left parenthesis upper X equals j right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript j equals 0 Overscript i Endscripts StartBinomialOrMatrix n 2 Choose i minus j EndBinomialOrMatrix p Superscript i minus j Baseline q Superscript n 2 minus i plus j Baseline StartBinomialOrMatrix n 1 Choose j EndBinomialOrMatrix p Superscript j Baseline q Superscript n 1 minus j 4th Row 1st Column Blank 2nd Column equals 3rd Column p Superscript i Baseline q Superscript n 1 plus n 2 minus i Baseline sigma summation Underscript j equals 0 Overscript i Endscripts StartBinomialOrMatrix n 2 Choose i minus j EndBinomialOrMatrix StartBinomialOrMatrix n 1 Choose j EndBinomialOrMatrix 5th Row 1st Column Blank 2nd Column StartLayout 1st Row Vandermonde right single quotation mark s identity 2nd Row equals EndLayout 3rd Column p Superscript i Baseline q Superscript n 1 plus n 2 minus i Baseline StartBinomialOrMatrix n 1 plus n 2 Choose i EndBinomialOrMatrix period EndLayoutP(X + Y = i)
=
i
⎲
j=0
P(X + Y = i | X = j)P(X = j)
Indep. and X=j
=
i
⎲
j=0
P(X + Y = i −j)P(X = j)
=
i
⎲
j=0
⎛n2
i −j
⎞
pi−jqn2−i+j
⎛n1
j
⎞
pjqn1−j
9 The same is true by conditioning on Y. 
Solutions to Exercises
311
=
pi qn1+n2−i 
i
⎲
j=0
⎛n2 
i − j
⎞⎛n1 
j
⎞
Vandermonde’s identity 
=
pi qn1+n2−i
⎛n1 + n2 
i
⎞
. 
5.3 It is a simply matter of direct computation using a little combinatorial identities 
and manipulation of binomial coefﬁcients: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X right parenthesis equals sigma summation Underscript i equals 1 Overscript n Endscripts i StartBinomialOrMatrix n Choose i EndBinomialOrMatrix p Superscript i Baseline left parenthesis 1 minus p right parenthesis Superscript n minus i Baseline 2nd Column equals 3rd Column sigma summation Underscript i equals 0 Overscript n Endscripts i StartFraction n factorial Over i factorial left parenthesis n minus i right parenthesis factorial EndFraction p Superscript i Baseline left parenthesis 1 minus p right parenthesis Superscript n minus i 2nd Row 1st Column Blank 2nd Column equals 3rd Column n p sigma summation Underscript i equals 1 Overscript n Endscripts StartFraction left parenthesis n minus 1 right parenthesis factorial Over left parenthesis i minus 1 right parenthesis factorial left parenthesis n minus i right parenthesis factorial EndFraction p Superscript i minus 1 Baseline left parenthesis 1 minus p right parenthesis Superscript n minus i 3rd Row 1st Column Blank 2nd Column equals 3rd Column n p sigma summation Underscript k equals 0 Overscript n minus 1 Endscripts StartBinomialOrMatrix n minus 1 Choose k EndBinomialOrMatrix p Superscript k Baseline left parenthesis 1 minus p right parenthesis Superscript n minus 1 minus k 4th Row 1st Column Blank 2nd Column equals 3rd Column n p left parenthesis p plus left parenthesis 1 minus p right parenthesis right parenthesis Superscript n minus 1 Baseline equals n p period EndLayoutE(X) =
n
⎲
i=1
i
⎛n
i
⎞
pi(1 −p)n−i =
n
⎲
i=0
i
n!
i!(n −i)!pi(1 −p)n−i
= np
n
⎲
i=1
(n −1)!
(i −1)!(n −i)!pi−1(1 −p)n−i
= np
n−1
⎲
k=0
⎛n −1
k
⎞
pk(1 −p)n−1−k
= np(p + (1 −p))n−1 = np.
5.4 First, we write the second moment of X ∼ Po(λ): 
sans serif upper E left parenthesis upper X squared right parenthesis equals sigma summation Underscript i equals 0 Overscript normal infinity Endscripts i squared sans serif upper P left parenthesis upper X equals i right parenthesis equals e Superscript negative lamda Baseline sigma summation Underscript i equals 0 Overscript normal infinity Endscripts i squared StartFraction lamda Superscript i Baseline Over i factorial EndFraction periodE(X2) =
∞
⎲
i=0
i2P(X = i) = e−λ
∞
⎲
i=0
i2 λi
i! .
(5) 
Next, we need to differentiate term by term the series ∑∞ 
i=0 
λi 
i! with respect to λ 
getting 
StartLayout 1st Row 1st Column sigma summation Underscript i equals 1 Overscript normal infinity Endscripts i StartFraction lamda Superscript i minus 1 Baseline Over i factorial EndFraction 2nd Column equals 3rd Column StartFraction normal d Over normal d lamda EndFraction e Superscript lamda Baseline equals e Superscript lamda Baseline 2nd Row 1st Column Blank 2nd Column long left right double arrow 3rd Column Blank 3rd Row 1st Column sigma summation Underscript i equals 1 Overscript normal infinity Endscripts i StartFraction lamda Superscript i Baseline Over i factorial EndFraction 2nd Column equals 3rd Column lamda e Superscript lamda Baseline period EndLayout
∞
⎲
i=1
i λi−1
i!
=
d
dλeλ = eλ
⇐⇒
∞
⎲
i=1
i λi
i!
=
λeλ.
Differentiating the left-hand side of the expression after the equivalence we have: 
StartLayout 1st Row 1st Column sigma summation Underscript i equals 1 Overscript normal infinity Endscripts i squared StartFraction lamda Superscript i minus 1 Baseline Over i factorial EndFraction 2nd Column equals 3rd Column StartFraction normal d Over normal d lamda EndFraction lamda e Superscript lamda Baseline equals e Superscript lamda Baseline plus lamda e Superscript lamda Baseline equals e Superscript lamda Baseline left parenthesis 1 plus lamda right parenthesis 2nd Row 1st Column Blank 2nd Column long left right double arrow 3rd Column Blank 3rd Row 1st Column sigma summation Underscript i equals 1 Overscript normal infinity Endscripts i squared StartFraction lamda Superscript i Baseline Over i factorial EndFraction 2nd Column equals 3rd Column lamda e Superscript lamda Baseline left parenthesis 1 plus lamda right parenthesis period EndLayout
∞
⎲
i=1
i2 λi−1
i!
=
d
dλλeλ = eλ + λeλ = eλ(1 + λ)
⇐⇒
∞
⎲
i=1
i2 λi
i!
=
λeλ(1 + λ).
312
Solutions to Exercises
Using the last line of the latter equivalence we can rewrite 
sans serif upper E left parenthesis upper X squared right parenthesis equals e Superscript negative lamda Baseline lamda e Superscript lamda Baseline left parenthesis 1 plus lamda right parenthesis equals lamda left parenthesis 1 plus lamda right parenthesis commaE(X2) = e−λλeλ(1 + λ) = λ(1 + λ),
and eventually we get 
sans serif upper V left parenthesis upper X right parenthesis equals sans serif upper E left parenthesis upper X squared right parenthesis minus left parenthesis sans serif upper E left parenthesis upper X right parenthesis right parenthesis squared equals lamda left parenthesis 1 plus lamda right parenthesis minus lamda squared equals lamda commaV(X) = E(X2) −(E(X))2 = λ(1 + λ) −λ2 = λ,
and we are done. 
5.5 As we did for the sum of two independent binomial rvs, we condition on X and 
use the law of total probability (6.11), see Chap. 6, for  xi = i ∈ C = {0, 1, 2, . . .} :  
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper X plus upper Y equals i right parenthesis 2nd Column equals 3rd Column sigma summation Underscript j equals 0 Overscript i Endscripts sans serif upper P left parenthesis upper X plus upper Y equals i vertical bar upper X equals j right parenthesis sans serif upper P left parenthesis upper X equals j right parenthesis 2nd Row 1st Column Blank 2nd Column StartLayout 1st Row Indep period and upper X equals j 2nd Row equals EndLayout 3rd Column sigma summation Underscript j equals 0 Overscript i Endscripts sans serif upper P left parenthesis upper X plus upper Y equals i minus j right parenthesis sans serif upper P left parenthesis upper X equals j right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript j equals 0 Overscript i Endscripts StartFraction normal e Superscript minus lamda 2 Baseline lamda 2 Superscript i minus j Baseline Over left parenthesis i minus j right parenthesis factorial EndFraction StartFraction normal e Superscript minus lamda 1 Baseline lamda 1 Superscript j Baseline Over j factorial EndFraction 4th Row 1st Column Blank 2nd Column equals 3rd Column StartFraction normal e Superscript minus left parenthesis lamda 1 plus lamda 2 right parenthesis Baseline Over i factorial EndFraction sigma summation Underscript j equals 0 Overscript i Endscripts StartBinomialOrMatrix i Choose j EndBinomialOrMatrix lamda 1 Superscript j Baseline lamda 2 Superscript i minus j 5th Row 1st Column Blank 2nd Column StartLayout 1st Row Bin period Th period 2nd Row equals EndLayout 3rd Column StartFraction normal e Superscript minus left parenthesis lamda 1 plus lamda 2 right parenthesis Baseline left parenthesis lamda 1 plus lamda 2 right parenthesis Superscript i Baseline Over i factorial EndFraction period EndLayoutP(X + Y = i)
=
i
⎲
j=0
P(X + Y = i | X = j)P(X = j)
Indep. and X=j
=
i
⎲
j=0
P(X + Y = i −j)P(X = j)
=
i
⎲
j=0
e−λ2λi−j
2
(i −j)!
e−λ1λj
1
j!
=
e−(λ1+λ2)
i!
i
⎲
j=0
⎛i
j
⎞
λj
1λi−j
2
Bin. Th.
=
e−(λ1+λ2)(λ1 + λ2)i
i!
.
5.6 We mainly apply the Bayes’ formula (6.12), see Chap. 6, and independence to 
write down the probability of X conditioned on X + Y = n: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper X equals i vertical bar upper X plus upper Y equals n right parenthesis 2nd Column StartLayout 1st Row Bayes right single quotation mark form period 2nd Row equals EndLayout 3rd Column StartFraction sans serif upper P left parenthesis upper X plus upper Y equals n vertical bar upper X equals i right parenthesis sans serif upper P left parenthesis upper X equals i right parenthesis Over sans serif upper P left parenthesis upper X plus upper Y equals n right parenthesis EndFraction 2nd Row 1st Column Blank 2nd Column StartLayout 1st Row Indep period and upper X equals i 2nd Row equals EndLayout 3rd Column StartFraction sans serif upper P left parenthesis upper Y equals n minus i right parenthesis sans serif upper P left parenthesis upper X equals i right parenthesis Over sans serif upper P left parenthesis upper X plus upper Y equals n right parenthesis EndFraction period EndLayoutP(X = i | X + Y = n)
Bayes’ form.
=
P(X + Y = n | X = i)P(X = i)
P(X + Y = n)
Indep. and X=i
=
P(Y = n −i)P(X = i)
P(X + Y = n)
.
The expression in the last line can be rewritten using the masses of X, Y and X +Y, 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper X equals i vertical bar upper X plus upper Y equals n right parenthesis 2nd Column equals 3rd Column StartStartFraction left parenthesis StartFraction e Superscript minus lamda 2 Baseline lamda 2 Superscript n minus i Baseline Over left parenthesis n minus i right parenthesis factorial EndFraction right parenthesis left parenthesis StartFraction e Superscript minus lamda 1 Baseline lamda 1 Superscript i Baseline Over i factorial EndFraction right parenthesis OverOver StartFraction e Superscript minus left parenthesis lamda 1 plus lamda 2 right parenthesis left parenthesis lamda 1 plus lamda 2 right parenthesis Super Superscript n Superscript Baseline Over n factorial EndFraction EndEndFraction 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartBinomialOrMatrix n Choose i EndBinomialOrMatrix StartFraction lamda 1 Superscript i Baseline lamda 2 Superscript n minus i Baseline Over left parenthesis lamda 1 plus lamda 2 right parenthesis Superscript n Baseline EndFraction 3rd Row 1st Column Blank 2nd Column equals 3rd Column StartBinomialOrMatrix n Choose i EndBinomialOrMatrix left parenthesis StartFraction lamda 1 Over lamda 1 plus lamda 2 EndFraction right parenthesis Superscript i Baseline left parenthesis StartFraction lamda 2 Over lamda 1 plus lamda 2 EndFraction right parenthesis Superscript n minus i Baseline comma EndLayoutP(X = i | X + Y = n) =
⎛
e−λ2λn−i
2
(n−i)!
⎞⎛
e−λ1λi
1
i!
⎞
e−(λ1+λ2)(λ1+λ2)n
n!
Solutions to Exercises
313
=
⎛n 
i
⎞
λi 
1λn−i 
2 
(λ1 + λ2)n 
=
⎛n 
i
⎞⎛
λ1 
λ1 + λ2
⎞i ⎛
λ2 
λ1 + λ2
⎞n−i 
, 
which yields the required binomial distribution for i = 0, 1, 2, . . .  , n. 
5.7 Writing down the MGFs of the binomial Xn and the Poisson X and passing to 
the limit we get 
StartLayout 1st Row 1st Column limit Underscript n right arrow normal infinity Endscripts upper M Subscript upper X Sub Subscript n Baseline left parenthesis u right parenthesis equals limit Underscript n right arrow normal infinity Endscripts sans serif upper E left parenthesis e Superscript u upper X Super Subscript n Superscript Baseline right parenthesis 2nd Column equals 3rd Column limit Underscript n right arrow normal infinity Endscripts left parenthesis p Subscript n Baseline e Superscript u Baseline plus left parenthesis 1 minus p Subscript n Baseline right parenthesis right parenthesis Superscript n 2nd Row 1st Column Blank 2nd Column equals 3rd Column limit Underscript n right arrow normal infinity Endscripts left parenthesis 1 plus StartFraction lamda left parenthesis e Superscript u Baseline minus 1 right parenthesis Superscript n Baseline Over n EndFraction right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column e Superscript lamda left parenthesis e Super Superscript u Superscript minus 1 right parenthesis Baseline equals sans serif upper E left parenthesis e Superscript u upper X Baseline right parenthesis equals upper M Subscript upper X Baseline left parenthesis u right parenthesis period EndLayout lim
n→∞MXn(u) = lim
n→∞E(euXn) = lim
n→∞(pneu + (1 −pn))n
= lim
n→∞
⎛
1 + λ(eu −1)n
n
⎞
= eλ(eu−1) = E(euX) = MX(u).
5.8 Let u ∈ (c, d) and write 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper U less than or slanted equals u vertical bar upper U element of left parenthesis c comma d right parenthesis right parenthesis 2nd Column equals 3rd Column StartFraction sans serif upper P left parenthesis upper U less than or slanted equals u comma c less than upper U less than d right parenthesis Over sans serif upper P left parenthesis c less than upper U less than d right parenthesis EndFraction 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction sans serif upper P left parenthesis c less than upper U less than or slanted equals u right parenthesis Over sans serif upper P left parenthesis c less than upper U less than d right parenthesis EndFraction equals StartFraction u minus c Over d minus c EndFraction period EndLayoutP(U ⩽u | U ∈(c, d)) = P(U ⩽u, c < U < d)
P(c < U < d)
= P(c < U ⩽u)
P(c < U < d) = u −c
d −c.
Then, the CDF of U conditional on U ∈ (c, d) is 0 for u ⩽c and 1 for u ⩾d. This  
entails the desired distribution U ∼ U(c, d). 
5.9 First, use the change of variable z = x−μ
√
2σ : 
StartLayout 1st Row 1st Column integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript upper X Baseline left parenthesis x right parenthesis normal d x 2nd Column equals 3rd Column StartFraction 1 Over StartRoot 2 pi EndRoot sigma EndFraction integral Subscript negative normal infinity Superscript normal infinity Baseline exp left parenthesis minus StartFraction left parenthesis x minus mu right parenthesis squared Over 2 sigma squared EndFraction right parenthesis normal d x 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction 1 Over StartRoot pi EndRoot EndFraction integral Subscript negative normal infinity Superscript normal infinity Baseline e Superscript minus z squared Baseline normal d z comma EndLayout
⎰∞
−∞
fX(x)dx =
1
√
2πσ
⎰∞
−∞
exp
⎛
−(x −μ)2
2σ 2
⎞
dx
=
1
√π
⎰∞
−∞
e−z2dz,
where dx = 
√
2σdz and exp(•) is the exponential function. Now, let I =
⎰∞ 
−∞ e−z2 dz. Since the volume under the surface w = e−(z2+y2) can be given by 
the product of two-dimensional areas I, by the Fubini’s theorem we may write it as 
an iterated integral: 
StartLayout 1st Row 1st Column upper I squared 2nd Column equals 3rd Column left parenthesis integral Subscript negative normal infinity Superscript normal infinity Baseline e Superscript minus z squared Baseline normal d z right parenthesis left parenthesis integral Subscript negative normal infinity Superscript normal infinity Baseline e Superscript minus y squared Baseline normal d y right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline integral Subscript negative normal infinity Superscript normal infinity Baseline e Superscript minus left parenthesis z squared plus y squared right parenthesis Baseline normal d z normal d y period EndLayoutI 2 =
⎛⎰∞
−∞
e−z2dz
⎞⎛⎰∞
−∞
e−y2dy
⎞
=
⎰∞
−∞
⎰∞
−∞
e−(z2+y2)dzdy.
314
Solutions to Exercises
Now we can use the bijective transformation T : R2 → R2, where (z, y) = T(r, θ) 
is deﬁned to be the vector function which maps the polar coordinates (r, θ) ∈ R2 to 
the rectilinear coordinates (z, y) ∈ R2 by the functions f, g : R2 → R as follows: 
StartLayout 1st Row 1st Column z 2nd Column equals 3rd Column f left parenthesis r comma theta right parenthesis equals r cosine theta comma 2nd Row 1st Column y 2nd Column equals 3rd Column g left parenthesis r comma theta right parenthesis equals r sine theta comma EndLayoutz = f (r, θ) = r cos θ,
y = g(r, θ) = r sin θ,
where r >  0, θ  ∈[0, 2π]. At this point we need an appeal to the change of variable 
formula for multiple integrals, see Sect. 4.9, We have:  
normal d z normal d y equals StartAbsoluteValue det Start 2 By 2 Matrix 1st Row 1st Column f Subscript r Baseline 2nd Column g Subscript r Baseline 2nd Row 1st Column f Subscript theta Baseline 2nd Column g Subscript theta Baseline EndMatrix EndAbsoluteValue normal d r normal d theta commadzdy =
||||det
⎛fr gr
fθ gθ
⎞|||| drdθ,
where fr = cos θ, fθ = r sin θ and gr = sin θ, gθ = −r cos θ are partial 
derivatives. Recall that sin2 + cos2 θ = 1. Then passing to polar coordinates 
we get the new integral 2
⎰c 
0 e−r2 r dr. Write −
⎰c 
0 −2e−r2 r dr and observe that 
d 
dr
⎛
e−r2⎞
= −2re−r2 dr. Hence, the last integral is −
⎛
e−a2 − e0⎞
and as a →∞ 
we obtain: 2
⎰∞ 
0 e−r2 r dr = 1. Eventually, we rewrite 
StartLayout 1st Row 1st Column upper I squared 2nd Column equals 3rd Column integral Subscript 0 Superscript 2 pi Baseline integral Subscript 0 Superscript normal infinity Baseline e Superscript minus r squared Baseline r normal d r normal d theta 2nd Row 1st Column Blank 2nd Column equals 3rd Column 2 pi integral Subscript 0 Superscript normal infinity Baseline e Superscript minus r squared Baseline r normal d r equals pi comma EndLayoutI 2 =
⎰2π
0
⎰∞
0
e−r2r drdθ
= 2π
⎰∞
0
e−r2r dr = π,
and ﬁnd I = √π, that is 1
√π I = 1. 
5.10 We compute the MGF as: 
StartLayout 1st Row 1st Column upper M Subscript a plus b upper X 2nd Column equals 3rd Column e Superscript u a Baseline sans serif upper E left parenthesis e Superscript u b upper X Baseline right parenthesis equals e Superscript u a Baseline e Superscript u b mu plus StartFraction u squared b squared sigma squared Over 2 EndFraction Baseline 2nd Row 1st Column Blank 2nd Column equals 3rd Column e Superscript left parenthesis a plus b mu right parenthesis plus StartFraction u squared left parenthesis a squared sigma squared right parenthesis Over 2 EndFraction Baseline comma EndLayoutMa+bX = euaE(eu bX) = euaeu bμ+ u2b2σ2
2
= e(a+b μ)+ u2(a2σ 2)
2
,
where the second equality follows from the expression of MX(u). A linear 
transformation of a Gaussian rv provides the MGF of a new Gaussian variable 
Y ∼ N(a + bμ, a2σ 2) where the localization parameter is a linear combination 
with the same coefﬁcients and the scale parameter is itself scaled by a factor b2.
Solutions to Exercises
315
5.11 Let fX(x1, x2) the bi-variate Gaussian density. Then, the marginal density of 
X1 is: 
StartLayout 1st Row 1st Column f Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript bold upper X Baseline left parenthesis x 1 comma x 2 right parenthesis normal d x 2 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction 1 Over 2 pi sigma 1 StartRoot 1 minus rho squared EndRoot EndFraction integral Subscript negative normal infinity Superscript normal infinity Baseline exp left parenthesis minus StartFraction 1 Over 2 left parenthesis 1 minus rho squared right parenthesis EndFraction left parenthesis u squared plus v squared minus 2 rho u v right parenthesis right parenthesis normal d v comma EndLayoutfX1(x1) =
⎰∞
−∞
fX(x1, x2)dx2
=
1
2πσ1
√
1 −ρ2
⎰∞
−∞
exp
⎛
−
1
2(1 −ρ2)(u2 + v2 −2ρuv)
⎞
dv,
where we set u = x1−μ1 
σ1 
and v = x2−μ2 
σ2 , so that dx2 = σ2dv. Moreover, u2 + v2 − 
2ρuv equals (v − ρu)2 + u2(1 − ρ2) whence the above becomes 
StartLayout 1st Row 1st Column f Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis 2nd Column equals 3rd Column StartFraction 1 Over sigma 1 StartRoot 2 pi EndRoot EndFraction exp left parenthesis minus StartFraction u squared Over 2 EndFraction right parenthesis 2nd Row 1st Column Blank 2nd Column times 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline StartFraction 1 Over StartRoot 2 pi EndRoot StartRoot 1 minus rho squared EndRoot EndFraction exp left parenthesis minus StartFraction 1 Over 2 left parenthesis 1 minus rho squared right parenthesis EndFraction left parenthesis v minus rho u right parenthesis squared normal d v right parenthesis period EndLayoutfX1(x1) =
1
σ1
√
2π
exp
⎛
−u2
2
⎞
×
⎰∞
−∞
1
√
2π
√
1 −ρ2 exp
⎛
−
1
2(1 −ρ2)(v −ρu)2dv
⎞
.
We recognize (viz. the integrand) the density N(ρu, 1 − ρ2). Bringing back u =
x1−μ1 
σ1 
entails fX1(x1) as the density of N(μ1, σ 2 
1 ). The same reasoning can be 
applied to X2. 
5.12 Let Y = eX, then we ﬁrstly have 
sans serif upper E left parenthesis upper Y Superscript n Baseline right parenthesis equals sans serif upper E left parenthesis e Superscript n upper X Baseline right parenthesis equals colon upper M Subscript upper X Baseline left parenthesis n right parenthesis equals exp left parenthesis n mu plus StartFraction n squared sigma squared Over 2 EndFraction right parenthesis comma n equals 1 comma 2 comma ellipsis commaE(Y n) = E(enX) =: MX(n) = exp
⎛
nμ + n2σ 2
2
⎞
,
n = 1, 2, . . . ,
where the ﬁrst two equalities hold for any rv X, and the third is for X ∼ N(μ, σ 2) 
and its MGF, i.e., the nth moment of the log-normal Y is the MGF of the Gaussian 
X evaluated at u = n. For n = 1 Eq. (5.17) follows. Now, for  n = 2 we have  
E(Y 2) = exp
(
2μ + 2σ 2)
and then 
sans serif upper V left parenthesis upper Y right parenthesis equals sans serif upper E left parenthesis upper Y squared right parenthesis minus left parenthesis sans serif upper E left parenthesis upper Y right parenthesis right parenthesis squared equals exp left parenthesis 2 mu plus 2 sigma squared right parenthesis minus left parenthesis exp left parenthesis n mu plus n squared sigma squared divided by 2 right parenthesis squared commaV(Y) = E(Y 2) −(E(Y))2 = exp
⎛
2μ + 2σ 2⎞
−
⎛
exp
⎛
nμ + n2σ 2/2
⎞2
,
which after little algebra yields (5.18). 
5.13 We compute the expectation over the interval (0, ∞): 
sans serif upper E left parenthesis upper X right parenthesis equals integral Subscript 0 Superscript normal infinity Baseline x lamda e Superscript minus lamda x Baseline normal d x periodE(X) =
⎰∞
0
xλe−λxdx.
316
Solutions to Exercises
Integrating by parts 
integral Subscript a Superscript b Baseline f left parenthesis x right parenthesis g prime left parenthesis x right parenthesis normal d x equals left bracket f left parenthesis x right parenthesis g left parenthesis x right parenthesis right bracket Subscript a Superscript b Baseline minus integral Subscript a Superscript b Baseline g left parenthesis x right parenthesis f prime left parenthesis x right parenthesis normal d x
⎰b
a
f (x)g'(x)dx = [f (x)g(x)]b
a −
⎰b
a
g(x)f '(x)dx
with f (x)  = x, g'(x) = λe−λx we get: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X right parenthesis 2nd Column equals 3rd Column left bracket minus x e Superscript minus lamda x Baseline right bracket Subscript 0 Superscript normal infinity Baseline plus integral Subscript 0 Superscript normal infinity Baseline e Superscript minus lamda x Baseline normal d x 2nd Row 1st Column Blank 2nd Column equals 3rd Column limit Underscript x right arrow normal infinity Endscripts left parenthesis minus x e Superscript minus lamda x Baseline right parenthesis minus 0 minus StartFraction 1 Over lamda EndFraction integral Subscript 0 Superscript normal infinity Baseline minus lamda e Superscript minus lamda x normal d x 3rd Row 1st Column Blank 2nd Column equals 3rd Column minus StartFraction limit Underscript x right arrow normal infinity Endscripts x Over e Superscript lamda limit Underscript x right arrow normal infinity Endscripts x Baseline EndFraction minus StartFraction 1 Over lamda EndFraction left bracket e Superscript minus lamda x Baseline right bracket Subscript 0 Superscript normal infinity 4th Row 1st Column Blank 2nd Column equals 3rd Column minus StartFraction 1 Over lamda e Superscript lamda limit Underscript x right arrow normal infinity Endscripts x Baseline EndFraction plus StartFraction 1 Over lamda EndFraction equals StartFraction 1 Over lamda EndFraction comma EndLayoutE(X) =
⎾
−xe−λx⏋∞
0 +
⎰∞
0
e−λxdx
= lim
x→∞
(
−xe−λx)
−0 −1
λ
⎰∞
0
−λe−λxdx
= −limx→∞x
eλ limx→∞x −1
λ
⎾
e−λx⏋∞
0
= −
1
λeλ limx→∞x + 1
λ = 1
λ,
where in the fourth equality we use l’Hôpital’s rule. Using the same type of 
integration by parts and assuming Y ∼ Exp(1) we also get 
sans serif upper E left parenthesis upper Y squared right parenthesis equals integral Subscript 0 Superscript normal infinity Baseline x squared e Superscript negative x Baseline normal d x equals 2 commaE(Y 2) =
⎰∞
0
x2e−xdx = 2,
so V(Y) = E(Y 2) − (E(Y))2 = 1, using the result above with λ = 1. Therefore, we 
have 
sans serif upper V left parenthesis StartFraction 1 Over lamda EndFraction upper X right parenthesis equals StartFraction 1 Over lamda squared EndFraction sans serif upper E left parenthesis upper Y right parenthesis equals StartFraction 1 Over lamda squared EndFraction commaV
⎛1
λX
⎞
= 1
λ2 E(Y) = 1
λ2 ,
and the result follows. 
5.14 First, we note that E((a+bX−a−bμ)p ) = bpE((X−μ)p ), for every a, p ∈ 
R and b /= 0. Using this and the standard normal Z = X−μ 
σ 
we have10 E((X)p ) = 
1 
σ p E(Xp ), so we can instead ﬁnd the pth moment of Z and then multiply by σ 2 to 
get the pth moment of the original Gaussian. Next, we use the MGF of Z through 
its Taylor series expansion: 
upper M Subscript upper Z Baseline left parenthesis u right parenthesis equals e Superscript u squared divided by 2 Baseline equals sigma summation Underscript p equals 0 Overscript normal infinity Endscripts StartFraction left parenthesis u squared divided by 2 right parenthesis Superscript p Baseline Over p factorial EndFraction equals sigma summation Underscript p equals 0 Overscript normal infinity Endscripts StartFraction left parenthesis 2 p right parenthesis factorial Over 2 Superscript p Baseline p factorial EndFraction StartFraction u Superscript 2 p Baseline Over left parenthesis 2 p right parenthesis factorial EndFraction periodMZ(u) = eu2/2 =
∞
⎲
p=0
(u2/2)p
p!
=
∞
⎲
p=0
(2p)!
2pp!
u2p
(2p)!.
10 Sine the standard normal has expectation zero, its pth central moment is equal to the pth 
moment. 
Solutions to Exercises
317
Since E(Zp ) equals the coefﬁcient of the term involving up in the Taylor series 
expansion of MZ(u) we have E(Z2p ) = (2p)! 
2pp! , i.e. the even moments of Z. Hence, 
we eventually have 
sans serif upper E left parenthesis left parenthesis upper X minus mu right parenthesis Superscript p Baseline right parenthesis equals StartFraction left parenthesis 2 p right parenthesis factorial Over 2 Superscript p Baseline p factorial EndFraction sigma Superscript 2 p Baseline commaE((X −μ)p) = (2p)!
2pp! σ 2p,
which is zero for odd p = 1, 3, 5, . . .  by the symmetry of Z. 
5.15 The density g(x) is zero for x ⩽0, then integrating with the substitution 
λx = z we get: 
StartLayout 1st Row 1st Column 1 2nd Column equals 3rd Column k integral Subscript 0 Superscript normal infinity Baseline x Superscript alpha minus 1 Baseline e Superscript minus x lamda normal d x 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction k Over lamda Superscript alpha Baseline EndFraction integral Subscript 0 Superscript normal infinity Baseline z Superscript alpha minus 1 Baseline e Superscript negative z Baseline normal d z equals k StartFraction upper Gamma left parenthesis alpha right parenthesis Over lamda Superscript alpha Baseline EndFraction 3rd Row 1st Column Blank 2nd Column long left right double arrow 3rd Column k equals StartFraction lamda Superscript alpha Baseline Over upper Gamma left parenthesis alpha right parenthesis EndFraction period EndLayout1
=
k
⎰∞
0
xα−1e−xλdx
=
k
λα
⎰∞
0
zα−1e−zdz = k 𝚪(α)
λα
⇐⇒k =
λα
𝚪(α).
5.16 First, from x = h(y) = λ y  we compute h'(y) = λ then we write 
StartLayout 1st Row 1st Column f Subscript upper Y Baseline left parenthesis y right parenthesis equals f Subscript upper X Baseline left parenthesis x right parenthesis lamda 2nd Column equals 3rd Column lamda StartFraction 1 Over upper Gamma left parenthesis alpha right parenthesis EndFraction left parenthesis lamda y right parenthesis Superscript alpha minus 1 Baseline e Superscript minus lamda y Baseline y Superscript negative 1 2nd Row 1st Column Blank 2nd Column equals 3rd Column CrossOut lamda EndCrossOut StartFraction 1 Over upper Gamma left parenthesis alpha right parenthesis EndFraction left parenthesis lamda y right parenthesis Superscript alpha Baseline left parenthesis CrossOut lamda EndCrossOut y right parenthesis Superscript negative 1 Baseline e Superscript minus lamda y Baseline y Superscript negative 1 Baseline comma EndLayoutfY (y) = fX(x)λ = λ
1
𝚪(α)(λ y)α−1e−λ yy−1
= λ
1
𝚪(α)(λ y)α(λ y)−1e−λ yy−1,
which is the desired density for y >  0. 
5.17 We ﬁrst compute the expectation: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X right parenthesis 2nd Column equals 3rd Column integral Subscript 0 Superscript normal infinity Baseline x StartFraction 1 Over upper Gamma left parenthesis alpha right parenthesis EndFraction x Superscript alpha minus 1 Baseline e Superscript negative x normal d x 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction 1 Over upper Gamma left parenthesis alpha right parenthesis EndFraction integral Subscript 0 Superscript normal infinity Baseline ModifyingBelow x Superscript alpha Baseline e Superscript negative x With bottom brace Underscript equals upper Gamma left parenthesis alpha plus 1 right parenthesis Endscripts normal d x 3rd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction alpha upper Gamma left parenthesis alpha right parenthesis Over upper Gamma left parenthesis alpha right parenthesis EndFraction equals alpha period EndLayoutE(X) =
⎰∞
0
x
1
𝚪(α)xα−1e−xdx
=
1
𝚪(α)
⎰∞
0
xαe−x
◟◝ ◜◞
=𝚪(α+1)
dx
= α𝚪(α)
𝚪(α) = α.
318
Solutions to Exercises
Next, we compute the second moment: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X squared right parenthesis 2nd Column equals 3rd Column integral Subscript 0 Superscript normal infinity Baseline x squared StartFraction 1 Over upper Gamma left parenthesis alpha right parenthesis EndFraction x Superscript alpha minus 1 Baseline e Superscript negative x normal d x 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction 1 Over upper Gamma left parenthesis alpha right parenthesis EndFraction integral Subscript 0 Superscript normal infinity Baseline ModifyingBelow x Superscript alpha plus 1 Baseline e Superscript negative x With bottom brace Underscript equals upper Gamma left parenthesis alpha plus 2 right parenthesis Endscripts normal d x 3rd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction left parenthesis alpha plus 1 right parenthesis alpha upper Gamma left parenthesis alpha right parenthesis Over upper Gamma left parenthesis alpha right parenthesis EndFraction equals left parenthesis alpha plus 1 right parenthesis alpha period EndLayoutE(X2) =
⎰∞
0
x2
1
𝚪(α)xα−1e−xdx
=
1
𝚪(α)
⎰∞
0
xα+1e−x
◟
◝ ◜
◞
=𝚪(α+2)
dx
= (α + 1)α𝚪(α)
𝚪(α)
= (α + 1)α.
As a result, V(X) = E(X2) − (E(X))2 = (α + 1)α − α2 = α. 
5.18 We ﬁrst set11 A = {x ∈ R | g(v) ⩽y} = {v2 ⩽y} = [−√y, √y] so that 
sans serif upper P left parenthesis upper W less than or slanted equals y right parenthesis equals sans serif upper P left parenthesis upper V element of upper A right parenthesis equals upper F Subscript upper V Baseline left parenthesis StartRoot y EndRoot right parenthesis minus upper F Subscript upper V Baseline left parenthesis minus StartRoot y EndRoot right parenthesis commaP(W ⩽y) = P(V ∈A) = FV (√y) −FV (−√y),
where we used the fact that V is a continuous rv. Differentiating we get: 
upper F prime Subscript upper W Baseline left parenthesis y right parenthesis equals f Subscript upper W Baseline left parenthesis y right parenthesis equals StartFraction 1 Over 2 StartRoot y EndRoot EndFraction left parenthesis f Subscript upper V Baseline left parenthesis StartRoot y EndRoot right parenthesis minus f Subscript upper V Baseline left parenthesis minus StartRoot y EndRoot right parenthesis right parenthesis periodF '
W(y) = fW(y) =
1
2√y
(
fV (√y) −fV (−√y)
)
.
Then, using V ∼ N(0, σ 2) we get the expression for the transformed density: 
StartLayout 1st Row 1st Column f Subscript upper W Baseline left parenthesis y right parenthesis 2nd Column equals 3rd Column StartFraction 1 Over 2 StartRoot y EndRoot EndFraction StartFraction 1 Over StartRoot 2 pi sigma squared EndRoot EndFraction left parenthesis minus e Superscript negative y divided by 2 sigma squared Baseline plus e Superscript negative y divided by 2 sigma squared Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction 1 Over StartRoot 2 pi sigma squared EndRoot EndFraction y Superscript negative 1 plus 1 divided by 2 Baseline e Superscript negative y divided by 2 sigma squared Baseline comma y greater than 0 period EndLayoutfW(y) =
1
2√y
1
√
2πσ 2
⎛
−e−y/2σ 2 + e−y/2σ 2⎞
=
1
√
2πσ 2 y−1+1/2e−y/2σ 2,
y > 0.
By comparing this density with that of a gamma rv we are done. 
Exercises of Chap. 6 
6.1 First, we check that this function is increasing in the variable x. Indeed, for 
x1 < x2 it holds FX(x1 | A) ⩽FX(x2 | A) because in formula (6.2) we have {X ⩽
x1} ⊂{X ⩽x2} for ﬁxed A ∈F. Second, right-continuity writes: 
StartLayout 1st Row 1st Column limit Underscript h down arrow 0 Endscripts upper F Subscript upper X Baseline left parenthesis x plus h vertical bar upper A right parenthesis 2nd Column equals 3rd Column limit Underscript n right arrow normal infinity Endscripts StartStartFraction sans serif upper P left parenthesis left brace upper X less than or slanted equals x plus StartFraction 1 Over n EndFraction right brace intersection upper A right parenthesis OverOver sans serif upper P left parenthesis upper A right parenthesis EndEndFraction 2nd Row 1st Column Blank 2nd Column equals Overscript cont period of sans serif upper P Endscripts 3rd Column StartStartFraction sans serif upper P left parenthesis limit Underscript n right arrow normal infinity Endscripts left brace upper X less than or slanted equals x plus StartFraction 1 Over n EndFraction right brace intersection upper A right parenthesis OverOver sans serif upper P left parenthesis upper A right parenthesis EndEndFraction equals upper F Subscript upper X Baseline left parenthesis x vertical bar upper A right parenthesis period EndLayout lim
h↓0 FX(x + h | A)
=
lim
n→∞
P
(
{X ⩽x + 1
n} ∩A
)
P(A)
cont. of P
=
P
(
limn→∞{X ⩽x + 1
n} ∩A
)
P(A)
= FX(x | A).
11 We cannot use formula (4.11) in Sect. 4.5, since  W = V 2 is not a monotone transform. 
Solutions to Exercises
319
The veriﬁcation that limx→−∞ FX(x | A) = 0 and limx→∞ FX(x | A) = 1 is done 
similarly. Eventually, P(a < X ⩽b | A) = FX(b | A) − FX(a | A) because {X ⩽
b} ∩ A equals the disjoint union of {X ⩽a} ∩ A and {a <  X ⩽b} ∩ A. 
6.2 It is easily to see fX | Y (x) ⩾0 for every x ∈ R and any y ∈ R s.t. the marginal 
fY (y) /= 0. Moreover: 
StartLayout 1st Row 1st Column integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript upper X vertical bar upper Y Baseline left parenthesis x right parenthesis normal d x 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline StartFraction f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis Over f Subscript upper Y Baseline left parenthesis y right parenthesis EndFraction normal d x 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction 1 Over f Subscript upper Y Baseline left parenthesis y right parenthesis EndFraction ModifyingBelow integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis normal d x With bottom brace Underscript equals f Subscript upper Y Baseline left parenthesis y right parenthesis Endscripts equals 1 period EndLayout
⎰∞
−∞
fX | Y (x)dx =
⎰∞
−∞
fX(x, y)
fY (y) dx
=
1
fY (y)
⎰∞
−∞
fX(x, y)dx
◟
◝ ◜
◞
=fY (y)
= 1.
6.3 By formula (6.19) we have  
sans serif upper E left parenthesis upper X vertical bar upper A right parenthesis equals sans serif upper E left parenthesis bold upper I Subscript upper B Baseline vertical bar upper A right parenthesis equals StartFraction sans serif upper E left parenthesis bold upper I Subscript upper B Baseline bold upper I Subscript upper A Baseline right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction equals StartFraction sans serif upper E left parenthesis bold upper I Subscript upper A intersection upper B Baseline right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction equals StartFraction sans serif upper P left parenthesis upper A intersection upper B right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction commaE(X | A) = E(IB | A) = E(IBIA)
P(A)
= E(IA∩B)
P(A)
= P(A ∩B)
P(A)
,
which entails conditional probability P(B | A). 
6.4 First, we observe that P(X = xi) = P(X = xi | A)P(A) + P(X = 
xi | Ac )P(Ac ), see the law of total probability. Thus, 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X right parenthesis 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript normal infinity Endscripts x Subscript i Baseline sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts x Subscript i Baseline sans serif upper P left parenthesis upper X equals x Subscript i Baseline vertical bar upper A right parenthesis sans serif upper P left parenthesis upper A right parenthesis 2nd Row 1st Column Blank 2nd Column Blank 3rd Column plus sigma summation Underscript i equals 1 Overscript normal infinity Endscripts x Subscript i Baseline sans serif upper P left parenthesis upper X equals x Subscript i Baseline vertical bar upper A Superscript c Baseline right parenthesis sans serif upper P left parenthesis upper A Superscript c Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper E left parenthesis upper X vertical bar upper A right parenthesis sans serif upper P left parenthesis upper A right parenthesis plus sans serif upper E left parenthesis upper X vertical bar upper A Superscript c Baseline right parenthesis sans serif upper P left parenthesis upper A Superscript c Baseline right parenthesis comma EndLayoutE(X) =
∞
⎲
i=1
xiP(X = xi) =
∞
⎲
i=1
xiP(X = xi | A)P(A)
+
∞
⎲
i=1
xiP(X = xi | Ac)P(Ac)
= E(X | A)P(A) + E(X | Ac)P(Ac),
since P(X = xi | A)P(A) = p(xi | A) and similarly for Ac. 
6.5 Let X has ﬁnite expectation so that also XIA ∈ L1. Assume P(A) > 0. Thus 
choose X = ID for any event D ∈F. We have:  
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper D vertical bar upper A right parenthesis 2nd Column equals 3rd Column StartFraction sans serif upper P left parenthesis upper D intersection upper A right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction equals StartFraction sans serif upper E left parenthesis bold upper I Subscript upper D intersection upper A Baseline right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction sans serif upper E left parenthesis bold upper I Subscript upper D Baseline bold upper I Subscript upper A Baseline right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction 3rd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction sans serif upper E left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction equals sans serif upper E left parenthesis bold upper I Subscript upper D Baseline vertical bar upper A right parenthesis EndLayoutP(D | A) = P(D∩A)
P(A)
= E(ID∩A)
P(A)
= E(IDIA)
P(A)
= E(XIA)
P(A)
= E(ID | A)
320
Solutions to Exercises
and formula (6.19) is proved for indicator rvs. Now, take a discrete rv X =
∑n 
i=1 xiIDi with pairwise disjoint events Di ∈F partitioning Ω. Hence: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X vertical bar upper A right parenthesis 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript n Endscripts x Subscript i Baseline sans serif upper P left parenthesis upper D Subscript i Baseline vertical bar upper A right parenthesis equals sigma summation Underscript i equals 1 Overscript n Endscripts StartFraction x Subscript i Baseline sans serif upper E left parenthesis bold upper I Subscript upper D Sub Subscript i Subscript Baseline bold upper I Subscript upper A Baseline right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction sans serif upper E left parenthesis left parenthesis sigma summation Underscript i equals 1 Overscript n Endscripts x Subscript i Baseline bold upper I Subscript upper D Sub Subscript i Subscript Baseline right parenthesis bold upper I Subscript upper A Baseline right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction equals StartFraction sans serif upper E left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction period EndLayoutE(X | A) =
n
⎲
i=1
xiP(Di | A) =
n
⎲
i=1
xiE(IDiIA)
P(A)
=
E
⎛
(∑n
i=1 xiIDi)IA
⎞
P(A)
= E(XIA)
P(A) .
Here we used the conditional distribution of X given by masses P(Di | A) =
P(Di∩A) 
P(A) , together with the previous deﬁnition E(IDi | A) = P(Di | A). Observe 
that we can take Di = {X = xi} for xi ∈ C = {x1, . . . , xn}. Eventually, let 
X = X+ − X− and take two sequences (X+
n )n∈N,(X−
n )n∈N converging pointwise 
to X+ and X− respectively. Then, we have X+
n IA → X+IA and X−
n IA → X−IA, 
pointwise and 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X vertical bar upper A right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis upper X Superscript plus Baseline vertical bar upper A right parenthesis minus sans serif upper E left parenthesis upper X Superscript minus Baseline vertical bar upper A right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column limit Underscript n Endscripts sans serif upper E left parenthesis upper X Subscript n Superscript plus Baseline vertical bar upper A right parenthesis minus limit Underscript n Endscripts sans serif upper E left parenthesis upper X Subscript n Superscript minus Baseline vertical bar upper A right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction sans serif upper E left parenthesis limit Underscript n Endscripts upper X Subscript n Superscript plus Baseline bold upper I Subscript upper A Baseline right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction minus StartFraction sans serif upper E left parenthesis limit Underscript n Endscripts upper X Subscript n Superscript minus Baseline bold upper I Subscript upper A Baseline right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction 4th Row 1st Column Blank 2nd Column equals 3rd Column StartFraction sans serif upper E left parenthesis upper X Superscript plus Baseline bold upper I Subscript upper A Baseline right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction minus StartFraction sans serif upper E left parenthesis upper X Superscript minus Baseline bold upper I Subscript upper A Baseline right parenthesis Over sans serif upper P left parenthesis upper A right parenthesis EndFraction period EndLayoutE(X | A) = E(X+ | A) −E(X−| A)
= lim
n E(X+
n | A) −lim
n E(X−
n | A)
= E(limn X+
n IA)
P(A)
−E(limn X−
n IA)
P(A)
= E(X+IA)
P(A)
−E(X−IA)
P(A)
.
The second equality follows from the MCT. 
6.6 By deﬁnition of Au we have: 
0 less than or slanted equals u bold upper I Subscript upper A Sub Subscript u Subscript Baseline less than or slanted equals upper X bold upper I Subscript upper A Sub Subscript u Subscript Baseline less than or slanted equals upper X period0 ⩽uIAu ⩽XIAu ⩽X.
Hence, applying expectation to all terms in the above chain of inequalities we get 
sans serif upper E left parenthesis u bold upper I Subscript upper A Sub Subscript u Subscript Baseline right parenthesis equals u sans serif upper P left parenthesis upper A Subscript u Baseline right parenthesis less than or slanted equals sans serif upper E left parenthesis upper X bold upper I Subscript upper A Sub Subscript u Subscript Baseline right parenthesis less than or slanted equals sans serif upper E left parenthesis upper X right parenthesis commaE(uIAu) = uP(Au) ⩽E(XIAu) ⩽E(X),
and after rearranging w.r.t. u we are done. 
6.7 Since Y is constant it holds {Y = c} = Ω. Hence E(X | Y) equals E(X | {Y = 
c}) = E(XIΩ) 
P(Ω) which is just E(X). Next,  E(IA | IB) = E(IA | {IB = 1}) for scenarios 
ω ∈ B. As byproduct, the last conditional expectation equals E(IA | B) = E(IAIB) 
P(B) , 
where E(IAIB) = E(IA∩B), which is P(A ∩ B) and we get the desired result. 
Observe that taking ω ∈ Bc we also get E(IA | IB) = E(IA | {IB = 0}) which 
equals P(A | Bc ).
Solutions to Exercises
321
6.8 Using conditional masses (6.10), we have: 
sans serif upper E left parenthesis upper X vertical bar upper Y equals y Subscript j Baseline right parenthesis equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts x Subscript i Baseline p left parenthesis x Subscript i Baseline vertical bar y Subscript j Baseline right parenthesis equals sigma summation Underscript i equals 1 Overscript normal infinity Endscripts x Subscript i Baseline StartFraction sans serif upper P left parenthesis upper X equals x Subscript i Baseline comma upper Y equals y Subscript j Baseline right parenthesis Over sans serif upper P left parenthesis upper Y equals y Subscript j Baseline right parenthesis EndFraction periodE(X | Y = yj) =
∞
⎲
i=1
xip(xi | yj) =
∞
⎲
i=1
xi
P(X = xi, Y = yj)
P(Y = yj)
.
Similarly, the conditional expectation of X given that a discrete random vector 
Y = (Y1, . . . , Yn) takes on values (c1, . . . , cn) ∈ Rn is the rv E(X | Y1, . . . , Yn) = 
f (Y1, . . . , Yn) which is constant over events {Y1 = c1, . . . , Yn = cn} with values 
sans serif upper E left parenthesis upper X vertical bar upper Y 1 equals c 1 comma ellipsis comma upper Y Subscript n Baseline equals c Subscript n Baseline right parenthesis equals f left parenthesis c 1 comma ellipsis comma c Subscript n Baseline right parenthesis periodE(X | Y1 = c1, . . . , Yn = cn) = f (c1, . . . , cn).
6.9 By change of variable formula, see 4.3 in Sect. 4.2, and using the distribution 
of Y we compute: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis sans serif upper E left parenthesis upper X vertical bar upper Y right parenthesis right parenthesis 2nd Column equals 3rd Column sigma summation Underscript j equals 1 Overscript normal infinity Endscripts sans serif upper E left parenthesis upper X vertical bar upper Y equals y Subscript j Baseline right parenthesis sans serif upper P left parenthesis upper Y equals y Subscript j Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript j equals 1 Overscript normal infinity Endscripts sigma summation Underscript i equals 1 Overscript normal infinity Endscripts x Subscript i Baseline sans serif upper P left parenthesis upper X equals x Subscript i Baseline comma upper Y equals y Subscript j Baseline right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript normal infinity Endscripts x Subscript i Baseline sans serif upper P left parenthesis upper X equals x Subscript i Baseline right parenthesis equals sans serif upper E left parenthesis upper X right parenthesis comma EndLayoutE (E(X | Y)) =
∞
⎲
j=1
E(X | Y = yj)P(Y = yj)
=
∞
⎲
j=1
∞
⎲
i=1
xiP(X = xi, Y = yj)
=
∞
⎲
i=1
xiP(X = xi) = E(X),
thus E(E(X | Y)) coincides with expectation of X. Observe that we tacitly assumed 
that X = (X, Y) is a discrete random vector with joint distribution given by masses. 
6.10 Since X = (X, Y) is a continuous random vector having continuous joint 
density fX(x, y), with a similar reasoning as in the case X, Y are both discrete we 
write 
sans serif upper E left parenthesis upper X vertical bar upper Y equals y right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline x f Subscript upper X vertical bar upper Y Baseline left parenthesis x vertical bar y right parenthesis normal d x commaE(X | Y = y) =
⎰∞
−∞
xfX | Y (x | y)dx,
as the value of E(X | Y) at y. Recall that fX | Y (x | y) = fX(x,y) 
fY (y) provided that 
fY (y) > 0. Now, f (Y)  = E(X | Y) is a continuous rv. Furthermore we have 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis sans serif upper E left parenthesis upper X vertical bar upper Y right parenthesis right parenthesis 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline left parenthesis integral Subscript negative normal infinity Superscript normal infinity Baseline x f Subscript upper X vertical bar upper Y Baseline left parenthesis x right parenthesis normal d x right parenthesis f Subscript upper Y Baseline left parenthesis y right parenthesis normal d y 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline x f Subscript upper X Baseline left parenthesis x right parenthesis normal d x equals sans serif upper E left parenthesis upper X right parenthesis comma EndLayoutE (E(X | Y)) =
⎰∞
−∞
⎛⎰∞
−∞
xfX | Y (x)dx
⎞
fY (y)dy
=
⎰∞
−∞
xfX(x)dx = E(X),
since fX | Y (x)fY (y) = fX(x, y) and the integral of the joint density for all y is just 
the marginal of X.
322
Solutions to Exercises
6.11 Items 1 and 2 are easy: take p(xi | yj) = P(X = xi) and fX | Y (x | y) = fX(x) 
in the calculations showed in the solutions to Exercises 6.9 and 6.10. For item 3 we 
have: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X vertical bar upper Y equals y Subscript j Baseline right parenthesis 2nd Column equals 3rd Column StartFraction sans serif upper E left parenthesis upper X bold upper I Subscript left brace upper Y equals y Sub Subscript j Subscript right brace Baseline right parenthesis Over sans serif upper P left parenthesis upper Y equals y Subscript j Baseline right parenthesis EndFraction 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction sans serif upper E left parenthesis upper X right parenthesis sans serif upper E left parenthesis bold upper I Subscript left brace upper Y equals y Sub Subscript j Subscript right brace Baseline right parenthesis Over sans serif upper P left parenthesis upper Y equals y Subscript j Baseline right parenthesis EndFraction equals sans serif upper E left parenthesis upper X right parenthesis period EndLayoutE(X | Y = yj) =
E(XI{Y=yj })
P(Y = yj)
=
E(X)E(I{Y=yj })
P(Y = yj)
= E(X).
6.12 First we note that if Y is discrete, then σ(Y) is the smallest σ-algebra 
containing events {Y = yj}, thus any other event can be represented by countable or 
even ﬁnite unions ∪j{Y = yj}. E.g., {a <  Y ⩽b} for a, b ∈ R can be given by the 
countable union ∪i∈I{Y = yi} where the index set is I = {j ∈ N | a <  yj ⩽b}. 
It follows {a <  Y ⩽b} ∈ σ(Y). Moreover, pairwise disjoint events form a partition 
of Ω, and since E(X | Y) evaluated at yi is constant over these events its σ(Y)-
measurability follows. Next, pick A = ∪i∈I{Y = yi} ∈ σ(Y) and observe that 
E(XIA) = E
⎛
X ∑
j∈I I{Y=yj }
⎞
, because the disjoint union of events {Y = yj} in 
the indicator IA yields the countable sum of I{Y=yj }. The last expectation equals
∑
j∈I E(XI{Y=yj }). But  
sans serif upper E left parenthesis sans serif upper E left parenthesis upper X vertical bar upper Y right parenthesis bold upper I Subscript upper A Baseline right parenthesis equals sigma summation Underscript j element of upper I Endscripts sans serif upper E left parenthesis upper X vertical bar upper Y equals y Subscript j Baseline right parenthesis sans serif upper P left parenthesis upper Y equals y Subscript j Baseline right parenthesis equals sigma summation Underscript j element of upper I Endscripts sans serif upper E left parenthesis upper X bold upper I Subscript left brace upper Y equals y Sub Subscript j Subscript right brace Baseline right parenthesis commaE (E(X | Y)IA) =
⎲
j∈I
E(X | Y = yj)P(Y = yj) =
⎲
j∈I
E(XI{Y=yj }),
since by deﬁnition E(X | Y = yj) = 
E(XI{Y=yj }) 
P(Y=yj ) . This implies that E(XIA) = 
E (E(X | Y)IA). 
6.13 Consider A = {X ⩾c} ∈A for any c >  0. We have 
0 less than or slanted equals c sans serif upper P left parenthesis upper A right parenthesis equals c sans serif upper E left parenthesis bold upper I Subscript upper A Baseline right parenthesis less than or slanted equals sans serif upper E left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesis equals 0 comma0 ⩽c P(A) = c E(IA) ⩽E(XIA) = 0,
where the last equality holds by assumption. Then we must have P(A) = 0. If we 
take A = {X ⩽−c} the probability is again zero. It follows that P(−c <  X  <  c)  = 
1 for every c >  0. We choose c small enough, P(−1 
n < X  <  1 
n ) = 1 for  n ∈ N. The 
event {X = 0} is the countable intersection ∩∞
n=1{−1 
n < X  <  1 
n} of the decreasing 
sequence of events {−1 
n < X  <  1 
n} ⊃{− 1 
n+1 < X  <  1 
n+1} and continuity of P( · ) 
yields 
sans serif upper P left parenthesis upper X equals 0 right parenthesis equals limit Underscript n right arrow normal infinity Endscripts sans serif upper P left parenthesis minus StartFraction 1 Over n EndFraction less than upper X less than StartFraction 1 Over n EndFraction right parenthesis equals limit Underscript n right arrow normal infinity Endscripts 1 equals 1 commaP(X = 0) = lim
n→∞P(−1
n < X < 1
n) = lim
n→∞1 = 1,
which means X a.s.
= 0 as required. 
6.14 By Exercise 6.13 and its solution, we simply have to show that if X a.s.
= X', 
then E(X | Y) a.s.
= E(X' | Y). In fact, suppose X and X' are σ(Y)-measurable
Solutions to Exercises
323
versions of the X’s expectation conditioned on Y. Then, we have X − X' a.s.
= 0 
and 
sans serif upper E left parenthesis left parenthesis upper X minus upper X Superscript prime Baseline right parenthesis bold upper I Subscript upper A Baseline right parenthesis equals 0 long left right double arrow sans serif upper E left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesis equals sans serif upper E left parenthesis upper X prime bold upper I Subscript upper A Baseline right parenthesis for all upper A element of script upper A subset of script upper F periodE((X −X')IA) = 0 ⇐⇒E(XIA) = E(X'IA) for all A ∈A ⊂F.
(6.6) 
This yields E(X | Y) a.s.
= E(X' | Y). 
6.15 Since Z = E(X | Y) ≡ E(X | σ(Y)), we must exhibit a Borel measurable 
function f : R → R s.t. Z = f (Y), and for every event A ∈ σ(Y) the unconditional 
expectations of XIA and ZIA are equal. We choose A = {Y ∈ B} which is surely in 
σ(Y), then recall that X = (X, Y) has a joint density fX(x, y) and 
sans serif upper E left parenthesis upper X right parenthesis equals integral Subscript negative normal infinity Superscript normal infinity Baseline x f Subscript upper X Baseline left parenthesis x right parenthesis normal d x equals integral Subscript negative normal infinity Superscript normal infinity Baseline x left bracket integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis normal d y right bracket normal d x commaE(X) =
⎰∞
−∞
xfX(x)dx =
⎰∞
−∞
x
⎾⎰∞
−∞
fX(x, y)dy
⏋
dx,
since X has univariate density given by integrating the joint density w.r.t. Y. The  
same applies to E(Y). Therefore, integrating over a subset and interchanging the 
order of integration we can compute: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X bold upper I Subscript left brace upper Y element of upper B right brace Baseline right parenthesis 2nd Column equals 3rd Column integral Underscript upper B Endscripts integral Subscript negative normal infinity Superscript normal infinity Baseline x f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis normal d y normal d x 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Underscript upper B Endscripts left bracket integral Subscript negative normal infinity Superscript normal infinity Baseline x f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis normal d x right bracket normal d y period EndLayoutE(XI{Y∈B}) =
⎰
B
⎰∞
−∞
xfX(x, y)dydx
=
⎰
B
⎾⎰∞
−∞
xfX(x, y)dx
⏋
dy.
Moreover, using the change of variable formula we compute: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis f left parenthesis upper Y right parenthesis bold upper I Subscript left brace upper Y element of upper B right brace Baseline right parenthesis 2nd Column equals 3rd Column integral Underscript upper B Endscripts integral Subscript negative normal infinity Superscript normal infinity Baseline f left parenthesis y right parenthesis f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis normal d x normal d y 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Underscript upper B Endscripts f left parenthesis y right parenthesis left bracket integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis normal d x right bracket normal d y period EndLayoutE(f (Y)I{Y∈B}) =
⎰
B
⎰∞
−∞
f (y)fX(x, y)dxdy
=
⎰
B
f (y)
⎾⎰∞
−∞
fX(x, y)dx
⏋
dy.
By deﬁnition of conditional expectation given a rv, for every Borel set B, both 
unconditional expectations must be equal which implies 
f left parenthesis y right parenthesis equals StartFraction integral Subscript negative normal infinity Superscript normal infinity Baseline x f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis normal d x Over integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis normal d x EndFraction periodf (y) =
⎰∞
−∞xfX(x, y)dx
⎰∞
−∞fX(x, y)dx .
Evaluating f ( · ) at the rv Y the proof is complete. 
6.16 For A = ∅ formula (6.22), 
ModifyingAbove sans serif upper P With tilde left parenthesis upper A right parenthesis equals sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesis comma with sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X right parenthesis equals 1 comma ˜P(A) = EP(XIA),
with EP(X) = 1,
324
Solutions to Exercises
yields ˜P(∅) = EP(XI∅) = 0. The same is true for the certain event Ω. It remains 
to show this holds for any other event A ∈ F, and additionally to prove countable 
additivity of ˜P. Let  X = ∑n 
j=1 xjIGj be a nonnegative discrete rv, and for a 
pairwise disjoint sequence (Ai)i∈N ⊂F take IA = I∪m 
i=1Ai = ∑m 
i=1 IAi . Recall that 
XIA is also nonnegative discrete, and XIA = ∑n 
j=1 xjIGj ∩A. Whence we have: 
StartLayout 1st Row 1st Column ModifyingAbove sans serif upper P With tilde left parenthesis upper A right parenthesis 2nd Column equals 3rd Column sigma summation Underscript j Endscripts x Subscript j Baseline sans serif upper P left parenthesis upper G Subscript j Baseline intersection left parenthesis union Subscript i Baseline upper A Subscript i Baseline right parenthesis right parenthesis equals sigma summation Underscript j Endscripts x Subscript j Baseline sigma summation Underscript i Endscripts sans serif upper P left parenthesis upper G Subscript j Baseline intersection upper A Subscript i Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript i Endscripts sigma summation Underscript j Endscripts x Subscript j Baseline sans serif upper P left parenthesis upper G Subscript j Baseline intersection upper A Subscript i Baseline right parenthesis equals sigma summation Underscript i Endscripts sans serif upper E left parenthesis upper X bold upper I Subscript upper A Sub Subscript i Subscript Baseline right parenthesis equals sigma summation Underscript i Endscripts ModifyingAbove sans serif upper P With tilde left parenthesis upper A Subscript i Baseline right parenthesis period EndLayout˜P(A) =
⎲
j
xjP(Gj ∩(∪iAi)) =
⎲
j
xj
⎲
i
P(Gj ∩Ai)
=
⎲
i
⎲
j
xjP(Gj ∩Ai) =
⎲
i
E(XIAi) =
⎲
i
˜P(Ai).
If X
⩾
0 we pick a pairwise disjoint sequence (Bk)k∈N 
⊂ F such that 
Am = ∪m 
k=1Bk and A1 ⊂ A2 ⊂ · · ·  is an increasing sequence in F with 
limit Am ↑ A = ∪mAm. This implies that 0 ⩽IA1 ⩽IA2 ⩽· · ·  converges 
pointwise, limm→∞ IAm = IA. Then: ˜P(A) = E(XIA) = limm→∞ E(XIAm) = 
limm→∞
∑m 
k=1 E(XIBk ) = limm→∞
∑m 
k=1 ˜P(Bk) = ∑∞ 
k=1 ˜P(Bk) = ˜P(A), where 
we used MCT in the second equality, the identity A = ∪∞
m=1Am = ∪∞
k=1Bk and 
the fact that IAm = ∑m 
k=1 IBk. Note how moving from Am to Am+1 = Am ∪ Bm+1 
if ω ∈ Bm+1 then IAm+1 = 1 and IAm = 0, for otherwise both indicators are 1 or 
zero. On the other hand, to show that ˜P ⪡P we proceed as follows. Start from a 
nonnegative discrete X = ∑n 
i=1 xiIGi and pairwise disjoint events A1, . . . , An in 
F, thus assume P(A) = 0 for  A ∈F. Since IA = I∪m 
j=1Aj = ∑m 
j=1 IAj then 
upper X bold upper I Subscript upper A Baseline equals sigma summation Underscript i equals 1 Overscript n Endscripts x Subscript i Baseline bold upper I Subscript upper G Sub Subscript i Subscript intersection upper A Baseline equals sigma summation Underscript i equals 1 Overscript n Endscripts x Subscript i Baseline bold upper I Subscript union Sub Subscript i equals 1 Sub Superscript m Subscript left parenthesis upper G Sub Subscript i Subscript intersection upper A Sub Subscript j Subscript right parenthesis Baseline equals sigma summation Underscript i equals 1 Overscript n Endscripts x Subscript i Baseline sigma summation Underscript j equals 1 Overscript m Endscripts bold upper I Subscript upper G Sub Subscript i Subscript intersection upper A Sub Subscript j Subscript Baseline commaXIA =
n
⎲
i=1
xiIGi∩A =
n
⎲
i=1
xiI∪m
i=1(Gi∩Aj ) =
n
⎲
i=1
xi
m
⎲
j=1
IGi∩Aj ,
and the latter equals ∑n 
i=1
∑m 
j=1 xiIGi∩Aj . Now, we have  
sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesis equals sigma summation Underscript i equals 1 Overscript n Endscripts sigma summation Underscript j equals 1 Overscript m Endscripts x Subscript i Baseline sans serif upper P left parenthesis upper G Subscript i Baseline intersection upper A Subscript j Baseline right parenthesis commaEP(XIA) =
n
⎲
i=1
m
⎲
j=1
xiP(Gi ∩Aj),
but since Aj ⊂ A each j and 0 ⩽P(Aj) ⩽P(A) = 0 we also have 0 ⩽P(Gi ∩ 
Aj) ⩽P(A) = 0, i.e. P(Gi ∩ Aj) = 0. Thus ˜P(A) = EP(XIA) = 0. For general 
X ⩾0 we write  
ModifyingAbove sans serif upper P With tilde left parenthesis upper A right parenthesis equals sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesis equals sup Underscript StartSet 0 less than or slanted equals upper Z less than or slanted equals upper X comma upper Z discrete EndSet Endscripts sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper Z bold upper I Subscript upper A Baseline right parenthesis comma˜P(A) = EP(XIA) =
sup
{0⩽Z⩽X, Z discrete}
EP(ZIA),
but the supremum is zero because each EP(ZIA) = 0.
Solutions to Exercises
325
6.17 First, assume X ⩾0 and recall that ˜P(A) = EP(XIA) is a measure such that 
˜P ⪡P, see Exercise 6.16. Now, we have  EP(XIA) = ˜P(A) = EP( d ˜P 
dPIA) which 
is item 3 of Theorem 6.2. Taking A = Ω and assuming EP(X) = 1 we have that 
XIA ∈ L1, then d ˜P 
dP has also ﬁnite expectation and it is a version of EP(X | A). For 
the general case, we apply the previous result to the positive and negative parts of 
X. Hence, Z1 = EP(X+ | A) and Z2 = EP(X−| A) are well deﬁned. Now, write 
Z1 − Z2 and observe this is a rv with ﬁnite expectation EP. Then, for every A ∈A 
we have 
StartLayout 1st Row 1st Column sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X bold upper I Subscript upper A Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X Superscript plus Baseline bold upper I Subscript upper A Baseline right parenthesis minus sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X Superscript minus Baseline bold upper I Subscript upper A Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper Z 1 bold upper I Subscript upper A Baseline right parenthesis minus sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper Z 2 bold upper I Subscript upper A Baseline right parenthesis equals sans serif upper E Subscript sans serif upper P Baseline left parenthesis left parenthesis upper Z 1 minus upper Z 2 right parenthesis bold upper I Subscript upper A Baseline right parenthesis period EndLayoutEP(XIA) = EP(X+IA) −EP(X−IA)
= EP(Z1IA) −EP(Z2IA) = EP((Z1 −Z2)IA).
We conclude Z1 − Z2 ∈ L1 satisﬁes property 3 of Theorem 6.2 and is a version of 
the expectation of X conditional on the sub-σ-algebra A. 
6.18 For the case X = IA we easily have E ˜P(X) = ˜P(A) = EP(IAY), for  
every A ∈ F. Passing to a nonnegative discrete X = ∑m 
i=1 xiIAi, where events 
Ai partition the sample space, we additionally have: 
StartLayout 1st Row 1st Column sans serif upper E Subscript ModifyingAbove sans serif upper P With tilde Baseline left parenthesis upper X right parenthesis 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript m Endscripts x Subscript i Baseline ModifyingAbove sans serif upper P With tilde left parenthesis upper A Subscript i Baseline right parenthesis equals sigma summation Underscript i equals 1 Overscript m Endscripts x Subscript i Baseline sans serif upper E Subscript ModifyingAbove sans serif upper P With tilde Baseline left parenthesis bold upper I Subscript upper A Sub Subscript i Subscript Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sigma summation Underscript i equals 1 Overscript m Endscripts x Subscript i Baseline sans serif upper E Subscript sans serif upper P Baseline left parenthesis bold upper I Subscript upper A Sub Subscript i Subscript Baseline upper Y right parenthesis equals Overscript linear period of exp period Endscripts sans serif upper E Subscript sans serif upper P Baseline left parenthesis sigma summation Underscript i equals 1 Overscript m Endscripts x Subscript i Baseline bold upper I Subscript upper A Sub Subscript i Subscript Baseline upper Y right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X upper Y right parenthesis period EndLayoutE ˜P(X) =
m
⎲
i=1
xi ˜P(Ai) =
m
⎲
i=1
xiE ˜P(IAi)
=
m
⎲
i=1
xiEP(IAiY)
linear. of exp.
=
EP
⎛m
⎲
i=1
xiIAiY
⎞
= EP(XY).
For nonnegative X ⩾0, pick a sequence of nonnegative discrete rvs 0 ⩽X1 ⩽
X2 ⩽· · ·  increasing pointwise to X. Since we showed E ˜P(Xn) = EP(XnY) now it 
follows: 
StartLayout 1st Row 1st Column sans serif upper E Subscript sans serif upper P overTilde Baseline left parenthesis upper X right parenthesis 2nd Column equals 3rd Column sans serif upper E Subscript sans serif upper P overTilde Baseline left parenthesis limit Underscript n Endscripts upper X Subscript n Baseline right parenthesis equals Overscript MCT Endscripts limit Underscript n Endscripts sans serif upper E Subscript sans serif upper P overTilde Baseline left parenthesis upper X Subscript n Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column limit Underscript n Endscripts sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X Subscript n Baseline upper Y right parenthesis equals Overscript MCT Endscripts sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X upper Y right parenthesis period EndLayoutE ˜P(X) = E ˜P(lim
n Xn) MCT
= lim
n E ˜P(Xn)
= lim
n EP(XnY) MCT
= EP(XY).
For a general rv X we have E ˜P(X+) = EP(X+Y) and E ˜P(X−) = EP(X−Y). Thus 
we get: 
sans serif upper E Subscript sans serif upper P overTilde Baseline left parenthesis upper X right parenthesis equals sans serif upper E Subscript sans serif upper P overTilde Baseline left parenthesis upper X Superscript plus Baseline right parenthesis minus sans serif upper E Subscript sans serif upper P overTilde Baseline left parenthesis upper X Superscript minus Baseline right parenthesis equals sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X Superscript plus Baseline upper Y right parenthesis minus sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X Superscript minus Baseline upper Y right parenthesis equals sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper X upper Y right parenthesis commaE ˜P(X) = E ˜P(X+) −E ˜P(X−) = EP(X+Y) −EP(X−Y) = EP(XY),
provided that both sides are ﬁnite. 
6.19 By assumption we have X 
Y ⩾0. By Exercise 6.18, formula (6.25) can be 
written with X replaced by X 
Y and now formula (6.26) easily follows.
326
Solutions to Exercises
6.20 We have EP(X) = sup
{
EP(Z) | 0 ⩽Z ⩽X
}
, for a simple rv Z =
∑k 
i=1 ziIAi ⩾0, where events A1, . . . , Ak form a partition of Ω. By assumption 
P(A) = 0, it follows P(A ∩ Ai) = 0 each i and then 
sans serif upper E Subscript sans serif upper P Baseline left parenthesis upper Z bold upper I Subscript upper A Baseline right parenthesis equals sigma summation Underscript i equals 1 Overscript k Endscripts z Subscript k Baseline sans serif upper P left parenthesis upper A intersection upper A Subscript i Baseline right parenthesis equals 0 periodEP(ZIA) =
k
⎲
i=1
zkP(A ∩Ai) = 0.
The supremum of
{
EP(Z) | 0 ⩽Z ⩽X
}
is also zero. We conclude that ˜P(A) = 
EP(XIA) = 0 so  ˜P ⪡P. 
6.21 If A = {∅, Ω} only the constant rvs induce events in A, i.e., they are 
A-measurable, and trivially admit ﬁnite expectation. Then, items 1 and 2 of 
Theorem 6.2 are proved. We check item 3 for A = ∅, Ω:
•
E(XI∅) = 0 = E(E(X)I∅),
•
E(XIΩ) = E(X) = E(E(X)IΩ). 
As a consequence we have E(X | A) a.s.
= E(X). If A = F, then E(X | F) induces 
events in F and item 3 holds for any A ∈ F. This implies that E(X | F) must be 
equal to X or any other rv Y a.s.
= X and we are done. 
6.22 Let Z = E(X | A) and G = {Z >  0} ∈ A, since Z is A-measurable. Write 
condition 3 of Theorem 6.2 for G and Gc , 
sans serif upper E left parenthesis upper Z bold upper I Subscript upper G Baseline right parenthesis equals sans serif upper E left parenthesis upper X bold upper I Subscript upper G Baseline right parenthesis less than or slanted equals sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue bold upper I Subscript upper G Baseline right parenthesis comma sans serif upper E left parenthesis minus upper Z bold upper I Subscript upper G Sub Superscript c Subscript Baseline right parenthesis equals sans serif upper E left parenthesis minus upper X bold upper I Subscript upper G Sub Superscript c Subscript Baseline right parenthesis less than or slanted equals sans serif upper E left parenthesis StartAbsoluteValue upper X EndAbsoluteValue bold upper I Subscript upper G Sub Superscript c Subscript Baseline right parenthesis commaE(ZIG) = E(XIG) ⩽E(|X|IG),
E(−ZIGc) = E(−XIGc) ⩽E(|X|IGc),
where the two inequalities above are a consequence of Jensen’s inequality, while 
E(ZIG) >  0 and E(−ZIGc) ⩾by the choice of G (note that Gc = {Y ⩽0}). Since 
X ∈ L1 by assumption, we have E(|X|IG) and E(|X|IGc) are both ﬁnite. Adding 
each other we ﬁnally have E(|Z|) ⩽E(|X|) <  ∞, then Z ∈ L1 as required. 
6.23 We show ﬁrst E
(
E(X | A) | H
) a.s.
= E(X | H). Fix an event A ∈ H ⊂ A, then 
use item 4 of Proposition 6.1 with Y = IA, 
sans serif upper E left parenthesis sans serif upper E left parenthesis upper X vertical bar script upper A right parenthesis vertical bar script upper H right parenthesis bold upper I Subscript upper A Baseline equals sans serif upper E left parenthesis bold upper I Subscript upper A Baseline sans serif upper E left parenthesis upper X vertical bar script upper A right parenthesis vertical bar script upper H right parenthesis commaE
(
E(X | A) | H
)
IA = E
(
IAE(X | A) | H
)
,
since σ(IA) ⊂ H and IA is H-measurable. But IA is also A-measurable, thus 
the last term on the right-hand side above becomes E (E(XIA | A) | H). Let Z' = 
E(XIA | A) and Z'' = E
(
E(X | A) | H
)
, using the above and taking expectation: 
sans serif upper E left parenthesis upper Z double prime bold upper I Subscript upper A Baseline right parenthesis equals sans serif upper E left parenthesis sans serif upper E left parenthesis upper Z prime vertical bar script upper H right parenthesis right parenthesis periodE(Z''IA) = E
(
E(Z' | H)
)
.
(**) 
Applying twice the property E(E(X | A)) = E(X), the right-hand term in (**) is  
now E(XIA). Then, by property (iii) of theorem 6.2 with Z = E(X | H) we have 
Z'' = Z by a.s. uniqueness. For the other equality in item 3 of Proposition 6.1,
Solutions to Exercises
327
consider property 4 of the same Proposition and write: 
sans serif upper E left parenthesis sans serif upper E left parenthesis upper X vertical bar script upper H right parenthesis vertical bar script upper A right parenthesis equals sans serif upper E left parenthesis upper X vertical bar script upper H right parenthesis sans serif upper E left parenthesis 1 vertical bar script upper A right parenthesis equals sans serif upper E left parenthesis upper X vertical bar script upper H right parenthesis periodE
(
E(X | H) | A
)
= E(X | H)E(1 | A) = E(X | H).
Indeed, the random variable Z = E(X | H) has generated σ-algebra σ(Z) ⊂ H ⊂ 
A. Then, Z is A-measurable and we can treat it as a constant. 
Exercises of Chap. 7 
7.1 Take the expectation of both sides of (7.2) and use property (6) of conditional 
expectation: 
sans serif upper E left parenthesis sans serif upper V left parenthesis upper Y vertical bar upper X right parenthesis right parenthesis equals sans serif upper E left parenthesis upper Y squared right parenthesis minus sans serif upper E left parenthesis StartSet sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesis EndSet squared right parenthesis periodE(V(Y | X)) = E(Y 2) −E
⎛
{E(Y | X)}2⎞
.
(6) 
Now, write the variance of the rv E(Y | X) : 
StartLayout 1st Row 1st Column sans serif upper V left parenthesis sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesis right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis StartSet sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesis EndSet squared right parenthesis minus StartSet sans serif upper E left parenthesis sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesis right parenthesis EndSet squared 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper E left parenthesis StartSet sans serif upper E left parenthesis upper Y vertical bar upper X right parenthesis EndSet squared right parenthesis minus StartSet sans serif upper E left parenthesis upper Y right parenthesis EndSet squared comma EndLayoutV (E(Y | X)) = E
⎛
{E(Y | X)}2⎞
−{E(E(Y | X))}2
= E
⎛
{E(Y | X)}2⎞
−{E(Y)}2 ,
(7) 
where we used property (6) again. Eventually, adding all sides of Eqs. (6) and (7) 
will complete the proof. 
7.2 Let W = E(Y | A) we have: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis left parenthesis upper Y minus upper Z right parenthesis squared right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis left parenthesis upper Y minus upper W plus upper W minus upper Z right parenthesis squared right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper E left parenthesis left parenthesis upper Y minus upper W right parenthesis squared right parenthesis plus 2 sans serif upper E left parenthesis left parenthesis upper Y minus upper W right parenthesis left parenthesis upper W minus upper Z right parenthesis right parenthesis 3rd Row 1st Column Blank 2nd Column plus 3rd Column sans serif upper E left parenthesis left parenthesis upper W minus upper Z right parenthesis squared right parenthesis period EndLayoutE((Y −Z)2) = E((Y −W + W −Z)2)
= E((Y −W)2) + 2E((Y −W)(W −Z))
+ E((W −Z)2).
Now, E((Y − W)(W − Z)) equals E (E((Y − W)(W −Z) | A)) by the tower 
property, and this in turn equals E ((W − Z)E((Y −W) | A)) taking out what 
is known (i.e. the A-measurable rv W − Z). Further, write E((Y − W) | A) as 
E(Y | A) − WE(1 | A) which is W − W = 0. We conclude the minimum of 
E((Y − Z)2) is at Z = W. 
7.3 Assume μX = μY = 0 and σX = σY = 1. Observe that V(X) = E(X2), 
V(Y) = E(Y 2), and both are equal to 1. Moreover, cov(X,Y) 
σXσY 
= corr(X, Y) = ρ. 
Now, let 
g left parenthesis a comma b right parenthesis equals sans serif upper E left parenthesis left brace upper Y minus left parenthesis a plus b upper X right parenthesis right brace squared right parenthesisg(a, b) = E
⎛
{Y −(a + bX)}2⎞
328
Solutions to Exercises
and compute 
StartLayout 1st Row 1st Column g left parenthesis a comma b right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis upper Y squared right parenthesis plus sans serif upper E left parenthesis minus 2 a upper Y minus 2 b upper X upper Y right parenthesis plus sans serif upper E left parenthesis a squared plus 2 a b upper X plus b squared upper X squared right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper V left parenthesis upper Y right parenthesis minus 2 b rho plus a squared plus b squared sans serif upper V left parenthesis upper X right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column 1 plus a squared plus b left parenthesis b minus 2 rho right parenthesis period EndLayoutg(a, b) = E(Y 2) + E(−2aY −2bXY) + E(a2 + 2abX + b2X2)
= V(Y) −2bρ + a2 + b2V(X)
= 1 + a2 + b(b −2ρ).
Hence, to ﬁnd the minimum we also compute the partials and set them to zero: 
StartLayout 1st Row 1st Column StartFraction partial differential Over partial differential a EndFraction equals 2 a 2nd Column equals 3rd Column 0 long left right double arrow a equals 0 2nd Row 1st Column StartFraction partial differential Over partial differential b EndFraction equals 2 b minus 2 rho 2nd Column equals 3rd Column 0 long left right double arrow b equals rho period EndLayout ∂
∂a = 2a = 0 ⇐⇒a = 0
∂
∂b = 2b −2ρ = 0 ⇐⇒b = ρ.
Thus, the minimizer is 1 − ρ2, and the linear predictor is Y = f (X)  = ρX and we 
are done. For the general case, we just consider the standardized versions of X, Y, 
then set 
StartFraction upper X minus mu Subscript upper X Baseline Over sigma Subscript upper X Baseline EndFraction equals rho StartFraction upper Y minus mu Subscript upper Y Baseline Over sigma Subscript upper Y Baseline EndFraction commaX −μX
σX
= ρ Y −μY
σY
,
and eventually rearrange for Y to get Eq. (7.5). 
7.4 Replace X with X − E(X) and Y with Y − E(Y). Next, observe that 
sans serif upper V left parenthesis upper X right parenthesis equals sans serif upper E left parenthesis left parenthesis upper X minus sans serif upper E left parenthesis upper X right parenthesis right parenthesis squared right parenthesis equals sans serif upper E left parenthesis upper X squared minus 2 upper X sans serif upper E left parenthesis upper X right parenthesis plus left parenthesis sans serif upper E left parenthesis upper X right parenthesis right parenthesis squared right parenthesis commaV(X) = E
(
(X −E(X))2)
= E
(
X2 −2XE(X) + (E(X))2)
,
and the same is true for Y. Thus, applying the Cauchy-Schwarz inequality with the 
above change of variable we get 
StartAbsoluteValue StartFraction sans serif upper E left parenthesis left parenthesis upper X minus sans serif upper E left parenthesis upper X right parenthesis right parenthesis left parenthesis upper Y minus sans serif upper E left parenthesis upper Y right parenthesis right parenthesis right parenthesis Over StartRoot sans serif upper E left parenthesis left parenthesis upper X minus sans serif upper E left parenthesis upper X right parenthesis right parenthesis squared right parenthesis sans serif upper E left parenthesis left parenthesis upper Y minus sans serif upper E left parenthesis upper Y right parenthesis right parenthesis squared right parenthesis EndRoot EndFraction EndAbsoluteValue less than or slanted equals 1 period
||||||
E
⎛
(X −E(X))(Y −E(Y))
⎞
/
E
(
(X −E(X))2)
E
(
(Y −E(Y))2)
||||||
⩽1.
In fact E
(
(X − E(X))(Y − E(Y))
)
= cov(X, Y). Next, observe that V(a + bX) = 
b2V(X) and the same is true for Y. Use formula cov(X, Y) = E(XY) −E(X)E(Y) 
to get cov(a +bX, c +dY) = b d  cov(X, Y) after some tedious algebra, and ﬁnally 
corr(a + bX, c + dY) = 
b d  cov(X,Y)
√
b2d2V(X)V(Y) = |b d| cov(X,Y) 
b d  √V(X)V(Y) . 
7.5 For the joint event {Y ⩽y} ∩{Z ⩽z} we have two cases: 
1. {Y ⩽y} := {ω | Y(ω) = a ⩽y} is just Ω if y ⩾a; 
2. {Y ⩽y} =  ∅ if y <  a. 
In case 1 the joint event reduces to {Z ⩽z}, and in case 2 it reduces to ∅. Applying 
P( · ) to the joint event we see that its value always equals P(Y ⩽y)P(Z ⩽z). 
We know that for two independent rvs X, Y and two suitable functions g, h : R → 
it holds E(g(X)h(Y)) = E(g(X))E(h(Y)). Then choosing g(x) = h(x) = x we
Solutions to Exercises
329
additionally get that the expectation of XY is equal to the product of the expectations 
of X and Y alone. Since we have proved that the degenerate rv Y = a and the rv 
Z = b X  are independent then: 
StartLayout 1st Row 1st Column sans serif upper V left parenthesis upper Y plus upper Z right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis left parenthesis upper Y plus upper Z right parenthesis squared right parenthesis minus left parenthesis sans serif upper E left parenthesis upper Y plus upper Z right parenthesis right parenthesis squared 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper E left parenthesis upper Y squared plus 2 upper Y upper Z plus upper Z squared right parenthesis minus left parenthesis sans serif upper E left parenthesis upper Y right parenthesis right parenthesis squared minus left parenthesis sans serif upper E left parenthesis upper Z right parenthesis right parenthesis squared minus 2 sans serif upper E left parenthesis upper Y right parenthesis sans serif upper E left parenthesis upper Z right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper E left parenthesis upper Y squared right parenthesis minus left parenthesis sans serif upper E left parenthesis upper Y right parenthesis right parenthesis squared plus sans serif upper E left parenthesis upper Z squared right parenthesis minus left parenthesis sans serif upper E left parenthesis upper Z right parenthesis right parenthesis squared equals sans serif upper V left parenthesis upper Y right parenthesis plus sans serif upper V left parenthesis upper Z right parenthesis period EndLayoutV(Y + Z) = E
⎛
(Y + Z)2⎞
−(E(Y + Z))2
= E
⎛
Y 2 + 2YZ + Z2⎞
−(E(Y))2 −(E(Z))2 −2E(Y)E(Z)
= E(Y 2) −(E(Y))2 + E(Z2) −(E(Z))2 = V(Y) + V(Z).
But V(Y) = V(a) = 0 and V(Z) = V(aX) = a2V(X) and the proof is complete. 
7.6 First we have 
sans serif upper E left parenthesis upper X upper Y right parenthesis equals sans serif upper E left parenthesis upper X left parenthesis a plus b upper X right parenthesis right parenthesis equals a sans serif upper E left parenthesis upper X right parenthesis plus b sans serif upper E left parenthesis upper X squared right parenthesis commaE(XY) = E (X(a + bX)) = a E(X) + b E(X2),
and clearly E(a + bX) = a + b E(X). Thus formula cov(X, Y) = E(XY) − 
E(X)E(Y) yields 
StartLayout 1st Row 1st Column sans serif c o v left parenthesis upper X comma upper Y right parenthesis 2nd Column equals 3rd Column a sans serif upper E left parenthesis upper X right parenthesis plus b sans serif upper E left parenthesis upper X squared right parenthesis minus sans serif upper E left parenthesis upper X right parenthesis left parenthesis a plus b sans serif upper E left parenthesis upper X right parenthesis right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column b left bracket sans serif upper E left parenthesis upper X squared right parenthesis minus left parenthesis sans serif upper E left parenthesis upper X right parenthesis right parenthesis squared right bracket equals b sans serif upper V left parenthesis upper X right parenthesis period EndLayoutcov(X, Y) = a E(X) + b E(X2) −E(X) (a + b E(X))
= b
⎾
E(X2) −(E(X))2⏋
= b V(X).
Now, computing the correlation we get: 
StartLayout 1st Row 1st Column sans serif c o r r left parenthesis upper X comma a plus b upper X right parenthesis 2nd Column equals 3rd Column StartFraction b sans serif upper V left parenthesis upper X right parenthesis Over StartRoot sans serif upper V left parenthesis upper X right parenthesis b squared sans serif upper V left parenthesis upper X right parenthesis EndRoot EndFraction 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction b sans serif upper V left parenthesis upper X right parenthesis Over StartAbsoluteValue b EndAbsoluteValue StartRoot sans serif upper V left parenthesis upper X right parenthesis sans serif upper V left parenthesis upper X right parenthesis EndRoot EndFraction equals sign left parenthesis b right parenthesis comma EndLayoutcorr(X, a + b X) =
b V(X)
√
V(X)b2 V(X)
=
b V(X)
|b| √V(X)V(X) = sign(b),
where sign(b) = 1 if  b >  0 and sign(b) = −1 if  b <  0. 
7.7 Performing the product inside expectation we get 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper X 1 upper X 2 minus upper X 1 upper X overTilde Subscript 2 Baseline minus upper X overTilde Subscript 1 Baseline upper X 2 plus upper X overTilde Subscript 1 Baseline upper X overTilde Subscript 2 Baseline right parenthesis 2nd Column equals 2 sans serif upper E left parenthesis upper X 1 upper X 2 right parenthesis minus 2 sans serif upper E left parenthesis upper X 1 right parenthesis sans serif upper E left parenthesis upper X 2 right parenthesis 2nd Row 1st Column Blank 2nd Column equals 2 sans serif c o v left parenthesis upper X 1 comma upper X 2 right parenthesis period EndLayoutE
⎛
X1X2 −X1 ˜X2 −˜X1X2 + ˜X1 ˜X2
⎞
= 2 E(X1X2) −2 E(X1)E(X2)
= 2 cov(X1, X2).
We used equality in distribution which implies E(g(X1, X2)) = E(g( ˜X1, ˜X2)) with 
g(x, y) = xy, and also independence which implies that the expectation of products 
factors into the product of expectations, but since block independence additionally 
implies FXi ≡F ˜Xi for i = 1, 2 then E(Xi) = E( ˜Xi). 
7.8 Since Y a.s.
= X means P(Y = X) = 1, take A = {ω ∈Ω | Y(ω) = X(ω)}. 
Next, considering B = {X ⩽x} we have that A ∩ B implies {X ⩽x} = {Y ⩽y}.
330
Solutions to Exercises
Moreover, from Ac = {X /= Y} and Ac ∩ B ⊂ Ac we get P(X ⩽x) ⩽P(Ac ) = 0 
which together with Ac∩{Y ⩽y} ⊂Ac imply P(X ⩽x) = P(Y ⩽y) = 0 on those 
scenarios s.t. the two rvs are different. Thus we have proved Y a.s.
= X ⇒ Y d= X. 
It is worth noting how this further implies E(g(X)) = E(g(Y)) since expectation is 
based on the distribution. 
7.9 Recall that equality a.s. implies E(g(X)) = E(g(Y)) for every bounded or 
continuous function g : R → R. Now, the hypotheses implies XY a.s.
= X2 since 
P(XY = XX) = P(Y = X) = 1. Thus, choosing g(x) = x we have: 
StartLayout 1st Row 1st Column sans serif c o r r left parenthesis upper X comma upper Y right parenthesis 2nd Column equals 3rd Column StartFraction sans serif upper E left parenthesis upper X upper Y right parenthesis minus sans serif upper E left parenthesis upper X right parenthesis sans serif upper E left parenthesis upper Y right parenthesis Over StartRoot sans serif upper V left parenthesis upper X right parenthesis sans serif upper V left parenthesis upper Y right parenthesis EndRoot EndFraction 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction sans serif upper E left parenthesis upper X upper X right parenthesis minus sans serif upper E left parenthesis upper X right parenthesis sans serif upper E left parenthesis upper X right parenthesis Over StartRoot sans serif upper V left parenthesis upper X right parenthesis sans serif upper V left parenthesis upper X right parenthesis EndRoot EndFraction equals StartFraction sans serif upper V left parenthesis upper X right parenthesis Over sans serif upper V left parenthesis upper X right parenthesis EndFraction equals 1 period EndLayoutcorr(X, Y) = E(XY) −E(X)E(Y)
√V(X)V(Y)
= E(XX) −E(X)E(X)
√V(X)V(X)
= V(X)
V(X) = 1.
Note that V(Y) = E(X2) − (E(X))2 by the hypotheses. For the case Y a.s.
= −X we 
readily obtain corr(X, Y) = −1. 
7.10 We have to check G(x, y) = max{0, FX(x) + FY (y) − 1} fulﬁlls conditions 
(a)–(d) seen in Sect. 3.1, Chap. 3. First we clearly have G : R2 →[0, 1], by  
construction. To show (a), i.e., G is nondecreasing, we choose x1 ⩽x2 and y1 ⩽y2 
and since marginals FX, FY are CDFs (then are nondecreasing) we get: 
StartLayout 1st Row max left brace 0 comma upper F Subscript upper X Baseline left parenthesis x 1 right parenthesis plus upper F Subscript upper Y Baseline left parenthesis y 1 right parenthesis minus 1 right brace less than or slanted equals max left brace 0 comma upper F Subscript upper X Baseline left parenthesis x 2 right parenthesis plus upper F Subscript upper Y Baseline left parenthesis y 2 right parenthesis minus 1 right brace period EndLayoutmax{0, FX(x1) + FY (y1) −1} ⩽max{0, FX(x2) + FY (y2) −1}.
Right-continuity (b) is easily recovered by right-continuity of the marginals: 
StartLayout 1st Row limit Underscript h down arrow 0 Endscripts left parenthesis limit Underscript k down arrow 0 Endscripts max left brace 0 comma upper F Subscript upper X Baseline left parenthesis x plus h right parenthesis plus upper F Subscript upper Y Baseline left parenthesis y plus k right parenthesis minus 1 right brace right parenthesis equals max left brace 0 comma upper F Subscript upper X Baseline left parenthesis x right parenthesis plus upper F Subscript upper Y Baseline left parenthesis y right parenthesis minus 1 right brace period EndLayoutlim
h↓0
⎛
lim
k↓0 max{0, FX(x + h) + FY (y + k) −1}
⎞
= max{0, FX(x) + FY (y) −1}.
To check (c) we compute: 
StartLayout 1st Row 1st Column max left brace 0 comma upper F Subscript upper X Baseline left parenthesis negative normal infinity right parenthesis plus upper F Subscript upper Y Baseline left parenthesis y right parenthesis minus 1 right brace 2nd Column equals 3rd Column 0 2nd Row 1st Column max left brace 0 comma upper F Subscript upper X Baseline left parenthesis x right parenthesis plus upper F Subscript upper Y Baseline left parenthesis negative normal infinity right parenthesis minus 1 right brace 2nd Column equals 3rd Column 0 3rd Row 1st Column max left brace 0 comma upper F Subscript upper X Baseline left parenthesis normal infinity right parenthesis plus upper F Subscript upper Y Baseline left parenthesis normal infinity right parenthesis minus 1 right brace 2nd Column equals 3rd Column 1 period EndLayoutmax{0, FX(−∞) + FY (y) −1} = 0
max{0, FX(x) + FY (−∞) −1} = 0
max{0, FX(∞) + FY (∞) −1} = 1.
Eventually, we verify G fulﬁlls (d) for the same pairs (x1, x2) and (y1, y2) as above: 
StartLayout 1st Row 1st Column max left brace 0 comma upper F Subscript upper X Baseline left parenthesis x 2 right parenthesis plus upper F Subscript upper Y Baseline left parenthesis y 2 right parenthesis minus 1 right brace 2nd Column minus 3rd Column max left brace 0 comma upper F Subscript upper X Baseline left parenthesis x 2 right parenthesis plus upper F Subscript upper Y Baseline left parenthesis y 1 right parenthesis minus 1 right brace 2nd Row 1st Column minus max left brace 0 comma upper F Subscript upper X Baseline left parenthesis x 1 right parenthesis plus upper F Subscript upper Y Baseline left parenthesis y 2 right parenthesis minus 1 right brace 2nd Column plus 3rd Column max left brace 0 comma upper F Subscript upper X Baseline left parenthesis x 1 right parenthesis plus upper F Subscript upper Y Baseline left parenthesis y 1 right parenthesis minus 1 right brace greater than or slanted equals 0 period EndLayoutmax{0, FX(x2) + FY (y2) −1} −max{0, FX(x2) + FY (y1) −1}
−max{0, FX(x1) + FY (y2) −1} + max{0, FX(x1) + FY (y1) −1} ⩾0.
The veriﬁcation that H(x, y) = min{FX(x), FY (y)} is a CDF follows easily by the 
same reasoning above.
Solutions to Exercises
331
Exercises of Chap. 8 
8.1 Take ϵ >  0 and let An(ϵ) = {|Xn − X| > ϵ}, for every n ∈ N. Then, by 
monotonicity, subadditivity and continuity of P we have 
limit Underscript n right arrow normal infinity Endscripts sans serif upper P left parenthesis upper A Subscript n Baseline left parenthesis epsilon right parenthesis right parenthesis less than or slanted equals limit Underscript n right arrow normal infinity Endscripts sans serif upper P left parenthesis union Subscript i greater than or slanted equals n Baseline upper A Subscript i Baseline left parenthesis epsilon right parenthesis right parenthesis equals sans serif upper P left parenthesis upper A Subscript i Baseline left parenthesis epsilon right parenthesis i period o period right parenthesis equals 0 comma lim
n→∞P(An(ϵ)) ⩽lim
n→∞P(∪i⩾nAi(ϵ)) = P(Ai(ϵ) i.o.) = 0,
where we used the hypotheses Xn 
a.s.
−−→X. See Sect. 1.5 for the notation {Ai(ϵ) i.o.}. 
Remark 5 We give some details on the last part of the solution above. The event 
{ lim 
n→∞ Xn = X} has complimentary event comprising those scenario ω where Xn(ω) 
fails to converge to X(ω) iff there is some ϵ >  0 s.t. |Xn(ω) − X(ω)| ⩾ϵ for 
inﬁnitely many n. As byproduct, 
left brace limit Underscript n right arrow normal infinity Endscripts upper X Subscript n Baseline equals upper X right brace Superscript c Baseline equals union Subscript epsilon Baseline left brace StartAbsoluteValue upper X Subscript n Baseline minus upper X EndAbsoluteValue greater than or slanted equals epsilon i period o period right brace equals union Subscript epsilon Baseline left brace upper A Subscript n Baseline left parenthesis epsilon right parenthesis i period o period right brace period
{
lim
n→∞Xn = X
}c = ∪ϵ{|Xn −X| ⩾ϵ i.o.} = ∪ϵ{An(ϵ) i.o.}.
Note the right-hand side increases as ϵ decreases. The ‘convergence’ event 
{ lim 
n→∞ Xn = X} has probability 1 iff its complement has probability zero, 
P(An(ϵ) i.o.) = 0. Moreover, the ‘convergence’ event is An(ϵ) = lim supn 
{An(ϵ) i.o.} and by [2, Th 4.1] and the above zero probability condition it follows 
lim 
n→∞P(|Xn − X| > ϵ)  = 0. It is worth noting that assuming ∑∞ 
n=1 P(|Xn − X| >
ϵ) < ∞ we have another sufﬁcient condition for Xn 
a.s.
−−→ X, since by Borel-Cantelli 
lemma 1.1, part (i) it follows P(An(ϵ) i.o.) = 0. 
8.2 Assume Xn 
ms
−−→ X and let ϵ >  0. Then, by Markov’s inequality (see 
Proposition 4.2, Sect. 4.6) we have:  
StartLayout 1st Row 1st Column sans serif upper P left parenthesis StartAbsoluteValue upper X Subscript n Baseline minus upper X EndAbsoluteValue greater than epsilon right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis StartAbsoluteValue upper X Subscript n Baseline minus upper X EndAbsoluteValue squared greater than epsilon squared right parenthesis 2nd Row 1st Column Blank 2nd Column less than or slanted equals 3rd Column StartFraction sans serif upper E left parenthesis left parenthesis upper X Subscript n Baseline minus upper X right parenthesis squared right parenthesis Over epsilon squared EndFraction period EndLayoutP(|Xn −X| > ϵ) = P(|Xn −X|2 > ϵ2)
⩽E((Xn −X)2)
ϵ2
.
By hypotheses, the numerator on the right-hand side of the inequality tends to zero 
and we are done. 
8.3 Assume Xn 
ms
−−→ X. By Cauchy-Schwarz inequality (4.3), Sect. 4.6, we have:  
sans serif upper E left parenthesis StartAbsoluteValue upper X Subscript n Baseline minus upper X EndAbsoluteValue right parenthesis less than or slanted equals StartRoot sans serif upper E left parenthesis left parenthesis upper X Subscript n Baseline minus upper X right parenthesis squared right parenthesis EndRoot periodE(|Xn −X|) ⩽
√
E((Xn −X)2).
By hypotheses, E((Xn − X)2) → 0, as n →∞ and thus also E(|Xn − X|) → 0.
332
Solutions to Exercises
8.4 By Chebyshev’s inequality (see Proposition 4.2, Sect. 4.6) we easily compute: 
sans serif upper P left parenthesis StartAbsoluteValue upper X Subscript n Baseline minus upper X EndAbsoluteValue greater than epsilon right parenthesis less than or slanted equals StartFraction sans serif upper E left parenthesis StartAbsoluteValue upper X Subscript n Baseline minus upper X EndAbsoluteValue right parenthesis Over epsilon EndFraction periodP(|Xn −X| > ϵ) ⩽E(|Xn −X|)
ϵ
.
Then, the hypotheses E(|Xn − X|) → 0 does imply P(|Xn − X| > ϵ)  → 0. 
8.5 First, we observe that the constant 
1
√
2π is each sample density can be ignored 
without loss of generality. Then we write: 
StartLayout 1st Row 1st Column product Underscript i equals 1 Overscript n Endscripts f left parenthesis upper R Subscript i Baseline comma theta right parenthesis 2nd Column equals 3rd Column product Underscript i equals 1 Overscript n Endscripts sigma Superscript negative 1 Baseline exp left parenthesis minus StartFraction 1 Over 2 sigma squared EndFraction left parenthesis upper R Subscript i Baseline minus mu right parenthesis squared right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sigma Superscript negative 1 Baseline exp left parenthesis minus StartFraction 1 Over 2 sigma squared EndFraction sigma summation Underscript i equals 1 Overscript n Endscripts left parenthesis upper R Subscript i Baseline minus mu right parenthesis squared right parenthesis period EndLayout
n
∏
i=1
f (Ri, θ) =
n
∏
i=1
σ −1 exp
⎛
−1
2σ 2 (Ri −μ)2
⎞
= σ −1 exp
⎛
−1
2σ 2
n
⎲
i=1
(Ri −μ)2
⎞
.
The latter expression can be rewritten 
sigma Superscript negative 1 Baseline exp left parenthesis minus StartFraction n upper V overbar Subscript n Baseline Over 2 sigma squared EndFraction right parenthesis exp left parenthesis minus StartFraction n left parenthesis upper R overbar Subscript n Baseline minus mu right parenthesis squared Over 2 sigma squared EndFraction right parenthesis commaσ −1 exp
⎛
−n ¯Vn
2σ 2
⎞
exp
⎛
−n( ¯Rn −μ)2
2σ 2
⎞
,
where ¯Rn = n−1 ∑n 
i=1 Ri is the sample mean and ¯Vn = n−1 ∑n 
i=1(Ri − ¯Rn)2 is the 
sample variance. Indeed, ∑n 
i=1(Ri−μ)2 = n ¯Vn+n( ¯Rn−μ)2, since ∑n 
i=1(Ri−μ)2 
is equal to ∑n 
i=1(Ri − ¯Rn + ¯Rn −μ)2. Passing to the log-likelihood, 
h left parenthesis mu comma sigma right parenthesis equals minus n ln sigma minus StartFraction n upper V overbar Subscript n Baseline Over 2 sigma squared EndFraction minus StartFraction n left parenthesis upper R overbar Subscript n Baseline minus mu right parenthesis squared Over 2 sigma squared EndFraction commah(μ, σ) = −n ln σ −n ¯Vn
2σ 2 −n( ¯Rn −μ)2
2σ 2
,
setting the ﬁrst-order conditions 
StartFraction partial differential Over partial differential mu EndFraction h left parenthesis mu comma sigma right parenthesis equals 0 comma StartFraction partial differential Over partial differential sigma EndFraction h left parenthesis mu comma sigma right parenthesis equals 0 ∂
∂μh(μ, σ) = 0,
∂
∂σ h(μ, σ) = 0
we ﬁnally get the desired maximizers ¯Rn and
√¯Vn. 
8.6 We let α = E(Tn) and compute: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis left parenthesis upper T Subscript n Baseline minus theta right parenthesis right parenthesis squared 2nd Column equals 3rd Column sans serif upper E left parenthesis left parenthesis upper T Subscript n Baseline minus theta plus alpha minus alpha right parenthesis right parenthesis squared 2nd Row 1st Column Blank 2nd Column equals 3rd Column left parenthesis alpha minus theta right parenthesis squared plus sans serif upper E left parenthesis left parenthesis upper T Subscript n Baseline minus alpha right parenthesis right parenthesis squared 3rd Row 1st Column Blank 2nd Column equals 3rd Column left parenthesis bias left parenthesis upper T Subscript n Baseline right parenthesis right parenthesis squared plus sans serif upper V left parenthesis upper T Subscript n Baseline right parenthesis period EndLayoutE((Tn −θ))2 = E((Tn −θ + α −α))2
= (α −θ)2 + E((Tn −α))2
= (bias(Tn))2 + V(Tn).
Next, assuming (bias(Tn))2 → 0 and √V(Tn) → 0, as n →∞, then by the above 
result we also have MSE → 0. As a consequence, Tn 
ms
−−→ θ and by Theorem 8.1, 
part (iii), convergence in probability follows.
Solutions to Exercises
333
8.7 We know that X a.s.
= Y is equivalent to X − Y a.s.
= 0. Now, let Np be the subset 
of Lp containing all rvs Z s.t. E(|Z|p )1/p = 0 for p ∈[1, ∞), or equivalently 
E(|Z|p ) = 0. Since |Z| ⩾0, by Exercise 4.17, part 3, we also have Z a.s.
= 0. Taking 
Z = X − Y the relation X a.s.
= Y now reads X − Y ∈ Np. Clearly, X a.s.
= X is 
X − X = 0 ∈ Np which trivially implies reﬂexivity. Since X a.s.
= Y is the same as 
Y a.s.
= X we have Y − X ∈ Np and the relation is symmetric. To show transitivity, 
use the triangle inequality 
StartLayout 1st Row 1st Column StartAbsoluteValue upper X minus upper U EndAbsoluteValue 2nd Column equals 3rd Column StartAbsoluteValue upper X minus upper Y plus upper Y minus upper U EndAbsoluteValue 2nd Row 1st Column Blank 2nd Column less than or slanted equals 3rd Column StartAbsoluteValue upper X minus upper Y EndAbsoluteValue plus StartAbsoluteValue upper Y minus upper U EndAbsoluteValue comma EndLayout|X −U| = |X −Y + Y −U|
⩽|X −Y| + |Y −U|,
which is equivalent to 
sans serif upper E left parenthesis StartAbsoluteValue upper X minus upper U EndAbsoluteValue Superscript p Baseline right parenthesis Superscript 1 divided by p Baseline less than or slanted equals sans serif upper E left parenthesis StartAbsoluteValue upper X minus upper Y EndAbsoluteValue plus StartAbsoluteValue upper Y minus upper U EndAbsoluteValue Superscript p Baseline right parenthesis Superscript 1 divided by p Baseline periodE(|X −U|p)1/p ⩽E
(
|X −Y| + |Y −U|p)1/p .
Applying Minkowski’s inequality (see Theorem 4.5) to the right-hand side we get 
sans serif upper E left parenthesis StartAbsoluteValue upper X minus upper Y EndAbsoluteValue plus StartAbsoluteValue upper Y minus upper U EndAbsoluteValue Superscript p Baseline right parenthesis Superscript 1 divided by p Baseline less than or slanted equals sans serif upper E left parenthesis StartAbsoluteValue upper X minus upper Y EndAbsoluteValue Superscript p Baseline right parenthesis Superscript 1 divided by p Baseline plus sans serif upper E left parenthesis StartAbsoluteValue upper Y minus upper U EndAbsoluteValue Superscript p Baseline right parenthesis Superscript 1 divided by p Baseline periodE
(
|X −Y| + |Y −U|p)1/p ⩽E(|X −Y|p)1/p + E(|Y −U|p)1/p.
Assume X a.s.
= Y and Y a.s.
= U, i.e. X − Y ∈ Np and Y − U ∈ Np. Expectations 
on the right-hand side of this last inequality are zero by assumption, so putting 
things together we have E(|X − U|p )1/p = 0 or equivalently E(|X − U|p ) = 0. 
Hence, X − U ∈ Np which means X a.s.
= U and transitivity is proved. Since a.s.
= 
is an equivalence relation on Lp we can take its quotient space Lp\a.s.
= as the set 
denoted by Lp containing all the equivalence classes induced by a.s.
=. Thus, X ∈ Lp 
if and only if |X|p ∈Lp and there are rvs W in Lp with |W|p ∈Lp and such that 
X a.s.
= W. 
Exercises of Chap. 9 
9.1 We have Bc t  ∼ N(0, c  t)  by the deﬁnition of a Brownian motion. Also,
√cBt ∼ N(0, c  t), since E(√cBt) = √cE(Bt), which is zero, and V(√cBt) = 
(√c)2V(Bt) = c t. 
9.2 We compute: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper B 4 less than b vertical bar upper B 1 equals a right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis upper B 4 minus upper B 1 less than b minus a vertical bar upper B 1 equals a right parenthesis 2nd Row 1st Column Blank 2nd Column StartLayout 1st Row indep period 2nd Row equals EndLayout 3rd Column sans serif upper P left parenthesis upper B 4 minus upper B 1 less than b minus a right parenthesis 3rd Row 1st Column Blank 2nd Column StartLayout 1st Row stat period incr period 2nd Row equals EndLayout 3rd Column sans serif upper P left parenthesis upper B Subscript b minus a Baseline less than b minus a right parenthesis 4th Row 1st Column Blank 2nd Column StartLayout 1st Row scaling 2nd Row equals EndLayout 3rd Column sans serif upper P left parenthesis StartRoot b minus a EndRoot upper B 1 less than b minus a right parenthesis equals sans serif upper P left parenthesis upper B 1 less than StartRoot b minus a EndRoot right parenthesis period EndLayoutP(B4 < b | B1 = a)
=
P(B4 −B1 < b −a | B1 = a)
indep.
=
P(B4 −B1 < b −a)
334
Solutions to Exercises
stat. incr. 
= 
P(Bb−a < b  − a) 
scaling 
= 
P
⎛√
b − aB1 < b  − a
⎞
= P
⎛
B1 < 
√
b − a
⎞
. 
The latter is the CDF of N(0, 1) evaluated at √b − a. 
9.3 For the Brownian motion with drift we have: 
StartLayout 1st Row 1st Column sans serif upper E left parenthesis upper B overTilde Subscript t Baseline right parenthesis 2nd Column equals 3rd Column mu t plus sigma sans serif upper E left parenthesis upper B Subscript t Baseline right parenthesis equals mu t comma 2nd Row 1st Column sans serif upper V left parenthesis upper B overTilde Subscript t Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper V left parenthesis mu t plus sigma upper B Subscript t Baseline right parenthesis equals sigma squared sans serif upper V left parenthesis upper B Subscript t Baseline right parenthesis equals sigma squared t period EndLayoutE( ˜Bt) = μt + σE(Bt) = μt,
V( ˜Bt) = V(μt + σBt) = σ 2V(Bt) = σ 2t.
Observe that, for s, t > 0, we have 
StartLayout 1st Row 1st Column sans serif c o v left parenthesis upper B overTilde Subscript t Baseline comma upper B overTilde Subscript s Baseline right parenthesis 2nd Column equals 3rd Column sans serif upper E left parenthesis upper B overTilde Subscript t Baseline upper B overTilde Subscript s Baseline right parenthesis minus sans serif upper E left parenthesis upper B overTilde Subscript t Baseline right parenthesis sans serif upper E left parenthesis upper B overTilde Subscript s Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column mu t mu s plus sigma squared sans serif upper E left parenthesis upper B Subscript t Baseline upper B Subscript s Baseline right parenthesis minus mu t mu s equals sigma squared min left brace s comma t right brace period EndLayoutcov( ˜Bt, ˜Bs) = E( ˜Bt ˜Bs) −E( ˜Bt)E( ˜Bs)
= μtμs + σ 2E(BtBs) −μtμs = σ 2 min{s, t}.
For the geometric Brownian motion we ﬁrstly have, for x >  0: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper S Subscript t Baseline less than or slanted equals x right parenthesis 2nd Column equals 3rd Column sans serif upper P left parenthesis upper S 0 e Superscript mu t plus sigma upper B Super Subscript t Superscript Baseline less than or slanted equals x right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis mu t plus sigma upper B Subscript t Baseline less than or slanted equals ln left parenthesis StartFraction x Over upper S 0 EndFraction right parenthesis right parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper B Subscript t Baseline less than or slanted equals StartFraction ln x minus ln upper S 0 minus mu t Over sigma EndFraction right parenthesis 4th Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis StartRoot t EndRoot upper B 1 less than or slanted equals StartFraction ln x minus ln upper S 0 minus mu t Over sigma EndFraction right parenthesis 5th Row 1st Column Blank 2nd Column equals 3rd Column sans serif upper P left parenthesis upper B 1 less than or slanted equals StartFraction ln x minus ln upper S 0 minus mu t Over StartRoot t EndRoot sigma EndFraction right parenthesis period EndLayoutP(St ⩽x) = P(S0eμt+σBt ⩽x)
= P
⎛
μt + σBt ⩽ln
⎛x
S0
⎞⎞
= P
⎛
Bt ⩽ln x −ln S0 −μt
σ
⎞
= P
⎛√
tB1 ⩽ln x −ln S0 −μt
σ
⎞
= P
⎛
B1 ⩽ln x −ln S0 −μt
√tσ
⎞
.
Eventually, the MGF Mμ+σBt (u) = Mμ+√tσB1 (u) is equal to exp(μ t + tσ 2u2 
2 ), 
from which we get E(e 
√tB1) = etσ 2u2/2 and further E(eσ Bt) = eσ 2t/2. From this  
and from Eqs. (5.17) and (5.18) in Sect. 5.7, the expressions for the expectation and 
variance of St follow. 
9.4 We compute the probability that Bt is at most a >  0: 
StartLayout 1st Row 1st Column sans serif upper P left parenthesis upper B Subscript t Baseline greater than or slanted equals a right parenthesis 2nd Column StartLayout 1st Row law of tot period pr period 2nd Row equals EndLayout 3rd Column sans serif upper P left parenthesis upper B Subscript t Baseline greater than or slanted equals a vertical bar upper T Subscript a Baseline less than or slanted equals t right parenthesis sans serif upper P left parenthesis upper T Subscript a Baseline less than or slanted equals t right parenthesis 2nd Row 1st Column Blank 2nd Column Blank 3rd Column plus sans serif upper P left parenthesis upper B Subscript t Baseline greater than or slanted equals a vertical bar upper T Subscript a Baseline greater than t right parenthesis sans serif upper P left parenthesis upper T Subscript a Baseline greater than t right parenthesis period EndLayoutP(Bt ⩾a) law of tot. pr.
=
P(Bt ⩾a | Ta ⩽t)P(Ta ⩽t)
+P(Bt ⩾a | Ta > t)P(Ta > t).
Assuming Ta > t  we have that Bt has not hit the barrier y = a, then {Bt ⩾a} 
has probability zero, and the second term in the right-hand side above vanishes.
Solutions to Exercises
335
Moreover, by the reﬂection principle we also have 
sans serif upper P left parenthesis upper B Subscript t Baseline greater than or slanted equals a vertical bar upper T Subscript a Baseline less than or slanted equals t right parenthesis equals sans serif upper P left parenthesis upper B Subscript t Baseline less than or slanted equals a vertical bar upper T Subscript a Baseline less than or slanted equals t right parenthesis equals one half commaP(Bt ⩾a | Ta ⩽t) = P(Bt ⩽a | Ta ⩽t) = 1
2,
thus P(Bt ⩾a) = 1 
2P(Ta ⩽t) and eventually P(Ta ⩽t) = 2P(Bt ⩾a). Observe 
that the latter is recovered by the normal standard Z ∼ N(0, 1) as 
2 sans serif upper P left parenthesis upper B Subscript t Baseline greater than or slanted equals a right parenthesis equals 2 left parenthesis 1 minus upper F Subscript upper Z Baseline left parenthesis StartFraction a Over StartRoot t EndRoot EndFraction right parenthesis right parenthesis period2P(Bt ⩾a) = 2
⎛
1 −FZ
⎛a
√t
⎞⎞
.
9.5 For the running maximum of a standard Brownian motion ¯Bt := supu∈[0,t] Bu 
we note that { ¯Bt > a} and {Ta < t}, are equivalent, for positive a. Therefore, 
sans serif upper P left parenthesis upper B overbar Subscript t Baseline less than or slanted equals a right parenthesis equals 1 minus sans serif upper P left parenthesis upper B overbar Subscript t Baseline greater than a right parenthesis equals 1 minus sans serif upper P left parenthesis upper T Subscript a Baseline less than or slanted equals t right parenthesis commaP( ¯Bt ⩽a) = 1 −P( ¯Bt > a) = 1 −P(Ta ⩽t),
where in the latter equality we used that Ta has a continuous distribution with CDF12 
2(1 − FZ( a
√t )), for  Z ∼ N(0, 1), see Exercise 9.4. Eventually, the desired CDF is 
2FZ( a
√t ) − 1. 
Exercises of Chap. 10 
10.1 We compute the corresponding quantile QX(0.05) = −10 which is just 
−VaRc,T (X), because 
upper F Subscript upper X Baseline left parenthesis negative 10 right parenthesis equals sans serif upper P left parenthesis upper X equals negative 105 right parenthesis plus sans serif upper P left parenthesis upper X equals negative 57 right parenthesis plus sans serif upper P left parenthesis upper X equals negative 10 right parenthesis equals 0.165 periodFX(−10) = P(X = −105) + P(X = −57) + P(X = −10) = 0.165.
We take the smallest value in the FX’s domain s.t. it crosses the given probability 
level c = 0.05, indeed 0.045 = FX(−57) <  0.05 < FX(−10). Here the support of 
the P&L rv is C = {−105, −57, −10, 39, 98, 226}, and we should be conﬁdent at 
100(1 − c)% = 95% to have only revenues. 
10.2 Write the following chain of equivalences: 
StartLayout 1st Row 1st Column upper Q Subscript negative upper X Superscript minus Baseline left parenthesis 1 minus c right parenthesis 2nd Column equals 3rd Column inf left brace x element of double struck upper R vertical bar sans serif upper P left parenthesis negative upper X less than or slanted equals x right parenthesis greater than or slanted equals 1 minus c right brace 2nd Row 1st Column Blank 2nd Column equals 3rd Column inf left brace x element of double struck upper R vertical bar 1 minus sans serif upper P left parenthesis upper X less than negative x right parenthesis greater than or slanted equals 1 minus c right brace 3rd Row 1st Column Blank 2nd Column equals 3rd Column inf left brace x element of double struck upper R vertical bar sans serif upper P left parenthesis upper X less than negative x right parenthesis less than or slanted equals c right brace 4th Row 1st Column Blank 2nd Column equals 3rd Column minus sup left brace y element of double struck upper R vertical bar sans serif upper P left parenthesis upper X less than y right parenthesis less than or slanted equals c right brace equals minus upper Q Subscript upper X Superscript plus Baseline left parenthesis c right parenthesis period EndLayoutQ−
−X(1 −c) = inf
{
x ∈R
|| P(−X ⩽x) ⩾1 −c
}
= inf
{
x ∈R
|| 1 −P(X < −x) ⩾1 −c
}
= inf
{
x ∈R
|| P(X < −x) ⩽c
}
= −sup
{
y ∈R
|| P(X < y) ⩽c
}
= −Q+
X(c).
12 The event {Ta = t} has zero probability. 
336
Solutions to Exercises
10.3 To prove that St = S0e(α−σ 2/2)t+σBt is a solution to the SDE dSt = αStdt + 
σStdBt, we apply Itô’s Formula with St = f (t,  Yt) = S0eμt+σYt and considering 
the diffusion equation dYt = Xtdt+ZtdBt, with Xt = 0 and Zt = 1, i.e., dYt = dBt 
and y = Bt. Thus: 
StartLayout 1st Row 1st Column normal d f left parenthesis t comma upper B Subscript t Baseline right parenthesis equals normal d upper S Subscript t Baseline 2nd Column equals 3rd Column left parenthesis StartFraction partial differential f Over partial differential t EndFraction plus one half StartFraction partial differential squared f Over partial differential y squared EndFraction right parenthesis normal d t plus StartFraction partial differential f Over partial differential y EndFraction normal d upper B Subscript t 2nd Row 1st Column Blank 2nd Column equals 3rd Column upper S Subscript t Baseline left parenthesis left parenthesis mu plus one half sigma squared right parenthesis normal d t plus sigma normal d upper B Subscript t Baseline right parenthesis period EndLayoutdf (t, Bt) = dSt =
⎛∂f
∂t + 1
2
∂2f
∂y2
⎞
dt + ∂f
∂y dBt
= St
⎛
(μ + 1
2σ 2)dt + σdBt
⎞
.
Eventually, it sufﬁces to let α = μ + 1 
2σ 2, i.e., μ = α − 1 
2σ 2. Observe that we 
used:
•
∂f 
∂y = σS0eμt+σBt = σSt
•
∂f 
∂t = μS0eμt+σBt = μSt
•
∂2f 
∂y2 = σ 2S0eμt+σBt = σ 2St. 
Thus, we arrived to 
StartFraction normal d upper S Subscript t Baseline Over upper S Subscript t Baseline EndFraction equals normal d ln upper S Subscript t Baseline equals left parenthesis alpha minus one half sigma squared right parenthesis normal d t plus sigma normal d upper B Subscript t Baseline commadSt
St
= d ln St = (α −1
2σ 2)dt + σdBt,
and integrating both sides we get13 
StartLayout 1st Row 1st Column integral Subscript 0 Superscript t Baseline normal d ln upper S Subscript t Baseline equals ln upper S Subscript t Baseline minus ln upper S 0 2nd Column equals 3rd Column ln left parenthesis StartFraction upper S Subscript t Baseline Over upper S 0 EndFraction right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column left parenthesis alpha minus one half sigma squared right parenthesis integral Subscript 0 Superscript t Baseline normal d u plus sigma integral Subscript 0 Superscript t Baseline normal d upper B Subscript u 3rd Row 1st Column Blank 2nd Column equals 3rd Column left parenthesis alpha minus one half sigma squared right parenthesis t plus sigma left parenthesis upper B Subscript t Baseline minus upper B 0 right parenthesis 4th Row 1st Column Blank 2nd Column long left right double arrow 3rd Column Blank 5th Row 1st Column upper S Subscript t 2nd Column equals 3rd Column upper S 0 e Superscript left parenthesis alpha minus one half sigma squared right parenthesis t plus sigma upper B Super Subscript t Superscript Baseline period EndLayout
⎰t
0
d ln St = ln St −ln S0
=
ln
⎛St
S0
⎞
=
(α −1
2σ 2)
⎰t
0
du + σ
⎰t
0
dBu
=
(α −1
2σ 2)t + σ(Bt −B0)
⇐⇒
St
=
S0e(α−1
2 σ 2)t+σBt .
10.4 Let t = 0 and S0 = y we have the following chain of equivalences: 
StartLayout 1st Row 1st Column upper S Subscript upper T Baseline greater than upper K 2nd Column long left right double arrow normal e Superscript left parenthesis r minus sigma squared divided by 2 right parenthesis upper T plus sigma StartRoot upper T EndRoot z Baseline greater than upper K divided by y 2nd Row 1st Column Blank 2nd Column long left right double arrow z greater than StartFraction ln left parenthesis upper K divided by y right parenthesis minus left parenthesis r minus sigma squared divided by 2 right parenthesis upper T Over sigma StartRoot upper T EndRoot EndFraction 3rd Row 1st Column Blank 2nd Column long left right double arrow z greater than sigma StartRoot upper T EndRoot minus normal d 1 comma EndLayoutST > K ⇐⇒e(r−σ 2/2)T +σ
√
T z > K/y
⇐⇒z > ln(K/y) −(r −σ 2/2)T
σ
√
T
⇐⇒z > σ
√
T −d1,
(8)
13 We also used df 
f = f '
f = d ln  f , as for a deterministic real valued function f . 
Solutions to Exercises
337
where ln(y/K) = −ln(K/y). Moreover we have: 
StartLayout 1st Row 1st Column sans serif upper E Subscript ModifyingAbove sans serif upper P With tilde Baseline left parenthesis bold upper I Subscript left brace upper S Sub Subscript upper T Subscript greater than upper K right brace Baseline right parenthesis 2nd Column equals ModifyingAbove sans serif upper P With tilde left parenthesis upper S Subscript upper T Baseline greater than upper K right parenthesis 2nd Row 1st Column Blank 2nd Column equals ModifyingAbove sans serif upper P With tilde left parenthesis z greater than sigma StartRoot upper T EndRoot minus normal d 1 right parenthesis 3rd Row 1st Column Blank 2nd Column equals ModifyingAbove sans serif upper P With tilde left parenthesis z less than normal d 1 minus sigma StartRoot upper T EndRoot right parenthesis 4th Row 1st Column Blank 2nd Column equals upper F Subscript upper Z Baseline left parenthesis normal d 1 minus sigma StartRoot upper T EndRoot right parenthesis equals upper F Subscript upper Z Baseline left parenthesis normal d 2 right parenthesis period EndLayoutE ˜P(I{ST >K}) = ˜P(ST > K)
= ˜P(z > σ
√
T −d1)
= ˜P(z < d1 −σ
√
T )
= FZ(d1 −σ
√
T ) = FZ(d2).
(9) 
Letting c = σ
√
T − d1 and using (8) we also have:  
StartLayout 1st Row 1st Column sans serif upper E Subscript ModifyingAbove sans serif upper P With tilde Baseline left parenthesis bold upper I Subscript left brace upper S Sub Subscript upper T Subscript greater than upper K right brace Baseline upper S Subscript upper T Baseline right parenthesis 2nd Column equals integral Subscript c Superscript normal infinity Baseline y normal e Superscript left parenthesis r minus sigma squared divided by 2 right parenthesis upper T plus sigma StartRoot upper T EndRoot z Baseline StartFraction 1 Over StartRoot 2 pi EndRoot EndFraction normal e Superscript minus z squared divided by 2 Baseline normal d z 2nd Row 1st Column Blank 2nd Column equals StartFraction 1 Over StartRoot 2 pi EndRoot EndFraction y e Superscript left parenthesis r minus sigma squared divided by 2 right parenthesis upper T Baseline integral Subscript c Superscript normal infinity Baseline e Superscript minus left parenthesis x squared minus 2 sigma StartRoot upper T EndRoot z right parenthesis divided by 2 Baseline normal d z 3rd Row 1st Column Blank 2nd Column equals StartFraction 1 Over StartRoot 2 pi EndRoot EndFraction y normal e Superscript r upper T Baseline integral Subscript c Superscript normal infinity Baseline normal e Superscript minus left parenthesis z minus sigma StartRoot upper T EndRoot right parenthesis squared divided by 2 Baseline normal d z 4th Row 1st Column Blank 2nd Column equals y normal e Superscript r upper T Baseline StartFraction 1 Over StartRoot 2 pi EndRoot EndFraction integral Subscript minus normal d 1 Superscript normal infinity Baseline normal e Superscript minus w squared divided by 2 Baseline normal d w left parenthesis letting w equals z minus sigma StartRoot upper T EndRoot right parenthesis 5th Row 1st Column Blank 2nd Column equals y normal e Superscript r upper T Baseline sans serif upper P left parenthesis z greater than minus normal d 1 right parenthesis equals y normal e Superscript r upper T Baseline upper F Subscript upper Z Baseline left parenthesis normal d 1 right parenthesis period EndLayoutE ˜P(I{ST >K} ST ) =
⎰∞
c
y e(r−σ 2/2)T +σ
√
T z
1
√
2π e−z2/2dz
=
1
√
2π y e(r−σ 2/2)T
⎰∞
c
e−(x2−2σ
√
T z)/2dz
=
1
√
2π yerT
⎰∞
c
e−(z−σ
√
T )2/2dz
= yerT
1
√
2π
⎰∞
−d1
e−w2/2dw
(letting w = z −σ
√
T )
= yerT P(z > −d1) = yerT FZ(d1).
(10) 
The European call option payoff is (ST − K)+ = (ST − K)I{ST >K}, thus using (9) 
and (10) in the expression 
StartLayout 1st Row 1st Column upper C 0 2nd Column equals 3rd Column sans serif upper E left parenthesis bold upper I Subscript left brace upper S Sub Subscript upper T Subscript greater than upper K right brace Baseline left parenthesis upper S Subscript upper T Baseline minus upper K right parenthesis right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column normal e Superscript minus r t Baseline sans serif upper E left parenthesis bold upper I Subscript left brace upper S Sub Subscript upper T Subscript greater than upper K right brace Baseline upper S Subscript upper T Baseline right parenthesis minus upper K normal e Superscript minus r t Baseline sans serif upper E left parenthesis bold upper I Subscript left brace upper S Sub Subscript upper T Subscript greater than upper K right brace Baseline right parenthesis comma EndLayoutC0 = E(I{ST >K}(ST −K))
= e−rtE(I{ST >K}ST ) −K e−rtE(I{ST >K}),
we get the desired result.
Appendix A 
Binary Expansions 
For every real number a element of double struck upper Ra ∈R we may write a binary expansion, that is an 
expression like 
b 0 period b 1 b 2 ellipsis b Subscript n Baseline ellipsis equals left parenthesis b 0 plus StartFraction b 1 Over 2 Superscript 1 Baseline EndFraction plus StartFraction b 2 Over 2 squared EndFraction plus midline horizontal ellipsis plus StartFraction b Subscript n Baseline Over 2 Superscript n Baseline EndFraction plus midline horizontal ellipsis right parenthesis commab0.b1b2 . . . bn . . . =
⎛
b0 + b1
21 + b2
22 + · · · + bn
2n + · · ·
⎞
,
(A.1) 
where now the digits b Subscript ibi are taken from the set StartSet 0 comma 1 EndSet{0, 1}, while b 0b0 can be expressed as 
c Subscript n Baseline 2 Superscript n plus midline horizontal ellipsis plus c 1 2 Superscript 1 plus c 0 2 Superscript 0cn2n + · · · + c121 + c020 and again c Subscript i Baseline element of StartSet 0 comma 1 EndSetci ∈{0, 1}. We are sure that the inﬁnite series 
sigma summation Underscript i equals 1 Overscript normal infinity Endscripts StartFraction b Subscript i Baseline Over 2 Superscript i Baseline EndFraction∑∞
i=1
bi
2i converges since its partial sums are increasing and bounded above, see 
Appendix B. We show that to each real number a it corresponds a binary expansion 
whose sum is indeed a. We restrict ourselves to the case 0 less than or slanted equals a less than 10 ⩽a < 1 (with b 0 equals 0b0 = 0) 
since binary expansions for lager numbers are build analogously. Then, choose a element of left bracket 0 comma 1 right parenthesisa ∈
[0, 1) and observe that a lies in exactly one of the two intervals left bracket 0 comma one half right parenthesis[0, 1
2) and left bracket one half comma 1 right parenthesis[ 1
2, 1). 
This ﬁrst choice is equivalent to split left bracket 0 comma 1 right parenthesis[0, 1) into two subintervals, each of length one half1
2. 
If a belong to left bracket 0 comma one half right parenthesis[0, 1
2) we let b 1 equals 0b1 = 0, otherwise we let b 1 equals 1b1 = 1. Hence, as b 0 equals 0b0 = 0, we  
can write the subinterval containing a as left bracket b 0 plus StartFraction b 1 Over 2 EndFraction comma b 0 plus StartFraction b 1 plus 1 Over 2 EndFraction right parenthesis[b0 + b1
2 , b0 + b1+1
2 ), indeed it is equivalent 
to consider the two intervals left bracket b 0 comma b 0 plus one half right parenthesis[b0, b0 + 1
2) and left bracket b 0 plus one half comma b 0 plus two halves right parenthesis[b0 + 1
2, b0 + 2
2). Obviously, the left-
hand point b 0 plus StartFraction b 1 Over 2 EndFractionb0 + b1
2 is the StartFraction largest integer Over 2 EndFraction largest integer
2
less than or equal to a. By further subdividing 
left bracket b 0 plus StartFraction b 1 Over 2 EndFraction comma b 0 plus StartFraction b 1 plus 1 Over 2 EndFraction right parenthesis[b0 + b1
2 , b0 + b1+1
2 ) into two intervals of type left bracket comma right parenthesis[ , ) and equal length one half1
2 we let b 2 equals 0b2 = 0
if a belong to the ﬁrst subinterval, otherwise b 2 equals 1b2 = 1. We can write the subinterval 
containing a as left bracket b 0 plus StartFraction b 1 Over 2 EndFraction plus StartFraction b 2 Over 2 squared EndFraction comma b 0 plus StartFraction b 1 Over 2 EndFraction plus StartFraction b 2 plus 1 Over 2 squared EndFraction right parenthesis[b0 + b1
2 + b2
22 , b0 + b1
2 + b2+1
22 ). Again, the left-hand point of this 
last interval is the StartFraction largest integer Over 2 squared EndFraction largest integer
22
less than or equal to a. Of course, we carry on in 
this manner and ﬁnd b 0 period b 1 b 2 ellipsis b Subscript n Baselineb0.b1b2 . . . bn that by construction differs from a less than StartFraction 1 Over 2 Superscript n Baseline EndFraction 1
2n , 
indeed we can write 
b 0 period b 1 b 2 ellipsis b Subscript n Baseline less than or slanted equals a less than b 0 period b 1 b 2 ellipsis b Subscript n Baseline plus StartFraction 1 Over 2 Superscript n Baseline EndFraction commab0.b1b2 . . . bn ⩽a < b0.b1b2 . . . bn + 1
2n ,
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4
339
340
A
Binary Expansions
since at the nth stage we have subdivided the interval containing a into n subinter-
vals of equal length StartFraction 1 Over 2 Superscript n Baseline EndFraction 1
2n . If we continue this procedure inﬁnitely many times, then 
n right arrow normal infinityn →∞and the equality a equals b 0 period b 1 b 2 b 3 comma ellipsisa = b0.b1b2b3, . . . is proved by a squeezing argument. 
The same construction can be adapted to expand any real number a by a decimal 
representation. We start with the interval left bracket q 0 comma q 0 plus 1 right parenthesis[q0, q0 + 1) containing a, where q 0q0 is 
the largest natural number less than or equal to a. If we divide this interval in 10 
subintervals of type left bracket comma right parenthesis[ , ) and equal length one tenth 1
10, then a lies in exactly one of these 
and we may denote its left-hand point by q 0 plus StartFraction q 1 Over 10 EndFractionq0 + q1
10 where q 1 element of StartSet 0 comma 1 comma 2 comma ellipsis comma 9 EndSetq1 ∈{0, 1, 2, . . . , 9}. 
Now b 0 plus StartFraction q 1 Over 10 EndFractionb0 + q1
10 is the StartFraction largest integer Over 10 EndFraction largest integer
10
which is less than or equal to a. By repeating this 
subdivision n times we get q 0 period q 1 q 2 ellipsis q Subscript n Baselineq0.q1q2 . . . qn that differs from a less than StartFraction 1 Over 10 Superscript n Baseline EndFraction 1
10n . Then, the 
same limiting procedure as above entails the desired equality a equals q 0 period q 1 q 2 q 3 ellipsisa = q0.q1q2q3 . . ..
Appendix B 
Sequences of Real Numbers 
A function f colon StartSet 1 comma 2 comma ellipsis comma n EndSet right arrow double struck upper Rf : {1, 2, . . . , n} →R has image f left parenthesis StartSet 1 comma 2 comma ellipsis comma n EndSet right parenthesis equals StartSet x 1 comma x 2 comma ellipsis comma x Subscript n Baseline EndSet subset of double struck upper Rf ({1, 2, . . . , n}) = {x1, x2, . . . , xn} ⊂
R. We usually write its value at i element of StartSet 1 comma 2 comma ellipsis comma n EndSeti ∈{1, 2, . . . , n} as f left parenthesis i right parenthesis equals x Subscript if (i) = xi and call it a ﬁnite 
sequence. It is possible to deﬁne an inﬁnite sequence simply by switching the 
domain StartSet 1 comma 2 comma ellipsis comma n EndSet{1, 2, . . . , n} into the whole set of natural numbers double struck upper NN. An inﬁnite sequence 
is written x 1 comma x 2 comma ellipsisx1, x2, . . . or brieﬂy left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n where the number x Subscript nxn is called the nth term of 
the sequence and indeed left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n is an indexed family of reals. 
Example B.1 For every n element of double struck upper Nn ∈N let deﬁne: 
StartLayout 1st Row 1st Column x Subscript n Baseline equals left parenthesis negative 1 right parenthesis Superscript n Baseline comma 2nd Column x 1 comma x 2 comma x 3 comma x 4 equals negative 1 comma 1 comma negative 1 comma 1 2nd Row 1st Column y Subscript n Baseline equals StartFraction 1 Over n plus 1 EndFraction comma 2nd Column y 1 comma y 2 comma y 3 comma y 4 equals one half comma one third comma one fourth comma one fifth 3rd Row 1st Column z Subscript n Baseline equals 2 left parenthesis n minus 1 right parenthesis comma 2nd Column z 1 comma z 2 comma z 3 comma z 4 equals 0 comma 2 comma 4 comma 6 period EndLayoutxn = (−1)n,
x1, x2, x3, x4 = −1, 1, −1, 1
yn =
1
n+1,
y1, y2, y3, y4 = 1
2, 1
3, 1
4, 1
5
zn = 2(n −1),
z1, z2, z3, z4 = 0, 2, 4, 6.
They are all inﬁnite sequences, whose ﬁrst four terms are displayed on the right. 
The previous example illustrates some important features of sequences. It may 
happen that x Subscript n 1 Baseline not equals x Subscript n 2xn1 /= xn2 for every n 1 not equals n 2n1 /= n2 in the domain of the sequence, i.e. the 
terms are all distinct. But the sequence with nth term x Subscript n Baseline equals left parenthesis negative 1 right parenthesis Superscript nxn = (−1)n in Example B.1 
shows that recurring terms are admitted. Furthermore, it may happen that x Subscript n Baseline less than or slanted equals x Subscript n plus 1xn ⩽xn+1
or x Subscript n Baseline greater than or slanted equals x Subscript n plus 1xn ⩾xn+1 for every n element of double struck upper Nn ∈N and in the former case we call such a sequence 
increasing, while in the latter case we call it decreasing. In both cases we have a 
monotonic sequence. Thus for larger values n: 
(a) the terms x Subscript nxn are far each other as n goes to inﬁnity, 
(b) the terms x Subscript nxn are never close each other, 
(c) the terms x Subscript nxn are closer each other as n goes to inﬁnity. 
A sequence left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n of type (a) is said to be divergent. If left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n is in addition increasing 
we write limit Underscript n right arrow normal infinity Endscripts x Subscript n Baseline equals normal infinitylimn→∞xn = ∞or x Subscript n Baseline right arrow normal infinityxn →∞. In case (c) the sequence is said to be 
convergent to a number x element of double struck upper Rx ∈R which we call limit and write limit Underscript n right arrow normal infinity Endscripts x Subscript n Baseline equals xlimn→∞xn = x or 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4
341
342
B
Sequences of Real Numbers
Fig. B.1 Top: increasing 
sequence that is divergent. 
Bottom: increasing sequence 
converging to x 
Fig. B.2 Given epsilon greater than 0ϵ > 0, we  
ﬁnd upper M equals 2M = 2 and from this 
value of the index on, n greater than or slanted equals upper Mn ⩾M, 
the terms x 2 comma x 3 comma ellipsisx2, x3, . . . are close 
each other and near x. 
Choosing epsilon prime greater than 0ϵ' > 0 we ﬁnd 
upper M equals 4M = 4 and x 4 comma x 5 comma ellipsisx4, x5, . . . are 
closer and closer to x 
x Subscript n Baseline right arrow xxn →x. Figure B.1 displays the tail behavior of a sequence. For a more formal 
description we need the concept of neighborhood, which enable us to measure how 
close the terms x Subscript nxn are each other in the tail of a sequence, for n large enough. If 
actually the sequence is convergent to x, then we need also to know the nearness of 
the terms x Subscript nxn to the supposed limit x. This proximity can be captured by the open 
interval left parenthesis x minus epsilon comma x plus epsilon right parenthesis(x −ϵ, x +ϵ) centered at x, for which we choose an arbitrary epsilon greater than 0ϵ > 0. Hence, 
if x Subscript n Baseline right arrow xxn →x we can ﬁnd a positive integer M for every epsilon greater than 0ϵ > 0 such that n greater than or slanted equals mn ⩾m implies 
x Subscript n Baseline element of left parenthesis x minus epsilon comma x plus epsilon right parenthesisxn ∈(x −ϵ, x +ϵ). A similar reasoning applies to decreasing sequences converging 
to some x. A decreasing sequence that is divergent entails limit Underscript n right arrow normal infinity Endscripts x Subscript n Baseline equals negative normal infinitylimn→∞xn = −∞. Case  
(b) above refers to sequences that are neither convergent nor divergent as their terms 
instead oscillate. The formal deﬁnition of convergence of a sequence follows (see 
also Fig. B.2): 
Deﬁnition B.1 A sequence left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n is said to be convergent to the limit x if for every 
epsilon greater than 0ϵ > 0 there exists an integer upper M element of double struck upper NM ∈N, which depends upon epsilonϵ, such that n greater than or slanted equals upper M right double arrow StartAbsoluteValue x Subscript n Baseline minus x EndAbsoluteValue less than epsilonn ⩾M ⇒
|xn −x| < ϵ. We write either limit x Subscript n Baseline equals xlim xn = x or x Subscript n Baseline right arrow xxn →x, for n right arrow normal infinityn →∞. 
Example B.2 Let left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n be a sequence with nth term x Subscript n Baseline equals a Superscript nxn = an, where a element of double struck upper Ra ∈R. If  
a equals 1a = 1 we have 1 Superscript n Baseline equals 11n = 1 for every integer n, then whenever epsilon greater than 0ϵ > 0 we ﬁnd upper N element of double struck upper NN ∈N
such that n greater than or slanted equals upper Nn ⩾N implies StartAbsoluteValue 1 minus 1 EndAbsoluteValue less than epsilon|1 −1| < ϵ and the sequence is trivially convergent. Now, 
assume StartAbsoluteValue a EndAbsoluteValue less than 1|a| < 1. Thus, for every epsilon greater than 0ϵ > 0 there exists upper N element of double struck upper NN ∈N such that n greater than or slanted equals upper Nn ⩾N implies 
StartAbsoluteValue a Superscript n Baseline EndAbsoluteValue less than epsilon|an| < ϵ. In fact, epsilon Superscript 1 divided by n Baseline right arrow 1ϵ1/n →1 while StartAbsoluteValue a EndAbsoluteValue less than 1|a| < 1 and then we may ﬁnd N such that 
StartAbsoluteValue a EndAbsoluteValue less than epsilon Superscript 1 divided by upper N|a| < ϵ1/N. From the latter relation we deduce that StartAbsoluteValue a Superscript upper N Baseline EndAbsoluteValue equals StartAbsoluteValue a EndAbsoluteValue Superscript upper N Baseline less than epsilon|aN| = |a|N < ϵ and this in 
turn gives StartAbsoluteValue a Superscript n Baseline EndAbsoluteValue less than StartAbsoluteValue a Superscript upper N Baseline EndAbsoluteValue less than epsilon|an| < |aN| < ϵ for n greater than or slanted equals upper Nn ⩾N. We conclude that a Subscript n Baseline right arrow 0an →0. If StartAbsoluteValue a EndAbsoluteValue greater than 1|a| > 1 the 
sequence diverges, a Superscript n Baseline right arrow normal infinityan →∞. We call a Superscript 1 Baseline comma a squared comma a cubed comma ellipsisa1, a2, a3, . . . a geometric sequence. 
A sequence is bounded above (below) if the set upper R equals StartSet x 1 comma x 2 comma ellipsis EndSetR = {x1, x2, . . .} is such that 
sup upper Rsup R left parenthesis inf upper R right parenthesis(inf R) is ﬁnite. If a sequence left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n is both bounded above and below, then 
is said to be bounded. We can write sup Underscript n Endscripts x Subscript nsupn xn and inf Underscript n Endscripts x Subscript ninfn xn to denote the supremum
B
Sequences of Real Numbers
343
and the inﬁmum of the image set of the sequence. Clearly, for a bounded sequence 
we can ﬁnd a number upper U greater than 0U > 0 such that StartAbsoluteValue x Subscript n Baseline EndAbsoluteValue less than upper U|xn| < U for every n element of double struck upper Nn ∈N, that is x Subscript n Baseline element of left parenthesis negative upper U comma upper U right parenthesisxn ∈
(−U, U). Observe that the sequence left parenthesis left parenthesis negative 1 right parenthesis Superscript n Baseline right parenthesis Subscript n((−1)n)n in Example B.1 is bounded but is 
not convergent. We will see soon that, on the contrary, any convergent sequence is 
always bounded. But ﬁrst, we analyze the behavior of monotonic sequences. 
Theorem B.1 Every increasing sequence (decreasing) which is bounded above 
(below) is convergent. 
Proof By assumption left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n is bounded above then there exists x equals sup left brace x Subscript n Baseline vertical bar n element of double struck upper N right bracex = sup{xn | n ∈
N}. We need to show that limit Underscript n right arrow normal infinity Endscripts x Subscript n Baseline equals xlimn→∞xn = x. Then, pick epsilon greater than 0ϵ > 0 and ﬁnd upper M element of double struck upper NM ∈N
such that x minus epsilon less than x Subscript upper M Baseline less than or slanted equals xx −ϵ < xM ⩽x. We can write x minus x Subscript m Baseline less than epsilonx −xm < ϵ. But left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n is increasing, 
then for every n greater than upper Mn > M we have x Subscript upper M Baseline less than or slanted equals x Subscript nxM ⩽xn and x minus x Subscript n Baseline less than or slanted equals x minus x Subscript upper Mx −xn ⩽x −xM. This implies 
StartAbsoluteValue x minus x Subscript n Baseline EndAbsoluteValue equals x minus x Subscript n Baseline less than or slanted equals x minus x Subscript upper M Baseline less than epsilon|x −xn| = x −xn ⩽x −xM < ϵ and we are done. 
█
If a sequence is increasing and bounded above we write x Subscript n Baseline up arrow xxn ↑x and x equals sup left brace x Subscript n Baseline right bracex = sup{xn}. 
Similarly, for decreasing sequence that are bounded below we write x Subscript n Baseline down arrow xxn ↓x and 
x equals inf left brace x Subscript n Baseline right bracex = inf{xn}. Hence, monotone sequences which are bounded always have a limit. 
The following properties are useful: 
1. If left parenthesis x Subscript n Baseline right parenthesis Subscript n Baseline comma left parenthesis y Subscript n Baseline right parenthesis Subscript n Baseline(xn)n, (yn)n and left parenthesis z Subscript n Baseline right parenthesis Subscript n(zn)n are such that x Subscript n Baseline less than or slanted equals z Subscript n Baseline less than or slanted equals y Subscript nxn ⩽zn ⩽yn for every n and limit x Subscript n Baseline equals limit y Subscript n Baseline equals xlim xn =
lim yn = x, then z Subscript n Baseline right arrow xzn →x. 
2. For every a comma b element of double struck upper Ra, b ∈R the sequence left parenthesis a x Subscript n Baseline plus b y Subscript n Baseline right parenthesis Subscript n(axn + byn)n converges to the limit a x plus b yax + by if 
and only if limit x Subscript n Baseline equals xlim xn = x and limit y Subscript n Baseline equals ylim yn = y. 
3. If left parenthesis x Subscript n Baseline y Subscript n Baseline right parenthesis Subscript n(xnyn)n is obtained by multiplying two convergent sequences x Subscript n Baseline right arrow xxn →x and 
y Subscript n Baseline right arrow yyn →y, then limit x Subscript n Baseline y Subscript n Baseline equals x ylim xnyn = xy. 
4. If x Subscript n Baseline less than or slanted equals y Subscript nxn ⩽yn for every n and x Subscript n Baseline right arrow x comma y Subscript n Baseline right arrow yxn →x, yn →y, then x less than or slanted equals yx ⩽y also known as squeeze 
rule. One can choose the constant sequence y Subscript n Baseline equals ayn = a for each n. The choice 
a equals 0a = 0 provides the sign rule. 
5. If limit Underscript n Endscripts StartAbsoluteValue x Subscript n Baseline EndAbsoluteValue equals zlimn |xn| = z, then the original sequence also converges, x Subscript n Baseline right arrow zxn →z (absolute 
convergence). 
Example B.3 Let left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n be a sequence with nth term x Subscript n Baseline equals StartFraction left parenthesis negative 1 right parenthesis Superscript n minus 1 Baseline Over n factorial EndFractionxn = (−1)n−1
n!
. If we take the 
limit as n right arrow normal infinityn →∞then StartFraction left parenthesis negative 1 right parenthesis Superscript normal infinity Baseline Over normal infinity EndFraction (−1)∞
∞
. Thanks to property 5 above we instead consider the 
sequence of absolute values StartAbsoluteValue x Subscript n Baseline EndAbsoluteValue equals StartAbsoluteValue StartFraction left parenthesis negative 1 right parenthesis Superscript n minus 1 Baseline Over n factorial EndFraction EndAbsoluteValue equals StartFraction StartAbsoluteValue left parenthesis negative 1 right parenthesis Superscript n minus 1 Baseline EndAbsoluteValue Over StartAbsoluteValue n factorial EndAbsoluteValue EndFraction|xn| =
||| (−1)n−1
n!
||| = |(−1)n−1|
|n!|
whose limit exists and 
equals zero. We conclude that x Subscript n Baseline right arrow 0xn →0. 
A convergent sequence has a unique limit. If x Subscript n Baseline right arrow xxn →x and x Subscript n Baseline right arrow yxn →y with x not equals yx /= y, 
then choosing epsilon equals StartFraction StartAbsoluteValue y minus x EndAbsoluteValue Over 4 EndFractionϵ = |y−x|
4
we have: 
left parenthesis x minus epsilon comma x plus epsilon right parenthesis intersection left parenthesis y minus epsilon comma y plus epsilon right parenthesis equals empty set period(x −ϵ, x + ϵ) ∩(y −ϵ, y + ϵ) = ∅.
But by assumption we should have upper M 1 comma upper M 2 element of double struck upper NM1, M2 ∈N such that implies 
n greater than or slanted equals upper M 1 right double arrow x Subscript n Baseline element of left parenthesis x minus epsilon comma x plus epsilon right parenthesis comma and n greater than or slanted equals upper M 2 right double arrow x Subscript n Baseline element of left parenthesis y minus epsilon comma y plus epsilon right parenthesis comman ⩾M1 ⇒xn ∈(x −ϵ, x + ϵ),
and
n ⩾M2 ⇒xn ∈(y −ϵ, y + ϵ),
344
B
Sequences of Real Numbers
which is impossible. For a given sequence left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n we can ‘extract’ a new sequence by 
a proper selection of a subset of indexes in double struck upper NN. More precisely, let i 1 less than i 2 less than i 3 less than midline horizontal ellipsisi1 < i2 < i3 < · · ·
be positive integers and deﬁne the function i Subscript n Baseline right arrow from bar x Subscript i Sub Subscript nin ⍿→xin for every n element of double struck upper Nn ∈N. This is  
nothing but a subsequence of left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n written left parenthesis x Subscript i Sub Subscript n Subscript Baseline right parenthesis Subscript n(xin)n. For example, left parenthesis 2 left parenthesis i Subscript n Baseline minus 1 right parenthesis right parenthesis Subscript n(2(in −1))n for 
i Subscript n Baseline element of StartSet 2 comma 4 comma 6 comma ellipsis EndSet subset of double struck upper Nin ∈{2, 4, 6, . . .} ⊂N is a subsequence of left parenthesis 2 left parenthesis n minus 1 right parenthesis right parenthesis Subscript n(2(n −1))n for n element of double struck upper Nn ∈N.
Appendix C 
Limit Superior and Limit Inferior 
Let left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n be a bounded sequence. Thus, we can construct two monotonic 
sequences:
•
.un = sup{xn, xn+1, . . .} such that left parenthesis u Subscript n Baseline right parenthesis Subscript n(un)n is decreasing, u Subscript n Baseline greater than or slanted equals u Subscript n plus 1un ⩾un+1 for every 
n element of double struck upper N semicolonn ∈N;
•
.dn = inf{xn, xn+1, . . .} such that left parenthesis d Subscript n Baseline right parenthesis Subscript n(dn)n is increasing, d Subscript n Baseline less than or slanted equals d Subscript n plus 1dn ⩽dn+1 for every n element of double struck upper Nn ∈N. 
For n lager enough the set StartSet x Subscript n Baseline comma x Subscript n plus 1 Baseline comma ellipsis EndSet{xn, xn+1, . . .} becomes smaller, then the set of its upper 
bounds is smaller too, while the set of its lower bounds is bigger. Clearly, d Subscript n Baseline less than or slanted equals u Subscript ndn ⩽un
for every n element of double struck upper Nn ∈N. This implies that for m less than or slanted equals n colonm ⩽n :
d Subscript m Baseline less than or slanted equals d Subscript n Baseline less than or slanted equals u Subscript n Baseline less than or slanted equals u Subscript m Baseline commadm ⩽dn ⩽un ⩽um,
so d Subscript m Baseline less than or slanted equals u Subscript ndm ⩽un for every pair of naturals m comma n periodm, n. We deduce that:
•
.(un)n is decreasing and bounded below by some d Subscript m Baseline semicolondm;
•
.(dn)n increasing and bounded above by some u Subscript nun. 
Theorem B.1 now implies u Subscript n Baseline right arrow uun →u and d Subscript n Baseline right arrow ddn →d. Furthermore, by the squeeze rule 
we also have d less than or slanted equals ud ⩽u. We call limit inferior of left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n the number 
d equals limit inf x Subscript n Baseline equals sup Underscript n Endscripts left brace inf Underscript k greater than or slanted equals n Endscripts x Subscript k Baseline right brace commad = lim inf xn = sup
n
⌠
inf
k⩾n xk
⎫
,
and limit superior the number 
u equals limit sup x Subscript n Baseline equals inf Underscript n Endscripts left brace sup Underscript k greater than or slanted equals n Endscripts x Subscript k Baseline right brace periodu = lim sup xn = inf
n
⌠
sup
k⩾n
xk
⎫
.
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4
345
346
C
Limit Superior and Limit Inferior
In fact, inf Underscript k greater than or slanted equals n Endscripts x Subscript k Baseline equals d Subscript ninfk⩾n xk = dn e sup Underscript k greater than or slanted equals n Endscripts x Subscript k Baseline equals u Subscript nsupk⩾n xk = un. Eventually we have: 
Proposition C.1 Let left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n be a bounded sequence. Then it is convergent to the limit 
x if and only if limit inf x Subscript n Baseline equals limit sup x Subscript n Baseline equals xlim inf xn = lim sup xn = x. 
We rephrase Proposition C.1 by saying that any convergent sequence is always 
bounded, but the converse is not true. 
Proof of Proposition C.1 .(⇐) By deﬁnition, we have d Subscript n Baseline less than or slanted equals x Subscript n Baseline less than or slanted equals u Subscript ndn ⩽xn ⩽un, for every 
n element of double struck upper Nn ∈N. Now, assume limit inf x Subscript n Baseline equals limit sup x Subscript n Baseline equals xlim inf xn = lim sup xn = x. We have that limit d Subscript n Baseline equals limit u Subscript n Baseline equals xlim dn = lim un =
x, then by the squeeze rule x Subscript n Baseline right arrow xxn →x. left parenthesis right double arrow right parenthesis(⇒) Let us suppose that limit x Subscript n Baseline equals xlim xn = x. By  
Deﬁnition B.1, for a given epsilon greater than 0ϵ > 0 we can ﬁnd a positive integer M t.c. n greater than or slanted equals upper Mn ⩾M
implies StartAbsoluteValue x Subscript n Baseline minus x EndAbsoluteValue less than epsilon|xn −x| < ϵ. The sequence StartSet s Subscript upper M Baseline comma s Subscript upper M plus 1 Baseline comma ellipsis EndSet{sM, sM+1, . . .} has the lower bound x minus epsilonx −ϵ and 
the upper bound x plus epsilonx + ϵ. Thus, it is bounded and we can construct two sequences 
left parenthesis d Subscript n Baseline right parenthesis Subscript n greater than or slanted equals upper M(dn)n⩾M e left parenthesis u Subscript n Baseline right parenthesis Subscript n greater than or slanted equals upper M(un)n⩾M such that x minus epsilon less than or slanted equals d Subscript upper M Baseline less than or slanted equals u Subscript upper M Baseline less than or slanted equals x plus epsilonx −ϵ ⩽dM ⩽uM ⩽x + ϵ. This implies: 
x minus epsilon less than or slanted equals limit inf x Subscript n Baseline less than or slanted equals limit sup x Subscript n Baseline less than or slanted equals x plus epsilon periodx −ϵ ⩽lim inf xn ⩽lim sup xn ⩽x + ϵ.
As epsilon greater than 0ϵ > 0 is an arbitrary number we obtain x less than or slanted equals limit inf x Subscript n Baseline less than or slanted equals limit sup x Subscript n Baseline less than or slanted equals xx ⩽lim inf xn ⩽lim sup xn ⩽x, and it 
must hold limit inf x Subscript n Baseline equals limit sup x Subscript n Baseline equals xlim inf xn = lim sup xn = x. 
█
It is easily seen that inf left brace x Subscript n Baseline right brace equals minus sup left brace minus x Subscript n Baseline right braceinf{xn} = −sup{−xn}. We then have: 
StartLayout 1st Row 1st Column sup Underscript n Endscripts left brace inf Underscript k greater than or slanted equals n Endscripts x Subscript k Baseline right brace 2nd Column equals 3rd Column minus inf Underscript n Endscripts left brace minus left parenthesis minus sup Underscript k greater than or slanted equals n Endscripts minus x Subscript k Baseline right parenthesis right brace 2nd Row 1st Column Blank 2nd Column equals 3rd Column minus inf Underscript n Endscripts left brace sup Underscript k greater than or slanted equals n Endscripts minus x Subscript k Baseline right brace period EndLayoutsup
n
⌠
inf
k⩾n xk
⎫
= −inf
n
⌠
−
⎛
−sup
k⩾n
−xk
⎞⎫
= −inf
n
⌠
sup
k⩾n
−xk
⎫
.
That is, limit inf x Subscript n Baseline equals minus limit sup left parenthesis minus x Subscript n Baseline right parenthesislim inf xn = −lim sup(−xn) and similarly limit sup x Subscript n Baseline equals minus limit inf left parenthesis minus x Subscript n Baseline right parenthesislim sup xn = −lim inf(−xn). 
Example C.1 Let left parenthesis x Subscript n Baseline right parenthesis Subscript n Baseline equals left parenthesis left parenthesis negative 1 right parenthesis Superscript n Baseline right parenthesis Subscript n(xn)n = ((−1)n)n and left parenthesis y Subscript n Baseline right parenthesis Subscript n Baseline equals left parenthesis left parenthesis negative 1 right parenthesis Superscript n Baseline left parenthesis 2 plus StartFraction 1 Over n EndFraction right parenthesis plus 2 right parenthesis Subscript n(yn)n = ((−1)n(2 + 1
n) + 2)n be two real 
sequences. We are going to compute their limits superior and inferior. For the ﬁrst 
sequence, observe that for every n element of double struck upper Nn ∈N we may ﬁnd an integer k such that k greater than or slanted equals nk ⩾n
implies left parenthesis negative 1 right parenthesis Superscript k Baseline equals 1(−1)k = 1. Clearly, sup left brace x Subscript n Baseline vertical bar k greater than or slanted equals n right brace equals 1sup{xn | k ⩾n} = 1 and taking the limit 
limit Underscript n right arrow normal infinity Endscripts sup left brace x Subscript n Baseline vertical bar k greater than or slanted equals n right brace equals inf Underscript n Endscripts left brace sup left brace x Subscript n Baseline vertical bar k greater than or slanted equals n right brace right brace equals limit sup x Subscript n Baseline equals 1 period lim
n→∞sup{xn | k ⩾n} = inf
n {sup{xn | k ⩾n}} = lim sup xn = 1.
In the same way we obtain limit inf x Subscript n Baseline equals negative 1lim inf xn = −1. For the second sequence, with the 
same reasoning we ﬁnd an integer k such that k greater than or slanted equals nk ⩾n implies sup left brace y Subscript n Baseline vertical bar k greater than or slanted equals n right brace equals left parenthesis left parenthesis 2 plus StartFraction 1 Over n EndFraction right parenthesis plus 2 right parenthesissup{yn | k ⩾n} =
((2 + 1
n) + 2) and taking the limit: 
limit Underscript n right arrow normal infinity Endscripts sup left brace y Subscript n Baseline colon k greater than or slanted equals n right brace equals inf Underscript n Endscripts left brace sup left brace y Subscript n Baseline colon k greater than or slanted equals n right brace right brace equals limit sup y Subscript n Baseline equals 4 period lim
n→∞sup{yn : k ⩾n} = inf
n {sup{yn : k ⩾n}} = lim sup yn = 4.
Similarly, we see that limit inf y Subscript n Baseline equals 0lim inf yn = 0.
C
Limit Superior and Limit Inferior
347
If left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n and left parenthesis y Subscript n Baseline right parenthesis Subscript n(yn)n are two bounded sequences it is always true that: 
limit sup left parenthesis x Subscript n Baseline plus y Subscript n Baseline right parenthesis less than or slanted equals limit sup x Subscript n Baseline plus limit sup y Subscript n Baseline periodlim sup(xn + yn) ⩽lim sup xn + lim sup yn.
Moreover, since limit sup left parenthesis left parenthesis minus x Subscript n Baseline right parenthesis plus left parenthesis minus y Subscript n Baseline right parenthesis right parenthesis less than or slanted equals limit sup left parenthesis minus x Subscript n Baseline right parenthesis plus limit sup left parenthesis minus y Subscript n Baseline right parenthesislim sup((−xn) + (−yn)) ⩽lim sup(−xn) + lim sup(−yn) we can 
multiply both sides by negative 1−1 and get: 
limit inf left parenthesis x Subscript n Baseline plus y Subscript n Baseline right parenthesis greater than or slanted equals limit inf x Subscript n Baseline plus limit inf y Subscript n Baseline periodlim inf(xn + yn) ⩾lim inf xn + lim inf yn.
Thanks to Proposition C.1, every bounded sequence left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n has at least one sub-
sequence left parenthesis x Subscript i Sub Subscript n Subscript Baseline right parenthesis Subscript n Baseline subset of left parenthesis x Subscript n Baseline right parenthesis Subscript n(xin)n ⊂(xn)n which is convergent (Bolzano-Weierstrass theorem). An 
alternative characterization of convergence is the following: 
Proposition C.2 Let left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n be a sequence. The set StartSet n element of double struck upper N vertical bar StartAbsoluteValue x Subscript n Baseline minus x EndAbsoluteValue greater than or slanted equals epsilon EndSet{n ∈N | |xn −x| ⩾ϵ} is ﬁnite 
if and only if left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n converges to the limit x. 
Proof Suppose x Subscript n Baseline right arrow xxn →x. Then, by Deﬁnition B.1 we have that the set StartSet n element of double struck upper N colon StartAbsoluteValue x Subscript n Baseline minus x EndAbsoluteValue greater than or slanted equals epsilon EndSet{n ∈N :
|xn −x| ⩾ϵ} contains at most k minus 1k −1 points. Conversely, if such is ﬁnite, then we 
would ﬁnd an upper bound upper U element of double struck upper RU ∈R. But choosing k equals upper U plus 1k = U + 1 we have StartAbsoluteValue x Subscript n Baseline minus x EndAbsoluteValue less than epsilon|xn −x| < ϵ
whenever n greater than or slanted equals kn ⩾k and so x Subscript n Baseline right arrow xxn →x. 
█
Recall that the product of a bounded sequence left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n by a convergent sequence 
left parenthesis y Subscript n Baseline right parenthesis Subscript n(yn)n is always a convergent sequence in its own. For example, left parenthesis left parenthesis negative one half right parenthesis Superscript n Baseline right parenthesis Subscript n((−1
2)n)n can be 
written as the product between two sequence, left parenthesis left parenthesis negative 1 right parenthesis Superscript n Baseline right parenthesis Subscript n((−1)n)n and left parenthesis left parenthesis one half right parenthesis Superscript n Baseline right parenthesis Subscript n(( 1
2)n)n, the former 
is bounded but not convergent while the latter is convergent to zero and we have 
limit Underscript n Endscripts left parenthesis negative 1 right parenthesis Superscript n Baseline one half right parenthesis Superscript n Baseline equals 0limn(−1)n 1
2)n = 0 too. We say that left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n is a Cauchy sequence if for every epsilon greater than 0ϵ > 0
there exists a natural k element of double struck upper Nk ∈N such that i comma j greater than or slanted equals ki, j ⩾k implies StartAbsoluteValue x Subscript i Baseline minus x Subscript j Baseline EndAbsoluteValue less than epsilon|xi −xj| < ϵ. In this case by 
choosing j equals kj = k we get: 
x Subscript k Baseline minus epsilon less than or slanted equals x Subscript i Baseline less than or slanted equals x Subscript k Baseline plus epsilon comma for every i greater than or slanted equals k periodxk −ϵ ⩽xi ⩽xk + ϵ,
for every
i ⩾k.
It follows that left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n bounded below the maximal element in StartSet x 1 comma x 2 comma ellipsis comma x Subscript k minus 1 Baseline comma x Subscript k Baseline minus epsilon EndSet{x1, x2, . . . , xk−1, xk −
ϵ}, and is also bounded above by the minimal element in StartSet x 1 comma x 2 comma ellipsis comma x Subscript k minus 1 Baseline comma x Subscript k Baseline plus epsilon EndSet{x1, x2, . . . , xk−1, xk + ϵ}. 
Hence, every Cauchy sequence is bounded. Furthermore, it holds 
x Subscript k Baseline minus epsilon less than or slanted equals d Subscript k Baseline less than or slanted equals u Subscript k Baseline less than or slanted equals x Subscript k Baseline plus epsilon commaxk −ϵ ⩽dk ⩽uk ⩽xk + ϵ,
which implies: 
x Subscript k Baseline minus epsilon less than or slanted equals d less than or slanted equals u less than or slanted equals x Subscript k Baseline plus epsilon long left right double arrow 0 less than or slanted equals u minus d less than or slanted equals 2 epsilon periodxk −ϵ ⩽d ⩽u ⩽xk + ϵ ⇐⇒0 ⩽u −d ⩽2ϵ.
As the number epsilon greater than 0ϵ > 0 is arbitrary we conclude that u equals du = d and the limit inferior 
equals the limit superior, then the Cauchy sequence left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n is also convergent. The 
converse is also true: any convergent sequence of real numbers is also a Cauchy 
sequence.
348
C
Limit Superior and Limit Inferior
Example C.2 The sequence left parenthesis left parenthesis negative 1 right parenthesis Superscript n Baseline right parenthesis Subscript n((−1)n)n is bounded but is not convergent, then it is 
not a Cauchy sequence. In fact, its terms are never arbitrarily close each other. The 
sequence left parenthesis left parenthesis negative one half right parenthesis Superscript n Baseline right parenthesis Subscript n((−1
2)n)n has terms negative one half comma one fourth comma negative one eighth comma one sixteenth comma ellipsis−1
2, 1
4, −1
8, 1
16, . . . that are closer each other as n 
is large enough and are also closer to zero. Then, the latter sequence is a Cauchy 
sequence.
Appendix D 
Inﬁnite Sums 
Let left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n be a sequence of real numbers. We can build partial sums: 
s 1 equals x 1 comma s 2 equals x 1 plus x 2 comma s 3 equals x 1 plus x 2 plus x 3 comma ellipsis periods1 = x1,
s2 = x1 + x2,
s3 = x1 + x2 + x3, . . . .
Clearly, left parenthesis s Subscript n Baseline right parenthesis Subscript n(sn)n is a new sequence for which it makes sense to verify its convergence: 
limit Underscript n right arrow normal infinity Endscripts s Subscript n Baseline equals limit Underscript n right arrow normal infinity Endscripts sigma summation Underscript k equals 1 Overscript n Endscripts x Subscript k Baseline equals sigma summation Underscript k equals 1 Overscript normal infinity Endscripts x Subscript k Baseline period lim
n→∞sn = lim
n→∞
n
⎲
k=1
xk =
∞
⎲
k=1
xk.
The sequence of partial sums is said to be an inﬁnite series, and is usually denoted 
by the symbol sigma summation Underscript k equals 1 Overscript normal infinity Endscripts x Subscript k∑∞
k=1 xk. If all terms x Subscript nxn in the original sequence are all non-negative 
we have: 
either sigma summation Underscript k equals 1 Overscript normal infinity Endscripts x Subscript k Baseline equals x or sigma summation Underscript k equals 1 Overscript normal infinity Endscripts x Subscript k Baseline equals normal infinity comma x Subscript k Baseline greater than or slanted equals 0 periodeither
∞
⎲
k=1
xk = x
or
∞
⎲
k=1
xk = ∞,
xk ⩾0.
We can recover a sequence from a series by letting x 1 equals s 1x1 = s1 and x Subscript n Baseline equals s Subscript n Baseline minus s Subscript n minus 1xn = sn −sn−1, 
for n greater than or slanted equals 2n ⩾2. A series is said to be absolutely convergent if the series sigma summation Underscript k Endscripts StartAbsoluteValue x Subscript k Baseline EndAbsoluteValue∑
k |xk| is 
indeed convergent. This always implies that also sigma summation Underscript k Endscripts x Subscript k∑
k xk is convergent. Moreover, 
the convergence of the series, sigma summation Underscript k Endscripts x Subscript k Baseline equals x∑
k xk = x, implies that of the original sequence, 
limit Underscript n Endscripts x Subscript n Baseline equals 0limn xn = 0. 
Example D.1 Let sigma summation Underscript k equals 1 Overscript n Endscripts x Subscript k Baseline equals s Subscript n∑n
k=1 xk = sn be such that x Subscript k Baseline equals StartFraction 1 Over k EndFractionxk =
1
k. Deﬁne the inﬁnite sum 
limit Underscript n Endscripts sigma summation Underscript k equals 1 Overscript n Endscripts x Subscript k Baseline equals limit Underscript n Endscripts s Subscript n Baseline equals sigma summation Underscript k equals 1 Overscript normal infinity Endscripts x Subscript klimn
∑n
k=1 xk = limn sn = ∑∞
k=1 xk. Observe that: sigma summation Underscript k equals 1 Overscript normal infinity Endscripts x Subscript k Baseline equals 1 plus one half plus left parenthesis one third plus one fourth right parenthesis plus left parenthesis one fifth plus midline horizontal ellipsis plus one eighth right parenthesis plus left parenthesis one ninth plus midline horizontal ellipsis plus one sixteenth right parenthesis plus midline horizontal ellipsis∑∞
k=1 xk = 1 + 1
2 +
⎛
1
3 + 1
4
⎞
+
⎛
1
5 + · · · + 1
8
⎞
+
⎛
1
9 + · · · + 1
16
⎞
+ · · · , where 
StartLayout 1st Row 1st Column one third plus one fourth 2nd Column greater than 3rd Column one fourth plus one fourth equals one half 2nd Row 1st Column one fifth plus midline horizontal ellipsis plus one eighth 2nd Column greater than 3rd Column one eighth plus midline horizontal ellipsis plus one eighth equals one half 3rd Row 1st Column one ninth plus midline horizontal ellipsis plus one sixteenth 2nd Column greater than 3rd Column one sixteenth plus midline horizontal ellipsis plus one sixteenth equals one half EndLayout1
3 + 1
4 > 1
4 + 1
4 = 1
2
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024
D. Rossello, A Cookbook with Probability One, La Matematica per il 3 2 161,
+
https://doi.org/10.1007/978-3-031-54688-4
349
350
D
Inﬁnite Sums
1 
5 + · · · +  1 
8 > 1 
8 + · · · +  1 
8 = 1 
2 
1 
9 + · · · +  1 
16 > 1 
16 + · · · +  1 
16 = 1 
2 
and so on. The behavior of the partial sums is that of a divergent sequence: 
StartLayout 1st Row 1st Column sigma summation Underscript k equals 1 Overscript n Endscripts StartFraction 1 Over k EndFraction 2nd Column greater than 3rd Column 1 plus ModifyingBelow left parenthesis one half plus one half plus one half plus one half right parenthesis With bottom brace Underscript equals 2 Endscripts plus ModifyingBelow left parenthesis one half plus midline horizontal ellipsis plus one half right parenthesis With bottom brace Underscript equals 3 Endscripts plus midline horizontal ellipsis EndLayout
n
⎲
k=1
1
k > 1 +
⎛
1
2 + 1
2 + 1
2 + 1
2
⎞
◟
◝ ◜
◞
= 2
+
⎛
1
2 + · · · + 1
2
⎞
◟
◝ ◜
◞
= 3
+ · · ·
We conclude that limit Underscript n Endscripts sigma summation Underscript k equals 1 Overscript n Endscripts StartFraction 1 Over k EndFraction equals normal infinitylimn
∑n
k=1
1
k = ∞, i.e. the series diverges. The inﬁnite sum 
sigma summation Underscript k equals 1 Overscript normal infinity Endscripts StartFraction 1 Over k EndFraction∑∞
k=1
1
k is also known as harmonic series. 
Example D.2 Let left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n be the sequence of Example B.2, with nth term x Subscript n Baseline equals a Superscript nxn = an. 
Let us consider the inﬁnite sum sigma summation Underscript k equals 1 Overscript normal infinity Endscripts a Superscript k∑∞
k=1 ak and show that the nth partial sum is a StartFraction 1 minus a Superscript n Baseline Over 1 minus a EndFractiona 1−an
1−a . 
Let 
s Subscript n Baseline equals sigma summation Underscript k equals 1 Overscript n Endscripts a Superscript k Baseline equals a plus a squared plus a cubed plus midline horizontal ellipsis plus a Superscript nsn =
n
⎲
k=1
ak = a + a2 + a3 + · · · + an
and write 
a s Subscript n Baseline equals a squared plus a cubed plus midline horizontal ellipsis plus a Superscript n plus 1 Baseline periodasn = a2 + a3 + · · · + an+1.
Subtracting terms by terms the above equalities we indeed get s Subscript n Baseline left parenthesis 1 minus a right parenthesis equals a left parenthesis 1 minus a Superscript n Baseline right parenthesissn(1−a) = a(1−an). 
If we assume StartAbsoluteValue a EndAbsoluteValue less than 1|a| < 1, then limit Underscript n Endscripts s Subscript n Baseline equals StartFraction a Over 1 minus a EndFractionlimn sn =
a
1−a and the series converges. The inﬁnite sum 
sigma summation Underscript k equals 1 Overscript normal infinity Endscripts a Superscript k∑∞
k=1 ak is also known as a geometric series. We may write sigma summation Underscript k equals 0 Overscript normal infinity Endscripts a Superscript k∑∞
k=0 ak so that the 
series start from a Superscript 0 Baseline equals 1a0 = 1. The previous computation of the nth term still applies and 
gives StartFraction 1 minus a Superscript n Baseline Over 1 minus a EndFraction 1−an
1−a as the new partial sum, which converges to StartFraction 1 Over 1 minus a EndFraction
1
1−a as n right arrow normal infinityn →∞and StartAbsoluteValue a EndAbsoluteValue less than 1|a| < 1. 
A double series is deﬁned by partial sums of type left parenthesis s Subscript n m Baseline right parenthesis Subscript n m(snm)nm, where n comma m element of double struck upper Nn, m ∈N. The  
terms s 11 comma s 12 comma s 21 comma s 13 comma ellipsiss11, s12, s21, s13, . . . can be collected into a matrix with an inﬁnite number of 
rows and columns. If we assume s Subscript n m Baseline greater than or slanted equals 0snm ⩾0 for every n comma m element of double struck upper Nn, m ∈N, then we can always 
write: 
sigma summation Underscript n equals 1 Overscript normal infinity Endscripts sigma summation Underscript m equals 1 Overscript normal infinity Endscripts s Subscript n m Baseline equals sigma summation Underscript m equals 1 Overscript normal infinity Endscripts sigma summation Underscript n equals 1 Overscript normal infinity Endscripts s Subscript n m Baseline period
∞
⎲
n=1
∞
⎲
m=1
snm =
∞
⎲
m=1
∞
⎲
n=1
snm.
(D.1) 
Indeed, the previous equality holds whenever both sums are ﬁnite. On the other 
hand, we can write: 
sigma summation Underscript n equals 1 Overscript normal infinity Endscripts sigma summation Underscript m equals 1 Overscript normal infinity Endscripts s Subscript n m Baseline greater than or slanted equals sigma summation Underscript i equals 1 Overscript n Endscripts sigma summation Underscript j equals 1 Overscript m Endscripts s Subscript i j Baseline equals sigma summation Underscript j equals 1 Overscript m Endscripts sigma summation Underscript i equals 1 Overscript n Endscripts s Subscript i j Baseline comma
∞
⎲
n=1
∞
⎲
m=1
snm ⩾
n
⎲
i=1
m
⎲
j=1
sij =
m
⎲
j=1
n
⎲
i=1
sij,
D
Inﬁnite Sums
351
and taking the limit as n comma m right arrow normal infinityn, m →∞we get 
sigma summation Underscript n equals 1 Overscript normal infinity Endscripts sigma summation Underscript m equals 1 Overscript normal infinity Endscripts s Subscript n m Baseline greater than or slanted equals sigma summation Underscript m equals 1 Overscript normal infinity Endscripts sigma summation Underscript n equals 1 Overscript normal infinity Endscripts s Subscript n m Baseline period
∞
⎲
n=1
∞
⎲
m=1
snm ⩾
∞
⎲
m=1
∞
⎲
n=1
snm.
This reasoning applies as well by inverting the indexes of the sums, then equal-
ity (D.1) must hold.
Appendix E 
Open Subsets of Real Numbers 
A topological space is a non-empty set X together with a collection tauτ of its subsets 
such that: 
T1 X and empty set∅belong to tauτ, 
T2 for arbitrary unions union Subscript i Baseline upper A Subscript i∪iAi of sets upper A Subscript iAi in tauτ it holds union Subscript i Baseline upper A Subscript i element of tau∪iAi ∈τ, 
T2 ﬁnite intersections intersection Subscript i equals 1 Superscript n Baseline upper A Subscript i∩n
i=1Ai of sets upper A Subscript iAi in tauτ are again here, intersection Subscript i equals 1 Superscript n Baseline upper A Subscript i Baseline element of tau period∩n
i=1Ai ∈τ.
The collection tauτ is said to contain open sets, actually subsets of upper X periodX. We know that a 
given subset upper O subset of double struck upper RO ⊂R sis open if for every x element of upper Ox ∈O there exists an open interval left parenthesis a comma b right parenthesis(a, b)
containing x and which is contained in upper O commaO, i.e. x element of left parenthesis a comma b right parenthesis subset of upper O periodx ∈(a, b) ⊂O. We can choose the 
neighborhood upper O equals left parenthesis x minus delta comma x plus delta right parenthesisO = (x −δ, x + δ) centered at x commax, where as usual delta greater than 0 periodδ > 0. Recall that 
an open interval is the set left parenthesis a comma b right parenthesis colon equals StartSet x element of double struck upper R vertical bar a less than x less than b EndSet(a, b) := {x ∈R | a < x < b} and a closed interval is the 
set left bracket a comma b right bracket colon equals StartSet x element of double struck upper R vertical bar a less than or slanted equals x less than or slanted equals b EndSet period[a, b] := {x ∈R | a ⩽x ⩽b}. Half-open intervals left parenthesis a comma b right bracket(a, b] and left bracket a comma b right parenthesis[a, b) are deﬁned 
analogously. In the former case it may happen a equals negative normal infinitya = −∞and in the latter b equals normal infinity periodb = ∞. A 
set C is said to be closed if its complement upper C Superscript c Baseline equals double struck upper R minus upper CCc = R \ C is indeed open. It can be 
shown that a set upper O element of tauO ∈τ is open if and only if its complement is closed. A function 
f colon upper A right arrow double struck upper Rf : A →R with domain upper A subset of double struck upper RA ⊂R is said to be continuous at a point c element of upper Ac ∈A if for 
every neighborhood left parenthesis f left parenthesis c right parenthesis minus epsilon comma f left parenthesis c right parenthesis plus epsilon right parenthesis subset of f left parenthesis upper A right parenthesis(f (c) −ϵ, f (c) + ϵ) ⊂f (A) centered at f left parenthesis c right parenthesisf (c) will correspond 
a neighborhood left parenthesis c minus delta comma c plus delta right parenthesis subset of upper A(c −δ, c + δ) ⊂A centered at c periodc. we can write: 
for all epsilon greater than 0 comma there exists delta greater than 0 t period c period StartAbsoluteValue x minus c EndAbsoluteValue less than delta right double arrow StartAbsoluteValue f left parenthesis x right parenthesis minus f left parenthesis c right parenthesis EndAbsoluteValue less than epsilon comma∀ϵ > 0, ∃δ > 0 t.c. |x −c| < δ ⇒|f (x) −f (c)| < ϵ,
(E.1) 
or more compactly limit Underscript x right arrow c Endscripts f left parenthesis x right parenthesis equals f left parenthesis c right parenthesis periodlimx→c f (x) = f (c). This is also the classical epsilon minus deltaϵ −δ deﬁnition 
of limit. The function f is said to be simply continuous if it is continuous at every 
point of its domain upper A periodA. If a function is not continuous at a point c on its domain we 
say that it is discontinuous at c periodc. A function f whose domain contains an interval 
left bracket c comma c plus delta right parenthesis[c, c + δ) for some delta greater than 0δ > 0 is continuous on the right at c if: 
for each left parenthesis x Subscript n Baseline right parenthesis Subscript n Baseline subset of left bracket c comma c plus delta right parenthesis such that x Subscript n Baseline right arrow c comma then f left parenthesis x Subscript n Baseline right parenthesis right arrow f left parenthesis c right parenthesis periodfor each
(xn)n ⊂[c, c + δ)
such that xn →c, then f (xn) →f (c).
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4
353
354
E
Open Subsets of Real Numbers
Similarly, f is said to be continuous on the left at c if the above limit exists with 
respect to a sequence left parenthesis x Subscript n Baseline right parenthesis Subscript n Baseline subset of left parenthesis c minus delta comma c right bracket period(xn)n ⊂(c −δ, c]. Clearly, a function which is continuous at 
c must be both continuous on the right and on the left at c periodc. The classical rephrasing 
of these sequential limits read: limit Underscript x down arrow c Endscripts f left parenthesis x right parenthesis equals f left parenthesis c right parenthesis commalimx↓c f (x) = f (c), where x down arrow cx ↓c means x right arrow cx →c
and c less than x commac < x, and limit Underscript x up arrow c Endscripts f left parenthesis x right parenthesis equals f left parenthesis c right parenthesis commalimx↑c f (x) = f (c), where x up arrow cx ↑c means x right arrow cx →c and c greater than x periodc > x. A 
function has a jump discontinuity at c whenever the right-hand limit and the left-
hand limit both exist (ﬁnite) but are different. Recall that the sum, the product and 
the quotient of two continuous functions is again a continuous function. In the latter 
case we must assume the function on the denominator being different from 0. There 
is an equivalent formulation of continuity for functions between topological spaces 
which is very useful. Here we specialize to functions from upper A subset of double struck upper RA ⊂R to double struck upper R commaR, where 
left parenthesis double struck upper R comma tau right parenthesis(R, τ) denotes the real topological space. 
Theorem E.1 A function f colon upper A right arrow double struck upper Rf : A →R is said to be continuous if and only if for 
every open set upper O element of tauO ∈τ the inverse image f Superscript negative 1 Baseline left parenthesis upper O right parenthesisf −1(O) is an open set in tau periodτ.
Proof (right double arrow⇒) By hypotheses f is continuous: 
there exists epsilon greater than 0 such that x element of left parenthesis c minus delta comma c plus delta right parenthesis right double arrow f left parenthesis x right parenthesis element of left parenthesis f left parenthesis c right parenthesis minus epsilon comma f left parenthesis c right parenthesis plus epsilon right parenthesis comma for some delta greater than 0 period∃ϵ > 0 such that x ∈(c−δ, c+δ) ⇒f (x) ∈(f (c)−ϵ, f (c)+ϵ),
for some δ > 0.
If c element of f Superscript negative 1 Baseline left parenthesis upper O right parenthesisc ∈f −1(O) then f left parenthesis c right parenthesis element of upper O commaf (c) ∈O, but O is open so 
there exists epsilon greater than 0 such that left parenthesis f left parenthesis c right parenthesis minus epsilon comma f left parenthesis c right parenthesis plus epsilon right parenthesis subset of upper O period∃ϵ > 0 such that (f (c) −ϵ, f (c) + ϵ) ⊂O.
This implies that f left parenthesis x right parenthesis element of upper Of (x) ∈O if and only if x element of left parenthesis c minus delta comma c plus delta right parenthesis commax ∈(c−δ, c+δ), hence the open interval is 
a neighborhood of c and is contained in f Superscript negative 1 Baseline left parenthesis upper O right parenthesis commaf −1(O), which is an open set. (left double arrow⇐) Assume 
that O is open. Then, f Superscript negative 1 Baseline left parenthesis upper O right parenthesisf −1(O) is open too. Pick c element of upper Ac ∈A and epsilon greater than 0ϵ > 0 and consider the 
open neighborhood left parenthesis f left parenthesis c right parenthesis minus epsilon comma f left parenthesis c right parenthesis plus epsilon right parenthesis period(f (c) −ϵ, f (c) + ϵ). We can let upper O equals left parenthesis f left parenthesis c right parenthesis minus epsilon comma f left parenthesis c right parenthesis plus epsilon right parenthesis periodO = (f (c) −ϵ, f (c) + ϵ).
The inverse image f Superscript negative 1 Baseline left parenthesis upper O right parenthesisf −1(O) is also open and contains the point c periodc. We can ﬁnd epsilon greater than 0ϵ > 0
such that left parenthesis c minus delta comma c plus delta right parenthesis subset of f Superscript negative 1 Baseline left parenthesis upper O right parenthesis comma(c −δ, c + δ) ⊂f −1(O), then it follows: 
x element of left parenthesis c minus delta comma c plus delta right parenthesis subset of f Superscript negative 1 Baseline left parenthesis left parenthesis f left parenthesis c right parenthesis minus epsilon comma f left parenthesis c right parenthesis plus epsilon right parenthesis right parenthesis right double arrow f left parenthesis x right parenthesis element of left parenthesis f left parenthesis c right parenthesis minus epsilon comma f left parenthesis c right parenthesis plus epsilon right parenthesis commax ∈(c −δ, c + δ) ⊂f −1 ((f (c) −ϵ, f (c) + ϵ)) ⇒f (x) ∈(f (c) −ϵ, f (c) + ϵ),
that is f is continuous. 
█
The following result is fundamental: 
Theorem E.2 Let left brace upper O Subscript i Baseline right brace Subscript i element of upper I{Oi}i∈I be an indexed family of open sets in left parenthesis double struck upper R comma tau right parenthesis period(R, τ). Then:
•
.∪i∈IOi is open
•
the ﬁnite intersection intersection Subscript i equals 1 Superscript n Baseline upper O Subscript i∩n
i=1Oi is open. 
Proof For every x element of union Subscript i element of upper I Baseline upper O Subscript ix ∈∪i∈IOi we can ﬁnd i element of upper Ii ∈I such that x element of upper O Subscript i Baseline periodx ∈Oi. Since upper O Subscript iOi is open 
there exists an open neighborhood left parenthesis x minus delta comma x plus delta right parenthesis subset of upper O Subscript i Baseline comma(x −δ, x + δ) ⊂Oi, for some delta greater than 0 periodδ > 0. But then 
left parenthesis x minus delta comma x plus delta right parenthesis subset of union Subscript i element of upper I Baseline upper O Subscript i Baseline comma(x −δ, x + δ) ⊂∪i∈IOi, and so the union is an open set. If upper O 1 comma ellipsis comma upper O Subscript n BaselineO1, . . . , On are open 
sets and x lies in intersection Subscript i equals 1 Superscript n Baseline upper O Subscript i Baseline comma∩n
i=1Oi, then x element of upper O Subscript ix ∈Oi for every i equals 1 comma ellipsis comma n periodi = 1, . . . , n. But upper O Subscript iOi is open, 
thus there exists delta Subscript i Baseline greater than 0δi > 0 such that left parenthesis x minus delta Subscript i Baseline comma x plus delta Subscript i Baseline right parenthesis(x −δi, x + δi) is contained in upper O Subscript i Baseline periodOi. Now, choose 
0 less than delta equals min left brace delta 1 comma ellipsis delta Subscript n Baseline right brace0 < δ = min{δ1, . . . δn} and get left parenthesis x minus delta comma x plus delta right parenthesis subset of left parenthesis x minus delta Subscript i Baseline comma x plus delta Subscript i Baseline right parenthesis subset of upper O Subscript i Baseline comma(x −δ, x + δ) ⊂(x −δi, x + δi) ⊂Oi, for all
E
Open Subsets of Real Numbers
355
i periodi. We conclude that left parenthesis x minus delta comma x plus delta right parenthesis(x −δ, x + δ) is also contained in intersection Subscript i equals 1 Superscript n Baseline upper O Subscript i Baseline comma∩n
i=1Oi, which in turn is an  
open set. 
█
Example E.1 Take the sequence of open intervals upper O Subscript i Baseline equals left parenthesis minus StartFraction 1 Over i EndFraction comma b right parenthesisOi = (−1
i , b) with b element of double struck upper R periodb ∈R. The 
countable intersection intersection Subscript i equals 1 Superscript normal infinity Baseline upper O Subscript i Baseline equals left bracket 0 comma b right parenthesis∩∞
i=1Oi = [0, b) is neither an open set nor a closed set in 
left parenthesis double struck upper R comma tau right parenthesis period(R, τ).
Eventually, it can be shown that any open set O in double struck upper RR can be covered by inﬁnitely 
many open intervals upper O equals union Subscript i equals 1 Superscript normal infinity Baseline left parenthesis a Subscript i Baseline comma b Subscript i Baseline right parenthesis comma a Subscript i Baseline less than or slanted equals b Subscript i Baseline comma i equals 1 comma 2 comma ellipsis periodO = ∪∞
i=1(ai, bi),
ai ⩽bi,
i = 1, 2, . . . .
Remark E.1 The continuity of a function in Theorem E.1 can be rephrased as 
follows. Let upper O equals union Subscript i equals 1 Superscript normal infinity Baseline left parenthesis a Subscript i Baseline comma b Subscript i Baseline right parenthesisO = ∪∞
i=1(ai, bi) be open and deﬁne f colon upper A right arrow double struck upper R periodf : A →R. The inverse image 
f Superscript negative 1 Baseline left parenthesis upper O right parenthesis equals f Superscript negative 1 Baseline left parenthesis union Subscript i equals 1 Superscript normal infinity Baseline left parenthesis a Subscript i Baseline comma b Subscript i Baseline right parenthesis right parenthesis equals union Subscript i equals 1 Superscript normal infinity Baseline f Superscript negative 1 Baseline left parenthesis left parenthesis a Subscript i Baseline comma b Subscript i Baseline right parenthesis right parenthesisf −1(O) = f −1(
∪∞
i=1 (ai, bi)
)
= ∪∞
i=1f −1((ai, bi))
is a countable union of open sets. 
The Borel sigma hyphen algebraσ-algebra is generated by the open sets in double struck upper R commaR, so let script upper O equals StartSet upper O subset of double struck upper R colon upper O is open EndSet𝒪= {O ⊂R :
O is open} and get script upper B equals sigma left parenthesis script upper O right parenthesis periodB = σ(𝒪).
Remark E.2 The length of a bounded half-open intervals left parenthesis a comma b right bracket comma left bracket a comma b right parenthesis(a, b], [a, b) is b minus a greater than 0 periodb−a > 0.
This remains true for open and closed intervals with ﬁnite endpoints. 
There is a sequential characterization of continuity for functions f colon upper A subset of double struck upper R right arrow double struck upper R periodf : A ⊂R →
R. Equation (E.1) implies that for every x element of upper Ax ∈A there exists a sequence left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n in A 
convergent to x commax, with x Subscript n Baseline not equals x commaxn /= x, such that: 
limit Underscript n right arrow normal infinity Endscripts f left parenthesis x Subscript n Baseline right parenthesis equals f left parenthesis limit Underscript n right arrow normal infinity Endscripts x Subscript n Baseline right parenthesis equals f left parenthesis x right parenthesis period lim
n→∞f (xn) = f
⎛
lim
n→∞xn
⎞
= f (x).
(E.2) 
This deﬁnition of continuity by sequences is equivalent to that given in Theorem E.2. 
Example E.2 Let f left parenthesis x right parenthesis equals StartFraction sine x Over x EndFraction periodf (x) = sin x
x . Take a sequence left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n in the domain of f such 
that x Subscript n Baseline right arrow 0 commaxn →0, with x Subscript n Baseline not equals 0xn /= 0 and n right arrow normal infinity periodn →∞. Then, the epsilon minus deltaϵ −δ deﬁnition limit Underscript x right arrow 0 Endscripts f left parenthesis x right parenthesislimx→0 f (x) is 
equivalent to: 
limit Underscript n right arrow normal infinity Endscripts StartFraction sine x Subscript n Baseline Over x Subscript n Baseline EndFraction equals StartFraction sine left parenthesis limit Underscript n Endscripts x Subscript n Baseline right parenthesis Over left parenthesis limit Underscript n Endscripts x Subscript n Baseline right parenthesis EndFraction equals 1 period lim
n→∞
sin xn
xn
= sin (limn xn)
(limn xn)
= 1.
The function f is continuous in zero and f left parenthesis 0 right parenthesis equals 1f (0) = 1 coincides with the limit. 
Example E.3 The function f left parenthesis x right parenthesis equals sine xf (x) = sin x has no limit for x right arrow normal infinity periodx →∞. To show this, 
let us ﬁnd two sequences left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n and left parenthesis y Subscript n Baseline right parenthesis Subscript n(yn)n in the domain of f such that x Subscript n Baseline right arrow normal infinityxn →∞and 
y Subscript n Baseline right arrow normal infinity commayn →∞, but sine left parenthesis x Subscript n Baseline right parenthesissin(xn) and sine left parenthesis y Subscript n Baseline right parenthesissin(yn) converge to two distinct ﬁnite limits. This clearly 
contradict the sequential characterization of a unique ﬁnite limit. Indeed, choosing 
x Subscript n Baseline equals 2 pi nxn = 2πn and y Subscript n Baseline equals 2 pi n plus StartFraction pi Over 2 EndFraction commayn = 2πn + π
2 , we have x Subscript n Baseline comma y Subscript n Baseline right arrow normal infinityxn, yn →∞for n right arrow normal infinityn →∞but: 
limit Underscript n right arrow normal infinity Endscripts sine x Subscript n Baseline equals sine left parenthesis limit Underscript n right arrow normal infinity Endscripts x Subscript n Baseline right parenthesis equals 0 comma lim
n→∞sin xn = sin
⎛
lim
n→∞xn
⎞
= 0,
356
E
Open Subsets of Real Numbers
as sine left parenthesis 2 pi n right parenthesis equals 0sin(2πn) = 0 for every n element of double struck upper N comman ∈N, and 
limit Underscript n right arrow normal infinity Endscripts sine y Subscript n Baseline equals sine left parenthesis limit Underscript n right arrow normal infinity Endscripts y Subscript n Baseline right parenthesis equals 1 comma lim
n→∞sin yn = sin
⎛
lim
n→∞yn
⎞
= 1,
as sine left parenthesis 2 pi n plus StartFraction pi Over 2 EndFraction right parenthesis equals 1sin(2πn + π
2 ) = 1 for every n element of double struck upper N periodn ∈N.
The derivative of f at a point c element of left parenthesis a comma b right parenthesis commac ∈(a, b), where the open interval is contained in 
the domain of f commaf, is given by 
limit Underscript x right arrow c Endscripts StartFraction f left parenthesis x right parenthesis minus f left parenthesis c right parenthesis Over x minus c EndFraction equals limit Underscript h right arrow 0 Endscripts StartFraction f left parenthesis c plus h right parenthesis minus f left parenthesis c right parenthesis Over h EndFraction equals limit Underscript n right arrow normal infinity Endscripts StartFraction f left parenthesis x Subscript n Baseline right parenthesis minus f left parenthesis c right parenthesis Over x Subscript n Baseline minus c EndFraction commalim
x→c
f (x)−f (c)
x−c
= lim
h→0
f (c+h)−f (c)
h
= lim
n→∞
f (xn)−f (c)
xn−c
,
and is denoted by f prime left parenthesis c right parenthesisf '(c) provided the limit exists and is ﬁnite. Note that in the above 
deﬁnition, the third sequential version requires that x Subscript n Baseline right arrow cxn →c and x Subscript n Baseline not equals c commaxn /= c, for any 
sequence left parenthesis x Subscript n Baseline right parenthesis Subscript n(xn)n in the domain of f periodf. A function is said to be differentiable in left parenthesis a comma b right parenthesis(a, b)
if its derivative exists at every point x element of left parenthesis a comma b right parenthesis periodx ∈(a, b). The derivative is itself a function 
f prime left parenthesis x right parenthesis commaf '(x), and we say that f is of class upper C Superscript 1C1 if its derivative exists and is a continuous 
function on an open interval. Recall that for every continuous function f colon left bracket a comma b right bracket right arrow double struck upper Rf : [a, b] →
R the following hold. 
1. The Weierstrass theorem: there exist points c and d in left bracket a comma b right bracket[a, b] such that f left parenthesis c right parenthesis less than or slanted equals f left parenthesis x right parenthesis less than or slanted equals f left parenthesis d right parenthesis commaf (c) ⩽
f (x) ⩽f (d), for x element of left bracket a comma b right bracket periodx ∈[a, b].
2. The Lagrange theorem or mean value theorem: if f prime left parenthesis x right parenthesisf '(x) exists for every x element of left parenthesis a comma b right parenthesis commax ∈
(a, b), then f left parenthesis b right parenthesis minus f left parenthesis a right parenthesis equals f prime left parenthesis c right parenthesis left parenthesis b minus a right parenthesisf (b) −f (a) = f '(c)(b −a) for some c element of left parenthesis a comma b right parenthesis periodc ∈(a, b).
3. If f left parenthesis a right parenthesis less than 0f (a) < 0 and f left parenthesis b right parenthesis greater than 0f (b) > 0 (or viceversa), then there exists c element of left parenthesis a comma b right parenthesisc ∈(a, b) such 
thatf left parenthesis c right parenthesis equals 0 periodf (c) = 0.
4. The rule sign: if f left parenthesis c right parenthesis greater than 0f (c) > 0 for some c element of left parenthesis a comma b right parenthesisc ∈(a, b) then there exists delta greater than 0δ > 0 such that 
f left parenthesis x right parenthesis greater than 0f (x) > 0 for x element of left parenthesis c minus delta comma c plus delta right parenthesis periodx ∈(c −δ, c + δ).
5. The intermediate value theorem: if f left parenthesis a right parenthesis less than m less than f left parenthesis b right parenthesisf (a) < m < f (b) then there exists some 
c element of left parenthesis a comma b right parenthesisc ∈(a, b) such that f left parenthesis c right parenthesis equals m periodf (c) = m.
A function g deﬁned on an open interval upper I subset of double struck upper RI ⊂R (bounded or unbounded) is said to 
be convex if 
g left parenthesis lamda x 1 plus left parenthesis 1 minus lamda right parenthesis x 2 right parenthesis less than or slanted equals lamda g left parenthesis x 1 right parenthesis plus left parenthesis 1 minus lamda right parenthesis g left parenthesis x 2 right parenthesis comma for all x 1 comma x 2 element of upper I comma lamda element of left bracket 0 comma 1 right bracket periodg(λx1 + (1 −λ)x2) ⩽λg(x1) + (1 −λ)g(x2),
∀x1, x2 ∈I, λ ∈[0, 1].
For lamda equals one halfλ = 1
2 we have g left parenthesis StartFraction x 1 plus x 2 Over 2 EndFraction right parenthesis less than or slanted equals StartFraction g left parenthesis x 1 right parenthesis plus g left parenthesis x 2 right parenthesis Over 2 EndFraction periodg( x1+x2
2
) ⩽g(x1)+g(x2)
2
. For example, g left parenthesis x right parenthesis equals x squared comma h left parenthesis x right parenthesis equals e Superscript xg(x) = x2, h(x) = ex
and k left parenthesis x right parenthesis equals StartAbsoluteValue x EndAbsoluteValuek(x) = |x| are all convex with domain upper I equals double struck upper R periodI = R. The latter is not differentiable 
at x equals 0 periodx = 0. A convex function is continuous (in the interior of its domain), with ﬁnite 
left and right derivatives g prime Subscript minusg'
−and g prime Subscript plusg'
+. If it is twice differentiable its second derivative 
g double prime left parenthesis x right parenthesis greater than or slanted equals 0g''(x) ⩾0, a sufﬁcient condition for convexity. The graph of a convex function g 
lies above its tangent, i.e. we may ﬁnd some a element of double struck upper Ra ∈R such that for a ﬁxed x 0 element of upper Ix0 ∈I it 
holds 
g left parenthesis x 0 right parenthesis plus a left parenthesis x minus x 0 right parenthesis less than or slanted equals g left parenthesis x right parenthesis comma for every x element of upper I left parenthesis support line right parenthesis periodg(x0) + a(x −x0) ⩽g(x),
for every x ∈I
(support line).
A function g deﬁned on I is said to be concave if minus g left parenthesis x right parenthesis−g(x) is convex for all x element of upper I periodx ∈I.
Appendix F 
Topology on n-Dimensional Euclidean 
Spaces 
An open set can be deﬁned through open neighborhoods, i.e. open intervals, and 
any open set is the union of all neighborhoods of its points.1 This still holds in the 
n-dimensional Euclidean space double struck upper R Superscript n Baseline commaRn, the set of all points/vectors bold x equals left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesis periodx = (x1, . . . , xn).
We remind the deﬁnition of Euclidean distance or metric and its relation with the 
Euclidean norm: 
d left parenthesis bold x comma bold y right parenthesis equals double vertical bar bold x minus bold y double vertical bar equals StartRoot sigma summation Underscript i equals 1 Overscript n Endscripts left parenthesis x Subscript i Baseline minus y Subscript i Baseline right parenthesis squared EndRoot periodd(x, y) = ‖x −y‖ =
⎾
|
|
⏌
n
⎲
i=1
(xi −yi)2.
(F.1) 
An open ball around bold xx with radius epsilon greater than 0ϵ > 0 is the set upper B Subscript epsilon Baseline left parenthesis bold x right parenthesis equals StartSet bold y element of double struck upper R Superscript n Baseline vertical bar double vertical bar bold x minus bold y double vertical bar less than epsilon EndSet commaBϵ(x) = {y ∈Rn | ‖x−y‖ < ϵ},
see Fig. F.1. For n equals 1n = 1 it is an open neighborhood; for n equals 2n = 2 it is an open disk in 
the Cartesian plane; for n equals 3n = 3 it equals the set of all points in double struck upper R cubedR3 strictly inside a 
sphere with center bold xx and radius epsilon periodϵ. Open sets in double struck upper R Superscript nRn are generated by the family of 
open balls. More speciﬁcally, a subset upper O subset of double struck upper R Superscript nO ⊂Rn is said to be open if any bold x element of upper Ox ∈O is 
the center of an open ball entirely contained in the set, that is for every epsilon greater than 0ϵ > 0 and all 
bold x element of upper Ox ∈O we have upper B Subscript epsilon Baseline left parenthesis bold x right parenthesis subset of upper O periodBϵ(x) ⊂O. For example, the Cartesian product of n open intervals 
in double struck upper R commaR,
left parenthesis a 1 comma b 1 right parenthesis times midline horizontal ellipsis times left parenthesis a Subscript n Baseline comma b Subscript n Baseline right parenthesis comma a Subscript i Baseline less than or slanted equals b Subscript i Baseline comma i equals 1 comma ellipsis comma n comma(a1, b1) × · · · × (an, bn),
ai ⩽bi, i = 1, . . . , n,
is an open set by the above deﬁnition. We known that in the n-dimensional Euclidean 
space the Borel sigma hyphen algebraσ-algebra script upper B Superscript nBn is generated by the collection of all open sets. Indeed, 
for every bold x element of upper O subset of double struck upper R Superscript nx ∈O ⊂Rn there exists an open ball with center bold xx and rational radius 
q element of double struck upper Q Subscript plus Baseline commaq ∈Q+, which is contained in the open set upper O periodO. Thus O can be deﬁned by the 
1 The class of all open neighborhoods in double struck upper RR is called a base for the metric topology. This is like the 
generator of a sigma hyphen algebraσ-algebra. 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4
357
358
F
Topology on n-Dimensional Euclidean Spaces
countable union of all open balls centered at each of its points: 
upper O equals union Subscript q element of double struck upper Q Sub Subscript plus Subscript Baseline upper B Subscript q Baseline left parenthesis bold x right parenthesis comma bold x element of upper OO = ∪q∈Q+Bq(x),
x ∈O
This implies that for every upper O element of script upper B Superscript nO ∈Bn we have upper B Subscript q Baseline left parenthesis bold x right parenthesis element of script upper B Superscript n Baseline commaBq(x) ∈Bn, then the Borel sigma hyphen algebraσ-algebra
of double struck upper R Superscript nRn also contains the open balls. Conversely, the collection of all open balls with 
rational radius generates script upper B Superscript n Baseline periodBn. Let F any subset of double struck upper R Superscript n Baseline commaRn, we say that bold x element of upper Fx ∈F is an 
interior point of F if bold xx is the center bold xx of an open ball contained in upper F periodF. The collection 
of all interior points of F is denoted by i n t left parenthesis upper F right parenthesis periodint(F). If we take any bold x element of i n t left parenthesis upper F right parenthesisx ∈int(F) then 
there is some epsilon greater than 0ϵ > 0 such that upper B Subscript epsilon Baseline left parenthesis bold x right parenthesis subset of upper F periodBϵ(x) ⊂F. Now, take any bold y element of upper B Subscript epsilon Baseline left parenthesis bold x right parenthesisy ∈Bϵ(x) and choose 
delta greater than 0δ > 0 small enough so that upper B Subscript delta Baseline left parenthesis bold x right parenthesis subset of upper B Subscript epsilon Baseline left parenthesis bold x right parenthesis periodBδ(x) ⊂Bϵ(x). Then, upper B Subscript delta Baseline left parenthesis bold x right parenthesis subset of upper FBδ(x) ⊂F and eventually 
bold y element of i n t left parenthesis upper F right parenthesis periody ∈int(F). This shows that the interior of F is itself an open set. Hence, we can 
rephrase the deﬁnition of an open set O by saying that all its points are interior 
points. Furthermore, any open set O is a neighborhood of a point bold xx whenever O 
contains some open ball around bold x periodx. Note that in general i n t left parenthesis upper F right parenthesis subset of upper F periodint(F) ⊂F. Using the 
triangle inequality and Fig. F.1 we can see that any open ball upper B Subscript epsilon Baseline left parenthesis bold x right parenthesisBϵ(x) is indeed an 
open set in double struck upper R Superscript n Baseline periodRn. The set upper F equals StartSet bold x equals left parenthesis x comma y right parenthesis vertical bar x less than y EndSetF = {x = (x, y) | x < y} is open in double struck upper R squared periodR2. A point bold x element of double struck upper R Superscript nx ∈Rn
is said to be a boundary point of a set upper F subset of double struck upper R Superscript nF ⊂Rn if every open ball centered at bold xx
contains at least one point in F and at least one in upper F Superscript c Baseline commaF c, that is upper B Subscript epsilon Baseline left parenthesis bold x right parenthesis intersection upper F not equals empty setBϵ(x) ∩F /= ∅
and upper B Subscript epsilon Baseline left parenthesis bold x right parenthesis intersection upper F Superscript c Baseline not equals empty setBϵ(x) ∩F c /= ∅. A set may includes none, some or all its boundary points. If 
bold x element of upper Fx ∈F but bold x not an element of i n t left parenthesis upper F right parenthesisx /∈int(F) then upper F intersection upper B Subscript epsilon Baseline left parenthesis bold x right parenthesis not equals empty setF ∩Bϵ(x) /= ∅for every epsilon greater than 0 commaϵ > 0, so bold xx is a boundary 
point of upper F periodF. The set of all boundary points of a set F is called the boundary of F 
and is denoted by partial differential upper F period∂F. For example, the boundary of upper B Subscript epsilon Baseline left parenthesis bold y right parenthesis subset of double struck upper R cubedBϵ(y) ⊂R3 is the sphere 
upper S cubed colon equals StartSet bold y element of double struck upper R cubed vertical bar double vertical bar bold x minus bold y double vertical bar equals epsilon EndSet periodS3 := {y ∈R3 | ‖x−y‖ = ϵ}. A set is closed if it is the complement of an open set. 
Equivalently, a set F is closed if and only if it contains all its boundary points, and 
upper F union partial differential upper F equals colon c l left parenthesis upper F right parenthesisF ∪∂F =: cl(F) called the closure of upper F periodF. It holds upper F subset of c l left parenthesis upper F right parenthesis periodF ⊂cl(F). A point bold xx lies in c l left parenthesis upper F right parenthesiscl(F)
provided that every open ball centered at this point is such that upper B Subscript epsilon Baseline left parenthesis bold x right parenthesis intersection upper F not equals empty set periodBϵ(x) ∩F /= ∅. For 
example, the Cartesian product 
left bracket a 1 comma b 1 right bracket times midline horizontal ellipsis times left bracket a Subscript n Baseline comma b Subscript n Baseline right bracket comma a Subscript i Baseline less than or slanted equals b Subscript i Baseline comma i equals 1 comma ellipsis comma n[a1, b1] × · · · × [an, bn],
ai ⩽bi, i = 1, . . . , n
is a closed set. Observe that F and upper F Superscript cF c have the same boundary points.2 It can be 
shown that:
•
.int(F) is the largest open set contained in upper F commaF, that is i n t left parenthesis upper F right parenthesis equals union Subscript upper D element of script upper D Baseline upper Dint(F) = ∪D∈DD with script upper DD
being the collection of all open subsets of upper F semicolonF;
•
.cl(F) is the smallest closed set containing upper F commaF, that is i n t left parenthesis upper F right parenthesis equals intersection Subscript upper G element of script upper G Baseline upper Gint(F) = ∩G∈GG with script upper GG
being the collection of all closed sets containing upper F periodF.
Another useful characterization of closeness is the following: 
Theorem F.1 A set  F in double struck upper R Superscript nRn is closed if and only if every convergent sequence of 
points in F has its limit in upper F periodF.
2 Any open set contains none of its boundary points. 
F
Topology on n-Dimensional Euclidean Spaces
359
Fig. F.1 The open ball upper B Subscript epsilon Baseline left parenthesis bold x right parenthesisBϵ(x)
is an open set 
Recall that a sequence left parenthesis bold x Subscript n Baseline right parenthesis Subscript n element of double struck upper N(xn)n∈N in double struck upper R Superscript nRn converges to a point bold x element of double struck upper R Superscript nx ∈Rn provided that 
distances vanish, double vertical bar bold x Subscript n Baseline minus bold x double vertical bar right arrow 0‖xn −x‖ →0 as n right arrow normal infinity comman →∞, that is for each epsilon greater than 0ϵ > 0 there exists 
k element of double struck upper Nk ∈N such that bold x Subscript n Baseline element of upper B Subscript epsilon Baseline left parenthesis bold x right parenthesisxn ∈Bϵ(x) for all k greater than n periodk > n. Indeed, a point bold x element of double struck upper R Superscript nx ∈Rn lies in c l left parenthesis upper F right parenthesiscl(F) if 
and only if bold xx is the limit of a sequence left parenthesis bold x Subscript n Baseline right parenthesis Subscript n Baseline subset of upper F period(xn)n ⊂F. By Theorem F.1, the points that 
make F a closed set are also called limit points. They can be alternatively deﬁned 
as those element bold xx in double struck upper R Superscript nRn such that upper B Subscript epsilon Baseline left parenthesis bold x right parenthesisBϵ(x) contains inﬁnitely many points of F for 
every epsilon greater than 0 commaϵ > 0, i.e. for each radius the corresponding open ball contains at least one 
point distinct from bold x periodx. We can summarize all the above by stating that upper F subset of double struck upper R Superscript nF ⊂Rn is 
open if and only if upper F equals i n t left parenthesis upper F right parenthesis commaF = int(F), and closed if and only if upper F equals c l left parenthesis upper F right parenthesis periodF = cl(F). Some kind 
of open and closed sets in the n-dimensional Euclidean space are determined by 
continuous functions. A map f colon upper F subset of double struck upper R Superscript n Baseline right arrow double struck upper Rf : F ⊂Rn →R is said to be continuous at a point 
bold x element of upper Fx ∈F if for every delta greater than 0δ > 0 there exists a epsilon greater than 0ϵ > 0 such that the distance StartAbsoluteValue f left parenthesis bold y right parenthesis minus f left parenthesis bold x right parenthesis EndAbsoluteValue|f (y) −f (x)|
is made strictly smaller that deltaδ for all bold y element of upper Fy ∈F with double vertical bar bold y minus bold x double vertical bar less than epsilon period‖y −x‖ < ϵ. We can equivalently 
write f left parenthesis upper B Subscript epsilon Baseline left parenthesis bold x right parenthesis intersection upper F right parenthesis subset of upper B Subscript delta Baseline left parenthesis f left parenthesis bold x right parenthesis right parenthesis periodf (Bϵ(x) ∩F) ⊂Bδ(f (x)). In fact, f Superscript negative 1 Baseline left parenthesis upper O right parenthesisf −1(O) is open whenever upper O subset of double struck upper R Superscript nO ⊂Rn is 
open and f is continuous. If f is continuous at very point in its domain F then we 
say that it is continuous on the whole upper F periodF. Let f colon double struck upper R Superscript n Baseline right arrow double struck upper Rf : Rn →R be a continuous function. 
we have:
•
the sets StartSet bold x element of double struck upper R Superscript n Baseline vertical bar f left parenthesis bold x right parenthesis greater than 0 EndSet{x ∈Rn | f (x) > 0} and StartSet bold x element of double struck upper R Superscript n Baseline vertical bar f left parenthesis bold x right parenthesis less than 0 EndSet{x ∈Rn | f (x) < 0} are open;
•
the sets StartSet bold x element of double struck upper R Superscript n Baseline vertical bar f left parenthesis bold x right parenthesis greater than or slanted equals 0 EndSet{x ∈Rn | f (x) ⩾0} and StartSet bold x element of double struck upper R Superscript n Baseline vertical bar f left parenthesis bold x right parenthesis less than or slanted equals 0 EndSet{x ∈Rn | f (x) ⩽0} are closed;
•
the set StartSet bold x element of double struck upper R Superscript n Baseline vertical bar f left parenthesis bold x right parenthesis not equals 0 EndSet{x ∈Rn | f (x) /= 0} is open and the set StartSet bold x element of double struck upper R Superscript n Baseline vertical bar f left parenthesis bold x right parenthesis equals 0 EndSet{x ∈Rn | f (x) = 0} is closed, 
see Fig. F.2. Recall the sequential deﬁnition of continuity: a function f is continuous 
at a point bold xx in its domain if here there exists a sequence left parenthesis bold x Subscript n Baseline right parenthesis Subscript n Baseline not equals bold x(xn)n /= x which has limit 
bold xx and such that double vertical bar f left parenthesis bold x Subscript n Baseline right parenthesis minus f left parenthesis bold x right parenthesis double vertical bar right arrow 0‖f (xn) −f (x)‖ →0 as n right arrow normal infinity periodn →∞. For vector functions bold f colon upper F subset of double struck upper R Superscript n Baseline right arrow double struck upper R Superscript m Baseline commaf : F ⊂
Rn →Rm, with n not equals m comman /= m, all the above deﬁnitions apply ceteris paribus. Be warning 
that bold f equals left parenthesis f 1 comma ellipsis comma f Subscript m Baseline right parenthesisf = (f1, . . . , fm) is indeed a vector of functions f Subscript i Baseline colon upper F subset of double struck upper R Superscript n Baseline right arrow double struck upper R commafi : F ⊂Rn →R, each 
i element of StartSet 1 comma ellipsis comma m EndSet periodi ∈{1, . . . , m}. Thus, the continuity of bold ff is understood in the appropriate norm/open 
ball. Notwithstanding, we have that bold ff is continuous at bold x element of upper Fx ∈F if and only if each 
component function f Subscript ifi is continuous at the same point. A set upper F subset of double struck upper R Superscript nF ⊂Rn is bounded 
if there exists upper M greater than 0M > 0 such that double vertical bar bold x double vertical bar less than or slanted equals upper M‖x‖ ⩽M for all bold x element of upper F periodx ∈F. Since for any convergent 
sequence the set StartSet bold x 1 comma bold x 2 ellipsis EndSet subset of double struck upper R Superscript n{x1, x2 . . .} ⊂Rn is bounded in the sense of the aforementioned 
deﬁnition we have that a set upper F subset of double struck upper R Superscript nF ⊂Rn is bounded if and only if every sequence in
360
F
Topology on n-Dimensional Euclidean Spaces
Fig. F.2 Bold line: those 
bold x element of double struck upper R squaredx ∈R2 such that f left parenthesis bold x right parenthesis equals 0f (x) = 0
form a closed set. Its 
complement is the union of 
two open set, then is itself 
open 
F has a subsequence StartSet bold x Subscript n Sub Subscript k Subscript Baseline EndSet subset of upper F{xnk} ⊂F which converges to a limit. Closed and bounded 
subsets of double struck upper R Superscript nRn are said to be  compact. 
Theorem F.2 A set upper F subset of double struck upper R Superscript nF ⊂Rn is compact if and only if every sequence of points in F 
has a subsequence that converges to a point belonging to upper F periodF.
Hence, boundedness implies convergence of subsequences in upper F commaF, while closeness 
guarantees that the limit points are elements of F and together are equivalent to 
compactness. For example, The closure of the open ball upper B Subscript epsilon Baseline left parenthesis bold x right parenthesisBϵ(x) is a closed and 
bounded set in double struck upper R squared commaR2, then c l left parenthesis upper B Subscript epsilon Baseline left parenthesis bold x right parenthesis right parenthesis equals upper B Subscript epsilon Baseline left parenthesis bold x right parenthesis union partial differential upper B Subscript epsilon Baseline left parenthesis bold x right parenthesiscl(Bϵ(x)) = Bϵ(x) ∪∂Bϵ(x) is a compact set. The above is 
the sequential characterization of compactness. Equivalently, let script upper G equals left parenthesis upper G Subscript i Baseline right parenthesis Subscript i element of upper JG = (Gi)i∈J be a 
collection of open subsets of a given set upper F subset of double struck upper R Superscript n Baseline commaF ⊂Rn, also called an open cover of upper F periodF.
A subcover of script upper GG is a subfamily of open sets that also cover upper F periodF.
Theorem F.3 A set  upper F subset of double struck upper R Superscript nF ⊂Rn is compact (i.e. bounded and closed) if and only if 
every open cover of F has a ﬁnite subcover. 
A continuous function bold f colon double struck upper R Superscript n Baseline right arrow double struck upper R Superscript mf : Rn →Rm preserves compactness: for every compact 
set upper K subset of double struck upper R Superscript nK ⊂Rn the image bold f left parenthesis upper K right parenthesis subset of double struck upper R Superscript mf(K) ⊂Rm is compact too. For example let n equals m equals 1n = m = 1
and deﬁne a function f colon left bracket a comma b right bracket right arrow double struck upper R commaf : [a, b] →R, then f left parenthesis left bracket a comma b right bracket right parenthesisf ([a, b]) is again a closed and bounded 
interval. This fact implies the Weierstrass theorem. So for m equals 1m = 1 we have: 
Theorem F.4 Let f colon double struck upper R Superscript n Baseline right arrow double struck upper Rf : Rn →R be a continuous function. Its restriction f vertical bar upper Kf |K to a 
compact set upper K subset of double struck upper R Superscript nK ⊂Rn is such that left brace y element of double struck upper R vertical bar y equals f left parenthesis x right parenthesis comma for some bold x element of upper K right brace{y ∈R | y = f (x), for some x ∈K} is bounded. 
Then, f attains a maximum and a minimum values.
Appendix G 
Vector Spaces and Normed Spaces 
A vector space over the ﬁeld of real numbers double struck upper RR is a a nonempty set V together with 
operations left parenthesis v comma w right parenthesis right arrow from bar v plus w(v, w) ⍿→v + w from upper V times upper VV × V to double struck upper RR and left parenthesis alpha comma v right parenthesis right arrow from bar alpha v(α, v) ⍿→αv from double struck upper R times upper VR × V to double struck upper RR
such that: 
(a1) .(v + w) + y = v + (w + y), for all v comma w comma y element of upper V semicolonv, w, y ∈V ;
(a2) .v + w = w + v for all v comma w element of upper V semicolonv, w ∈V ;
(a3) there is an element 0 element of upper V0 ∈V with the property v plus 0 equals v commav + 0 = v, for all v element of upper V semicolonv ∈V ;
(a4) for each v element of upper Vv ∈V there is an element negative x element of upper V−x ∈V with the property v plus left parenthesis negative v right parenthesis equals 0v + (−v) = 0
(s1) .1v = v holds for all v element of upper V semicolonv ∈V ;
(s2) .α(βv) = (αβ)v, for all alpha comma beta element of double struck upper Rα, β ∈R and all v element of upper V semicolonv ∈V ;
(d1) .(α + β)v = αv + βv, for all alpha comma beta element of double struck upper Rα, β ∈R and all v element of upper V semicolonv ∈V ;
(d2) .α(v + w) = αv + αw, for all alpha element of double struck upper Rα ∈R and all v comma w element of upper V periodv, w ∈V.
Properties (a1)–(a4) refer to vector addition; properties (s1) and (s2) refer to scalar 
multiplication; properties (d1) and (d2) are distributive laws. Elements of V are 
called vectors. 
Example G.1 The fundamental example of vector space is double struck upper R Superscript n Baseline periodRn. For all bold x comma bold y element of double struck upper R Superscript n Baseline commax, y ∈Rn,
vector addition bold x plus bold yx + y is meant componentwise, x Subscript i Baseline plus y Subscript ixi + yi each i equals 1 comma ellipsis comma n periodi = 1, . . . , n. Scalar 
multiplication alpha bold xαx is done in the same fashion, alpha x Subscript iαxi for any alpha element of double struck upper Rα ∈R and and each 
i equals 1 comma ellipsis comma n periodi = 1, . . . , n. The element bold 0 equals left parenthesis 0 comma ellipsis comma 0 right parenthesis element of double struck upper R Superscript n0 = (0, . . . , 0) ∈Rn satisﬁes property (a3) and is 
called the zero vector or the origin of double struck upper R Superscript n Baseline periodRn. We can identify elements bold x element of double struck upper R Superscript nx ∈Rn with 
row vectors, 1 times n comma1 × n, or column vectors bold x prime commax', after matrix transposition. If n equals 2n = 2 we 
have the following geometric picture. Any element bold xx is represented as an arrow 
in the Cartesian plane starting from the origin bold 00 and directed towards the point 
located at left parenthesis x 1 comma x 2 right parenthesis comma(x1, x2), the coordinates of bold x periodx. The vector negative bold x−x points in the reverse 
direction. Addition between two vectors is called the parallelogram law. Scalar 
multiplication alpha bold xαx modiﬁes the length of the arrow by a factor alphaα and also its direction 
if alpha less than 0 periodα < 0. See Fig. G.1. Vectors bold yy and bold xx are parallel if bold y equals alpha bold xy = αx for some scalar alpha element of double struck upper R periodα ∈R.
All the above hold for the three-dimensional Euclidean space, see Appendix J. 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4
361
362
G
Vector Spaces and Normed Spaces
Fig. G.1 
bold yy is the 
displacement required to 
move bold xx to bold x plus bold yx + y
Fig. G.2 The hyperplane H 
as a shift of the set upper S equals double struck upper RS = R by 
bold x 0x0
A subspace of a vector space V is a subset upper V prime subset of upper VV ' ⊂V such that alpha v plus alpha w element of upper V primeαv + αw ∈V ' for 
all alpha comma beta element of double struck upper Rα, β ∈R and all v element of upper V commav ∈V, i.e. upper V primeV ' is a vector space in its own with respect to the 
same operations plus+ and dot· restricted to upper V prime periodV '. If we let v 0 element of upper Vv0 ∈V ﬁxed and consider the set 
H of all vectors of the form w equals v plus v 0w = v + v0 where v range over the whole subspace upper V primeV '
while v 0v0 does not belong necessarily to upper V prime commaV ', it is called a hyperplane and is obtained 
by shifting the subspace upper V primeV ' by the vector v 0 periodv0. Note that H in general is not itself a 
vector space (verify this). 
Example G.2 In upper V equals double struck upper R cubedV = R3 the set double struck upper RR is a line and the set double struck upper R squaredR2 is a plane. We can 
represents the hyperplane H as the set left brace bold y element of double struck upper R squared vertical bar bold y equals bold x plus bold x 0 comma bold x element of upper S comma bold x 0 f i x e d right brace comma{y ∈R2 | y = x + x0, x ∈S, x0 ﬁxed},
see Fig. G.2, where S is the set of all those x element of double struck upper R squaredx ∈R2 such that bold x equals left parenthesis x 1 comma 0 right parenthesisx = (x1, 0) for every 
x 1 element of double struck upper R periodx1 ∈R.
A linear combination of n vectors v 1 comma ellipsis comma v Subscript n Baseline element of upper Vv1, . . . , vn ∈V is sigma summation Underscript i equals 1 Overscript n Endscripts alpha Subscript i Baseline v Subscript i Baseline comma∑n
i=1 αivi, where alpha Subscript i Baseline element of double struck upper Rαi ∈
R each i periodi. A (ﬁnite) collection of vectors StartSet v 1 comma ellipsis comma v Subscript m Baseline EndSet{v1, . . . , vm} is said to be linearly 
independent if we cannot ﬁnd scalars alpha 1 comma ellipsis comma alpha Subscript m Baseline commaα1, . . . , αm, not all zero, such that their 
linear combination is the zero vector. An arbitrary set upper V primeV ' of vectors of V is said 
to be linearly independent if any nonempty ﬁnite subset of upper V primeV ' contains linearly 
independent vectors. A nonempty subset upper V prime subset of upper VV ' ⊂V of a vector space V can be used 
to form a third set script upper SS containing all linear combinations of elements in upper V prime periodV '. The set 
script upper SS is a subspace called the span of upper V primeV ' denoted by s p a n left parenthesis upper V Superscript prime Baseline right parenthesis periodspan(V '). Since upper V primeV ' generate script upper SS
we write script upper S equals s p a n left parenthesis upper V Superscript prime Baseline right parenthesis periodS = span(V '). If V contains a ﬁnite set of n linearly independent vectors 
and all other sets of n plus 1n + 1 vectors is linear dependent, then we shall say that the 
dimension of V is n comman, written dimension upper V equals n commadimV = n, and say that V is a ﬁnite dimensional 
vector space whatever V may contains an inﬁnite number of vectors. If upper S subset of upper VS ⊂V and 
S is a linearly independent set spanning upper V commaV, then S is a basis of upper V periodV.
Example G.3 The set double struck upper R Superscript nRn of all n-tuples bold x equals left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesisx = (x1, . . . , xn) is a ﬁnite dimensional 
vector space. Indeed the ﬁnite subset script upper S equals StartSet bold e 1 comma ellipsis comma bold e Subscript n Baseline EndSetS = {e1, . . . , en} of points bold e Subscript iei whose all 
coordinates are zero but the ith, which is equal to 1, is linearly independent and each 
bold x element of double struck upper R Superscript nx ∈Rn can be uniquely expressed as a linear combination bold x equals alpha 1 bold e 1 plus midline horizontal ellipsis plus alpha Subscript n Baseline bold e Subscript nx = α1e1 + · · · + αnen
for scalars alpha Subscript i Baseline commaαi, all not zero. Thus, double struck upper R Superscript n Baseline equals s p a n left parenthesis script upper S right parenthesis commaRn = span(S), i.e. script upper SS spans double struck upper R Superscript n Baseline commaRn, and StartAbsoluteValue script upper S EndAbsoluteValue equals n|S| = n so 
that dimension double struck upper R Superscript n Baseline equals n perioddimRn = n.
A function upper L colon upper V 1 right arrow upper V 2L : V1 →V2 deﬁned between two vector spaces is said to be linear 
if upper L left parenthesis alpha v plus alpha w right parenthesis equals alpha upper L left parenthesis v right parenthesis plus alpha upper L left parenthesis w right parenthesis commaL(αv + αw) = αL(v) + αL(w), for all alpha comma beta element of double struck upper Rα, β ∈R and all v element of upper V 1 periodv ∈V1. If upper V 2 equals double struck upper RV2 = R we
G
Vector Spaces and Normed Spaces
363
Fig. G.3 The line 
bold y equals bold w plus alpha bold xy = w + αx with constant 
bold w comma bold xw, x and bold x not equals bold 0x /= 0
call such an L a linear functional. Any bijective linear function has a linear inverse. 
A line segment connecting v element of upper Vv ∈V and w element of upper Vw ∈V is the set of points in V of the form 
lamda v plus left parenthesis 1 minus lamda right parenthesis wλv + (1 −λ)w with lamda element of left bracket 0 comma 1 right bracket periodλ ∈[0, 1]. A subset upper C subset of upper VC ⊂V of a vector space is convex if for 
each pair of v comma w element of upper Cv, w ∈C the line segment connecting them is included in upper C periodC.
Example G.4 In double struck upper R cubedR3 the equation bold y equals alpha bold xy = αx represents all points on the line through 
the origin in the direction of bold xx whenever alphaα ranges over double struck upper RR and bold x not equals bold 0 periodx /= 0. If bold w comma bold x element of double struck upper R cubedw, x ∈R3
and bold x not equals bold 0x /= 0 the equation bold y equals bold w plus alpha bold xy = w + αx is a line through bold ww in the direction of bold x periodx. See 
Fig. G.3. 
A vector space V enables us to do algebraic operations with its elements. The 
linear structure of V can be enriched by introducing a function double vertical bar double vertical bar colon upper V right arrow double struck upper R‖ ‖ : V →R such 
that 
(1) .‖v‖ ⩾0 for each v element of upper V commav ∈V, and double vertical bar v double vertical bar equals 0‖v‖ = 0 if and only if v equals 0 semicolonv = 0;
(2) .‖αv‖ = |α| ‖v‖ for all alpha element of double struck upper Rα ∈R and v element of upper V semicolonv ∈V ;
(3) .‖v + w‖ ⩽‖v‖ + ‖w‖ for all v comma w element of upper V periodv, w ∈V.
The set V endowed with such a function is called a normed space and double vertical bar double vertical bar‖ ‖ is a norm. 
We sometimes shall write left parenthesis upper V comma double vertical bar double vertical bar right parenthesis period(V, ‖ ‖). Property (3) is called triangle inequality. The  
norm provides a vector space V with a topological structure. Indeed, double vertical bar v minus w double vertical bar equals d left parenthesis v comma w right parenthesis‖v −w‖ =
d(v, w) deﬁnes a metric for all v comma w element of upper V periodv, w ∈V. It turns out that concepts like open ball, 
open set, closed set and convergent sequences can be adapted to normed vector 
spaces. 
Example G.5 Let left bracket a comma b right bracket[a, b] be a closed bounded interval in double struck upper RR and let upper C left bracket a comma b right bracketC[a, b] be the set 
of all continuous real-valued functions f on left bracket a comma b right bracket period[a, b]. It is easily veriﬁed that upper C left bracket a comma b right bracketC[a, b] is 
a vector space, provided that sums of functions and products between real numbers 
and functions are understood componentwise. The map double vertical bar double vertical bar colon upper C left bracket a comma b right bracket right arrow double struck upper R‖ ‖ : C[a, b] →R deﬁned 
by double vertical bar f double vertical bar colon equals integral Underscript left bracket a comma b right bracket Endscripts StartAbsoluteValue f EndAbsoluteValue normal d m‖f ‖ :=
⎰
[a,b] |f |dm is a norm on upper C left bracket a comma b right bracket periodC[a, b]. Another norm can be deﬁned via the 
formula double vertical bar f double vertical bar colon equals sup left brace StartAbsoluteValue f left parenthesis x right parenthesis EndAbsoluteValue vertical bar x element of left bracket a comma b right bracket right brace comma‖f ‖ := sup{|f (x)| | x ∈[a, b]}, since any continuous function on the 
compact set left bracket a comma b right bracket[a, b] is also bounded. 
Example G.5 suggests that we can deﬁne different norms on the same vector 
space. Nonetheless, it can be shown that on a ﬁnite-dimensional normed vector 
space all norms are equivalent and deﬁne the same open sets. We shall provide 
another characterization of a vector space upper V periodV. The inner product of two vectors 
u comma w element of upper V commau, w ∈V, denoted by left angle bracket u comma w right angle bracket comma〈u, w〉, is deﬁned to be a function satisfying: 
(I1) . 〈u, w〉= 〈w, u〉
(I2) .〈u + z, w〉= 〈u, w〉+ 〈z, w〉
364
G
Vector Spaces and Normed Spaces
(I3) . α〈u, w〉= α〈u, w〉
(I4) .〈u, u〉⩾0, with left angle bracket u comma u right angle bracket equals 0〈u, u〉= 0 if and only if u equals 0 periodu = 0.
In any vector space V endowed with an inner product we can deﬁne a norm by 
double vertical bar x double vertical bar equals StartRoot left angle bracket u comma u right angle bracket EndRoot comma‖x‖ = √〈u, u〉, and then a distance d left parenthesis u comma w right parenthesis equals double vertical bar u minus w double vertical bar equals StartRoot left angle bracket u minus w comma u minus w right angle bracket EndRoot periodd(u, w) = ‖u −w‖ = √〈u −w, u −w〉. Two 
vectors are said to be orthogonal if left angle bracket u comma w right angle bracket equals 0 comma〈u, w〉= 0, and we can write u up tack w periodu⊥w. If a ﬁnite set 
upper S equals StartSet u 1 comma ellipsis comma u Subscript n Baseline EndSetS = {u1, . . . , un} of vectors in V is such that u Subscript i Baseline up tack u Subscript jui⊥uj for every i not equals j element of StartSet 1 comma ellipsis comma n EndSeti /= j ∈{1, . . . , n}
we say that S is an orthogonal set. If, in addition, u Subscript i Baseline element of upper Sui ∈S has unit length double vertical bar x double vertical bar equals left angle bracket u comma u right angle bracket equals 1 comma‖x‖ =
〈u, u〉= 1, each i commai, we call S an orthonormal set. The n-dimensional Euclidean 
space double struck upper R Superscript nRn is an inner product space with: 
left angle bracket bold x comma bold y right angle bracket colon equals sigma summation Underscript i equals 1 Overscript n Endscripts x Subscript i Baseline y Subscript i Baseline period〈x, y〉:=
n
⎲
i=1
xiyi.
The induced norm is double vertical bar bold x double vertical bar equals StartRoot left angle bracket bold x comma bold x right angle bracket EndRoot period‖x‖ = √〈x, x〉. The usual basis of double struck upper R Superscript nRn is formed by vectors 
bold e Subscript iei with all entries zero but the ith which is 1. The set StartSet bold e 1 comma ellipsis comma bold e Subscript n Baseline EndSet{e1, . . . , en} is indeed an 
orthonormal set. The Cauchy-Schwartz inequality holds: 
StartAbsoluteValue left angle bracket bold x comma bold y right angle bracket EndAbsoluteValue Superscript 1 divided by 2 Baseline less than or slanted equals double vertical bar bold x double vertical bar plus double vertical bar bold y double vertical bar period|〈x, y〉|1/2 ⩽‖x‖ + ‖y‖.
The inner product gives additional geometric properties. In particular, since by the 
cosine rule 
double vertical bar bold x minus bold y double vertical bar squared equals double vertical bar bold x double vertical bar squared plus double vertical bar bold y double vertical bar squared minus 2 double vertical bar bold x double vertical bar double vertical bar bold y double vertical bar cosine theta‖x −y‖2 = ‖x‖2 + ‖y‖2 −2‖x‖‖y‖ cos θ
we can, after simplifying, write 
left angle bracket bold x comma bold y right angle bracket equals double vertical bar bold x double vertical bar double vertical bar bold y double vertical bar cosine theta period〈x, y〉= ‖x‖‖y‖ cos θ.
The following is the deﬁnition of the angle between two Euclidean vectors: 
cosine theta equals StartFraction left angle bracket bold x comma bold y right angle bracket Over double vertical bar bold x double vertical bar double vertical bar bold y double vertical bar EndFractioncos θ = 〈x, y〉
‖x‖‖y‖
where theta element of left bracket 0 comma pi right bracket periodθ ∈[0, π]. A hyperplane can now be deﬁned in the following way. Consider 
two orthogonal vectors left angle bracket bold x comma bold y right angle bracket equals 0〈x, y〉= 0 where bold xx is kept ﬁxed. In double struck upper R squaredR2 this represents the 
equation of a line through the origin and in double struck upper R cubedR3 it provides a plane through the origin. 
In both cases, bold xx is orthogonal to the line or the plane, and is called the normal. 
Similarly, the equation left angle bracket bold x comma bold y minus bold w right angle bracket equals 0〈x, y −w〉= 0 represents a plane through the ﬁxed vector 
bold ww with normal bold x periodx. Taking left angle bracket bold x comma bold w right angle bracket equals c〈x, w〉= c the equation becomes left angle bracket bold x comma bold y right angle bracket equals c period〈x, y〉= c. Note that the 
product bold x bold upper AxA between a vector bold x element of double struck upper R Superscript nx ∈Rn and a n times nn × n matrix bold upper AA is a vector in double struck upper R Superscript n Baseline periodRn. Then 
we can always write left angle bracket bold x bold upper A comma bold y right angle bracket period〈xA, y〉.
Appendix H 
Sequence and Series of Functions 
Let left parenthesis f Subscript n Baseline right parenthesis Subscript n(fn)n be a sequence of real-valued functions all deﬁned on the interval upper I subset of double struck upper R periodI ⊂R.
We say that left parenthesis f Subscript n Baseline right parenthesis Subscript n(fn)n converge pointwise to a function f deﬁned on the same interval, 
if f Subscript n Baseline left parenthesis x right parenthesis right arrow f left parenthesis x right parenthesisfn(x) →f (x) as n right arrow normal infinityn →∞for all x element of upper I periodx ∈I. Observe that f 1 left parenthesis x right parenthesis comma f 2 left parenthesis x right parenthesis comma ellipsisf1(x), f2(x), . . . is a 
sequence of real numbers which converges to the number f left parenthesis x right parenthesis commaf (x), for each x element of upper I periodx ∈I. If 
the convergence fails for some x element of upper Ix ∈I, then we can deﬁne 
upper D equals StartSet x element of double struck upper R vertical bar limit Underscript n right arrow normal infinity Endscripts f Subscript n Baseline left parenthesis x right parenthesis is finite EndSetD =
{
x ∈R | lim
n→∞fn(x) is ﬁnite
}
as the region of convergence. A stronger deﬁnition of convergence is the following: 
Deﬁnition H.1 A sequence of functions left parenthesis f Subscript n Baseline right parenthesis Subscript n(fn)n is said to converges uniformly on 
an interval I if for each epsilon greater than 0ϵ > 0 there is an integer number upper M commaM, depending on epsilonϵ but not 
on x commax, such that StartAbsoluteValue f Subscript n Baseline left parenthesis x right parenthesis minus f left parenthesis x right parenthesis EndAbsoluteValue less than epsilon|fn(x) −f (x)| < ϵ for all n greater than upper Mn > M and all x element of upper I periodx ∈I.
It can be shown that this deﬁnition is equivalent to: 
f Subscript n Baseline right arrow f uniformly on upper I if double vertical bar f Subscript n Baseline minus f double vertical bar right arrow 0 as n right arrow normal infinity commafn →f uniformly on I if ‖fn −f ‖ →0 as n →∞,
where double vertical bar f Subscript n Baseline minus f double vertical bar equals sup left brace StartAbsoluteValue f Subscript n Baseline left parenthesis x right parenthesis minus f left parenthesis x right parenthesis EndAbsoluteValue vertical bar x element of upper I right brace period‖fn −f ‖ = sup{|fn(x) −f (x)| | x ∈I}. If left parenthesis f Subscript n Baseline right parenthesis Subscript n(fn)n is formed by continuous 
functions on I and f Subscript n Baseline right arrow ffn →f uniformly, then f is continuous on upper I periodI. If each f Subscript nfn
has a continuous derivative on left bracket a comma b right bracket[a, b], f Subscript n Baseline right arrow ffn →f pointwise and left parenthesis f prime Subscript n right parenthesis Subscript n(f '
n)n converges 
uniformly on left bracket a comma b right bracket comma[a, b], then f prime Subscript n Baseline right arrow f primef '
n →f ' on left bracket a comma b right bracket period[a, b]. If each f Subscript nfn is continuous and f Subscript n Baseline right arrow ffn →f
uniformly on left bracket a comma b right bracket comma[a, b], then integral Subscript a Superscript b Baseline f Subscript n Baseline left parenthesis x right parenthesis normal d x right arrow integral Subscript a Superscript b Baseline f left parenthesis x right parenthesis normal d x period
⎰b
a fn(x)dx →
⎰b
a f (x)dx. A power series in general 
form is sigma summation Underscript i equals 0 Overscript normal infinity Endscripts a Subscript i Baseline left parenthesis x minus a right parenthesis Superscript i∑∞
i=0 ai (x −a)i, which converges either for x equals ax = a, or all  x, or for  
StartAbsoluteValue x minus a EndAbsoluteValue less than upper R|x −a| < R, where upper R equals sup Underscript x element of upper E Endscripts StartAbsoluteValue x minus a EndAbsoluteValue greater than 0R = supx∈E |x −a| > 0 is the radius of convergence, 
where upper E equals StartSet x element of double struck upper R vertical bar the series converges EndSetE = {x ∈R | the series converges}. Here a Subscript i Baseline comma aai, a are constants. In fact, a power 
series is a partial sum of a sequence of functions a Subscript i Baseline left parenthesis x minus a right parenthesis Superscript iai (x −a)i for i equals 0 comma 1 comma 2 comma ellipsisi = 0, 1, 2, . . .. 
More generally, given a sequence of functions left parenthesis f Subscript n Baseline left parenthesis x right parenthesis right parenthesis Subscript n(fn(x))n the series sigma summation Underscript i equals 0 Overscript normal infinity Endscripts f Subscript i Baseline left parenthesis x right parenthesis∑∞
i=0 fi(x)
converges to the sum s left parenthesis x right parenthesiss(x) in D if given epsilon greater than 0ϵ > 0 there exists upper N left parenthesis x comma epsilon right parenthesis element of double struck upper NN(x, ϵ) ∈N such that 
StartAbsoluteValue s left parenthesis x right parenthesis minus s Subscript n Baseline left parenthesis x right parenthesis EndAbsoluteValue less than epsilon|s(x) −sn(x)| < ϵ whenever n greater than upper Nn > N, where s Subscript n Baseline left parenthesis x right parenthesis equals sigma summation Underscript i equals 0 Overscript n Endscripts f Subscript i Baseline left parenthesis x right parenthesissn(x) = ∑n
i=0 fi(x). This is simply  
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4
365
366
H
Sequence and Series of Functions
the convergence of the sequence of partial sums s Subscript n Baseline left parenthesis x right parenthesissn(x) to the limiting function s left parenthesis x right parenthesiss(x). 
Again, if upper N left parenthesis x comma epsilon right parenthesis equals upper N left parenthesis epsilon right parenthesisN(x, ϵ) = N(ϵ) does depend only on epsilonϵ and not on x, uniform convergence 
comes into play. If f Subscript i Baseline left parenthesis x right parenthesisfi(x) are continuous in upper I equals left bracket a comma b right bracketI = [a, b] and sigma summation Underscript i equals 0 Overscript n Endscripts f Subscript i Baseline left parenthesis x right parenthesis∑n
i=0 fi(x) is uniformly 
convergent to s left parenthesis x right parenthesiss(x) in upper I commaI, then s left parenthesis x right parenthesiss(x) is continuous in I. If f Subscript i Baseline left parenthesis x right parenthesisfi(x) are integrable in I and 
sigma summation Underscript i equals 0 Overscript n Endscripts f Subscript i Baseline left parenthesis x right parenthesis∑n
i=0 fi(x) is uniformly convergent to s left parenthesis x right parenthesiss(x) in upper I commaI, then 
integral Subscript a Superscript b Baseline sigma summation Underscript i equals 0 Overscript n Endscripts f Subscript i Baseline left parenthesis x right parenthesis normal d x equals sigma summation Underscript i equals 0 Overscript n Endscripts integral Subscript a Superscript b Baseline f Subscript i Baseline left parenthesis x right parenthesis normal d x comma
⎰b
a
n
⎲
i=0
fi(x)dx =
n
⎲
i=0
⎰b
a
fi(x)dx,
i.e., we can exchange the deﬁnite integral with the inﬁnite sum. Eventually, if 
f Subscript i Baseline left parenthesis x right parenthesisfi(x) have continuous derivatives in I and sigma summation Underscript i equals 0 Overscript n Endscripts f Subscript i Baseline left parenthesis x right parenthesis∑n
i=0 fi(x) converges to s left parenthesis x right parenthesiss(x) while 
sigma summation Underscript i equals 0 Overscript n Endscripts f prime Subscript i Baseline left parenthesis x right parenthesis∑n
i=0 f '
i (x) is uniformly convergent in I, then 
StartFraction normal d Over normal d x EndFraction sigma summation Underscript i equals 0 Overscript n Endscripts f Subscript i Baseline left parenthesis x right parenthesis equals sigma summation Underscript i equals 0 Overscript n Endscripts StartFraction normal d Over normal d x EndFraction f Subscript i Baseline left parenthesis x right parenthesis comma d
dx
n
⎲
i=0
fi(x) =
n
⎲
i=0
d
dx fi(x),
i.e., we can exchange the derivative with the inﬁnite sum.
Appendix I 
Review of Multivariate Differentiation 
and Integration 
The partial derivative 
StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential x EndFraction left parenthesis x comma y right parenthesis equals limit Underscript h right arrow 0 Endscripts StartFraction upper F Subscript bold upper X Baseline left parenthesis x plus h comma y right parenthesis minus upper F Subscript bold upper X Baseline left parenthesis x comma y right parenthesis Over h EndFraction∂FX
∂x (x, y) = lim
h→0
FX(x + h, y) −FX(x, y)
h
gives the change of the bi-variate CDF in the direction parallel to the x-axis. 
Similarly, 
StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential y EndFraction left parenthesis x comma y right parenthesis equals limit Underscript k right arrow 0 Endscripts StartFraction upper F Subscript bold upper X Baseline left parenthesis x comma y plus k right parenthesis minus upper F Subscript bold upper X Baseline left parenthesis x comma y right parenthesis Over k EndFraction∂FX
∂y (x, y) = lim
k→0
FX(x, y + k) −FX(x, y)
k
measures the change of the bi-variate CDF in the direction parallel to the y-axis. If 
the limit 
limit Underscript h right arrow 0 Endscripts StartFraction upper F Subscript bold upper X Baseline left parenthesis x plus u 1 h comma y plus u 2 h right parenthesis minus upper F Subscript bold upper X Baseline left parenthesis x comma y right parenthesis Over h EndFraction lim
h→0
FX(x + u1h, y + u2h) −FX(x, y)
h
(I.1) 
exists1 is called the directional derivative of upper F Subscript bold upper XFX at left parenthesis x comma y right parenthesis(x, y), written2 normal d Subscript bold u Baseline upper F Subscript bold upper X Baseline left parenthesis x comma y right parenthesisduFX(x, y). 
Formula (I.1) gives the change of upper F Subscript bold upper XFX in both the variables. In a more general setting 
we can write 
normal d Subscript bold u Baseline upper F Subscript bold upper X Baseline left parenthesis bold x right parenthesis colon equals limit Underscript h right arrow 0 Endscripts StartFraction upper F Subscript bold upper X Baseline left parenthesis bold x plus h bold u right parenthesis minus upper F Subscript bold upper X Baseline left parenthesis bold x right parenthesis Over h EndFraction commaduFX(x) := lim
h→0
FX(x + hu) −FX(x)
h
,
(I.2) 
1 Observe that left parenthesis x plus u 1 h comma y plus u 2 h right parenthesis(x + u1h, y + u2h) is automatically in the domain double struck upper R squaredR2 of the CDF. 
2 The direction of change is given by moving a distance h double vertical bar bold u double vertical barh‖u‖ from the vector left parenthesis x comma y right parenthesis(x, y) to the vector 
left parenthesis x plus u 1 h comma y plus u 2 h right parenthesis(x + u1h, y + u2h) along the direction of the vector bold u equals left parenthesis u 1 comma u 2 right parenthesisu = (u1, u2) for which double vertical bar bold u double vertical bar equals StartRoot u 1 squared plus u 2 squared EndRoot‖u‖ =
/
u2
1 + u2
2. 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4
367
368
I
Review of Multivariate Differentiation and Integration
where bold x plus h bold u equals left parenthesis x 1 plus h u 1 comma ellipsis comma x Subscript n Baseline plus h u Subscript n Baseline right parenthesisx+hu = (x1+hu1, . . . , xn+hun). It is worth noting that for bold u identical to bold e Subscript iu ≡ei Eq. (I.2) 
entails StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential x Subscript i Baseline EndFraction left parenthesis bold x right parenthesis ∂FX
∂xi (x) for i equals 1 comma ellipsis comma ni = 1, . . . , n. Recall that bold e Subscript iei is the n-dimensional vector whose 
entries are zeros except the ith which is one. Whenever the further limit 
limit Underscript bold h right arrow bold 0 Endscripts StartFraction StartAbsoluteValue upper F Subscript bold upper X Baseline left parenthesis bold a plus bold h right parenthesis minus upper F Subscript bold upper X Baseline left parenthesis bold a right parenthesis minus bold b dot bold h EndAbsoluteValue Over double vertical bar bold h double vertical bar EndFraction equals 0 lim
h→0
||FX(a + h) −FX(a) −b · h
||
‖h‖
= 0
(I.3) 
exists we say that the CDF if differentiable at bold a element of double struck upper R Superscript na ∈Rn. Recall that the vector sum 
bold a plus bold h element of double struck upper R Superscript na + h ∈Rn is understood componentwise, i.e., a Subscript i Baseline plus h Subscript iai + hi for i equals 1 comma ellipsis comma ni = 1, . . . , n are the 
entries of the resulting vector. Also, bold h right arrow bold 0h →0 is meant to holds componentwise, i.e. 
h Subscript i Baseline right arrow 0hi →0 for i equals 1 comma ellipsis comma ni = 1, . . . , n and bold 0 element of double struck upper R Superscript n0 ∈Rn being the vector of all zeros. Finally, the dot 
product bold b dot bold hb·h equals the inner product left angle bracket bold b comma bold h right angle bracket〈b, h〉of n-dimensional vectors deﬁned as the 
scalar sigma summation Underscript i equals 1 Overscript n Endscripts b Subscript i Baseline h Subscript i∑n
i=1 bihi, with double vertical bar bold h double vertical bar equals StartRoot bold h dot bold h EndRoot‖h‖ =
√
h · h. Now intuitively, if (I.3) holds true the change 
upper F Subscript bold upper X Baseline left parenthesis bold a plus bold h right parenthesis minus upper F Subscript bold upper X Baseline left parenthesis bold a right parenthesisFX(a + h) −FX(a) differs little from the linear function g left parenthesis bold h right parenthesis equals bold b dot bold hg(h) = b · h, and we can 
approximate it via 
upper F Subscript bold upper X Baseline left parenthesis bold a plus bold h right parenthesis minus upper F Subscript bold upper X Baseline left parenthesis bold a right parenthesis almost equals nabla upper F Subscript bold upper X Baseline left parenthesis bold x right parenthesis dot bold h commaFX(a + h) −FX(a) ≈∇FX(x) · h,
(I.4) 
where nabla upper F Subscript bold upper X Baseline left parenthesis bold x right parenthesis∇FX(x) is called the CDFs gradient i.e. the n-dimensional vector whose 
entries are the partial derivatives StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential x Subscript i Baseline EndFraction left parenthesis bold x right parenthesis ∂FX
∂xi (x). If this is the case, the multivariate CDF 
posses all the partial derivatives and all the directional derivatives3 for i equals 1 comma ellipsis comma ni = 1, . . . , n. 
Example I.1 In the bi-variate case with CDF differentiable at bold a equals left parenthesis a 1 comma a 2 right parenthesisa = (a1, a2) we have 
StartStartFraction StartAbsoluteValue upper F Subscript bold upper X Baseline left parenthesis x comma y right parenthesis minus upper F Subscript bold upper X Baseline left parenthesis a 1 comma a 2 right parenthesis minus StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential x EndFraction left parenthesis a 1 comma a 2 right parenthesis left parenthesis x minus a 1 right parenthesis minus StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential y EndFraction left parenthesis a 1 comma a 2 right parenthesis left parenthesis x minus a 2 right parenthesis EndAbsoluteValue OverOver double vertical bar left parenthesis x comma y right parenthesis minus left parenthesis a 1 comma a 2 right parenthesis double vertical bar EndEndFraction right arrow 0
||FX(x, y) −FX(a1, a2) −∂FX
∂x (a1, a2)(x −a1) −∂FX
∂y (a1, a2)(x −a2)
||
‖(x, y) −(a1, a2)‖
→0
as left parenthesis x comma y right parenthesis right arrow left parenthesis a 1 comma a 2 right parenthesis(x, y) →(a1, a2). We can say that z equals upper F Subscript bold upper X Baseline left parenthesis a 1 comma a 2 right parenthesis plus StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential x EndFraction left parenthesis a 1 comma a 2 right parenthesis left parenthesis x minus a 1 right parenthesis plus StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential y EndFraction left parenthesis a 1 comma a 2 right parenthesis left parenthesis y minus a 2 right parenthesisz = FX(a1, a2) + ∂FX
∂x (a1, a2)(x −a1) +
∂FX
∂y (a1, a2)(y −a2) is a good approximation of the CDF and this is the equation 
of the tangent plane (in double struck upper R cubedR3) of its graph at the point bold a equals left parenthesis a 1 comma a 2 right parenthesisa = (a1, a2). The analogous 
one-dimensional case is that of a real-valued function upper F left parenthesis x right parenthesisF(x) differentiable at a element of double struck upper Ra ∈R
being in an open interval (neighborhood) contained in its domain, for which y equals f left parenthesis a right parenthesis plus f prime left parenthesis a right parenthesis left parenthesis x minus a right parenthesisy =
f (a)+f '(a)(x−a) is the linear function whose graph is the tangent (in the Cartesian 
plane double struck upper R squaredR2) of the F’s graph at the point left parenthesis a comma upper F left parenthesis a right parenthesis right parenthesis(a, F(a)): in fact, the tangent line given by 
the above equation is s.t. limit Underscript x right arrow a Endscripts StartFraction upper F left parenthesis x right parenthesis minus upper F left parenthesis a right parenthesis minus upper F prime left parenthesis a right parenthesis left parenthesis x minus a right parenthesis Over x minus a EndFraction equals 0limx→a F(x)−F(a)−F '(a)(x−a)
x−a
= 0. 
In Eq. (I.3) we can let bold x equals bold a plus bold hx = a + h so that bold h equals bold x minus bold ah = x −a and the limit is equivalently 
taken as bold x right arrow bold ax →a, componentwise. Recall that double vertical bar bold x minus bold a double vertical bar equals StartRoot sigma summation Underscript i equals 1 Overscript n Endscripts left parenthesis x Subscript i Baseline minus a Subscript i Baseline right parenthesis squared EndRoot‖x −a‖ =
/∑n
i=1(xi −ai)2 equals 
the Euclidean distance d left parenthesis bold x comma bold a right parenthesisd(x, a). Thus the limit would imply that d left parenthesis bold x comma bold a right parenthesis right arrow 0d(x, a) →0 as 
bold x right arrow bold ax →a (the CDF is evaluated in a neighborhood of bold aa).
3 These can be given as normal d Subscript bold u Baseline upper F Subscript bold upper X Baseline left parenthesis bold x right parenthesis equals nabla upper F Subscript bold upper X Baseline left parenthesis bold x right parenthesis dot bold uduFX(x) = ∇FX(x) · u. 
I
Review of Multivariate Differentiation and Integration
369
Remark I.1 As in the one-dimensional case if upper F Subscript bold upper XFX is differentiable at bold aa then it is 
continuous at this point. Moreover, if all the partial derivatives StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential x Subscript i Baseline EndFraction ∂FX
∂xi exist and are 
continuous (in a neighborhood of bold aa) then the CDF is differentiable at this point. As 
by product we have the following hierarchy: 
continuous partials StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential x Subscript i Baseline EndFraction long right double arrow upper F Subscript bold upper X Baseline differentiable long right double arrow partials exist periodcontinuous partials ∂FX
∂xi =⇒FX differentiable =⇒partials exist.
The second implication is due to the truly deﬁnition of partial derivative, since for 
the limit in (I.3) to exist is necessary that the gradient exists. 
Here some remarks on multivariate differentiation.
•
If a function upper F left parenthesis x 1 comma ellipsis comma x Subscript n Baseline right parenthesisF(x1, . . . , xn) admits second order partials StartFraction partial differential squared upper F Over partial differential x Subscript i Baseline partial differential x Subscript j Baseline EndFraction left parenthesis bold a right parenthesis ∂2F
∂xi∂xj (a) at a point bold aa in 
its domain,4 for i comma j equals 1 comma ellipsis comma ni, j = 1, . . . , n, and they are continuous at that point then the 
order of partial differentiation does not matter (Schwarz’s theorem or Young’s 
theorem).
•
We call sigma summation Underscript i equals 1 Overscript n Endscripts sigma summation Underscript j equals 1 Overscript n Endscripts StartFraction partial differential squared upper F Over partial differential x Subscript i Baseline partial differential x Subscript j Baseline EndFraction left parenthesis bold a right parenthesis normal d x Subscript i Baseline normal d x Subscript j∑n
i=1
∑n
j=1
∂2F
∂xi∂xj (a)dxidxj the second order total differential. 
The very basics of multivariate integration is the Riemann double integral. Let  
f colon left bracket a comma b right bracket times left bracket c comma d right bracket right arrow double struck upper Rf : [a, b] × [c, d] →R where the domain dom left parenthesis f right parenthesisdom(f ) is a compact subset of double struck upper R squaredR2. We  
partition left bracket a comma b right bracket[a, b] into n element of double struck upper Nn ∈N subintervals left bracket x Subscript i minus 1 Baseline comma x Subscript i Baseline right bracket[xi−1, xi] for i equals 1 comma ellipsis comma ni = 1, . . . , n and left bracket c comma d right bracket[c, d] into 
m element of double struck upper Nm ∈N subintervals left bracket y Subscript j minus 1 Baseline comma y Subscript j Baseline right bracket[yj−1, yj] for i equals 1 comma ellipsis comma mi = 1, . . . , m. Thus we compute the Riemann 
sum 
upper S Subscript n comma m Baseline colon equals sigma summation Underscript i equals 1 Overscript n Endscripts sigma summation Underscript j equals 1 Overscript m Endscripts f left parenthesis c Subscript i Baseline comma c Subscript j Baseline right parenthesis upper Delta x Subscript i Baseline upper Delta y Subscript j Baseline comma left parenthesis c Subscript i Baseline comma c Subscript j Baseline right parenthesis element of left bracket x Subscript i minus 1 Baseline comma x Subscript i Baseline right bracket times left bracket y Subscript j minus 1 Baseline comma y Subscript j Baseline right bracket commaSn,m :=
n
⎲
i=1
m
⎲
j=1
f (ci, cj)ΔxiΔyj,
(ci, cj) ∈[xi−1, xi] × [yj−1, yj],
(I.5) 
where upper Delta x Subscript i Baseline equals x Subscript i Baseline minus x Subscript i minus 1Δxi = xi −xi−1 and upper Delta y Subscript j Baseline equals y Subscript j Baseline minus y Subscript j minus 1Δyj = yj −yj−1 for each i comma ji, j. Assuming further f is 
bounded then 
limit Underscript Endscripts upper S Subscript n comma m Baseline equals integral Subscript a Superscript b Baseline left bracket integral Subscript c Superscript d Baseline f left parenthesis x comma y right parenthesis normal d y right bracket normal d x equals integral Subscript c Superscript d Baseline left bracket integral Subscript a Superscript b Baseline f left parenthesis x comma y right parenthesis normal d x right bracket normal d y comma lim Sn,m =
⎰b
a
⎾⎰d
c
f (x, y)dy
⏋
dx =
⎰d
c
⎾⎰b
a
f (x, y)dx
⏋
dy,
(I.6) 
provided the limit exists. The latter is taken for ﬁner partitions of the two intervals 
above, as n right arrow normal infinityn →∞, m right arrow normal infinitym →∞and s.t. 
sup left brace left parenthesis x Subscript i Baseline minus x Subscript i minus 1 Baseline right parenthesis left parenthesis y Subscript j Baseline minus y Subscript j minus 1 Baseline right parenthesis right brace right arrow 0 period sup
{
(xi −xi−1)(yj −yj−1)
}
→0.
4 If the function has domain strictly included in double struck upper R cubedR3, then all statements about continuity and 
differentiability are meant to hold at interior points and for small changes (so that all vectors 
involved do not move away from the domain). 
370
I
Review of Multivariate Differentiation and Integration
Fig. I.1 Surface as the graph 
of a function of two variable: 
the volume of a solid body 
over a sub-rectangle 
The supremum means that we take the largest left parenthesis x Subscript i Baseline minus x Subscript i minus 1 Baseline right parenthesis left parenthesis y Subscript j Baseline minus y Subscript j minus 1 Baseline right parenthesis equals area left parenthesis upper R Subscript i j Baseline right parenthesis(xi −xi−1)(yj −yj−1) = area(Rij), 
i.e. the area of rectangles upper R Subscript i j Baseline equals left bracket x Subscript i minus 1 Baseline comma x Subscript i Baseline right bracket times left bracket y Subscript j minus 1 Baseline comma y Subscript j Baseline right bracketRij
= [xi−1, xi] × [yj−1, yj]. This is also called 
the diameter of5 left bracket a comma b right bracket times left bracket c comma d right bracket[a, b] × [c, d]. The brackets in iterated integrals can be delete. 
Formula (I.6) especially holds if f is continuous on dom left parenthesis f right parenthesis equals left bracket a comma b right bracket times left bracket c comma d right bracketdom(f ) = [a, b] × [c, d]. 
If the function f is deﬁned over a more general bounded region in the plane, say 
dom left parenthesis f right parenthesis equals upper B subset of double struck upper R squareddom(f ) = B ⊂R2, then the above deﬁnition can be restated for the function 
ModifyingAbove f With tilde left parenthesis x comma y right parenthesis colon equals StartLayout Enlarged left brace 1st Row 1st Column f left parenthesis x comma y right parenthesis comma 2nd Column if left parenthesis x comma y right parenthesis element of upper B 2nd Row 1st Column 0 comma 2nd Column if left parenthesis x comma y right parenthesis element of left bracket a comma b right bracket times left bracket c comma d right bracket minus upper B comma EndLayout ˜f (x, y) :=
⌠f (x, y), if (x, y) ∈B
0,
if (x, y) ∈[a, b] × [c, d] \ B,
i.e. reconsidering the Riemann sum (I.5) for every left parenthesis c Subscript i Baseline comma c Subscript j Baseline right parenthesis(ci, cj) in upper R Subscript i j Baseline intersection upper BRij ∩B. If the limit (I.6) 
exists we can write at once the double Riemann integral as 
double integral Underscript upper B Endscripts ModifyingAbove f With tilde left parenthesis x comma y right parenthesis normal d x normal d y comma
⎰⎰
B
˜f (x, y)dxdy,
and again it equals both the two iterated integrals in (I.6). In Fig. I.1, upper R Subscript i j Baseline intersection upper B equals upper R Subscript i jRij ∩B = Rij
because upper R Subscript i jRij is inside B. Assuming f is nonnegative, the double Riemann integral 
can be interpreted as the volume of a solid body given by every point bold x equals left parenthesis x comma y comma z right parenthesisx = (x, y, z)
lying between the f ’s graph6 and the rectangle left bracket a comma b right bracket times left bracket c comma d right bracket[a, b] × [c, d] or the more general 
region B in the plane. 
Remark I.2 (Cavalieri’s Principle) Assume f is deﬁned on left bracket a comma b right bracket times left bracket c comma d right bracket[a, b] × [c, d]. We  
can cut a slice of the solid by a plane for example parallel to the y zyz-plane (then 
perpendicular to the x zxz-plane), thus getting a cross-sectional area upper A left parenthesis x right parenthesisA(x) at distance 
x element of left bracket a comma b right bracketx ∈[a, b] from the reference plane. Now, incrementing x by upper Delta xΔx the volume of the
5 One can deﬁne the diameter of any closed bounded set in double struck upper R squaredR2 as the maximum distance between 
any two of its points. 
6 Recall it can be implicitly deﬁned by the equation g left parenthesis x comma y comma z right parenthesis equals 0g(x, y, z) = 0, where g left parenthesis x comma y comma z right parenthesis equals z minus f left parenthesis x comma y right parenthesisg(x, y, z) = z−f (x, y). 
I
Review of Multivariate Differentiation and Integration
371
corresponding slab with this cross-sectional area and thickness upper Delta xΔx is approximately 
upper V left parenthesis x plus upper Delta x right parenthesis minus upper V left parenthesis x right parenthesis almost equals upper A left parenthesis x right parenthesis upper Delta xV (x +Δx)−V (x) ≈A(x)Δx. We obtain better approximation for smaller upper Delta xΔx and 
it is possible to get upper V prime left parenthesis x right parenthesis equals upper A left parenthesis x right parenthesisV '(x) = A(x) in the limit, i.e. upper V left parenthesis b right parenthesis minus upper V left parenthesis a right parenthesis equals integral Subscript a Superscript b Baseline upper A left parenthesis x right parenthesis normal d xV (b)−V (a) =
⎰b
a A(x)dx where 
we can let upper V identical to upper V left parenthesis b right parenthesisV ≡V (b) and upper V left parenthesis a right parenthesis equals 0V (a) = 0. In summary: Let upper S subset of double struck upper R cubedS ⊂R3 be a solid and let 
left parenthesis upper Pi Subscript x Baseline right parenthesis Subscript a less than or slanted equals x less than or slanted equals b(Πx)a⩽x⩽b a family of parallel planes s.t.
•
S lies between upper Pi Subscript aΠa and upper Pi Subscript bΠb,
•
.A(x) denotes the area of the S’s slice cut by upper Pi Subscript xΠx, 
then vol left parenthesis upper S right parenthesis equals upper V equals integral Subscript a Superscript b Baseline upper A left parenthesis x right parenthesis normal d xvol(S) = V =
⎰b
a A(x)dx. This approach can be restated by parallel planes 
left parenthesis upper Pi Subscript y Baseline right parenthesis Subscript c less than or slanted equals y less than or slanted equals d(Πy)c⩽y⩽d, but the volume remained unchanged. 
We have the following two-dimensional version of the mean value theorem, now 
for double integrals:
•
.
⎰⎰
B f (x, y)dxdy = μ
⎰⎰
B dxdy = μarea(B), for mu Subscript asterisk Baseline less than or slanted equals mu less than or slanted equals mu Superscript asteriskμ∗⩽μ ⩽μ∗and bounded 
f left parenthesis x comma y right parenthesis element of left bracket mu Subscript asterisk Baseline comma mu Superscript asterisk Baseline right bracketf (x, y) ∈[μ∗, μ∗] for every left parenthesis x comma y right parenthesis element of upper B(x, y) ∈B;
•
if B is connected7 then mu equals f left parenthesis c 1 comma c 2 right parenthesisμ = f (c1, c2) for some left parenthesis c 1 comma c 2 right parenthesis element of upper B(c1, c2) ∈B. 
The fact that double integral Underscript upper B Endscripts normal d x normal d y equals area left parenthesis upper B right parenthesis
⎰⎰
B dxdy = area(B) can be justiﬁed by the following probabilistic 
example. 
Example I.2 Let f left parenthesis x comma y right parenthesis equals StartFraction 1 Over pi r squared EndFractionf (x, y) =
1
πr2 for x squared plus y squared less than or slanted equals r squaredx2 + y2 ⩽r2 with r greater than 0r > 0, and zero otherwise. 
We show that this function is indeed a density of some bi-variate absolutely 
continuous random vector bold upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y), i.e. f identical to f Subscript bold upper Xf ≡fX. In fact, upper B equals StartSet left parenthesis x comma y right parenthesis element of double struck upper R squared vertical bar x squared plus y squared less than or slanted equals r squared EndSetB = {(x, y) ∈
R2 | x2 + y2 ⩽r2} is the subset of the plane given by a circle with radius r, so  
the double integral double integral Underscript upper B Endscripts normal d x normal d y equals pi r squared
⎰⎰
B dxdy = πr2 is equivalent to area left parenthesis upper B right parenthesisarea(B) and putting f left parenthesis x comma y right parenthesisf (x, y)
inside the above integral gives 1. Then f is a joint density and can be the model for 
the experiment of choosing at random a point into the circle with radius r. 
More generally, we can ﬁnd a solid in double struck upper R cubedR3 given by points bold x equals left parenthesis x comma y comma z right parenthesisx = (x, y, z) between 
the plane upper Pi Subscript zΠz with equation z equals f left parenthesis x comma y right parenthesisz = f (x, y) and the connected region upper B subset of double struck upper R squaredB ⊂R2, whose 
boundary partial differential upper B∂B is the closed line script l𝓁obtained by the equation g left parenthesis x comma y right parenthesis equals 0g(x, y) = 0. Thus the 
volume of the cylinder is 
upper V equals double integral Underscript upper B Endscripts k normal d x normal d y equals k double integral Underscript upper B Endscripts normal d x normal d y commaV =
⎰⎰
B
kdxdy = k
⎰⎰
B
dxdy,
7 It is the closure of a connected open subset in double struck upper R squaredR2, i.e. it is not the union of two disjoint closed 
subsets in double struck upper R squaredR2. 
372
I
Review of Multivariate Differentiation and Integration
Fig. I.2 Cylinder with base 
given by the circle  B. The  B’s 
boundary is the line script l𝓁given 
by the equation 
g left parenthesis x comma y right parenthesis equals StartRoot x plus y EndRoot minus r equals 0g(x, y) = √x + y −r = 0. 
A copy of  B also lies in the 
plane upper Pi Subscript zΠz identiﬁed by the 
equation z equals kz = k
where k normal d x normal d ykdxdy is the inﬁnitesimal volume of a parallelepiped with height k w.r.t. to 
the x yxy-plane and base’s area equal to normal d x normal d y commadxdy, On the other hand, the volume also 
equals area left parenthesis upper B right parenthesis karea(B)k thus implying area left parenthesis upper B right parenthesis equals double integral Underscript upper B Endscripts normal d x normal d y commaarea(B) =
⎰⎰
B dxdy, see Fig. I.2.
Appendix J 
A Glimpse to Vector Analysis in double struck upper R cubedR3
This appendix is an application of results from Appendix G to the three-dimensional 
Euclidean space. Recall that for two points bold x equals left parenthesis x 1 comma x 2 comma x 3 right parenthesisx = (x1, x2, x3) and bold y equals left parenthesis y 1 comma y 2 comma y 3 right parenthesisy = (y1, y2, y3)
we consider the concept of a vector as the directed line segment from bold xx to bold y periody. In 
particular, any point bold xx can be identiﬁed with a vector starting from the origin bold 0 equals left parenthesis 0 comma 0 comma 0 right parenthesis0 =
(0, 0, 0) and ending at bold xx itself. The magnitude of a vector starting from the origin is 
its Euclidean norm double vertical bar bold x double vertical bar comma‖x‖, and since h bold x equals left parenthesis h x 1 comma h x 2 comma h x 3 right parenthesish x = (h x1, h x2, h x3) we have that, for h greater than 0h > 0, 
double vertical bar h bold x double vertical bar equals h double vertical bar bold x double vertical bar‖h x‖ = h‖x‖, the second vector has the same direction of the ﬁrst but h times its 
magnitude. Introducing the unit vectors bold e 1 equals left parenthesis 1 comma 0 comma 0 right parenthesise1 = (1, 0, 0), bold e 2 equals left parenthesis 0 comma 1 comma 0 right parenthesise2 = (0, 1, 0) and bold e 3 equals left parenthesis 0 comma 0 comma 1 right parenthesise3 =
(0, 0, 1) we can express any other vector bold x equals left parenthesis x 1 comma x 2 comma x 3 right parenthesisx = (x1, x2, x3) as x 1 bold e 1 plus x 2 bold e 2 plus x 3 bold e 3x1 e1 + x2 e2 + x3 e3, 
where each x Subscript i Baseline bold e Subscript ixi ei is the component of X in the direction of the x Subscript ixi-axes. These unit 
vectors are sometimes called standard basis vectors and denoted by bold i comma bold j comma bold ki, j, k. Since the 
Euclidean norm satisﬁes (see also Appendix G) 
1. .‖x‖ ⩾0 for each bold x element of double struck upper R Superscript nx ∈Rn and double vertical bar bold x double vertical bar equals 0‖x‖ = 0 if and only if bold x equals bold 0x = 0, 
2. .‖hx‖ = |h| ‖x‖ for all bold x element of double struck upper R Superscript nx ∈Rn and h element of double struck upper Rh ∈R, 
3. .‖x + y‖ ⩽‖x‖ + ‖y‖ for all bold x comma bold y element of double struck upper R Superscript nx, y ∈Rn (triangle inequality), 
by item 2 we have that for h less than 0h < 0 the vector h bold xh x moves along the same straight line 
but in opposite direction than bold xx. For h equals negative 1h = −1 the magnitude is the same, the direction 
is opposite. If bold y equals h bold xy = h x then StartFraction 1 Over h EndFraction bold y 1
h y is a unit vector with the same direction as bold xx since 
double vertical bar StartFraction 1 Over h EndFraction bold y double vertical bar equals StartFraction 1 Over StartAbsoluteValue h EndAbsoluteValue EndFraction double vertical bar h bold x double vertical bar equals StartFraction 1 Over StartAbsoluteValue h EndAbsoluteValue EndFraction StartAbsoluteValue h EndAbsoluteValue equals 1‖ 1
h y‖ =
1
|h| ‖h x‖ =
1
|h| |h| = 1. Writing the inner product left angle bracket dot comma dot right angle bracket〈·, ·〉as the dot product, 
for the standard unit vectors we have: 
bold e 1 dot bold e 1 equals bold e 2 dot bold e 2 equals bold e 3 dot bold e 3 equals 1 comma bold e 1 dot bold e 2 equals bold e 2 dot bold e 3 equals bold e 3 dot bold e 1 equals 0 periode1 · e1 = e2 · e2 = e3 · e3 = 1,
e1 · e2 = e2 · e3 = e3 · e1 = 0.
We deduce:
•
.‖ei‖ = ei · ei, for i equals 1 comma 2 comma 3i = 1, 2, 3;
•
these vectors are orthogonal. 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4
373
374
J
A Glimpse to Vector Analysis in double struck upper R cubedR3
These features can be extended to all the vectors, thus bold x comma bold yx, y are orthogonal iff their 
inner product is zero (they are perpendicular). To get more geometric intuition, we 
ﬁrst recall that the vector sum bold x plus bold yx + y yields a new vector bold zz representing the diagonal 
of a parallelogram with two sides given by bold xx and bold yy (starting both from the origin), a 
third side being the vector parallel to bold yy and starting from the tip of bold xx, a fourth side 
being the vector parallel to bold xx and starting from the tip of bold yy. More interestingly, we 
can identify any vector bold ww not necessarily starting from bold 00 by simply considering the 
vector difference bold y plus left parenthesis negative 1 right parenthesis bold x colon equals bold y minus bold xy + (−1)x := y −x. Thus, if bold ww is just the difference then it moves 
from the tip of bold xx to the tip of bold yy and has coordinates left parenthesis y 1 minus x 1 comma y 2 minus x 2 comma y 3 minus x 3 right parenthesis period(y1 −x1, y2 −x2, y3 −x3). Now 
we are ready to state the geometric version of the orthogonality condition between 
two vectors. Recall that 
bold x dot bold y equals double vertical bar bold x double vertical bar double vertical bar bold y double vertical bar cosine theta comma for 0 less than or slanted equals theta less than or slanted equals pi periodx · y = ‖x‖‖y‖ cos θ,
for 0 ⩽θ ⩽π.
Here thetaθ is the angle between the two vectors. To prove the above we ﬁrst note that a 
distributive law holds between the inner product and the vector sum: 
bold x dot left parenthesis bold y plus bold z right parenthesis equals bold x dot bold y plus bold x dot bold z periodx · (y + z) = x · y + x · z.
Then we apply the cosine law and get: 
double vertical bar bold y minus bold x double vertical bar squared equals double vertical bar bold x double vertical bar squared plus double vertical bar bold y double vertical bar squared minus 2 double vertical bar bold x double vertical bar double vertical bar bold y double vertical bar cosine theta period‖y −x‖2 = ‖x‖2 + ‖y‖2 −2‖x‖ ‖y‖ cos θ.
(J.1) 
It sufﬁces to rewrite double vertical bar bold y minus bold x double vertical bar squared equals left parenthesis bold y minus bold x right parenthesis dot left parenthesis bold y minus bold x right parenthesis‖y −x‖2 = (y −x) · (y −x), bold x squared equals bold x dot bold xx2 = x · x and bold y squared equals bold y dot bold yy2 = y · y thus 
expand the inner product 
StartLayout 1st Row 1st Column left parenthesis bold y minus bold x right parenthesis dot left parenthesis bold y minus bold x right parenthesis 2nd Column equals 3rd Column bold y dot left parenthesis bold y minus bold x right parenthesis minus bold x dot left parenthesis bold y minus bold x right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column bold y dot bold y minus bold y dot bold x minus bold x dot bold y plus bold x dot bold x 3rd Row 1st Column Blank 2nd Column equals 3rd Column bold x dot bold x plus bold y dot bold y minus 2 bold x dot bold y comma EndLayout(y −x) · (y −x) = y · (y −x) −x · (y −x)
= y · y −y · x −x · y + x · x
= x · x + y · y −2x · y,
and eventually rearranging to get the result. Henceforth, two vector are orthogonal 
iff theta equals StartFraction pi Over 2 EndFractionθ =
π
2 , so that cosine theta equals 0cos θ = 0 and the inner product is zero too. Equation J.1 
is the Carnot’s theorem: For any triangle with a side of length c and oppo-
site angle thetaθ between the two remaining adjacent sides of length a comma ba, b we have: 
c squared equals a squared plus b squared minus 2 a b cosine thetac2 = a2 + b2 −2a b cos θ . It is interesting to note how the gradient of a real-
valued function upper F left parenthesis x 1 comma x 2 comma x 3 right parenthesisF(x1, x2, x3) of three variables may be formally written using the 
vector calculus we have brieﬂy developed. Let 
nabla colon equals bold e 1 StartFraction partial differential Over partial differential x 1 EndFraction plus bold e 2 StartFraction partial differential Over partial differential x 2 EndFraction plus bold e 3 StartFraction partial differential Over partial differential x 3 EndFraction∇:= e1 ∂
∂x1 + e2 ∂
∂x2 + e3 ∂
∂x3
we have (considering F as a scalar) 
nabla upper F colon equals nabla dot upper F equals bold e 1 StartFraction partial differential upper F Over partial differential x 1 EndFraction plus bold e 2 StartFraction partial differential upper F Over partial differential x 2 EndFraction plus bold e 3 StartFraction partial differential upper F Over partial differential x 3 EndFraction period∇F := ∇· F = e1 ∂F
∂x1 + e2 ∂F
∂x2 + e3 ∂F
∂x3 .
J
A Glimpse to Vector Analysis in double struck upper R cubedR3
375 
Thus we can safely evaluate the above operator at a point bold x element of double struck upper R cubedx ∈R3 to get 
nabla upper F left parenthesis bold x right parenthesis equals left parenthesis StartFraction partial differential upper F Over partial differential x 1 EndFraction left parenthesis bold x right parenthesis comma StartFraction partial differential upper F Over partial differential x 2 EndFraction left parenthesis bold x right parenthesis comma StartFraction partial differential upper F Over partial differential x 3 EndFraction left parenthesis bold x right parenthesis right parenthesis period∇F(x) =
⎛
∂F
∂x1 (x), ∂F
∂x2 (x), ∂F
∂x3 (x)
⎞
.
Now it is easy to prove that nabla left parenthesis upper F plus upper G right parenthesis equals nabla upper F plus nabla upper G∇(F +G) = ∇F +∇G. Moreover, if upper F left parenthesis bold x right parenthesis equals kF(x) = k deﬁnes 
a surface script upper S subset of double struck upper R cubedS ⊂R3, for k element of double struck upper Rk ∈R, then nabla upper F left parenthesis bold x right parenthesis∇F(x) is the vector orthogonal to this surface 
at a point lying in script upper SS and identiﬁed with the tip of a vector1 bold xx. In fact, deﬁning the 
total differential as 
normal d upper F left parenthesis bold x right parenthesis equals StartFraction partial differential upper F Over partial differential x 1 EndFraction left parenthesis bold x right parenthesis normal d x 1 plus StartFraction partial differential upper F Over partial differential x 2 EndFraction left parenthesis bold x right parenthesis normal d x 2 plus StartFraction partial differential upper F Over partial differential x 3 EndFraction left parenthesis bold x right parenthesis normal d x 3 commadF(x) = ∂F
∂x1 (x) dx1 + ∂F
∂x2 (x) dx2 + ∂F
∂x3 (x) dx3,
i.e. the measure of how F changes by small variations in all its variables, then from 
the script upper SS’s equation we deduce that normal d upper F left parenthesis bold x right parenthesis equals normal d k equals 0dF(x) = dk = 0. But observing how the total 
differential can be rewritten, 
ModifyingBelow left parenthesis bold e 1 StartFraction partial differential upper F Over partial differential x 1 EndFraction plus bold e 2 StartFraction partial differential upper F Over partial differential x 2 EndFraction plus bold e 3 StartFraction partial differential upper F Over partial differential x 3 EndFraction right parenthesis With bottom brace Underscript equals nabla upper F Endscripts dot ModifyingBelow left parenthesis bold e 1 normal d x 1 plus bold e 2 normal d x 2 plus bold e 3 normal d x 3 right parenthesis With bottom brace Underscript equals normal d bold x Endscripts comma
⎛
e1 ∂F
∂x1 + e2 ∂F
∂x2 + e3 ∂F
∂x3
⎞
◟
◝ ◜
◞
=∇F
· (e1dx1 + e2dx2 + e3dx3)
◟
◝ ◜
◞
=dx
,
where normal d bold xdx is a vector lying in the plane tangent to the surface, we ﬁnally get that the 
latter is the inner product nabla upper F dot normal d bold x equals 0∇F · dx = 0 which entails the orthogonality condition 
claimed. 
Example J.1 Consider a bi-variate CDF upper F Subscript bold upper XFX and a point lying on the surface script upper SS
deﬁned implicitly by the equation giving the graph of the CDF, g left parenthesis x comma y comma z right parenthesis equals z minus upper F Subscript bold upper X Baseline left parenthesis x comma y right parenthesis equals 0g(x, y, z) = z −
FX(x, y) = 0. Taking bold a equals left parenthesis a 1 comma a 2 comma z right parenthesisa = (a1, a2, z) as its position vector and another point in script upper SS
with position vector bold x equals left parenthesis x comma y comma z right parenthesisx = (x, y, z), we have that bold x minus bold ax −a is a new vector which lies on 
the plane tangent to the surface at bold aa. Since we know that nabla g∇g is orthogonal to script upper SS at 
the point with position vector bold xx, we deduce 
left parenthesis bold x minus bold a right parenthesis dot nabla g left parenthesis bold a right parenthesis equals 0 period(x −a) · ∇g(a) = 0.
Observe that 
nabla g left parenthesis bold a right parenthesis equals left parenthesis StartFraction partial differential g Over partial differential x EndFraction left parenthesis bold a right parenthesis comma StartFraction partial differential g Over partial differential y EndFraction left parenthesis bold a right parenthesis comma StartFraction partial differential g Over partial differential z EndFraction left parenthesis bold a right parenthesis right parenthesis equals left parenthesis minus StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential x EndFraction left parenthesis bold a right parenthesis comma minus StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential y EndFraction left parenthesis bold a right parenthesis comma 0 right parenthesis period∇g(a) =
⎛
∂g
∂x (a), ∂g
∂y (a), ∂g
∂z (a)
⎞
=
⎛
−∂FX
∂x (a), −∂FX
∂y (a), 0
⎞
.
Expanding the inner product we ﬁnally have: 
StartLayout 1st Row 1st Column left parenthesis x minus a 1 comma y minus a 2 comma z minus z right parenthesis 2nd Column dot 3rd Column left parenthesis minus StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential x EndFraction left parenthesis bold a right parenthesis comma minus StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential y EndFraction left parenthesis bold a right parenthesis comma 0 right parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column minus StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential x EndFraction left parenthesis bold a right parenthesis left parenthesis x minus a 1 right parenthesis minus StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential y EndFraction left parenthesis bold a right parenthesis left parenthesis y minus a 2 right parenthesis plus 0 period EndLayout(x −a1, y −a2, z −z) ·
⎛
−∂FX
∂x (a), −∂FX
∂y (a), 0
⎞
= −∂FX
∂x (a)(x −a1) −∂FX
∂y (a)(y −a2) + 0.
1 The vector bold xx whose tip identiﬁes a point lying in a surface is called position vector. 
376
J
A Glimpse to Vector Analysis in double struck upper R cubedR3
Example J.2 The last expression minus StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential x EndFraction left parenthesis bold a right parenthesis left parenthesis x minus a 1 right parenthesis minus StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential y EndFraction left parenthesis bold a right parenthesis left parenthesis y minus a 2 right parenthesis−∂FX
∂x (a)(x −a1) −∂FX
∂y (a)(y −a2) is that of the 
inner product left parenthesis bold x minus bold a right parenthesis dot nabla g left parenthesis bold a right parenthesis(x −a) · ∇g(a) which must be equal to zero. Moreover we started 
from upper F Subscript bold upper X Baseline left parenthesis x comma y right parenthesis minus z equals 0FX(x, y) −z = 0 and this is also valid at left parenthesis a 1 comma a 2 right parenthesis(a1, a2). Thus combining all these 
results we ﬁnally have the equation of the plane tangent at the point bold aa to the surface 
representing the CDF’s graph: 
z equals upper F Subscript bold upper X Baseline left parenthesis a 1 comma a 2 right parenthesis StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential x EndFraction left parenthesis a 1 comma a 2 right parenthesis left parenthesis x minus a 1 right parenthesis plus StartFraction partial differential upper F Subscript bold upper X Baseline Over partial differential y EndFraction left parenthesis a 1 comma a 2 right parenthesis left parenthesis y minus a 2 right parenthesis periodz = FX(a1, a2) ∂FX
∂x (a1, a2)(x −a1) + ∂FX
∂y (a1, a2)(y −a2).
Appendix K 
Stieltjes Integral 
integral Subscript 0 Superscript normal infinity Baseline x normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis
⎰∞
0
x dFX(x) is a particular instance of a Stieltjes integral. In fact, for a continuous 
function g left parenthesis x right parenthesisg(x) over the interval left bracket a comma b right bracket[a, b] it is deﬁned through the following steps: 
1. .[a, b] is partitioned by points a equals x 0 less than x 1 less than midline horizontal ellipsis less than x Subscript n Baseline equals b semicolona = x0 < x1 < · · · < xn = b;
2. take the ‘representative value’ g left parenthesis c Subscript i Baseline right parenthesis commag(ci), for c Subscript i Baseline element of left parenthesis x Subscript i minus 1 Baseline comma x Subscript i Baseline right bracket semicolonci ∈(xi−1, xi];
3. use an increasing (right-continuous)1 function upper F left parenthesis x right parenthesisF(x) over the same interval to 
compute the weighted sum upper S Subscript n Baseline colon equals sigma summation Underscript i equals 1 Overscript n Endscripts g left parenthesis c Subscript i Baseline right parenthesis left bracket upper F left parenthesis x Subscript i Baseline right parenthesis minus upper F left parenthesis x Subscript i minus 1 Baseline right parenthesis right bracketSn := ∑n
i=1 g(ci) [F(xi) −F(xi−1)]; 
4. take limit Underscript n right arrow normal infinity Endscripts upper S Subscript n Baseline equals integral Subscript a Superscript b Baseline g left parenthesis x right parenthesis normal d upper F left parenthesis x right parenthesislimn→∞Sn =
⎰b
a g(x)dF(x), sending the largest interval length (viz. mesh) 
to zero. 
Since we may choose g left parenthesis x right parenthesisg(x) as bounded over left bracket a comma b right bracket[a, b], it is crucial for the limit to exist 
that g left parenthesis x right parenthesisg(x) and upper F left parenthesis x right parenthesisF(x) do not share discontinuities at the same points x element of left bracket a comma b right bracketx ∈[a, b], indeed 
upper F left parenthesis x right parenthesisF(x) must be continuous at the discontinuities of g left parenthesis x right parenthesisg(x). Sufﬁcient conditions for the 
existence of Stieltjes integrals: g continuous and F increasing, or F expressed as 
the difference of two increasing functions. In our applications to probability we 
consider:
•
.g(x) = x and upper F left parenthesis x right parenthesis identical to upper F Subscript upper X Baseline left parenthesis x right parenthesisF(x) ≡FX(x);
•
.ci = xi−1 = i−1
2n in formula (4.37);
•
.E(Xn) is then the expectation of a discrete rv with these values and masses 
sans serif upper P left parenthesis upper X Subscript n Baseline equals StartFraction i minus 1 Over 2 Superscript n Baseline EndFraction right parenthesisP(Xn = i−1
2n ). 
Remark K.1 For continuous g left parenthesis x right parenthesisg(x) we have the Riemann-Stieltjes integral 
integral Subscript a Superscript b Baseline g left parenthesis x right parenthesis normal d upper F left parenthesis x right parenthesis
⎰b
a g(x)dF(x) exists. On the other hand, for upper F left parenthesis x right parenthesis equals xF(x) = x we have the classical 
Riemann integral. Be warned that in real analysis, for a measurable g left parenthesis x right parenthesisg(x) and a 
function upper F left parenthesis x right parenthesisF(x) corresponding to some Lebesgue-Stieltjes measure (see Appendix 
in Chap. 2) we have integral Subscript a Superscript b Baseline g left parenthesis x right parenthesis normal d upper F left parenthesis x right parenthesis
⎰b
a g(x)dF(x) as a Lebesgue-Stieltjes integral, which exists 
provided that g left parenthesis x right parenthesisg(x) is continuous except for a countable set of points in its domain. 
1 Right-continuity is not necessary, but in our application to probability is obvious. 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4
377
378
K
Stieltjes Integral
It is worth noting that any CDF upper F Subscript upper XFX may be expressed as the difference of two 
increasing functions whenever it is of a bounded variation on left bracket 0 comma 1 right bracket comma[0, 1], i.e., 
sup Underscript script upper P Endscripts sigma summation Underscript i equals 1 Overscript n Endscripts StartAbsoluteValue upper F Subscript upper X Baseline left parenthesis x Subscript i Baseline right parenthesis minus upper F Subscript upper X Baseline left parenthesis x Subscript i minus 1 Baseline right parenthesis EndAbsoluteValue less than normal infinity comma script upper P is a partition of left bracket 0 comma 1 right bracket comma sup
P
n
⎲
i=1
|FX(xi) −FX(xi−1)| < ∞,
P is a partition of [0, 1],
(K.1) 
and we write upper F Subscript upper X Baseline element of BV left bracket 0 comma 1 right bracket commaFX ∈BV[0, 1], where BV left bracket 0 comma 1 right bracketBV[0, 1] denotes the set of all bounded 
variation functions with domain left bracket 0 comma 1 right bracket period[0, 1]. More generally, the Riemann-Stieltjes 
integral integral Subscript 0 Superscript 1 Baseline g left parenthesis x right parenthesis normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis
⎰1
0 g(x)dFX(x) exists if the following conditions hold:
•
.g(x) and upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x) do not have discontinuities at the same points x element of left bracket 0 comma 1 right bracket semicolonx ∈[0, 1];
•
.g(x) is of a bounded p-variation and upper F Subscript upper X Baseline left parenthesis x right parenthesisFX(x) is of a bounded q-variation for some 
p comma q greater than 0p, q > 0 such that StartFraction 1 Over p EndFraction plus StartFraction 1 Over q EndFraction equals 1 period1
p + 1
q = 1.
The deﬁnition of p-variation is similar to Eq. (K.1), excepts that we must add the 
exponent p greater than 0p > 0 to each absolute differences, StartAbsoluteValue upper F Subscript upper X Baseline left parenthesis x Subscript i Baseline right parenthesis minus upper F Subscript upper X Baseline left parenthesis x Subscript i minus 1 Baseline right parenthesis EndAbsoluteValue Superscript p Baseline period|FX(xi)−FX(xi−1)|p. The q-variation 
is deﬁned similarly.
Appendix L 
Leibniz’s Formula 
Let f left parenthesis x comma t right parenthesisf (x, t) be deﬁned over left bracket a comma b right bracket times left bracket c comma d right bracket[a, b] × [c, d], where it is continuous. Assuming further 
that the partial derivative StartFraction partial differential f Over partial differential t EndFraction left parenthesis x comma t right parenthesis ∂f
∂t (x, t) is also continuous over the same domain. Then, 
we have 
StartFraction normal d Over normal d x EndFraction integral Subscript c Superscript d Baseline f left parenthesis x comma t right parenthesis normal d t equals integral Subscript c Superscript d Baseline StartFraction partial differential f Over partial differential x EndFraction left parenthesis x comma t right parenthesis normal d t period d
dx
⎰d
c
f (x, t)dt =
⎰d
c
∂f
∂x (x, t)dt.
(L.1) 
When it is assumed that f left parenthesis x comma t right parenthesis comma StartFraction partial differential f Over partial differential x EndFraction left parenthesis x comma t right parenthesisf (x, t), ∂f
∂x (x, t) are continuous for every x element of left bracket a comma b right bracketx ∈[a, b] and 
every t element of double struck upper Rt ∈R, that integral Subscript negative normal infinity Superscript normal infinity Baseline f left parenthesis x comma t right parenthesis normal d t
⎰∞
−∞f (x, t)dt is ﬁnite for every x element of left bracket a comma b right bracketx ∈[a, b] and there exists another 
function h left parenthesis t right parenthesish(t) s.t. integral Subscript negative normal infinity Superscript normal infinity Baseline h left parenthesis t right parenthesis normal d t
⎰∞
−∞h(t)dt is ﬁnite and StartAbsoluteValue StartFraction partial differential f Over partial differential x EndFraction left parenthesis x comma t right parenthesis EndAbsoluteValue less than or slanted equals h left parenthesis t right parenthesis| ∂f
∂x (x, t)| ⩽h(t) for every t element of double struck upper Rt ∈R and 
x element of left bracket a comma b right bracketx ∈[a, b] then 
StartFraction normal d Over normal d x EndFraction integral Subscript negative normal infinity Superscript normal infinity Baseline f left parenthesis x comma t right parenthesis normal d t equals integral Subscript negative normal infinity Superscript normal infinity Baseline StartFraction partial differential f Over partial differential x EndFraction left parenthesis x comma t right parenthesis normal d t period d
dx
⎰∞
−∞
f (x, t)dt =
⎰∞
−∞
∂f
∂x (x, t)dt.
(L.2) 
Minor changes yield the following. 
StartLayout 1st Row StartFraction normal d Over normal d x EndFraction integral Subscript c Superscript normal infinity Baseline f left parenthesis x comma t right parenthesis normal d t equals integral Subscript c Superscript normal infinity Baseline StartFraction partial differential f Over partial differential x EndFraction left parenthesis x comma t right parenthesis normal d t comma StartAbsoluteValue StartFraction partial differential f Over partial differential x EndFraction left parenthesis x comma y right parenthesis EndAbsoluteValue less than or slanted equals h left parenthesis t right parenthesis for every t greater than or slanted equals c EndLayout d
dx
⎰∞
c
f (x, t)dt =
⎰∞
c
∂f
∂x (x, t)dt,
||||
∂f
∂x (x, y)
|||| ⩽h(t) for every t ⩾c
(L.3) 
and the same for StartFraction normal d Over normal d x EndFraction integral Subscript negative normal infinity Superscript d Baseline f left parenthesis x comma y right parenthesis normal d t d
dx
⎰d
−∞f (x, y)dt with StartAbsoluteValue StartFraction partial differential f Over partial differential t EndFraction left parenthesis x comma y right parenthesis EndAbsoluteValue less than or slanted equals h left parenthesis t right parenthesis| ∂f
∂t (x, y)| ⩽h(t) for every t less than or slanted equals dt ⩽d. A more  
general version of formula (L.1) is  
StartLayout 1st Row StartFraction normal d Over normal d x EndFraction integral Subscript u left parenthesis x right parenthesis Superscript v left parenthesis x right parenthesis Baseline f left parenthesis x comma t right parenthesis normal d t equals f left parenthesis x comma v left parenthesis x right parenthesis right parenthesis v prime left parenthesis x right parenthesis minus f left parenthesis x comma u left parenthesis x right parenthesis right parenthesis u prime left parenthesis x right parenthesis plus integral Subscript u left parenthesis x right parenthesis Superscript v left parenthesis x right parenthesis Baseline StartFraction partial differential f Over partial differential x EndFraction left parenthesis x comma t right parenthesis normal d t comma EndLayout d
dx
⎰v(x)
u(x)
f (x, t)dt = f (x, v(x))v'(x) −f (x, u(x))u'(x) +
⎰v(x)
u(x)
∂f
∂x (x, t)dt,
(L.4) 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4
379
380
L
Leibniz’s Formula
provided that u left parenthesis x right parenthesis comma v left parenthesis x right parenthesisu(x), v(x) are differentiable functions (with continuous derivatives) 
deﬁned over left bracket a comma b right bracket[a, b] and their images are contained in left bracket c comma d right bracket[c, d]. 
Example L.1 We give more details in the derivation of the marginal density 
f Subscript upper X 1 Baseline left parenthesis x 1 right parenthesisfX1(x1) from a multivariate CDF upper F Subscript bold upper X Baseline left parenthesis x 1 comma x 2 comma ellipsis comma x Subscript n Baseline right parenthesisFX(x1, x2, . . . , xn) having a joint density 
f Subscript bold upper X Baseline left parenthesis x 1 comma x 2 comma ellipsis comma x Subscript n Baseline right parenthesisfX(x1, x2, . . . , xn). First we take x 2 comma ellipsis comma x Subscript n Baseline right arrow normal infinityx2, . . . , xn →∞in the CDF and write it using 
the density (via Fubini’s theorem): 
upper F Subscript bold upper X Baseline left parenthesis x 1 comma normal infinity comma ellipsis comma normal infinity right parenthesis equals StartFraction normal d Over normal d x 1 EndFraction integral Subscript negative normal infinity Superscript x 1 Baseline left bracket integral Subscript negative normal infinity Superscript normal infinity Baseline midline horizontal ellipsis integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript bold upper X Baseline left parenthesis u 1 comma u 2 comma ellipsis comma u Subscript n Baseline right parenthesis normal d u 2 midline horizontal ellipsis normal d u Subscript n Baseline right bracket normal d u 1 periodFX(x1, ∞, . . . , ∞) =
d
dx1
⎰x1
−∞
⎾⎰∞
−∞
· · ·
⎰∞
−∞
fX(u1, u2, . . . , un)du2 · · · dun
⏋
du1.
Next, we deﬁne upper G left parenthesis u 1 right parenthesis colon equals integral Subscript negative normal infinity Superscript normal infinity Baseline midline horizontal ellipsis integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript bold upper X Baseline left parenthesis u 1 comma u 2 comma ellipsis comma u Subscript n Baseline right parenthesis normal d u 2 midline horizontal ellipsis normal d u Subscript n BaselineG(u1) :=
⎰∞
−∞· · ·
⎰∞
−∞fX(u1, u2, . . . , un)du2 · · · dun as a function 
of only u 1u1. Thus we need to differentiate the integral integral Subscript negative normal infinity Superscript x 1 Baseline upper G left parenthesis u 1 right parenthesis normal d u 1
⎰x1
−∞G(u1)du1 w.r.t. to the 
variable x 1x1 and to this end we invoke the Leibniz’s formula (L.4): 
StartFraction normal d Over normal d x 1 EndFraction integral Subscript negative normal infinity Superscript x 1 Baseline upper G left parenthesis u 1 right parenthesis normal d u 1 equals upper G left parenthesis x 1 right parenthesis StartFraction normal d x 1 Over normal d x 1 EndFraction minus integral Subscript negative normal infinity Superscript x 1 Baseline StartFraction partial differential upper G Over partial differential x 1 EndFraction left parenthesis u 1 right parenthesis normal d u 1 period d
dx1
⎰x1
−∞
G(u1)du1 = G(x1)dx1
dx1
−
⎰x1
−∞
∂G
∂x1
(u1)du1.
As byproduct upper G left parenthesis x 1 right parenthesisG(x1) equals integral Subscript negative normal infinity Superscript normal infinity Baseline midline horizontal ellipsis integral Subscript negative normal infinity Superscript normal infinity Baseline f Subscript bold upper X Baseline left parenthesis x 1 comma u 2 comma ellipsis comma u Subscript n Baseline right parenthesis normal d u 2 midline horizontal ellipsis normal d u Subscript n Baseline
⎰∞
−∞· · ·
⎰∞
−∞fX(x1, u2, . . . , un)du2 · · · dun, while 
StartFraction normal d x 1 Over normal d x 1 EndFraction equals 1 dx1
dx1 = 1 and the partial derivative is zero. Finally, the n minus 1n−1 iterated integrals yield the 
desired marginal density f Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis periodfX1(x1). We used formula (L.4) with f left parenthesis x comma u 1 right parenthesis equals upper G left parenthesis u 1 right parenthesisf (x, u1) = G(u1), 
v left parenthesis x 1 right parenthesis equals x 1v(x1) = x1 and u left parenthesis x 1 right parenthesis equals normal infinityu(x1) = ∞.
Appendix M 
Lebesgue Measure 
A measure on the measurable space left parenthesis double struck upper R comma script upper B right parenthesis(R, B) which plays a central role in the theory 
of probability distributions is described in the following: 
Theorem M.1 There exists a unique measure m on left parenthesis double struck upper R comma script upper B right parenthesis comma(R, B), called the Lebesgue 
measure, which assigns to each interval left parenthesis a comma b right bracket element of script upper B(a, b] ∈B its length m left parenthesis left parenthesis a comma b right bracket right parenthesis equals b minus am((a, b]) = b −a
and is translation invariant. 
The Lebesgue measure on double struck upper RR is diffusive and attaches zero to singletons, ﬁnite 
sets and countable sets. 
Remark M.1 We give a formulation of Lebesgue null sets, similar to that of sans serif upper PP-null 
events. For each epsilon greater than 0ϵ > 0 there exists a sequence of intervals1 left parenthesis upper I Subscript i Baseline right parenthesis Subscript i Baseline subset of script upper B(Ii)i ⊂B such that 
upper A subset of union Subscript i Baseline upper I Subscript i Baseline commaA ⊂∪iIi, i.e. they cover upper A commaA, and their total length is arbitrary small, sigma summation Underscript i Endscripts m left parenthesis upper I Subscript i Baseline right parenthesis less than epsilon period∑
i m(Ii) < ϵ.
By Theorem M.1 we take upper I Subscript i Baseline equals left parenthesis a Subscript i Baseline comma b Subscript i Baseline right bracketIi = (ai, bi] with length given by m left parenthesis upper I Subscript i Baseline right parenthesis equals b Subscript i Baseline minus a Subscript i Baseline periodm(Ii) = bi −ai. Each 
singleton StartSet x EndSet element of script upper B{x} ∈B is such that StartSet x EndSet subset of left parenthesis x minus StartFraction epsilon Over 4 Superscript i Baseline EndFraction comma x plus StartFraction epsilon Over 4 Superscript i Baseline EndFraction right bracket{x} ⊂
(
x−ϵ
4i , x+ ϵ
4i
⏋
and can be covered by inﬁnitely 
many intervals for i equals 1 comma 2 comma ellipsis periodi = 1, 2, . . . . We have 
sigma summation Underscript i Endscripts m left parenthesis upper I Subscript i Baseline right parenthesis equals StartFraction epsilon Over 2 EndFraction sigma summation Underscript i equals 1 Overscript normal infinity Endscripts StartFraction 1 Over 2 Superscript i Baseline EndFraction equals StartFraction epsilon Over 2 EndFraction comma
⎲
i
m(Ii) = ϵ
2
∞
⎲
i=1
1
2i = ϵ
2,
then sigma summation Underscript i Endscripts m left parenthesis upper I Subscript i Baseline right parenthesis less than epsilon period∑
i m(Ii) < ϵ. Thus by monotonicity, StartSet x EndSet less than or slanted equals sigma summation Underscript i Endscripts m left parenthesis upper I Subscript i Baseline right parenthesis comma{x} ⩽∑
i m(Ii), and the arbitrarily of epsilonϵ
we must have m left parenthesis StartSet x EndSet right parenthesis equals 0 periodm({x}) = 0.
Remark M.2 There are other Lebesgue null sets than the countable ones. A classic 
example of uncountable null set is due to George Cantor. Given left bracket 0 comma 1 right bracket comma[0, 1], remove the 
middle third left parenthesis one third comma two thirds right parenthesis( 1
3, 2
3) to obtain upper C 1 equals left bracket 0 comma one third right bracket union left bracket two thirds comma 1 right bracket periodC1 = [0, 1
3] ∪[ 2
3, 1]. Next, remove the middle third of 
each of these two intervals to obtain upper C 2C2 and continue the process n times. Now, upper C Subscript nCn
1 They may overlap. 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4
381
382
M
Lebesgue Measure
is the union of 2 Superscript n2n disjoint closed intervals each of length StartFraction 1 Over 3 Superscript n Baseline EndFraction comma 1
3n , then m left parenthesis upper C Subscript n Baseline right parenthesis equals left parenthesis two thirds right parenthesis Superscript n Baseline periodm(Cn) =
⎛
2
3
⎞n
.
The Cantor set is upper C equals intersection Subscript n equals 1 Superscript normal infinity Baseline upper C Subscript n Baseline periodC = ∩∞
n=1Cn. Let epsilon greater than 0 commaϵ > 0, pick a large n element of double struck upper Nn ∈N such that left parenthesis two thirds right parenthesis Superscript n Baseline less than epsilon
⎛
2
3
⎞n
< ϵ
and observe that upper C subset of upper C Subscript n Baseline periodC ⊂Cn. Therefore, we ﬁnd a sequence of intervals upper C Subscript nCn covering C 
whose total length is less than an arbitrary epsilonϵ and conclude m left parenthesis upper C right parenthesis equals 0 periodm(C) = 0. But it can be 
shown that C has the same cardinality of left bracket 0 comma 1 right bracket comma[0, 1], then it is an uncountable subset of 
double struck upper RR with Lebesgue measure zero. 
Now, we come to translation invariance. Since the length of an interval does not 
change under a shifting, m left parenthesis left parenthesis a plus x comma b plus x right bracket right parenthesis equals b minus am((a + x, b + x]) = b −a for all x element of double struck upper R commax ∈R, then it can 
be shown that this property still holds for general Borel sets of the form upper A plus x colon equals StartSet a plus x vertical bar a element of upper A EndSet colonA + x :=
{a + x | a ∈A} : they have Lebesgue measure m left parenthesis upper A plus x right parenthesis equals m left parenthesis upper A right parenthesis periodm(A + x) = m(A). A similar 
behavior hold under dilation: for every x element of double struck upper Rx ∈R and a given upper A element of script upper B commaA ∈B, the Borel set 
x upper A colon equals StartSet x a vertical bar a element of upper A EndSetx A := {x a | a ∈A} has measure m left parenthesis x upper A right parenthesis equals StartAbsoluteValue x EndAbsoluteValue m left parenthesis upper A right parenthesis periodm(x A) = |x|m(A). E.g. upper A equals left parenthesis a comma b right parenthesisA = (a, b) and 
x less than 0x < 0 imply m left parenthesis x upper A right parenthesis equals StartAbsoluteValue x EndAbsoluteValue left parenthesis b minus a right parenthesis commam(xA) = |x|(b−a), so that length is not altered by negative dilation.2 
Interesting enough, if we restrict ourselves to the unit interval upper Omega equals left parenthesis 0 comma 1 right bracketΩ = (0, 1] and take 
the smallest sigma hyphen algebraσ-algebra script upper B Subscript left parenthesis 0 comma 1 right bracketB(0,1] generated by the collection 
StartSet union Subscript i equals 1 Superscript n Baseline upper I Subscript i Baseline vertical bar upper I Subscript i Baseline equals left parenthesis a Subscript i Baseline comma b Subscript i Baseline right bracket are disjoint comma 0 less than a Subscript i Baseline less than b Subscript i Baseline less than or slanted equals 1 EndSet comma
{
∪n
i=1 Ii | Ii = (ai, bi] are disjoint, 0 < ai < bi ⩽1
}
,
then the Lebesgue measure on left parenthesis upper Omega comma script upper B Subscript left parenthesis 0 comma 1 right bracket Baseline right parenthesis
(
Ω, B(0,1]
)
is a probability measure. The Lebesgue 
measure can be extended to Borel subsets of the n-dimensional Euclidean space. 
First, Theorem M.1 is valid in double struck upper R Superscript nRn so that the pair left parenthesis double struck upper R Superscript n Baseline comma script upper B Superscript n Baseline right parenthesis(Rn, Bn) can be equipped with 
the n-dimensional Lebesgue measure m Superscript nmn which assigns a volume to half-open 
rectangles simply by the product of lengths of each side in the Cartesian product: 
m Superscript n Baseline left parenthesis left parenthesis bold a comma bold b right bracket right parenthesis equals m left parenthesis left parenthesis a 1 comma b 1 right bracket right parenthesis times midline horizontal ellipsis times m left parenthesis left parenthesis a Subscript n Baseline comma b Subscript n Baseline right bracket right parenthesis equals product Underscript i equals 1 Overscript n Endscripts left parenthesis b Subscript i Baseline minus a Subscript i Baseline right parenthesis comma bold a less than bold b element of double struck upper R Superscript n Baseline periodmn((a, b]) = m((a1, b1]) × · · · × m((an, bn]) =
n
∏
i=1
(bi −ai),
a < b ∈Rn.
The volume of left bracket bold a comma bold b right bracket comma left parenthesis bold a comma bold b right parenthesis[a, b], (a, b) and left bracket bold a comma bold b right parenthesis[a, b) is again product Underscript i equals 1 Overscript n Endscripts left parenthesis b Subscript i Baseline minus a Subscript i Baseline right parenthesis period∏n
i=1(bi−ai). Therefore, the volume 
remains unchanged if we consider the Cartesian product upper I 1 times midline horizontal ellipsis times upper I Subscript nI1 × · · · × In of intervals 
upper I 1 comma ellipsis comma upper I Subscript n BaselineI1, . . . , In in double struck upper RR which are open, closed or neither open nor closed. 
Example M.1 Let double struck upper R times double struck upper RR × R be the two-dimensional Euclidean space and take upper I Subscript i Baseline equals left bracket a Subscript i Baseline comma b Subscript i Baseline right bracket commaIi =
[ai, bi], each i equals 1 comma 2 periodi = 1, 2. Then consider the sets upper N Subscript i Baseline equals left brace left parenthesis x 1 comma x 2 right parenthesis vertical bar a Subscript i Baseline less than or slanted equals x Subscript i Baseline less than or slanted equals b Subscript i Baseline comma x Subscript j Baseline equals a Subscript j Baseline right braceNi = {(x1, x2) | ai ⩽xi ⩽bi, xj =
aj} with i not equals ji /= j taken from StartSet 1 comma 2 EndSet period{1, 2}. We can cover them by countable collections of 
open rectangles whose union has arbitrary small total volume, thus upper N 1N1 and upper N 2N2 are 
m squaredm2-null and upper I 1 times upper I 2 minus left parenthesis upper N 1 union upper N 2 right parenthesisI1×I2\(N1∪N2) has 2-dimensional Lebesgue measure m squared left parenthesis upper I 1 times upper I 2 right parenthesis equals left parenthesis b 1 minus a 1 right parenthesis left parenthesis b 2 minus a 2 right parenthesis commam2(I1×I2) =
(b1 −a1)(b2 −a2), which is equal to that of the Cartesian product left parenthesis a 1 comma b 1 right bracket times left parenthesis a 2 comma b 2 right bracket(a1, b1]×(a2, b2]
as the 2-dimensional version of Theorem M.1 requires.
2 Note that m left parenthesis left parenthesis negative normal infinity comma a right bracket right parenthesis equals normal infinitym((−∞, a]) = ∞and m left parenthesis left parenthesis negative normal infinity comma normal infinity right parenthesis right parenthesis equals normal infinity equals m left parenthesis double struck upper R right parenthesis periodm((−∞, ∞)) = ∞= m(R).
M
Lebesgue Measure
383
With the n-dimensional Lebesgue measure at hand, let StartFraction 1 Over m Superscript n Baseline left parenthesis upper E right parenthesis EndFraction
1
mn(E) be attached to a 
Borel set upper E element of script upper B Superscript nE ∈Bn such that 0 less than m Superscript n Baseline left parenthesis upper E right parenthesis less than normal infinity0 < mn(E) < ∞. Formula sans serif upper P left parenthesis upper A right parenthesis colon equals StartFraction m Superscript n Baseline left parenthesis upper A intersection upper E right parenthesis Over m Superscript n Baseline left parenthesis upper E right parenthesis EndFractionP(A) := mn(A∩E)
mn(E)
deﬁnes a 
probability measure on the measurable space left parenthesis upper E comma script upper F Subscript upper E Baseline right parenthesis comma(E, FE), where script upper F Subscript upper EFE denotes the trace-
sigma hyphen algebraσ-algebra of subset taken from upper E subset of double struck upper R Superscript n Baseline commaE ⊂Rn, that is StartSet upper A intersection upper E vertical bar upper A element of script upper B Superscript n Baseline EndSet{A ∩E | A ∈Bn}, with sans serif upper P left parenthesis upper E right parenthesis equals 1P(E) = 1. 
The case n equals 1n = 1 with upper E equals left parenthesis 0 comma 1 right bracketE = (0, 1] and m Superscript 1 Baseline equals mm1 = m has been treated above. Pay attention 
to the behavior of upper A intersection upper E subset of upper E colonA ∩E ⊂E : we have 0 less than m Superscript n Baseline left parenthesis upper E right parenthesis less than normal infinity0 < mn(E) < ∞so that every subset 
has positive Lebesgue measure too. A ﬁnal word. We know that upper X equals StartFraction ModifyingAbove normal d sans serif upper P With tilde Over normal d sans serif upper P EndFractionX =
˜dP
dP is the 
Radon-Nikodým derivative of sans serif upper P overTilde˜P w.r.t. the old probability measure sans serif upper PP, provided the 
former is absolutely continuous (in the sense of measure) w.r.t. the latter. The term 
‘derivative’ is analogous to consider the density f Subscript upper X Baseline left parenthesis x right parenthesis equals StartFraction normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis Over normal d x EndFractionfX(x) = dFX(x)
dx
of an absolutely 
continuous CDF. To see how this is intimately true, let us recall the continuous 
uniform probability measure on the sample space upper Omega equals left bracket 0 comma 1 right parenthesisΩ = [0, 1) s.t. sans serif upper P left parenthesis upper A right parenthesis equals b minus aP(A) = b −a
for every bounded interval upper A equals left parenthesis a comma b right parenthesis comma left parenthesis a comma b right bracket comma left bracket a comma b right parenthesis comma left bracket a comma b right bracketA = (a, b), (a, b], [a, b), [a, b]. Now write f left parenthesis x right parenthesis equals StartFraction 1 Over b minus a EndFraction bold upper I Subscript left bracket a comma b right bracket Baseline left parenthesis x right parenthesisf (x) =
1
b−a I[a,b](x) and re-deﬁne the set function 
sans serif upper P left parenthesis upper B right parenthesis colon equals StartFraction 1 Over b minus a EndFraction m left parenthesis left bracket a comma b right bracket intersection upper B right parenthesis comma for every upper B subset of double struck upper R commaP(B) :=
1
b−a m([a, b] ∩B),
for every B ⊂R,
where the Bs are Borel subsets of reals, and m left parenthesis left bracket a comma b right bracket right parenthesis equals b minus am([a, b]) = b −a is the Lebesgue 
measure acting on bounded intervals left bracket a comma b right bracket[a, b] as the uniform probability measure, 
where now upper A subset of double struck upper RA ⊂R. It follows that m left parenthesis upper B right parenthesis equals 0m(B) = 0 implies sans serif upper P left parenthesis upper B right parenthesis equals 0P(B) = 0, indeed 
left bracket a comma b right bracket intersection upper B subset of upper B[a, b] ∩B ⊂B and then by monotonicity 0 less than or slanted equals m left parenthesis left bracket a comma b right bracket intersection upper B right parenthesis less than or slanted equals m left parenthesis upper B right parenthesis equals 00 ⩽m([a, b] ∩B) ⩽m(B) = 0. 
The function f left parenthesis x right parenthesisf (x) is actually the density of a rv X’s probability law, i.e., we can 
identify sans serif upper P identical to sans serif upper P Subscript upper XP ≡PX and then sans serif upper P Subscript upper X Baseline left parenthesis upper B right parenthesis equals sans serif upper P left parenthesis upper X element of upper B right parenthesisPX(B) = P(X ∈B) is s.t. sans serif upper P Subscript upper X Baseline much less than mPX ⪡m, and we also identify 
f identical to f Subscript upper Xf ≡fX. In fact, it can be shown that for any probability distribution over upper B subset of double struck upper RB ⊂R
the existence of f Subscript upper X Baseline left parenthesis x right parenthesis greater than or slanted equals 0fX(x) ⩾0 s.t. integral Underscript double struck upper R Endscripts f Subscript upper X Baseline left parenthesis x right parenthesis normal d x equals 1
⎰
R fX(x)dx = 1 entails 
sans serif upper P Subscript upper X Baseline left parenthesis upper B right parenthesis equals integral Underscript upper B Endscripts f Subscript upper X Baseline left parenthesis x right parenthesis normal d x commaPX(B) =
⎰
B
fX(x)dx,
and sans serif upper P Subscript upper X Baseline much less than mPX ⪡m. In fact, f Subscript upper XfX is the density of sans serif upper P Subscript upper XPX and upper X equals StartFraction normal d sans serif upper P overTilde Over normal d sans serif upper P EndFractionX = d ˜P
dP may safely be called 
the density of sans serif upper P overTilde˜P w.r.t. sans serif upper PP. Since the latter is also the Radon-Nikodým derivative (of sans serif upper P overTilde˜P
w.r.t. sans serif upper PP) the ultimate connection is the following: for an absolutely continuous CDF 
upper F Subscript upper XFX it holds upper F Subscript upper X Baseline left parenthesis x right parenthesis equals integral Underscript left parenthesis negative normal infinity comma x right bracket Endscripts f Subscript upper X Baseline left parenthesis u right parenthesis normal d uFX(x) =
⎰
(−∞,x] fX(u)du and then we have 
sans serif upper P Subscript upper X Baseline left parenthesis upper B right parenthesis equals integral Underscript upper B Endscripts normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis equals integral Underscript upper B Endscripts f Subscript upper X Baseline left parenthesis u right parenthesis normal d x equals integral Underscript double struck upper R Endscripts f Subscript upper X Baseline left parenthesis u right parenthesis bold upper I Subscript upper B Baseline left parenthesis x right parenthesis normal d x commaPX(B) =
⎰
B
dFX(x) =
⎰
B
fX(u)dx =
⎰
R
fX(u)IB(x)dx,
with the obvious analogy on one hand between sans serif upper E Subscript sans serif upper PEP and integral Underscript double struck upper R Endscripts
⎰
R, on the other hand 
between X and f Subscript upper XfX.
Appendix N 
Lebesgue Integral 
We recall the following result about Riemann integration. 
Theorem N.1 
.f : [a, b] →R is Riemann-integrable iff for all epsilon greater than 0ϵ > 0 there exists a 
partition script upper PP s.t. upper U left parenthesis script upper P comma f right parenthesis minus upper L left parenthesis script upper P comma f right parenthesis less than epsilon periodU(P, f ) −L(P, f ) < ϵ.
Here, 
upper L left parenthesis script upper P comma f right parenthesis colon equals sigma summation Underscript i equals 1 Overscript n Endscripts m Subscript i Baseline left parenthesis x Subscript i Baseline minus x Subscript i minus 1 Baseline right parenthesis comma m Subscript i Baseline equals inf left brace f left parenthesis x right parenthesis vertical bar x element of left bracket x Subscript i minus 1 Baseline comma x Subscript i Baseline right bracket right braceL(P, f ) :=
n
⎲
i=1
mi(xi −xi−1),
mi = inf
{
f (x) | x ∈[xi−1, xi]
}
are lower Riemann sums and 
upper U left parenthesis script upper P comma f right parenthesis colon equals sigma summation Underscript i equals 1 Overscript n Endscripts upper M Subscript i Baseline left parenthesis x Subscript i Baseline minus x Subscript i minus 1 Baseline right parenthesis comma upper M Subscript i Baseline equals sup left brace f left parenthesis x right parenthesis vertical bar x element of left bracket x Subscript i minus 1 Baseline comma x Subscript i Baseline right bracket right braceU(P, f ) :=
n
⎲
i=1
Mi(xi −xi−1),
Mi = sup
{
f (x) | x ∈[xi−1, xi]
}
are upper Riemann sums, for every partition script upper P equals StartSet x 0 comma x 1 comma ellipsis comma x Subscript n Baseline EndSetP = {x0, x1, . . . , xn}. Instead, we can 
refer to the common Riemann sum 
upper S left parenthesis script upper P comma f right parenthesis colon equals sigma summation Underscript i equals 1 Overscript n Endscripts f left parenthesis c Subscript i Baseline right parenthesis left parenthesis x Subscript i Baseline minus x Subscript i minus 1 Baseline right parenthesis comma script upper P partition of left bracket a comma b right bracket commaS(P, f ) :=
n
⎲
i=1
f (ci)(xi −xi−1),
P partition of [a, b],
where c Subscript i Baseline element of left bracket x Subscript i minus 1 Baseline comma x Subscript i Baseline right bracketci ∈[xi−1, xi]. We deﬁne the mesh 
double vertical bar script upper P double vertical bar colon equals max left brace left parenthesis x Subscript i Baseline minus x Subscript i minus 1 Baseline right parenthesis vertical bar script upper P partition left bracket a comma b right bracket right brace equals max Underscript 1 less than or slanted equals i less than or slanted equals n Endscripts left parenthesis x Subscript i Baseline minus x Subscript i minus 1 Baseline right parenthesis period‖P‖ := max
{
(xi −xi−1) | P partition [a, b]
}
= max
1⩽i⩽n(xi −xi−1).
If the Riemann integral exists, then 
limit Underscript double vertical bar script upper P double vertical bar right arrow 0 Endscripts upper S left parenthesis script upper P comma f right parenthesis equals upper R less than normal infinity comma
lim
‖P‖→0
S(P, f ) = R < ∞,
(N.1) 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4
385
386
N
Lebesgue Integral
for every epsilon greater than 0ϵ > 0 s.t. there exists delta greater than 0δ > 0 and a partition of left bracket a comma b right bracket[a, b] with mesh double vertical bar script upper P double vertical bar less than delta‖P‖ < δ
s.t. StartAbsoluteValue upper S left parenthesis script upper P comma f right parenthesis minus upper R EndAbsoluteValue less than epsilon comma|S(P, f ) −R| < ϵ, for all c Subscript i Baseline element of left bracket x Subscript i minus 1 Baseline comma x Subscript i Baseline right bracket periodci ∈[xi−1, xi].
Example N.1 The function f left parenthesis x right parenthesis equals bold upper I Subscript double struck upper Q Baseline left parenthesis x right parenthesisf (x) = IQ(x) is not Riemann-integrable. Over the 
restricted domain left bracket 0 comma 1 right bracket[0, 1], this function has lower Riemann sums are 0, while all upper 
Riemann sums are 1. Then, f is not integrable in the Riemann sense. 
Other pathological behaviors refer to sequences of functions left parenthesis f Subscript n Baseline left parenthesis x right parenthesis right parenthesis Subscript n(fn(x))n deﬁned 
over the same closed interval converging to a limit function f left parenthesis x right parenthesisf (x): it is not always 
true that limit Underscript n Endscripts integral Subscript a Superscript b Baseline f Subscript n Baseline left parenthesis x right parenthesis normal d x equals integral Subscript a Superscript b Baseline limit Underscript n Endscripts f Subscript n Baseline left parenthesis x right parenthesis normal d x equals integral Subscript a Superscript b Baseline f left parenthesis x right parenthesis normal d xlimn
⎰b
a fn(x)dx =
⎰b
a limn fn(x)dx =
⎰b
a f (x)dx, and interchanging 
limits with integral fails. To overcome this an other issues, the following procedure 
of integration comes into play. Given a bounded f colon left bracket a comma b right bracket right arrow double struck upper Rf : [a, b] →R with image 
upper G equals f left parenthesis left bracket a comma b right bracket right parenthesis equals StartSet f left parenthesis x right parenthesis vertical bar x element of left bracket a comma b right bracket EndSetG = f ([a, b]) =
{
f (x) | x ∈[a, b]
}
,we instead partition left bracket inf upper G comma sup upper G right bracket[inf G, sup G] via 
script upper P equals StartSet y 0 comma y 1 comma ellipsis comma y Subscript n Baseline EndSetP = {y0, y1, . . . , yn} yielding1 subintervals upper J Subscript i Baseline equals left bracket y Subscript i minus 1 Baseline comma y Subscript i Baseline right parenthesisJi = [yi−1, yi). We require that f 
is Borel-measurable, then f Superscript negative 1 Baseline left parenthesis upper J Subscript i Baseline right parenthesisf −1 (Ji) is again a Borel subset of double struck upper RR to which we attach 
its Lebesgue measure. Next, fora all i we deﬁne the Lebesgue sum 
upper L e left parenthesis script upper P comma f right parenthesis equals sigma summation Underscript i equals 1 Overscript n Endscripts c Subscript i Baseline m left parenthesis upper J Subscript i Baseline right parenthesis commaLe(P, f ) =
n
⎲
i=1
cim (Ji) ,
(N.2) 
where we can choose either c Subscript i Baseline element of upper J Subscript ici ∈Ji or c Subscript i Baseline equals inf upper J Subscript ici = inf Ji. Therefore, f is Lebesgue-
integrable if the limit 
limit Underscript double vertical bar script upper P double vertical bar right arrow 0 Endscripts upper L e left parenthesis script upper P comma f right parenthesis equals upper L equals integral Underscript left bracket a comma b right bracket Endscripts f left parenthesis x right parenthesis normal d m comma
lim
‖P‖→0
Le(P, f ) = L =
⎰
[a,b]
f (x)dm,
(N.3) 
exists and is ﬁnite, i.e., for every epsilon greater than 0ϵ > 0 exists delta greater than 0δ > 0 and a partition of left bracket inf upper G comma sup upper G right bracket[inf G, sup G]
with ﬁnite mesh double vertical bar script upper P double vertical bar less than delta‖P‖ < δ yielding StartAbsoluteValue upper L e left parenthesis script upper P comma f right parenthesis minus upper L EndAbsoluteValue less than epsilon|Le(P, f ) −L| < ϵ. Observe that script upper PP partitions 
left bracket inf upper G comma sup upper G right bracket[inf G, sup G] through intervals upper J 1 comma ellipsis comma upper J Subscript n BaselineJ1, . . . , Jn, and this induces a partition of the f ’s 
domain via the Borel sets 
upper A Subscript i Baseline equals StartSet x element of upper D vertical bar y Subscript i minus 1 Baseline less than or slanted equals f left parenthesis x right parenthesis less than y Subscript i Baseline EndSet equals f Superscript negative 1 Baseline left parenthesis upper J Subscript i Baseline right parenthesis commaAi =
{
x ∈D | yi−1 ⩽f (x) < yi
}
= f −1(Ji),
and the domain is the disjoint union union Subscript i equals 1 Superscript n Baseline upper A Subscript i∪n
i=1Ai. Observe that upper J Subscript iJi are mutually disjoint. 
Remark N.1 It is worth noting that step functions g colon left bracket a comma b right bracket right arrow double struck upper Rg : [a, b] →R deﬁned 
as g left parenthesis x right parenthesis equals c Subscript ig(x) = ci for x element of left parenthesis x Subscript i minus 1 Baseline comma x Subscript i Baseline right parenthesis commax ∈(xi−1, xi), for a partition script upper P equals StartSet x 0 comma x 1 comma ellipsis comma x Subscript n Baseline EndSetP = {x0, x1, . . . , xn} of the 
ﬁnite interval left bracket a comma b right bracket comma[a, b], are Riemann-integrable with Riemann integral integral Subscript a Superscript b Baseline g left parenthesis x right parenthesis normal d x equals sigma summation Underscript i equals 1 Overscript n Endscripts c Subscript i Baseline left parenthesis x Subscript i Baseline minus x Subscript i minus 1 Baseline right parenthesis
⎰b
a g(x)dx =
∑n
i=1 ci(xi −xi−1). Indeed, for a Riemann-integrable function f colon left bracket a comma b right bracket right arrow double struck upper Rf : [a, b] →R it 
can be shown that 
integral Subscript a Superscript b Baseline f left parenthesis x right parenthesis normal d x equals sup left brace integral Subscript a Superscript b Baseline g left parenthesis x right parenthesis normal d x vertical bar g less than or slanted equals f comma g step func period right brace period
⎰b
a
f (x)dx = sup
⌠⎰b
a
g(x)dx
||| g ⩽f, g step func.
⎫
.
1 Here y 0 equals inf upper Gy0 = inf G and y Subscript n Baseline equals sup upper Gyn = sup G. 
N
Lebesgue Integral
387
We can set g left parenthesis x right parenthesis equals sigma summation Underscript i equals 1 Overscript n Endscripts c Subscript i Baseline bold upper I Subscript upper I Sub Subscript ig(x) = ∑n
i=1 ciIIi for intervals upper I Subscript iIi stemming from a partition script upper PP of left bracket a comma b right bracket[a, b]
s.t. left bracket a comma b right bracket equals union Subscript i equals 1 Superscript n Baseline upper I Subscript i[a, b] = ∪n
i=1Ii, with at most one common point, i.e., upper I Subscript i Baseline intersection upper I Subscript j Baseline equals empty setIi ∩Ij = ∅or equals StartSet x EndSet= {x} with 
x element of left bracket a comma b right bracketx ∈[a, b] and i not equals ji /= j. 
As showed by Remark N.1, the Lebesgue integral of a nonnegative step function 
g left parenthesis x right parenthesis equals sigma summation Underscript i equals 1 Overscript n Endscripts c Subscript i Baseline bold upper I Subscript upper A Sub Subscript ig(x) = ∑n
i=1 ciIAi, where upper A Subscript i Baseline subset of left bracket a comma b right bracketAi ⊂[a, b] are pairwise disjoint and s.t. union Subscript i equals 1 Superscript n Baseline upper A Subscript i Baseline equals left bracket a comma b right bracket∪n
i=1Ai =
[a, b], is integral Underscript left bracket a comma b right bracket Endscripts g left parenthesis x right parenthesis normal d m equals sigma summation Underscript i equals 1 Overscript n Endscripts c Subscript i Baseline m left parenthesis upper A Subscript i Baseline right parenthesis
⎰
[a,b] g(x)dm = ∑n
i=1 cim(Ai). Moreover, any nonnegative function f is 
Lebesgue-integrable iff there exist nonnegative step functions g 1 comma g 2g1, g2 s.t. g 1 left parenthesis x right parenthesis less than or slanted equals f left parenthesis x right parenthesis less than or slanted equals g 2 left parenthesis x right parenthesisg1(x) ⩽
f (x) ⩽g2(x) for x element of left bracket a comma b right bracketx ∈[a, b] and 
integral Underscript left bracket a comma b right bracket Endscripts g 2 left parenthesis x right parenthesis normal d m minus integral Underscript left bracket a comma b right bracket Endscripts g 1 left parenthesis x right parenthesis normal d m less than epsilon comma
⎰
[a,b]
g2(x)dm −
⎰
[a,b]
g1(x)dm < ϵ,
for any epsilon greater than 0ϵ > 0. For general functions we can always take f Superscript minus Baseline comma f Superscript plus Baseline greater than or slanted equals 0f −, f + ⩾0 s.t. f equals f Superscript plus Baseline minus f Superscript minusf =
f + −f −and 
integral Underscript left bracket a comma b right bracket Endscripts f left parenthesis x right parenthesis normal d m equals integral Underscript left bracket a comma b right bracket Endscripts f Superscript plus Baseline left parenthesis x right parenthesis normal d m minus integral Underscript left bracket a comma b right bracket Endscripts f Superscript minus Baseline left parenthesis x right parenthesis normal d m period
⎰
[a,b]
f (x)dm =
⎰
[a,b]
f +(x)dm −
⎰
[a,b]
f −(x)dm.
All the usual properties of the Riemann integral transfers to the Lebesgue integral.2 
In particular: 
1. If f left parenthesis x right parenthesis equals cf (x) = c for every x commax, then it is Lebesgue-integrable and integral Underscript double struck upper R Endscripts f left parenthesis x right parenthesis normal d m equals c period
⎰
R f (x)dm = c.
2. If both f comma gf, g are Lebesgue-integrable and a comma b element of double struck upper R commaa, b
∈
R, then integral Underscript double struck upper R Endscripts left brace a f left parenthesis x right parenthesis plus b g left parenthesis x right parenthesis right brace normal d m equals a integral Underscript double struck upper R Endscripts f left parenthesis x right parenthesis normal d m plus b integral Underscript double struck upper R Endscripts g left parenthesis x right parenthesis normal d m period
⎰
R{a f (x) +
b g(x)}dm = a
⎰
R f (x)dm + b
⎰
R g(x)dm.
3. If f left parenthesis x right parenthesis less than or slanted equals g left parenthesis x right parenthesisf (x) ⩽g(x) for every x commax, and both functions are Lebesgue-integrable, then 
integral Underscript double struck upper R Endscripts f left parenthesis x right parenthesis normal d m less than or slanted equals integral Underscript double struck upper R Endscripts g left parenthesis x right parenthesis normal d m period
⎰
R f (x)dm ⩽
⎰
R g(x)dm.
4. .
⎰
R f (x)dm = ∑∞
i=1
⎰
Bi f (x)dm provided that upper B 1 comma upper B 2 comma ellipsisB1, B2, . . . form a partition of double struck upper R commaR,
i.e. upper B Subscript i Baseline intersection upper B Subscript j Baseline equals empty setBi ∩Bj = ∅for i not equals ji /= j and union Subscript i equals 1 Superscript normal infinity Baseline upper B Subscript i Baseline equals double struck upper R period∪∞
i=1Bi = R.
5. For every sequence of nonnegative Borel-measurable functions f 1 comma f 2 comma ellipsisf1, f2, . . . it 
holds integral Underscript double struck upper R Endscripts sigma summation Underscript n equals 1 Overscript normal infinity Endscripts f Subscript n Baseline normal d m equals sigma summation Underscript n equals 1 Overscript normal infinity Endscripts integral Underscript double struck upper R Endscripts f Subscript n Baseline normal d m period
⎰
R
∑∞
n=1 fndm = ∑∞
n=1
⎰
R fndm.
6. . 
||⎰
R f (x)dm
|| ⩽
⎰
R |f (x)|dm
Properties 1 and 3 can be stated in the a.e. sense, with the Lebesgue measure 
being zero over the sets left brace f not equals c right brace{f /= c} and left brace f greater than g right brace period{f > g}. Moreover, the Lebesgue integral 
can be deﬁned over general Borel subset of double struck upper RR just by indicators, integral Underscript upper B Endscripts f left parenthesis x right parenthesis normal d m equals integral Underscript double struck upper R Endscripts bold upper I Subscript upper B Baseline f left parenthesis x right parenthesis normal d m
⎰
B f (x)dm =
⎰
R IBf (x)dm. The function in Example N.1 is Lebesgue-integrable over every ﬁnite 
interval left bracket a comma b right bracket[a, b], since 
integral Underscript left bracket a comma b right bracket Endscripts g left parenthesis x right parenthesis normal d m equals integral Underscript left bracket a comma b right bracket Endscripts bold upper I Subscript double struck upper Q intersection left bracket a comma b right bracket Baseline normal d m equals 1 m left parenthesis double struck upper Q intersection left bracket a comma b right bracket right parenthesis plus 0 m left parenthesis left parenthesis double struck upper Q intersection left bracket a comma b right bracket right parenthesis Superscript c Baseline right parenthesis equals 0 comma
⎰
[a,b]
g(x)dm =
⎰
[a,b]
IQ∩[a,b]dm = 1m(Q ∩[a, b]) + 0m((Q ∩[a, b])c) = 0,
2 Exchanging limits and integrals is permitted under weaker conditions than for Riemann integra-
tion. 
388
N
Lebesgue Integral
for double struck upper Q intersection left bracket a comma b right bracketQ ∩[a, b] is countable and has Lebesgue measure zero, and so is left parenthesis double struck upper Q intersection left bracket a comma b right bracket right parenthesis Superscript c(Q ∩[a, b])c. 
Riemann and Lebesgue integrals are linked: 
Theorem N.2 Let f colon left bracket a comma b right bracket right arrow double struck upper Rf : [a, b] →R with negative normal infinity less than a less than b less than normal infinity−∞< a < b < ∞.
•
If f is Riemann-integrable over left bracket a comma b right bracket comma[a, b], then f is Lebesgue-integrable and 
integral Subscript a Superscript b Baseline f left parenthesis x right parenthesis normal d x equals integral Underscript left bracket a comma b right bracket Endscripts f left parenthesis x right parenthesis normal d m
⎰b
a f (x)dx =
⎰
[a,b] f (x)dm.
•
If f is bounded in left bracket a comma b right bracket[a, b] then f is Riemann-integrable iff it is continuous m-
almost everywhere (a.e.). 
The last statement means upper A equals StartSet x element of left bracket a comma b right bracket vertical bar f left parenthesis x right parenthesis is not continuous EndSetA = {x ∈[a, b] | f (x) is not continuous} has 
Lebesgue measure zero, m left parenthesis upper A right parenthesis equals 0m(A) = 0. This can happen on a countable set of real 
numbers. Eventually, if f is Lebesgue-integrable over left bracket a comma b right bracket[a, b] then 
upper F left parenthesis x right parenthesis equals integral Underscript left bracket a comma x right bracket Endscripts f left parenthesis u right parenthesis normal d m comma for every x element of left bracket a comma b right bracketF(x) =
⎰
[a,x]
f (u)dm,
for every x ∈[a, b]
implies upper F prime left parenthesis x right parenthesis equals f left parenthesis x right parenthesisF '(x) = f (x) m-a.e. in left bracket a comma b right bracket[a, b], and if f is also differentiable we also have 
upper F primeF ' as Lebesgue-integrable and upper F left parenthesis x right parenthesis minus upper F left parenthesis a right parenthesis equals integral Underscript left bracket a comma x right bracket Endscripts upper F prime left parenthesis u right parenthesis normal d mF(x) −F(a) =
⎰
[a,x] F '(u)dm.
Appendix O 
Double Lebesgue Integral 
Double integrals as double integral Underscript upper B Endscripts normal d x normal d y
⎰⎰
B dxdy are related to the Lebesgue measure m squaredm2 on double struck upper R squaredR2. This  
can be deﬁned as a product measure, i.e.:
•
for any subset upper B equals upper B 1 times upper B 2B = B1 × B2 given by a Cartesian product with upper B 1 comma upper B 2 subset of double struck upper RB1, B2 ⊂R, it  
holds m squared left parenthesis upper B right parenthesis equals m left parenthesis upper B 1 right parenthesis m left parenthesis upper B 2 right parenthesism2(B) = m(B1)m(B2) where m is the one-dimensional Lebesgue measure 
on double struck upper RR;
•
for pairwise disjoint subsets upper B comma upper C subset of double struck upper R squaredB, C ⊂R2 it holds m squared left parenthesis upper B union upper C right parenthesis equals m squared left parenthesis upper B right parenthesis plus m squared left parenthesis upper C right parenthesism2(B ∪C) = m2(B) + m2(C);
•
for subsets of the plane s.t. upper B subset of upper CB ⊂C it holds m squared left parenthesis upper B right parenthesis less than or slanted equals m squared left parenthesis upper C right parenthesism2(B) ⩽m2(C). 
Formally m squaredm2 can be written m times mm × m. Recall that 
m left parenthesis left parenthesis a comma b right bracket right parenthesis equals m left parenthesis left parenthesis a comma b right parenthesis right parenthesis equals m left parenthesis left bracket a comma b right parenthesis right parenthesis equals m left parenthesis left bracket a comma b right bracket right parenthesis equals b minus am((a, b]) = m((a, b)) = m([a, b)) = m([a, b]) = b −a
for reals a less than ba < b and m left parenthesis double struck upper R right parenthesis equals normal infinitym(R) = ∞. Hence, m squaredm2 is just the product of the sides’ length 
m left parenthesis left bracket a comma b right bracket right parenthesis equals b minus am([a, b]) = b −a and m left parenthesis left bracket c comma d right bracket right parenthesis equals d minus cm([c, d]) = d −c of the rectangle left bracket a comma b right bracket times left bracket c comma d right bracket[a, b] × [c, d]. The area 
of any other ﬁgure in the plane like circles, which cannot be written as Cartesian 
products, may nevertheless be assigned by m times mm×m. This is because (as any probability 
measure) the Lebesgue product measure m times mm × m is continuous in that we can ﬁnd 
an decreasing sequence of rectangles upper R 1 superset of upper R 2 comma superset of ellipsisR1 ⊃R2, ⊃. . . s.t. the circle B equals their 
union upper B equals union Subscript n Baseline upper R Subscript nB = ∪nRn and 
m times m left parenthesis upper B right parenthesis equals limit Underscript n right arrow normal infinity Endscripts m times m left parenthesis upper R Subscript n Baseline right parenthesis long left right double arrow area left parenthesis upper B right parenthesis equals limit Underscript n right arrow normal infinity Endscripts area left parenthesis white medium square Subscript n Baseline right parenthesis periodm × m(B) = lim
n→∞m × m(Rn) ⇐⇒area(B) = lim
n→∞area(□n).
Remark O.1 The domain of the one-dimensional Lebesgue measure m as a set 
function is the smallest sigma hyphen algebraσ-algebra containing intervals like left parenthesis a comma b right bracket(a, b] and left parenthesis a comma b right parenthesis(a, b). For the  
two-dimensional Lebesgue measure m times mm × m the domain is the smallest sigma hyphen algebraσ-algebra
containing Cartesian products left parenthesis a comma b right bracket times left parenthesis c comma d right bracket(a, b] × (c, d], for reals a less than ba < b and c less than dc < d. In both 
cases the endpoints of such intervals can be negative normal infinity−∞or normal infinity∞. Observe that m evaluates 
ﬁnite or countable set StartSet x 1 comma x 2 comma ellipsis EndSet{x1, x2, . . .} with zero as well as m times mm × m evaluates countable 
set StartSet bold x 1 comma bold x 2 comma ellipsis EndSet subset of double struck upper R squared{x1, x2, . . .} ⊂R2, segments, lines and planes with zero. 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4
389
390
O
Double Lebesgue Integral
Integrating functions of two variables w.r.t. to m times mm × m starts from the choice 
f left parenthesis x comma y right parenthesis equals bold upper I Subscript upper B Baseline left parenthesis x comma y right parenthesisf (x, y) = IB(x, y) for a subset upper B subset of double struck upper R squaredB ⊂R2 picked from the appropriate sigma hyphen algebraσ-algebra: 
StartLayout 1st Row 1st Column m times m left parenthesis upper B right parenthesis 2nd Column equals 3rd Column integral Underscript double struck upper R times double struck upper R Endscripts bold upper I Subscript upper B Baseline left parenthesis x comma y right parenthesis normal d m times m 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Underscript double struck upper R Endscripts left bracket integral Underscript double struck upper R Endscripts bold upper I Subscript upper B Baseline left parenthesis x comma y right parenthesis normal d x right bracket normal d y 3rd Row 1st Column Blank 2nd Column equals 3rd Column integral Underscript double struck upper R Endscripts left bracket integral Underscript double struck upper R Endscripts bold upper I Subscript upper B Baseline left parenthesis x comma y right parenthesis normal d y right bracket normal d x comma EndLayoutm × m(B) =
⎰
R×R
IB(x, y)dm × m
(O.1)
=
⎰
R
⎾⎰
R
IB(x, y)dx
⏋
dy
=
⎰
R
⎾⎰
R
IB(x, y)dy
⏋
dx,
where we used the identiﬁcation normal d x identical to normal d mdx ≡dm and normal d y identical to normal d mdy ≡dm. This is the ﬁrst step in 
deﬁning integration w.r.t. the Lebesgue product measure as Fubini’s theorem Round 
1. If upper B equals upper B 1 times upper B 2B = B1 × B2 we note that bold upper I Subscript upper B Baseline left parenthesis x comma y right parenthesis equals bold upper I Subscript upper B 1 Baseline left parenthesis x right parenthesis bold upper I Subscript upper B 2 Baseline left parenthesis y right parenthesisIB(x, y) = IB1(x)IB2(y) and substituting above we 
get that the double integral double integral Underscript double struck upper R squared Endscripts bold upper I Subscript upper B Baseline left parenthesis x comma y right parenthesis normal d x normal d y equals double integral Underscript upper B Endscripts normal d x normal d y
⎰⎰
R2 IB(x, y)dxdy =
⎰⎰
B dxdy equals 
integral Subscript negative normal infinity Superscript normal infinity Baseline bold upper I Subscript upper B 1 Baseline left parenthesis x right parenthesis normal d x integral Subscript negative normal infinity Superscript normal infinity Baseline bold upper I Subscript upper B 2 Baseline left parenthesis y right parenthesis normal d y equals integral Underscript upper B 1 Endscripts normal d x integral Underscript upper B 2 Endscripts normal d y comma
⎰∞
−∞
IB1(x)dx
⎰∞
−∞
IB2(y)dy =
⎰
B1
dx
⎰
B2
dy,
so the product of two one-dimensional integrals yields just the ‘area’ 
m times m left parenthesis upper B right parenthesis equals m left parenthesis upper B 1 right parenthesis m left parenthesis upper B 2 right parenthesis periodm × m(B) = m(B1)m(B2).
The above double integral can be extended1 to bounded, continuous or more general 
functions f left parenthesis x comma y right parenthesisf (x, y), instead of indicators bold upper I Subscript upper B Baseline left parenthesis x comma y right parenthesisIB(x, y), s.t. the integral double integral Underscript upper B Endscripts f left parenthesis x comma y right parenthesis normal d x normal d y
⎰⎰
B f (x, y)dxdy
exists. 
Remark O.2 In Fubini’s theorem Round 1 given by formula (O.1) it is crucial that 
the two functions 
y right arrow from bar integral Underscript double struck upper R Endscripts bold upper I Subscript upper B Baseline left parenthesis x comma y right parenthesis normal d xy ⍿→
⎰
R
IB(x, y)dx
and 
x right arrow from bar integral Underscript double struck upper R Endscripts bold upper I Subscript upper B Baseline left parenthesis x comma y right parenthesis normal d yx ⍿→
⎰
R
IB(x, y)dy
are integrable in double struck upper RR w.r.t m and their one-dimensional integrals coincide. 
The above approach to integration may be pushed further, by considering any 
pair of nonempty sets upper S 1 comma upper S 2S1, S2 endowed with their own sigma hyphen algebraσ-algebras upper Sigma 1 comma upper Sigma 2Σ1, Σ2. Thus one
1 Using a standard machine similar to that used in deﬁning expectations. 
O
Double Lebesgue Integral
391
can show there exists a product measure m 1 times m 2m1×m2 s.t. m Subscript i Baseline colon upper Sigma Subscript i Baseline right arrow left bracket 0 comma normal infinity right bracketmi : Σi →[0, ∞] is a measure 
for i equals 1 comma 2i = 1, 2 and:
•
.m1 × m2(B) = m1(B1)m2(B2) for upper B equals upper B 1 times upper B 2 element of upper Sigma 1 times upper Sigma 2B = B1 × B2 ∈Σ1 × Σ2;
•
formula (O.1) holds, with generic integrable function f left parenthesis x comma y right parenthesisf (x, y) replacing bold upper I Subscript upper B Baseline left parenthesis x comma y right parenthesisIB(x, y)
and the one-dimensional Lebesgue measure replaced by the two m 1 comma m 2m1, m2;
•
the functions y right arrow from bar integral Underscript upper S 1 Endscripts f left parenthesis x comma y right parenthesis normal d m 1y ⍿→
⎰
S1 f (x, y)dm1 and x right arrow from bar integral Underscript upper S 1 Endscripts f left parenthesis x comma y right parenthesis normal d m 2x ⍿→
⎰
S1 f (x, y)dm2 are integrable w.r.t. 
m 2m2 and m 2m2, and their integrals coincide. 
Here upper Sigma 1 times upper Sigma 2Σ1×Σ2 is called the product sigmaσ-algebra and is generated by Cartesian products 
of subsets taken individually from upper S 1S1 and upper S 2S2. But be warned that it is not the 
Cartesian product of the two sigma hyphen algebraσ-algebras, despite we used the same symbol. 
Example O.1 We can consider upper S 1 times upper S 2 equals double struck upper R squaredS1 × S2 = R2 and the (probabilistic) product 
measure sans serif upper P Subscript bold upper X Baseline equals sans serif upper P Subscript upper X Baseline times sans serif upper P Subscript upper YPX = PX × PY corresponding to the laws of two independent rvs upper X comma upper YX, Y s.t. 
sans serif upper P Subscript bold upper X Baseline left parenthesis upper B right parenthesis equals sans serif upper P Subscript upper X Baseline left parenthesis upper B 1 right parenthesis sans serif upper P Subscript upper Y Baseline left parenthesis upper B 1 right parenthesis equals integral Underscript upper B 1 Endscripts normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis integral Underscript upper B 2 Endscripts normal d upper F Subscript upper Y Baseline left parenthesis y right parenthesis commaPX(B) = PX(B1)PY (B1) =
⎰
B1
dFX(x)
⎰
B2
dFY (y),
where upper B equals upper B 1 times upper B 2B = B1 × B2 for subsets upper B 1 comma upper B 2 subset of double struck upper RB1, B2 ⊂R for which sans serif upper P Subscript upper X Baseline left parenthesis upper B 1 right parenthesis equals sans serif upper P left parenthesis upper X element of upper B 1 right parenthesisPX(B1) = P(X ∈B1)
and sans serif upper P Subscript upper Y Baseline left parenthesis upper B 2 right parenthesis equals sans serif upper P left parenthesis upper Y element of upper B 2 right parenthesisPY (B2) = P(Y ∈B2). Here bold upper X equals left parenthesis upper X comma upper Y right parenthesisX = (X, Y). In fact the independence assumption 
entails sans serif upper P Subscript bold upper X Baseline equals sans serif upper P Subscript upper X Baseline sans serif upper P Subscript upper YPX = PXPY and by the Fubini’s theorem we have, for a upper B subset of double struck upper R squaredB ⊂R2 other than 
a Cartesian product, 
sans serif upper P left parenthesis bold upper X element of upper B right parenthesis equals sans serif upper P Subscript bold upper X Baseline left parenthesis upper B right parenthesis equals double integral Underscript upper B Endscripts normal d upper F Subscript upper X Baseline left parenthesis x right parenthesis normal d upper F Subscript upper Y Baseline left parenthesis y right parenthesis commaP(X ∈B) = PX(B) =
⎰⎰
B
dFX(x)dFY (y),
But when the independence assumption is dropped the joint CDF upper F Subscript bold upper XFX no longer 
corresponds to a product probability law sans serif upper P Subscript bold upper X Baseline equals sans serif upper P Subscript upper X Baseline sans serif upper P Subscript upper YPX = PXPY . For the Fubini’s theorem 
to hold we need the further assumption that bold upper XX is absolutely continuous with joint 
density s.t. 
sans serif upper P Subscript bold upper X Baseline left parenthesis upper B right parenthesis equals double integral Underscript upper B Endscripts f Subscript bold upper X Baseline left parenthesis x comma y right parenthesis normal d x normal d y periodPX(B) =
⎰⎰
B
fX(x, y)dxdy.
This corresponds to an iterated integral provided B equals the Cartesian product 
of two subsets in double struck upper RR, like intervals. Then, for absolutely continuous random vectors 
we have sans serif upper P Subscript bold upper X Baseline much less than m times mPX ⪡m × m with Radon-Nikodým derivative just the density f Subscript bold upper XfX, i.e. 
m times m left parenthesis upper B right parenthesis equals 0m × m(B) = 0 implies sans serif upper P Subscript bold upper X Baseline left parenthesis upper B right parenthesis equals 0PX(B) = 0. 
Example O.2 Another typical usage of product measures and Fubini’s theorem is 
when m 1 equals sans serif upper Pm1 = P, m 2 equals mm2 = m and f left parenthesis x comma y right parenthesis equals f left parenthesis omega comma y right parenthesisf (x, y) = f (ω, y). Therefore, upper S 1 times upper S 2 equals upper Omega times double struck upper RS1 × S2 = Ω × R, but  
in some applications the ‘second set’ in the Cartesian product can be reduced to a 
subset such as left bracket 0 comma normal infinity right parenthesis[0, ∞). The product measure is m times sans serif upper Pm × P and the double integral with
392
O
Double Lebesgue Integral
the corresponding iterated integrals (viz. Fubini’s theorem) are: 
StartLayout 1st Row 1st Column double integral Underscript upper Omega times double struck upper R Endscripts f left parenthesis omega comma y right parenthesis normal d sans serif upper P times m 2nd Column equals 3rd Column integral Underscript upper Omega Endscripts left bracket integral Subscript negative normal infinity Superscript normal infinity Baseline f left parenthesis omega comma y right parenthesis normal d y right bracket normal d sans serif upper P 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket integral Underscript upper Omega Endscripts f left parenthesis omega comma y right parenthesis normal d sans serif upper P right bracket normal d y period EndLayout
⎰⎰
Ω×R
f (ω, y)dP × m =
⎰
Ω
⎾⎰∞
−∞
f (ω, y)dy
⏋
dP
=
⎰∞
−∞
⎾⎰
Ω
f (ω, y)dP
⏋
dy.
For example letting f left parenthesis omega comma y right parenthesis equals bold upper I Subscript upper B Baseline left parenthesis omega comma y right parenthesisf (ω, y) = IB(ω, y) with the set upper B equals StartSet left parenthesis omega comma y right parenthesis vertical bar 0 less than or slanted equals y less than or slanted equals upper X left parenthesis omega right parenthesis EndSetB = {(ω, y) | 0 ⩽y ⩽X(ω)}
and replacing double struck upper RR with left bracket 0 comma normal infinity right parenthesis[0, ∞) we get 
StartLayout 1st Row 1st Column double integral Underscript upper Omega times left bracket 0 comma normal infinity right parenthesis Endscripts bold upper I Subscript upper B Baseline left parenthesis omega comma y right parenthesis normal d sans serif upper P times m 2nd Column equals 3rd Column integral Underscript upper Omega Endscripts left bracket integral Subscript 0 Superscript normal infinity Baseline bold upper I Subscript upper B Baseline left parenthesis omega comma y right parenthesis normal d y right bracket normal d sans serif upper P 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript 0 Superscript normal infinity Baseline left bracket integral Underscript upper Omega Endscripts bold upper I Subscript upper B Baseline left parenthesis omega comma y right parenthesis normal d sans serif upper P right bracket normal d y comma EndLayout
⎰⎰
Ω×[0,∞)
IB(ω, y)dP × m =
⎰
Ω
⎾⎰∞
0
IB(ω, y)dy
⏋
dP
=
⎰∞
0
⎾⎰
Ω
IB(ω, y)dP
⏋
dy,
where upper X left parenthesis omega right parenthesisX(ω) is a nonnegative rv. 
Example O.3 Now 
integral Subscript 0 Superscript normal infinity Baseline bold upper I Subscript upper B Baseline left parenthesis omega comma y right parenthesis normal d y equals integral Subscript 0 Superscript upper X left parenthesis omega right parenthesis Baseline normal d y equals upper X left parenthesis omega right parenthesis
⎰∞
0
IB(ω, y)dy =
⎰X(ω)
0
dy = X(ω)
and 
integral Underscript upper Omega Endscripts bold upper I Subscript upper B Baseline left parenthesis omega comma y right parenthesis normal d sans serif upper P equals integral Underscript left brace upper X greater than or slanted equals y right brace Endscripts normal d sans serif upper P equals sans serif upper P left parenthesis upper X greater than or slanted equals y right parenthesis period
⎰
Ω
IB(ω, y)dP =
⎰
{X⩾y}
dP = P(X ⩾y).
Thus we get 
integral Underscript upper Omega Endscripts upper X left parenthesis omega right parenthesis normal d sans serif upper P equals sans serif upper E left parenthesis upper X right parenthesis equals integral Subscript 0 Superscript normal infinity Baseline sans serif upper P left parenthesis upper X greater than or slanted equals y right parenthesis normal d y comma
⎰
Ω
X(ω)dP = E(X) =
⎰∞
0
P(X ⩾y)dy,
an alternative way of deriving the formula for expectations of nonnegative rvs. 
Remark O.3 Alternatively we can consider the product measure sans serif upper P Subscript upper X Baseline times mPX × m so that 
StartLayout 1st Row 1st Column double integral Underscript double struck upper R squared Endscripts f left parenthesis x comma y right parenthesis normal d sans serif upper P Subscript upper X times m 2nd Column equals 3rd Column integral Subscript negative normal infinity Superscript normal infinity Baseline left bracket integral Subscript 0 Superscript normal infinity Baseline bold upper I Subscript upper B Baseline left parenthesis x comma y right parenthesis normal d y right bracket normal d sans serif upper P Subscript upper X 2nd Row 1st Column Blank 2nd Column equals 3rd Column integral Subscript 0 Superscript normal infinity Baseline left bracket integral Subscript negative normal infinity Superscript normal infinity Baseline bold upper I Subscript upper B Baseline left parenthesis x comma y right parenthesis normal d sans serif upper P Subscript upper X Baseline right bracket normal d y comma EndLayout
⎰⎰
R2 f (x, y)dPX × m =
⎰∞
−∞
⎾⎰∞
0
IB(x, y)dy
⏋
dPX
=
⎰∞
0
⎾⎰∞
−∞
IB(x, y)dPX
⏋
dy,
where upper B equals StartSet left parenthesis x comma y right parenthesis vertical bar 0 less than or slanted equals y less than or slanted equals x EndSetB = {(x, y) | 0 ⩽y ⩽x}. Thus, the ﬁrst bracket is integral Subscript 0 Superscript x Baseline normal d y equals x
⎰x
0 dy = x while the 
second is integral Subscript y Superscript normal infinity Baseline normal d sans serif upper P Subscript upper X Baseline equals sans serif upper P left parenthesis upper X greater than or slanted equals y right parenthesis
⎰∞
y
dPX = P(X ⩾y) for a corresponding rv X with law sans serif upper P Subscript upper XPX.
O
Double Lebesgue Integral
393
Given two probability spaces left parenthesis upper Omega 1 comma script upper F 1 comma sans serif upper P 1 right parenthesis(Ω1, F1, P1) and left parenthesis upper Omega 2 comma script upper F 2 comma sans serif upper P 2 right parenthesis comma(Ω2, F2, P2), how can we merge 
the sigma hyphen algebraσ-algebras to build a new probability measure over subsets of upper Omega 1 times upper Omega 2 commaΩ1 × Ω2, using 
both sans serif upper P 1P1 and sans serif upper P 2P2 (this is an example of compound experiment)? Here a useful device 
to get the right answer. 
Theorem O.1 Let left parenthesis upper Omega Subscript i Baseline comma script upper F Subscript i Baseline comma sans serif upper P Subscript i Baseline right parenthesis(Ωi, Fi, Pi) be probability spaces, each i equals 1 comma ellipsis comma n periodi = 1, . . . , n. Then, 
there exists a unique probability measure sans serif upper PP on the product sigma hyphen algebraσ-algebra script upper F equals times Subscript i equals 1 Superscript n Baseline script upper F Subscript iF = ×n
i=1Fi
such that its value for rectangles upper A 1 times upper A 2 times midline horizontal ellipsis times upper A Subscript n Baseline subset of upper Omega 1 times upper Omega 2 times midline horizontal ellipsis times upper Omega Subscript nA1 × A2 × · · · × An ⊂Ω1 × Ω2 × · · · × Ωn is the 
product of single probabilities, sans serif upper P left parenthesis upper A 1 times midline horizontal ellipsis times upper A Subscript n Baseline right parenthesis equals sans serif upper P 1 left parenthesis upper A 1 right parenthesis sans serif upper P 2 left parenthesis upper A 2 right parenthesis midline horizontal ellipsis sans serif upper P Subscript n Baseline left parenthesis upper A Subscript n Baseline right parenthesis periodP(A1 × · · · × An) = P1(A1) P2(A2) · · · Pn(An).
The sans serif upper PP above is the product of the sans serif upper P Subscript i Baseline periodPi. For events upper A element of script upper FA ∈F that are not expressed as 
Cartesian products, sans serif upper P left parenthesis upper A right parenthesisP(A) does not factor. Sometimes, to emphasize the underlying 
product sample space upper OmegaΩ we write sans serif upper P equals sans serif upper P Subscript 1 comma 2 comma ellipsis comma nP = P1,2,...,n or sans serif upper P 1 times midline horizontal ellipsis times sans serif upper P Subscript n Baseline periodP1 × · · · × Pn. What is the 
sigma hyphen algebraσ-algebra script upper F equals times Subscript i equals 1 Superscript n Baseline script upper F Subscript iF = ×n
i=1Fi introduced in Theorem O.1? To answer the question we 
specialize to the case i equals 1 comma 2 periodi = 1, 2. Then, script upper F 1 times script upper F 2F1 × F2 is the smallest sigma hyphen algebraσ-algebra containing 
rectangles upper A 1 times upper A 2 commaA1 × A2, for upper A Subscript i Baseline element of script upper F Subscript iAi ∈Fi each i periodi. It is the product sigma hyphen algebraσ-algebra. Be warned that 
script upper F 1 times script upper F 2F1 × F2 is not the Cartesian product of script upper F 1F1 and script upper F 2F2, despite we use the same symbol 
times×. It is worth noting that script upper F 1 times script upper F 2F1 × F2 can be equivalently generated by the collection 
containing sets of the form upper A 1 times upper Omega 2A1×Ω2 or upper Omega 1 times upper A 2 commaΩ1×A2, for upper A Subscript i Baseline element of script upper F Subscript i Baseline commaAi ∈Fi, i.e. Cartesian products 
in which one factor is the whole ith sample space. 
Example O.4 Recall that to a given joint CDF upper F Subscript bold upper X Baseline left parenthesis x 1 comma x 2 right parenthesisFX(x1, x2) on double struck upper R squaredR2 does correspond 
1-to-1 a unique probability measure sans serif upper P Subscript bold upper XPX on left parenthesis double struck upper R squared comma script upper B squared right parenthesis(R2, B2) via 
sans serif upper P Subscript bold upper X Baseline left parenthesis left parenthesis a 1 comma b 1 right bracket times left parenthesis a 2 comma b 2 right bracket right parenthesis equals upper Delta Subscript a 1 comma b 1 Baseline upper Delta Subscript a 2 comma b 2 Baseline upper F Subscript bold upper X Baseline left parenthesis x 1 comma x 2 right parenthesis greater than or slanted equals 0 periodPX((a1, b1] × (a2, b2]) = Δa1,b1Δa2,b2FX(x1, x2) ⩾0.
Now, to get sans serif upper P Subscript bold upper XPX as a product measure we ﬁrst note that the two-dimensional Borel 
sigma hyphen algebraσ-algebra script upper B squaredB2 is equal to the product sigma hyphen algebraσ-algebra script upper B times script upper BB×B of two one-dimensional Borel 
sigma hyphen algebraσ-algebras on double struck upper RR (this is a non-trivial result). Please: do not confuse script upper B times script upper BB × B with the 
Cartesian product of the one-dimensional Borel sigma hyphen algebraσ-algebra, and recall that we only 
use the same symbol times×. Next, by Theorem O.1 above we must have sans serif upper P Subscript bold upper X Baseline left parenthesis upper B 1 times upper B 2 right parenthesis equals sans serif upper P Subscript upper X 1 Baseline left parenthesis upper B 1 right parenthesis times sans serif upper P Subscript upper X 2 Baseline left parenthesis upper B 2 right parenthesisPX(B1 ×B2) =
PX1(B1) × PX2(B2) for any Borel set upper B Subscript i Baseline element of script upper BBi ∈B and i equals 1 comma 2i = 1, 2 and a random vector 
bold upper X equals left parenthesis upper X 1 comma upper X 2 right parenthesisX = (X1, X2). Specifying the CDF upper F Subscript bold upper X Baseline left parenthesis x 1 comma x 2 right parenthesisFX(x1, x2) as equal to upper F Subscript upper X 1 Baseline left parenthesis x 1 right parenthesis upper F Subscript upper X 2 Baseline left parenthesis x 2 right parenthesisFX1(x1)FX2(x2), i.e. 
using independence of upper F Subscript upper X Sub Subscript i Baseline left parenthesis x Subscript i Baseline right parenthesisFXi(xi) CDFs on double struck upper R commaR, we yield the desired result: starting 
from left-open two-dimensional intervals and then extending to the whole script upper B times script upper B periodB × B.
Note that 
upper Delta Subscript a 1 comma b 1 Baseline upper Delta Subscript a 2 comma b 2 Baseline upper F Subscript bold upper X Baseline left parenthesis x 1 comma x 2 right parenthesis equals left parenthesis upper F Subscript upper X 1 Baseline left parenthesis b 1 right parenthesis minus upper F Subscript upper X 1 Baseline left parenthesis a 1 right parenthesis right parenthesis dot left parenthesis upper F Subscript upper X 2 Baseline left parenthesis b 2 right parenthesis minus upper F Subscript upper X 2 Baseline left parenthesis a 2 right parenthesis right parenthesis greater than or slanted equals 0 periodΔa1,b1Δa2,b2FX(x1, x2) = (FX1(b1) −FX1(a1)) · (FX2(b2) −FX2(a2)) ⩾0.
References 
1. Billingsley, P.: Convergence of Probability Measures. Wiley, New York (1993) 
2. Billingsley, P.: Probability and Measure. Wiley, New York (1995) 
3. Breiman, L.: Probability. SIAM, CLASSICS in Applied Mathematics 07 (1992) 
4. Brockwell, J.P., Davis, R.A.: Time Series: Theory and Methods. Springer, New York (1991) 
5. Çinlar, E.: Probability and Stochastics. Springer, New York (2011) 
6. Davidson, J.: Stochastic Limit Theory. Oxford University Press, New York (1994) 
7. Föllmer, H., Shied, A.: Stochastic Finance: An Introduction in Discrete Time, Fourth revised 
and extended edition. de Gruyter, Berlin (2016) 
8. Jacod, J., Protter, P.: Probability, Second corrected printing. Springer, Berlin (2004) 
9. Karatzas, I., Shreve, S.: Brownian Motion and Stochastic Calculus. Springer, New York (1991) 
10. Karr, A.F.: Probability. Springer, New York (1993) 
11. McNeil, J.A., Frey, R., Embrechts, P.: Quantitative Risk Management. Concepts, Techniques 
and Tools, Revised Edition. Princeton University Press, Princeton (2015) 
12. Revuz, D., Yor, M.: Continuous Martingale and Brownian Motion. Springer, New York (1991) 
13. Rüschendorf, L.: Mathematical Risk Analysis (Dependence, Risk Bounds, Optimal Allocations 
and Portfolios). Springer, Berlin (2013) 
14. Steele, J.M.: Stochastic Calculus and Financial Applications. Springer, New York (2001) 
15. van der Vaart, A.W.: Asymptotic Statistics. Cambridge University Press, New York (1998) 
16. Williams, D.: Probability with Martingales. Cambridge University Press, Cambridge (1991) 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4
395
Index 
Symbols 
upper L Superscript pLp spaces, 130, 234 
limit inflim inf and limit suplim sup, 345 
piπ-system, 16 
sigma hyphen algebraσ-algebra
Borel, 59 
coarser, 183 
deﬁnition, 5 
ﬁner, 183 
generated by a random vector, 77 
generated by a rv, 14 
generated by an event, 14 
tail, 15 
trace, 20 
trivial, 14 
A 
Absolutely continuous function, 65 
Abstract expectation, 137 
Algebra, 59 
Atom, 11 
Auto-correlation function, 243 
Auto-covariance function, 242 
B 
Basis of a vector space, 362 
Bayes’ formula, 176 
Bernoulli trial, 145 
Best linear predictor, 192 
Bias, 216 
Bilinear, 235 
Binary expansion, 339 
Binomial tree, 17 
Black-Scholes formula, 277 
Block dependence, 91 
Boole’s Inequality, 24 
Borel-Cantelli, 13 
Borel-measurable function, 61 
Borel sets, 59 
Boundary point, 358 
Bounded linear operators, 127 
Bounded set, 359 
Bounded variation function, 378 
C 
Càdlàg, 58 
Cantor, 381 
Carathéodory, 59 
Carnot’s theorem, 374 
Cauchy-Schwarz inequality, 116 
Cauchy sequences, 236 
Cavalieri’s principle, 370 
Central limit theorem 
multivariate, 214 
univariate, 213, 254 
Central moment, 110 
Change of variable formula, 106 
Characteristic function, 111, 212, 229 
Closure, 358 
Coefﬁcient of determination, 193 
Coherent risk measures 
deﬁnition, 265 
dual representation, 266 
robust representation, 266 
Comonotonic risk measures, 266 
Compact set, 360 
Complex numbers, 112 
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024 
D. Rossello, A Cookbook with Probability One, La Matematica per il 3+2 161, 
https://doi.org/10.1007/978-3-031-54688-4
397
398
Index
Concave real-valued function, 356 
Conditional density, 174 
Conditional distributions, 173 
Conditional expectation 
given a sigma hyphen algebraσ-algebra, 181, 277 
given an event, 176 
given a random variable, 179 
Conditional independence, 99 
Conditional masses, 173 
Conditional variance, 191 
Conjugate exponents, 132 
Connected set, 371 
Consistent FIDIS, 240 
Contingent claim, 273 
Continuous function, 353 
Continuous mapping theorem, 211 
Convergence of random variables 
upper L Superscript 1L1, 209 
almost sure, 209 
in distribution, 209, 226 
in mean square, 209, 281 
in probability, 209 
weak convergence, 210 
Convergence of real-valued functions 
pointwise, 365 
uniform, 365 
Convex real-valued function, 356 
Convex risk measures, 265 
Convex subset of a vector space, 363 
Convolution formula, 91 
Copula function, 198, 204 
Covariance, 119 
Cumulative distribution function (CDF) 
multivariate continuous, 80 
multivariate discrete, 79 
multivariate, n-increasing, 97 
multivariate, deﬁnition, 77 
univariate continuous, 32 
univariate discrete, 29 
univariate, defective, 228 
univariate, deﬁnition, 27 
Cylinder sets, 239 
D 
Delta function, 50 
Delta method, 214 
DeMorgan’s law, 19 
Dependence, 3 
Diffeomorphism, 128 
Differentiable multivariable function, 368 
Differentiable real-valued function, 356 
Diffusion equation, 282 
Dimension of a vector space, 362 
Dirac delta measure, 37 
Directional derivative, 367 
Dispersion parameter, 114 
Distribution function, 63 
Donsker’s invariance principle, 259 
Doob-Dynkin lemma, 180 
Double Lebesgue integral, 389 
Dynkin system, 16 
E 
Empirical distribution function, 216 
Empirical process, 216 
Empirical quantile function, 218 
Equivalence relation, 235 
Estimate, 208 
Estimator 
point, 215 
unbiased, 216 
Euclidean metric, 82, 357 
Euclidean norm, 357 
Event 
sans serif upper PP-null, 6 
almost surely, 7 
certain, 4 
deﬁnition, 3 
eventually, 13 
impossible, 4 
independent, 86 
indexed family, 87 
inﬁnitely often, 12 
partition, 22 
Expectation 
continuous, 105 
discrete, 104 
Expected shortfall, 178, 267 
Expectile 
deﬁnition, 268 
risk measure, 269 
F 
Failure probability, 146 
Fatou’s lemma, 141 
Filtration, 238 
Finite dimensional distribution, 90, 239 
Finite measure, 59 
Fourier transform, 230 
Free of arbitrage market, 273 
Fubini’s theorem, 81, 94, 380, 390
Index
399
G 
Gamma function, 167 
Gaussian copula, 200 
Generalized functions, 50 
Generator, 15 
Girsanov’s theorem, 276 
Glivenko-Cantelli theorem, 217 
Gradient, 368 
H 
Heaviside function, 36 
Helly’s selection principle, 228 
Hilbert space, 236 
Histogram, 219 
Hitting time, 253 
Hoeffding’s lemma, 195 
Hyperplane, 362 
I 
Image measure, 62 
Independence, 98 
Independence copula, 199 
Indicator 
deterministic, 35 
random, 35 
Inequality 
Cauchy-Schwarz, 235, 364 
Chebyshev, 118, 213, 280 
Hölder, 117, 235 
Jensen, 117 
Lyapunov, 235 
Markov, 118 
Minkowski, 117, 235 
Inner product, 363, 368 
Integration by parts formula, 139 
Integration over subsets, 108 
Interior point, 358 
Inverse Fourier transform, 113 
Inverse transform method, 154 
Itô isometry, 281 
Itô stochastic integral, 275, 279 
Itô’s formula, 283 
J 
Jacobian, 128 
Jacobian matrix, 128 
Jacobi’s transformation formula, 128 
Joint density function, 81 
Joint masses, 78 
Jump discontinuity, 29, 354 
K 
Kolmogorov, 2 
Kolmogorov extension theorem, 240 
Kurtosis, 114 
L 
Lagrange, 356 
Laplace transform, 232 
Law of total probability, 176 
Law of total variance, 191 
Least-square estimate, 191 
Lebesgue integral, 135, 385 
Lebesgue measure, 56, 381 
Lebesgue null sets, 381 
Lebesgue’s dominated convergence theorem, 
141, 232 
Lebesgue-Stieltjes measure, 377 
Left-inverse, 263 
Leibniz’s formula, 379 
Levy’s continuity theorem, 212, 231 
Likelihood function, 215 
Limit, 341 
Limit points, 359 
Linear functional, 127, 217, 363 
Linearly independent vectors, 362 
Linear operator, 127 
Linear prediction, 190 
Lipschitz condition, 66 
Location parameter, 114 
Log-likelihood function, 215 
Log-normal stock price model, 222 
Lower Fréchet bound, 197 
M 
Marginal distribution 
continuous, 81 
discrete, 78 
Market efﬁciency, 175, 193 
Markov property, 18 
Maximal linear dependence, 195 
Mean absolute deviation, 114 
Mean function, 241 
Mean squared error, 216 
Measurable map, 61 
Measurable rectangles, 239 
Measurable space, 6 
Median, 47 
Memoryless property, 166 
Metric, 236 
Minimal linear dependence, 195
400
Index
Mixed 
CDF, 38 
random variable, 48 
Moment, 110 
Moment generating function, 111, 146, 148, 
152, 156, 159, 165, 168, 169, 231 
Monotone convergence theorem, 135 
Monte Carlo Simulation, 220 
Multivariate expectation, 120 
N 
Natural ﬁltration, 238 
Neighborhood, 342, 353 
Norm, 235, 363 
Normed space, 236, 363 
O 
Open ball, 357 
Open cover, 360 
Open sets, 353 
Option 
European, 40 
payoff of, 40 
strike price, 40 
Order 
increasing concave, 43 
partial, 42 
usual stochastic, 42 
Ordered statistics, 218 
Orthogonal, 236 
Orthogonal vectors, 364, 373 
Orthonormal set, 364 
Outcome, 1 
P 
Parallelogram law, 361 
Parametric distribution 
Bernoulli, 144, 145 
binomial, 144, 146 
continuous uniform, 144 
discrete uniform, 143, 144 
exponential, 144, 164 
gamma, 144, 167 
Gaussian, 144, 158, 277 
Poisson, 144, 150 
Student-t, 144, 169 
Partial derivative, 82 
Pearson correlation coefﬁcient, 120 
Portfolio 
arbitrage, 275 
optimization, 123 
performance, 123 
return, 122 
self-ﬁnancing, 274 
value, 40, 273 
variance, 122 
Portmanteau’s lemma, 225 
Power series, 365 
Prediction error, 189, 193 
Predictor, 189 
Probability 
absolute continuity, 32 
absolutely continuous, 181 
conditional, 85 
continuity of, 12 
convex combination of, 48 
countable additivity, 6 
density function, 32 
diffusive, 11 
ﬁnitely additive, 59 
inclusion-exclusion formula, 24 
intuition, 2 
law, 27 
mass function, 29 
measure, 6 
purely atomic, 11 
regular conditional, 184, 187 
singular, 52 
singular continuous, 52 
symmetric law, 44 
transform, 153 
union-intersection formula, 24 
Probability space 
continuous uniform, 23 
deﬁnition, 6 
discrete, 10 
discrete uniform, 9 
real, 62 
Product measure, 389 
Product sigma hyphen algebraσ-algebra, 391 
Projection, 190, 236 
Projection map, 69 
Proper location-scale density, 116 
Pseudo-metric, 235 
Q 
Quadratic form, 161 
Quadratic variation, 279 
Quantile 
deﬁnition, 45, 263 
transform, 153 
Quantile plot, 219
Index
401
R 
Radius of convergence, 365 
Radon-Nikodým 
derivative, 182, 187 
theorem, 182 
Radon-Nikodým derivative, 266, 383 
Random experiment, 1 
Random sample, 207 
Random variable 
almost surely equal, 41 
antimonotone, 85 
comonotone, 85 
continuous, 32 
deﬁnition, 29 
equal in distribution, 41 
IID, 89 
image, 61 
inverse image, 61 
limit of, 71 
negative part of, 39 
pointwise convergence, 134 
positive part of, 39 
range, 61 
simple, 36 
sketchy deﬁnition, 1 
support, 29 
tight, 227 
uncorrelated, 125 
uniformly integrable, 227 
uniformly tight, 227 
Random vector 
continuous, 80 
deﬁnition, 76 
discrete, 77 
Real measurable space, 59 
Real-valued sequence, 341 
Real-valued series, 349 
Reﬂection principle, 253 
Regression 
coefﬁcient, 193 
function, 189 
line, 193 
Replicable payoff, 273 
Residual variance, 193 
Return 
arithmetic, 39 
continuosly compounded, 40 
gross, 39 
log, 39 
Riemann double integral, 369 
Riemann-integrable function, 385 
Right-inverse, 263 
Risk 
credit, 262 
liquidity, 262 
market, 262 
Risk factors, 196 
Risk-neutral drift, 276 
Risk neutral pricing, 181, 184, 221 
S 
Sample mean, 208 
Sample path, 237 
Sample space, 1 
Sample variance, 208 
Sampling distribution, 216 
Scale parameter, 116 
Semi-deﬁnite positive matrix, 133 
Sequential conditioning, 88 
Set operation 
complementation, 4 
difference, 4 
intersection, 4 
union, 4 
Shape parameter, 114 
Skewness coefﬁcient, 114 
Sklar’s theorem, 198, 204 
Slutsky’s lemma, 212, 229 
Space of a subspace, 362 
Standard deviation, 110 
State space, 237 
Statistical functional, 217 
Statistics, 208 
Stieltjes integral, 53, 94, 279, 377 
Stieltjes measure, 64 
Stochastic dependence, 84 
Stochastic differential equation, 274 
Stochastic process 
adapted, 238 
AR(1), 250, 256 
Brownian motion, 252, 274 
continuous-time, 237 
deﬁnition, 237 
discrete-time, 237 
GARCH(1,1), 251, 256 
Gaussian, 244 
independent increments, 242 
Markov, 250 
martingale, 248 
martingale difference, 249 
random walk, 246 
simple, 280 
stationary increments, 242 
strictly stationary, 242 
weakly stationary, 242 
white noise, 243 
Wiener, 252
402
Index
Stop-loss 
function, 40 
insurance, 131 
transform, 269 
Strong law of large numbers, 213 
Stylized facts, 45, 251 
Subspace of a vector space, 362 
Success probability, 145 
Support line, 356 
Survival function, 43 
T 
Tangent plane, 368, 376 
Tick, 16 
Times series, 237 
Topological space, 353 
Total differential, 375 
Triangle inequality, 363, 373 
U 
Uncertainty, 1 
Unconditional densities, 175 
Unconditional distribution, 237 
Upper Fréchet bound, 197 
V 
Value-at-risk, 261 
Variance, 110 
Variance-covariance matrix, 121 
Variance function, 242 
Vector space, 127, 361 
W 
Weak law of large numbers, 213 
Weierstrass, 356 
Weierstrass theorem, 360 
Y 
Young’s theorem, 369
